<!DOCTYPE html>
<!-- Generated by Cython 3.0.9 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: cssm.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { color: #000000; margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 3.0.9</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="cssm.cpp">cssm.cpp</a></p>
<div class="cython"><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0001</span>: # Globaly settings for cython</pre>
<pre class='cython code score-8 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test_2, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0002</span>: # cython: cdivision=True</pre>
<pre class="cython line score-0">&#xA0;<span class="">0003</span>: # cython: wraparound=False</pre>
<pre class="cython line score-0">&#xA0;<span class="">0004</span>: # cython: boundscheck=False</pre>
<pre class="cython line score-0">&#xA0;<span class="">0005</span>: # cython: initializedcheck=False</pre>
<pre class="cython line score-0">&#xA0;<span class="">0006</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0007</span>: # Functions for DDM data simulation</pre>
<pre class="cython line score-0">&#xA0;<span class="">0008</span>: import cython</pre>
<pre class="cython line score-0">&#xA0;<span class="">0009</span>: from libc.stdlib cimport rand, RAND_MAX, srand</pre>
<pre class="cython line score-0">&#xA0;<span class="">0010</span>: from libc.math cimport log, sqrt, pow, fmax, atan, sin, cos, tan, M_PI, M_PI_2</pre>
<pre class="cython line score-0">&#xA0;<span class="">0011</span>: from libc.time cimport time</pre>
<pre class="cython line score-0">&#xA0;<span class="">0012</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0013</span>: import numpy as np</pre>
<pre class='cython code score-8 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_ImportDottedModule</span>(__pyx_n_s_numpy, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 13, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 13, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0014</span>: cimport numpy as np</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0015</span>: import numbers</pre>
<pre class='cython code score-8 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_ImportDottedModule</span>(__pyx_n_s_numbers, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 15, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_numbers, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 15, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0016</span>: #import pandas as pd</pre>
<pre class="cython line score-0">&#xA0;<span class="">0017</span>: </pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0018</span>: DTYPE = np.float32</pre>
<pre class='cython code score-11 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 18, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 18, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_DTYPE, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 18, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0019</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0020</span>: cdef set_seed(random_state):</pre>
<pre class='cython code score-5 '>static PyObject *__pyx_f_4cssm_set_seed(PyObject *__pyx_v_random_state) {
  PyObject *__pyx_r = NULL;
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.set_seed", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0021</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">0022</span>:     if random state is provided,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0023</span>:     this function sets a random state globally for the function.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0024</span>:     """</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0025</span>:     if random_state is None:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_random_state == Py_None);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0026</span>:         return srand(time(NULL))</pre>
<pre class='cython code score-1 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_2 = __Pyx_void_to_None(srand(time(NULL)));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 26, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0027</span>:     if isinstance(random_state, numbers.Integral):</pre>
<pre class='cython code score-11 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numbers);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 27, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_Integral);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 27, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_random_state, __pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(0, 27, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0028</span>:         return srand(random_state)</pre>
<pre class='cython code score-8 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_As_unsigned_int</span>(__pyx_v_random_state); if (unlikely((__pyx_t_4 == (unsigned int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 28, __pyx_L1_error)</span>
    __pyx_t_3 = __Pyx_void_to_None(srand(__pyx_t_4));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 28, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0029</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0030</span>: # Method to draw random samples from a gaussian</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0031</span>: cdef float random_uniform():</pre>
<pre class='cython code score-0 '>static float __pyx_f_4cssm_random_uniform(void) {
  float __pyx_v_r;
  float __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0032</span>:     cdef float r = rand()</pre>
<pre class='cython code score-0 '>  __pyx_v_r = rand();
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0033</span>:     return r / RAND_MAX</pre>
<pre class='cython code score-0 '>  __pyx_r = (__pyx_v_r / ((float)RAND_MAX));
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0034</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0035</span>: cdef float random_exponential():</pre>
<pre class='cython code score-2 '>static float __pyx_f_4cssm_random_exponential(void) {
  float __pyx_r;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.random_exponential", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0036</span>:     return - log(random_uniform())</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_1 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 36, __pyx_L1_error)</span>
  __pyx_r = (-log(__pyx_t_1));
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0037</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0038</span>: cdef float random_stable(float alpha):</pre>
<pre class='cython code score-2 '>static float __pyx_f_4cssm_random_stable(float __pyx_v_alpha) {
  float __pyx_v_eta;
  float __pyx_v_u;
  float __pyx_v_w;
  float __pyx_v_x;
  float __pyx_r;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.random_stable", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0039</span>:     cdef float eta, u, w, x</pre>
<pre class="cython line score-0">&#xA0;<span class="">0040</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0041</span>:     u = M_PI * (random_uniform() - 0.5)</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_1 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 41, __pyx_L1_error)</span>
  __pyx_v_u = (M_PI * (__pyx_t_1 - 0.5));
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0042</span>:     w = random_exponential()</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = __pyx_f_4cssm_random_exponential(); if (unlikely(__pyx_t_1 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 42, __pyx_L1_error)</span>
  __pyx_v_w = __pyx_t_1;
</pre><pre class="cython line score-0">&#xA0;<span class="">0043</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0044</span>:     if alpha == 1.0:</pre>
<pre class='cython code score-0 '>  __pyx_t_2 = (__pyx_v_alpha == 1.0);
  if (__pyx_t_2) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0045</span>:         eta = M_PI_2 # useless but kept to remain faithful to wikipedia entry</pre>
<pre class='cython code score-0 '>    __pyx_v_eta = M_PI_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0046</span>:         x = (1.0 / eta) * ((M_PI_2) * tan(u))</pre>
<pre class='cython code score-0 '>    __pyx_v_x = ((1.0 / ((double)__pyx_v_eta)) * (M_PI_2 * tan(__pyx_v_u)));
</pre><pre class="cython line score-0">&#xA0;<span class="">0047</span>:     else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0048</span>:         x = (sin(alpha * u) / (pow(cos(u), 1 / alpha))) * pow(cos(u - (alpha * u)) / w, (1.0 - alpha) / alpha)</pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_v_x = ((sin((__pyx_v_alpha * __pyx_v_u)) / pow(cos(__pyx_v_u), (1.0 / __pyx_v_alpha))) * pow((cos((__pyx_v_u - (__pyx_v_alpha * __pyx_v_u))) / ((double)__pyx_v_w)), ((1.0 - __pyx_v_alpha) / ((double)__pyx_v_alpha))));
  }
  __pyx_L3:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0049</span>:     return x</pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_x;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0050</span>: </pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0051</span>: cdef float[:] draw_random_stable(int n, float alpha):</pre>
<pre class='cython code score-11 '>static __Pyx_memviewslice __pyx_f_4cssm_draw_random_stable(int __pyx_v_n, float __pyx_v_alpha) {
  int __pyx_v_i;
  __Pyx_memviewslice __pyx_v_result = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_5, 1);
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.draw_random_stable", __pyx_clineno, __pyx_lineno, __pyx_filename);
  goto __pyx_L2;
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "Memoryview return value is not initialized");
  }
  __pyx_L2:;
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_result, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0052</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0053</span>:     cdef int i</pre>
<pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0054</span>:     cdef float[:] result = np.zeros(n, dtype = DTYPE)</pre>
<pre class='cython code score-32 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 54, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 54, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 54, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 54, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 54, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 54, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 54, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 54, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 54, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 54, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_result = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0055</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0056</span>:     for i in range(n):</pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_n;
  __pyx_t_7 = __pyx_t_6;
  for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0057</span>:         result[i] = random_stable(alpha)</pre>
<pre class='cython code score-5 '>    __pyx_t_9 = __pyx_f_4cssm_random_stable(__pyx_v_alpha); if (unlikely(__pyx_t_9 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 57, __pyx_L1_error)</span>
    __pyx_t_10 = __pyx_v_i;
    *((float *) ( /* dim=0 */ (__pyx_v_result.data + __pyx_t_10 * __pyx_v_result.strides[0]) )) = __pyx_t_9;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0058</span>:     return result</pre>
<pre class='cython code score-0 '>  __PYX_INC_MEMVIEW(&amp;__pyx_v_result, 1);
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0059</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0060</span>: cdef float random_gaussian():</pre>
<pre class='cython code score-2 '>static float __pyx_f_4cssm_random_gaussian(void) {
  float __pyx_v_x1;
  float __pyx_v_x2;
  float __pyx_v_w;
  float __pyx_r;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.random_gaussian", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0061</span>:     cdef float x1, x2, w</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0062</span>:     w = 2.0</pre>
<pre class='cython code score-0 '>  __pyx_v_w = 2.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0063</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0064</span>:     while(w &gt;= 1.0):</pre>
<pre class='cython code score-0 '>  while (1) {
    __pyx_t_1 = (__pyx_v_w &gt;= 1.0);
    if (!__pyx_t_1) break;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0065</span>:         x1 = 2.0 * random_uniform() - 1.0</pre>
<pre class='cython code score-5 '>    __pyx_t_2 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_2 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 65, __pyx_L1_error)</span>
    __pyx_v_x1 = ((2.0 * __pyx_t_2) - 1.0);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0066</span>:         x2 = 2.0 * random_uniform() - 1.0</pre>
<pre class='cython code score-5 '>    __pyx_t_2 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_2 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 66, __pyx_L1_error)</span>
    __pyx_v_x2 = ((2.0 * __pyx_t_2) - 1.0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0067</span>:         w = x1 * x1 + x2 * x2</pre>
<pre class='cython code score-0 '>    __pyx_v_w = ((__pyx_v_x1 * __pyx_v_x1) + (__pyx_v_x2 * __pyx_v_x2));
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0068</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0069</span>:     w = ((-2.0 * log(w)) / w) ** 0.5</pre>
<pre class='cython code score-0 '>  __pyx_v_w = pow(((-2.0 * log(__pyx_v_w)) / ((double)__pyx_v_w)), 0.5);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0070</span>:     return x1 * w</pre>
<pre class='cython code score-0 '>  __pyx_r = (__pyx_v_x1 * __pyx_v_w);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0071</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0072</span>: cdef int sign(float x):</pre>
<pre class='cython code score-0 '>static int __pyx_f_4cssm_sign(float __pyx_v_x) {
  int __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0073</span>:     return (x &gt; 0) - (x &lt; 0)</pre>
<pre class='cython code score-0 '>  __pyx_r = ((__pyx_v_x &gt; 0.0) - (__pyx_v_x &lt; 0.0));
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0074</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0075</span>: cdef float csum(float[:] x):</pre>
<pre class='cython code score-0 '>static float __pyx_f_4cssm_csum(__Pyx_memviewslice __pyx_v_x) {
  int __pyx_v_i;
  int __pyx_v_n;
  float __pyx_v_total;
  float __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0076</span>:     cdef int i</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0077</span>:     cdef int n = x.shape[0]</pre>
<pre class='cython code score-0 '>  __pyx_v_n = (__pyx_v_x.shape[0]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0078</span>:     cdef float total = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_total = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0079</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0080</span>:     for i in range(n):</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_n;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0081</span>:         total += x[i]</pre>
<pre class='cython code score-0 '>    __pyx_t_4 = __pyx_v_i;
    __pyx_v_total = (__pyx_v_total + (*((float *) ( /* dim=0 */ (__pyx_v_x.data + __pyx_t_4 * __pyx_v_x.strides[0]) ))));
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0082</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0083</span>:     return total</pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_total;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0084</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0085</span>: ## @cythonboundscheck(False)</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0086</span>: cdef void assign_random_gaussian_pair(float[:] out, int assign_ix):</pre>
<pre class='cython code score-2 '>static void __pyx_f_4cssm_assign_random_gaussian_pair(__Pyx_memviewslice __pyx_v_out, int __pyx_v_assign_ix) {
  float __pyx_v_x1;
  float __pyx_v_x2;
  float __pyx_v_w;
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.assign_random_gaussian_pair", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0087</span>:     cdef float x1, x2, w</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0088</span>:     w = 2.0</pre>
<pre class='cython code score-0 '>  __pyx_v_w = 2.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0089</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0090</span>:     while(w &gt;= 1.0):</pre>
<pre class='cython code score-0 '>  while (1) {
    __pyx_t_1 = (__pyx_v_w &gt;= 1.0);
    if (!__pyx_t_1) break;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0091</span>:         x1 = (2.0 * random_uniform()) - 1.0</pre>
<pre class='cython code score-5 '>    __pyx_t_2 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_2 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 91, __pyx_L1_error)</span>
    __pyx_v_x1 = ((2.0 * __pyx_t_2) - 1.0);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0092</span>:         x2 = (2.0 * random_uniform()) - 1.0</pre>
<pre class='cython code score-5 '>    __pyx_t_2 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_2 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 92, __pyx_L1_error)</span>
    __pyx_v_x2 = ((2.0 * __pyx_t_2) - 1.0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0093</span>:         w = (x1 * x1) + (x2 * x2)</pre>
<pre class='cython code score-0 '>    __pyx_v_w = ((__pyx_v_x1 * __pyx_v_x1) + (__pyx_v_x2 * __pyx_v_x2));
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0094</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0095</span>:     w = ((-2.0 * log(w)) / w) ** 0.5</pre>
<pre class='cython code score-0 '>  __pyx_v_w = pow(((-2.0 * log(__pyx_v_w)) / ((double)__pyx_v_w)), 0.5);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0096</span>:     out[assign_ix] = x1 * w</pre>
<pre class='cython code score-0 '>  __pyx_t_3 = __pyx_v_assign_ix;
  *((float *) ( /* dim=0 */ (__pyx_v_out.data + __pyx_t_3 * __pyx_v_out.strides[0]) )) = (__pyx_v_x1 * __pyx_v_w);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0097</span>:     out[assign_ix + 1] = x2 * w # this was x2 * 2 ..... :0</pre>
<pre class='cython code score-0 '>  __pyx_t_3 = (__pyx_v_assign_ix + 1);
  *((float *) ( /* dim=0 */ (__pyx_v_out.data + __pyx_t_3 * __pyx_v_out.strides[0]) )) = (__pyx_v_x2 * __pyx_v_w);
</pre><pre class="cython line score-0">&#xA0;<span class="">0098</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0099</span>: # @cythonboundscheck(False)</pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0100</span>: cdef float[:] draw_gaussian(int n):</pre>
<pre class='cython code score-11 '>static __Pyx_memviewslice __pyx_f_4cssm_draw_gaussian(int __pyx_v_n) {
  int __pyx_v_i;
  __Pyx_memviewslice __pyx_v_result = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_5, 1);
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.draw_gaussian", __pyx_clineno, __pyx_lineno, __pyx_filename);
  goto __pyx_L2;
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "Memoryview return value is not initialized");
  }
  __pyx_L2:;
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_result, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0101</span>:     # Draws standard normal variables - need to have the variance rescaled</pre>
<pre class="cython line score-0">&#xA0;<span class="">0102</span>:     cdef int i</pre>
<pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0103</span>:     cdef float[:] result = np.zeros(n, dtype=DTYPE)</pre>
<pre class='cython code score-32 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 103, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 103, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 103, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 103, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 103, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 103, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 103, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 103, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 103, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 103, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_result = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0104</span>:     for i in range(n // 2):</pre>
<pre class='cython code score-0 '>  __pyx_t_6 = (__pyx_v_n / 2);
  __pyx_t_7 = __pyx_t_6;
  for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-0">&#xA0;<span class="">0105</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0106</span>:         assign_random_gaussian_pair(result, i * 2)</pre>
<pre class='cython code score-0 '>    __pyx_f_4cssm_assign_random_gaussian_pair(__pyx_v_result, (__pyx_v_i * 2));<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 106, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0107</span>:     if n % 2 == 1:</pre>
<pre class='cython code score-0 '>  __pyx_t_9 = ((__pyx_v_n % 2) == 1);
  if (__pyx_t_9) {
/* … */
  }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0108</span>:         result[n - 1] = random_gaussian()</pre>
<pre class='cython code score-5 '>    __pyx_t_10 = __pyx_f_4cssm_random_gaussian(); if (unlikely(__pyx_t_10 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 108, __pyx_L1_error)</span>
    __pyx_t_11 = (__pyx_v_n - 1);
    *((float *) ( /* dim=0 */ (__pyx_v_result.data + __pyx_t_11 * __pyx_v_result.strides[0]) )) = __pyx_t_10;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0109</span>:     return result</pre>
<pre class='cython code score-0 '>  __PYX_INC_MEMVIEW(&amp;__pyx_v_result, 1);
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0110</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0111</span>: # DUMMY TEST SIMULATOR ------------------------------------------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0112</span>: # Simulate (rt, choice) tuples from: SIMPLE DDM -----------------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0113</span>: # Simplest algorithm</pre>
<pre class="cython line score-0">&#xA0;<span class="">0114</span>: # delete random comment</pre>
<pre class="cython line score-0">&#xA0;<span class="">0115</span>: # delete random comment 2</pre>
<pre class="cython line score-0">&#xA0;<span class="">0116</span>: #@cython.boundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0117</span>: #@cython.wraparound(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0118</span>: </pre>
<pre class="cython line score-89" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0119</span>: def test(np.ndarray[float, ndim = 1] v, # drift by timestep 'delta_t'</pre>
<pre class='cython code score-89 '>/* Python wrapper */
static PyObject *__pyx_pw_4cssm_1test(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_4cssm_1test = {"test", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_4cssm_1test, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_4cssm_1test(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyArrayObject *__pyx_v_v = 0;
  PyArrayObject *__pyx_v_a = 0;
  PyArrayObject *__pyx_v_z = 0;
  PyArrayObject *__pyx_v_t = 0;
  float __pyx_v_s;
  float __pyx_v_delta_t;
  float __pyx_v_max_t;
  int __pyx_v_n_samples;
  int __pyx_v_n_trials;
  PyObject *__pyx_v_random_state = 0;
  PyObject *__pyx_v_smooth = 0;
  PyObject *__pyx_v_return_option = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("test (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_v,&amp;__pyx_n_s_a,&amp;__pyx_n_s_z,&amp;__pyx_n_s_t,&amp;__pyx_n_s_s,&amp;__pyx_n_s_delta_t,&amp;__pyx_n_s_max_t,&amp;__pyx_n_s_n_samples,&amp;__pyx_n_s_n_trials,&amp;__pyx_n_s_random_state,&amp;__pyx_n_s_smooth,&amp;__pyx_n_s_return_option,0};
  PyObject* values[12] = {0,0,0,0,0,0,0,0,0,0,0,0};
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4cssm_test(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_random_state, PyObject *__pyx_v_smooth, PyObject *__pyx_v_return_option) {
  __Pyx_memviewslice __pyx_v_v_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_a_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_z_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_t_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_rts = NULL;
  PyObject *__pyx_v_choices = NULL;
  __Pyx_memviewslice __pyx_v_rts_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_choices_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  float __pyx_v_delta_t_sqrt;
  float __pyx_v_sqrt_st;
  float __pyx_v_y;
  float __pyx_v_t_particle;
  float __pyx_v_smooth_u;
  Py_ssize_t __pyx_v_n;
  Py_ssize_t __pyx_v_k;
  int __pyx_v_m;
  int __pyx_v_num_draws;
  __Pyx_memviewslice __pyx_v_gaussian_values = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_LocalBuf_ND __pyx_pybuffernd_a;
  __Pyx_Buffer __pyx_pybuffer_a;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_t;
  __Pyx_Buffer __pyx_pybuffer_t;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_v;
  __Pyx_Buffer __pyx_pybuffer_v;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_z;
  __Pyx_Buffer __pyx_pybuffer_z;
  PyObject *__pyx_r = NULL;
  __pyx_pybuffer_v.pybuffer.buf = NULL;
  __pyx_pybuffer_v.refcount = 0;
  __pyx_pybuffernd_v.data = NULL;
  __pyx_pybuffernd_v.rcbuffer = &amp;__pyx_pybuffer_v;
  __pyx_pybuffer_a.pybuffer.buf = NULL;
  __pyx_pybuffer_a.refcount = 0;
  __pyx_pybuffernd_a.data = NULL;
  __pyx_pybuffernd_a.rcbuffer = &amp;__pyx_pybuffer_a;
  __pyx_pybuffer_z.pybuffer.buf = NULL;
  __pyx_pybuffer_z.refcount = 0;
  __pyx_pybuffernd_z.data = NULL;
  __pyx_pybuffernd_z.rcbuffer = &amp;__pyx_pybuffer_z;
  __pyx_pybuffer_t.pybuffer.buf = NULL;
  __pyx_pybuffer_t.refcount = 0;
  __pyx_pybuffernd_t.data = NULL;
  __pyx_pybuffernd_t.rcbuffer = &amp;__pyx_pybuffer_t;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_v, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 119, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_v.diminfo[0].strides = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_v.diminfo[0].shape = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_a, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 119, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_z, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 119, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_z.diminfo[0].strides = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_z.diminfo[0].shape = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_t, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 119, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_t.diminfo[0].strides = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_t.diminfo[0].shape = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.shape[0];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_2, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_7, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.test", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_v_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_a_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_z_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_t_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_choices);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_rts_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_choices_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__24 = <span class='py_c_api'>PyTuple_Pack</span>(30, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_t, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_random_state, __pyx_n_s_smooth, __pyx_n_s_return_option, __pyx_n_s_v_view, __pyx_n_s_a_view, __pyx_n_s_z_view, __pyx_n_s_t_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_y, __pyx_n_s_t_particle, __pyx_n_s_smooth_u, __pyx_n_s_n, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_num_draws, __pyx_n_s_gaussian_values);<span class='error_goto'> if (unlikely(!__pyx_tuple__24)) __PYX_ERR(0, 119, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__24);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__24);
/* … */
  __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(8);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 119, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 119, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_11, 1, __pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 119, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_11, 2, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 119, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_11, 3, __pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 119, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_11, 4, __pyx_t_10)) <span class='error_goto'>__PYX_ERR(0, 119, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_11, 5, Py_None)) <span class='error_goto'>__PYX_ERR(0, 119, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_False));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_False));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_11, 6, ((PyObject *)Py_False))) <span class='error_goto'>__PYX_ERR(0, 119, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject*)__pyx_n_u_full));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject*)__pyx_n_u_full));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_11, 7, ((PyObject*)__pyx_n_u_full))) <span class='error_goto'>__PYX_ERR(0, 119, __pyx_L1_error)</span>;
  __pyx_t_4 = 0;
  __pyx_t_7 = 0;
  __pyx_t_5 = 0;
  __pyx_t_9 = 0;
  __pyx_t_10 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_4cssm_1test, 0, __pyx_n_s_test, NULL, __pyx_n_s_cssm, __pyx_d, ((PyObject *)__pyx_codeobj__25));<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 119, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_10, __pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 119, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_codeobj__25 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(12, 0, 0, 30, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__24, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_test, 119, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__25)) __PYX_ERR(0, 119, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0120</span>:          np.ndarray[float, ndim = 1] a, # boundary separation</pre>
<pre class="cython line score-0">&#xA0;<span class="">0121</span>:          np.ndarray[float, ndim = 1] z,  # between 0 and 1</pre>
<pre class="cython line score-0">&#xA0;<span class="">0122</span>:          np.ndarray[float, ndim = 1] t, # non-decision time</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0123</span>:          float s = 1, # noise sigma</pre>
<pre class='cython code score-5 '>  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)1.0));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 123, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0124</span>:          float delta_t = 0.001, # timesteps fraction of seconds</pre>
<pre class='cython code score-5 '>  __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(((double)0.001));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 124, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0125</span>:          float max_t = 20, # maximum rt allowed</pre>
<pre class='cython code score-5 '>  __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)20.0));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 125, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0126</span>:          int n_samples = 20000, # number of samples considered</pre>
<pre class='cython code score-2 '>  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)0x4E20));<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 126, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0127</span>:          int n_trials = 10,</pre>
<pre class='cython code score-2 '>  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)10));<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 127, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0128</span>:          random_state = None,</pre>
<pre class='cython code score-2 '>    values[9] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
</pre><pre class="cython line score-228" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0129</span>:          smooth = False,</pre>
<pre class='cython code score-228 '>    values[10] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    values[11] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_full)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_v)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 119, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_a)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 119, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("test", 0, 4, 12, 1); <span class='error_goto'>__PYX_ERR(0, 119, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_z)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 119, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("test", 0, 4, 12, 2); <span class='error_goto'>__PYX_ERR(0, 119, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_t)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[3]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 119, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("test", 0, 4, 12, 3); <span class='error_goto'>__PYX_ERR(0, 119, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_s);
          if (value) { values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 119, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_delta_t);
          if (value) { values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 119, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_max_t);
          if (value) { values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 119, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_samples);
          if (value) { values[7] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 119, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_trials);
          if (value) { values[8] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 119, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  9:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_random_state);
          if (value) { values[9] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 119, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 10:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_smooth);
          if (value) { values[10] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 119, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 11:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_return_option);
          if (value) { values[11] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 119, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "test") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 119, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_v = ((PyArrayObject *)values[0]);
    __pyx_v_a = ((PyArrayObject *)values[1]);
    __pyx_v_z = ((PyArrayObject *)values[2]);
    __pyx_v_t = ((PyArrayObject *)values[3]);
    if (values[4]) {
      __pyx_v_s = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[4]); if (unlikely((__pyx_v_s == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 123, __pyx_L3_error)</span>
    } else {
      __pyx_v_s = ((float)((float)1.0));
    }
    if (values[5]) {
      __pyx_v_delta_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[5]); if (unlikely((__pyx_v_delta_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 124, __pyx_L3_error)</span>
    } else {
      __pyx_v_delta_t = ((float)((double)0.001));
    }
    if (values[6]) {
      __pyx_v_max_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[6]); if (unlikely((__pyx_v_max_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 125, __pyx_L3_error)</span>
    } else {
      __pyx_v_max_t = ((float)((float)20.0));
    }
    if (values[7]) {
      __pyx_v_n_samples = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[7]); if (unlikely((__pyx_v_n_samples == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 126, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_samples = ((int)((int)0x4E20));
    }
    if (values[8]) {
      __pyx_v_n_trials = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[8]); if (unlikely((__pyx_v_n_trials == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 127, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_trials = ((int)((int)10));
    }
    __pyx_v_random_state = values[9];
    __pyx_v_smooth = values[10];
    __pyx_v_return_option = values[11];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("test", 0, 4, 12, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 119, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.test", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) <span class='error_goto'>__PYX_ERR(0, 119, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) <span class='error_goto'>__PYX_ERR(0, 120, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) <span class='error_goto'>__PYX_ERR(0, 121, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) <span class='error_goto'>__PYX_ERR(0, 122, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_4cssm_test(__pyx_self, __pyx_v_v, __pyx_v_a, __pyx_v_z, __pyx_v_t, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_random_state, __pyx_v_smooth, __pyx_v_return_option);
</pre><pre class="cython line score-0">&#xA0;<span class="">0130</span>:          return_option = 'full', # 'full' or 'minimal'</pre>
<pre class="cython line score-0">&#xA0;<span class="">0131</span>:          ):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0132</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0133</span>:     set_seed(random_state)</pre>
<pre class='cython code score-1 '>  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 133, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0134</span>:     # Param views</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0135</span>:     cdef float[:] v_view = v</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_v), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 135, __pyx_L1_error)</span>
  __pyx_v_v_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0136</span>:     cdef float[:] a_view = a</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_a), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 136, __pyx_L1_error)</span>
  __pyx_v_a_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0137</span>:     cdef float[:] z_view = z</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_z), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 137, __pyx_L1_error)</span>
  __pyx_v_z_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0138</span>:     cdef float[:] t_view = t</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_t), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 138, __pyx_L1_error)</span>
  __pyx_v_t_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0139</span>: </pre>
<pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0140</span>:     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)</pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 140, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 140, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 140, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 140, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 140, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 140, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 140, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 140, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 140, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_rts = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0141</span>:     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)</pre>
<pre class='cython code score-46 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 141, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 141, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 141, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 141, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 141, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 141, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 141, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 141, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 141, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 141, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 141, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 141, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_intc);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 141, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 141, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 141, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_choices = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0142</span>:     cdef float[:, :, :] rts_view = rts</pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_rts, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 142, __pyx_L1_error)</span>
  __pyx_v_rts_view = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0143</span>:     cdef int[:, :, :] choices_view = choices</pre>
<pre class='cython code score-2 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_int</span>(__pyx_v_choices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 143, __pyx_L1_error)</span>
  __pyx_v_choices_view = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0144</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0145</span>:     cdef float delta_t_sqrt = sqrt(delta_t)</pre>
<pre class='cython code score-0 '>  __pyx_v_delta_t_sqrt = sqrt(__pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0146</span>:     cdef float sqrt_st = delta_t_sqrt * s</pre>
<pre class='cython code score-0 '>  __pyx_v_sqrt_st = (__pyx_v_delta_t_sqrt * __pyx_v_s);
</pre><pre class="cython line score-0">&#xA0;<span class="">0147</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0148</span>:     cdef float y, t_particle, smooth_u</pre>
<pre class="cython line score-0">&#xA0;<span class="">0149</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0150</span>:     #cdef int n</pre>
<pre class="cython line score-0">&#xA0;<span class="">0151</span>:     cdef Py_ssize_t n, k</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0152</span>:     cdef int m = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_m = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0153</span>:     cdef int num_draws = int(max_t / delta_t + 1)</pre>
<pre class='cython code score-0 '>  __pyx_v_num_draws = ((int)((__pyx_v_max_t / __pyx_v_delta_t) + 1.0));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0154</span>:     cdef float[:] gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 154, __pyx_L1_error)</span>
  __pyx_v_gaussian_values = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0155</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0156</span>:     for k in range(n_trials):</pre>
<pre class='cython code score-0 '>  __pyx_t_9 = __pyx_v_n_trials;
  __pyx_t_10 = __pyx_t_9;
  for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
    __pyx_v_k = __pyx_t_11;
</pre><pre class="cython line score-0">&#xA0;<span class="">0157</span>:         # Loop over samples</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0158</span>:         for n in range(n_samples):</pre>
<pre class='cython code score-0 '>    __pyx_t_12 = __pyx_v_n_samples;
    __pyx_t_13 = __pyx_t_12;
    for (__pyx_t_14 = 0; __pyx_t_14 &lt; __pyx_t_13; __pyx_t_14+=1) {
      __pyx_v_n = __pyx_t_14;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0159</span>:             y = z_view[k] * a_view[k] # reset starting point</pre>
<pre class='cython code score-0 '>      __pyx_t_15 = __pyx_v_k;
      __pyx_t_16 = __pyx_v_k;
      __pyx_v_y = ((*((float *) ( /* dim=0 */ (__pyx_v_z_view.data + __pyx_t_15 * __pyx_v_z_view.strides[0]) ))) * (*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_16 * __pyx_v_a_view.strides[0]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0160</span>:             t_particle = 0.0 # reset time</pre>
<pre class='cython code score-0 '>      __pyx_v_t_particle = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0161</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0162</span>:             # Random walker</pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0163</span>:             while y &lt;= a_view[k] and y &gt;= 0 and t &lt;= max_t:</pre>
<pre class='cython code score-14 '>      while (1) {
        __pyx_t_16 = __pyx_v_k;
        __pyx_t_18 = (__pyx_v_y &lt;= (*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_16 * __pyx_v_a_view.strides[0]) ))));
        if (__pyx_t_18) {
        } else {
          __pyx_t_17 = __pyx_t_18;
          goto __pyx_L9_bool_binop_done;
        }
        __pyx_t_18 = (__pyx_v_y &gt;= 0.0);
        if (__pyx_t_18) {
        } else {
          __pyx_t_17 = __pyx_t_18;
          goto __pyx_L9_bool_binop_done;
        }
        __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_max_t);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 163, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(((PyObject *)__pyx_v_t), __pyx_t_6, Py_LE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 163, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely((__pyx_t_18 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 163, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_17 = __pyx_t_18;
        __pyx_L9_bool_binop_done:;
        if (!__pyx_t_17) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0164</span>:                 y += v_view[k] * delta_t + sqrt_st * gaussian_values[m] # update particle position</pre>
<pre class='cython code score-0 '>        __pyx_t_16 = __pyx_v_k;
        __pyx_t_15 = __pyx_v_m;
        __pyx_v_y = (__pyx_v_y + (((*((float *) ( /* dim=0 */ (__pyx_v_v_view.data + __pyx_t_16 * __pyx_v_v_view.strides[0]) ))) * __pyx_v_delta_t) + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_15 * __pyx_v_gaussian_values.strides[0]) ))))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0165</span>:                 t_particle += delta_t</pre>
<pre class='cython code score-0 '>        __pyx_v_t_particle = (__pyx_v_t_particle + __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0166</span>:                 m += 1</pre>
<pre class='cython code score-0 '>        __pyx_v_m = (__pyx_v_m + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0167</span>:                 if m == num_draws:</pre>
<pre class='cython code score-0 '>        __pyx_t_17 = (__pyx_v_m == __pyx_v_num_draws);
        if (__pyx_t_17) {
/* … */
        }
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0168</span>:                     gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 168, __pyx_L1_error)</span>
          __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
          __pyx_v_gaussian_values = __pyx_t_2;
          __pyx_t_2.memview = NULL;
          __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0169</span>:                     m = 0</pre>
<pre class='cython code score-0 '>          __pyx_v_m = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0170</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0171</span>:             # Note that for purposes of consistency with Navarro and Fuss,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0172</span>:             # the choice corresponding the lower barrier is +1, higher barrier is -1</pre>
<pre class="cython line score-0">&#xA0;<span class="">0173</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0174</span>:             # Apply smoothing with uniform if desired</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0175</span>:             if smooth:</pre>
<pre class='cython code score-2 '>      __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_smooth); if (unlikely((__pyx_t_17 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 175, __pyx_L1_error)</span>
      if (__pyx_t_17) {
/* … */
        goto __pyx_L13;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0176</span>:                 if t_particle == 0:</pre>
<pre class='cython code score-0 '>        __pyx_t_17 = (__pyx_v_t_particle == 0.0);
        if (__pyx_t_17) {
/* … */
          goto __pyx_L14;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0177</span>:                     smooth_u = random_uniform() * 0.5 * delta_t</pre>
<pre class='cython code score-5 '>          __pyx_t_19 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_19 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 177, __pyx_L1_error)</span>
          __pyx_v_smooth_u = ((__pyx_t_19 * 0.5) * __pyx_v_delta_t);
</pre><pre class="cython line score-0">&#xA0;<span class="">0178</span>:                 else:</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0179</span>:                     smooth_u = (0.5 - random_uniform()) * delta_t</pre>
<pre class='cython code score-5 '>        /*else*/ {
          __pyx_t_19 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_19 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 179, __pyx_L1_error)</span>
          __pyx_v_smooth_u = ((0.5 - __pyx_t_19) * __pyx_v_delta_t);
        }
        __pyx_L14:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0180</span>:             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0181</span>:                 smooth_u = 0.0</pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_v_smooth_u = 0.0;
      }
      __pyx_L13:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0182</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0183</span>:             rts_view[n, k, 0] = t_particle + t_view[k] + smooth_u # store rt</pre>
<pre class='cython code score-0 '>      __pyx_t_15 = __pyx_v_k;
      __pyx_t_16 = __pyx_v_n;
      __pyx_t_20 = __pyx_v_k;
      __pyx_t_21 = 0;
      *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_16 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_20 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_21 * __pyx_v_rts_view.strides[2]) )) = ((__pyx_v_t_particle + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_15 * __pyx_v_t_view.strides[0]) )))) + __pyx_v_smooth_u);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0184</span>:             choices_view[n, k, 0] = (-1) * sign(y) # store choice</pre>
<pre class='cython code score-5 '>      __pyx_t_22 = __pyx_f_4cssm_sign(__pyx_v_y); if (unlikely(__pyx_t_22 == ((int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 184, __pyx_L1_error)</span>
      __pyx_t_15 = __pyx_v_n;
      __pyx_t_21 = __pyx_v_k;
      __pyx_t_20 = 0;
      *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_15 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_21 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[2]) )) = (-1L * __pyx_t_22);
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0185</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0186</span>:     if return_option == 'full':</pre>
<pre class='cython code score-2 '>  __pyx_t_17 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_return_option, __pyx_n_u_full, Py_EQ)); if (unlikely((__pyx_t_17 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 186, __pyx_L1_error)</span>
  if (__pyx_t_17) {
/* … */
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0187</span>:         return {'rts': rts, 'choices': choices, 'metadata': {'v': v,</pre>
<pre class='cython code score-20 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 187, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 187, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 187, __pyx_L1_error)</span>
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(12);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 187, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_v, ((PyObject *)__pyx_v_v)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 187, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0188</span>:                                                             'a': a,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 187, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0189</span>:                                                             'z': z,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_z, ((PyObject *)__pyx_v_z)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 187, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0190</span>:                                                             't': t,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 187, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0191</span>:                                                             's': s,</pre>
<pre class='cython code score-11 '>    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_s);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 191, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_s, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 187, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0192</span>:                                                             'delta_t': delta_t,</pre>
<pre class='cython code score-11 '>    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_t);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 192, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_delta_t, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 187, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0193</span>:                                                             'max_t': max_t,</pre>
<pre class='cython code score-11 '>    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_max_t);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 193, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_max_t, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 187, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0194</span>:                                                             'n_samples': n_samples,</pre>
<pre class='cython code score-8 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 194, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_n_samples, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 187, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0195</span>:                                                             'n_trials': n_trials,</pre>
<pre class='cython code score-18 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 195, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_n_trials, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 187, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_simulator, __pyx_n_u_ddm) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 187, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_boundary_fun_type, __pyx_n_u_constant) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 187, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0196</span>:                                                             'simulator': 'ddm',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0197</span>:                                                             'boundary_fun_type': 'constant',</pre>
<pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0198</span>:                                                             'possible_choices': [-1, 1]}}</pre>
<pre class='cython code score-23 '>    __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 198, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_int_neg_1)) <span class='error_goto'>__PYX_ERR(0, 198, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 198, __pyx_L1_error)</span>;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_possible_choices, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 187, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_metadata, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 187, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0199</span>:     elif return_option == 'minimal':</pre>
<pre class='cython code score-2 '>  __pyx_t_17 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_return_option, __pyx_n_u_minimal, Py_EQ)); if (unlikely((__pyx_t_17 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 199, __pyx_L1_error)</span>
  if (likely(__pyx_t_17)) {
/* … */
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0200</span>:         return {'rts': rts, 'choices': choices, 'metadata': {'simulator': 'ddm',</pre>
<pre class='cython code score-20 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 200, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 200, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 200, __pyx_L1_error)</span>
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 200, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_simulator, __pyx_n_u_ddm) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 200, __pyx_L1_error)</span>
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0201</span>:                                                              'possible_choices': [-1, 1],</pre>
<pre class='cython code score-22 '>    __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 201, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_int_neg_1)) <span class='error_goto'>__PYX_ERR(0, 201, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 201, __pyx_L1_error)</span>;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_possible_choices, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 200, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_boundary_fun_type, __pyx_n_u_constant) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 200, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0202</span>:                                                              'boundary_fun_type': 'constant',</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0203</span>:                                                              'n_samples': n_samples,</pre>
<pre class='cython code score-8 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 203, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_n_samples, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 200, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0204</span>:                                                              'n_trials': n_trials,}}</pre>
<pre class='cython code score-14 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 204, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_n_trials, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 200, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_metadata, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 200, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0205</span>:     else:</pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0206</span>:         raise ValueError('return_option must be either "full" or "minimal"')</pre>
<pre class='cython code score-10 '>  /*else*/ {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 206, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='error_goto'>__PYX_ERR(0, 206, __pyx_L1_error)</span>
  }
/* … */
  __pyx_tuple__11 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_return_option_must_be_either_ful);<span class='error_goto'> if (unlikely(!__pyx_tuple__11)) __PYX_ERR(0, 206, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__11);
</pre><pre class="cython line score-0">&#xA0;<span class="">0207</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0208</span>: # ---------------------------------------------------------------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0209</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0210</span>: # DUMMY TEST SIMULATOR ------------------------------------------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0211</span>: # Simulate (rt, choice) tuples from: SIMPLE DDM -----------------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0212</span>: # Simplest algorithm</pre>
<pre class="cython line score-0">&#xA0;<span class="">0213</span>: # delete random comment</pre>
<pre class="cython line score-0">&#xA0;<span class="">0214</span>: # delete random comment 2</pre>
<pre class="cython line score-0">&#xA0;<span class="">0215</span>: #@cython.boundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0216</span>: #@cython.wraparound(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0217</span>: </pre>
<pre class="cython line score-84" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0218</span>: def test2(np.ndarray[float, ndim = 1] v, # drift by timestep 'delta_t'</pre>
<pre class='cython code score-84 '>/* Python wrapper */
static PyObject *__pyx_pw_4cssm_3test2(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_4cssm_3test2 = {"test2", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_4cssm_3test2, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_4cssm_3test2(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyArrayObject *__pyx_v_v = 0;
  PyArrayObject *__pyx_v_a = 0;
  PyArrayObject *__pyx_v_z = 0;
  PyArrayObject *__pyx_v_t = 0;
  float __pyx_v_s;
  float __pyx_v_delta_t;
  float __pyx_v_max_t;
  int __pyx_v_n_samples;
  int __pyx_v_n_trials;
  PyObject *__pyx_v_random_state = 0;
  PyObject *__pyx_v_smooth = 0;
  PyObject *__pyx_v_return_option = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("test2 (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_v,&amp;__pyx_n_s_a,&amp;__pyx_n_s_z,&amp;__pyx_n_s_t,&amp;__pyx_n_s_s,&amp;__pyx_n_s_delta_t,&amp;__pyx_n_s_max_t,&amp;__pyx_n_s_n_samples,&amp;__pyx_n_s_n_trials,&amp;__pyx_n_s_random_state,&amp;__pyx_n_s_smooth,&amp;__pyx_n_s_return_option,0};
  PyObject* values[12] = {0,0,0,0,0,0,0,0,0,0,0,0};
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4cssm_2test2(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_t, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_random_state, PyObject *__pyx_v_smooth, PyObject *__pyx_v_return_option) {
  __Pyx_memviewslice __pyx_v_v_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_a_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_z_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_t_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_rts = NULL;
  PyObject *__pyx_v_choices = NULL;
  __Pyx_memviewslice __pyx_v_rts_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_choices_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  float __pyx_v_delta_t_sqrt;
  float __pyx_v_sqrt_st;
  float __pyx_v_y;
  float __pyx_v_t_particle;
  float __pyx_v_smooth_u;
  Py_ssize_t __pyx_v_n;
  Py_ssize_t __pyx_v_k;
  int __pyx_v_m;
  int __pyx_v_num_draws;
  __Pyx_memviewslice __pyx_v_gaussian_values = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_LocalBuf_ND __pyx_pybuffernd_a;
  __Pyx_Buffer __pyx_pybuffer_a;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_t;
  __Pyx_Buffer __pyx_pybuffer_t;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_v;
  __Pyx_Buffer __pyx_pybuffer_v;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_z;
  __Pyx_Buffer __pyx_pybuffer_z;
  PyObject *__pyx_r = NULL;
  __pyx_pybuffer_v.pybuffer.buf = NULL;
  __pyx_pybuffer_v.refcount = 0;
  __pyx_pybuffernd_v.data = NULL;
  __pyx_pybuffernd_v.rcbuffer = &amp;__pyx_pybuffer_v;
  __pyx_pybuffer_a.pybuffer.buf = NULL;
  __pyx_pybuffer_a.refcount = 0;
  __pyx_pybuffernd_a.data = NULL;
  __pyx_pybuffernd_a.rcbuffer = &amp;__pyx_pybuffer_a;
  __pyx_pybuffer_z.pybuffer.buf = NULL;
  __pyx_pybuffer_z.refcount = 0;
  __pyx_pybuffernd_z.data = NULL;
  __pyx_pybuffernd_z.rcbuffer = &amp;__pyx_pybuffer_z;
  __pyx_pybuffer_t.pybuffer.buf = NULL;
  __pyx_pybuffer_t.refcount = 0;
  __pyx_pybuffernd_t.data = NULL;
  __pyx_pybuffernd_t.rcbuffer = &amp;__pyx_pybuffer_t;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_v, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_v.diminfo[0].strides = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_v.diminfo[0].shape = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_a, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_z, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_z.diminfo[0].strides = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_z.diminfo[0].shape = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_t, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_t.diminfo[0].strides = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_t.diminfo[0].shape = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.shape[0];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_2, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_7, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.test2", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_v_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_a_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_z_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_t_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_choices);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_rts_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_choices_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(8);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 218, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_10)) <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_11)) <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 3, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 4, __pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 5, Py_None)) <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_False));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_False));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 6, ((PyObject *)Py_False))) <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject*)__pyx_n_u_full));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject*)__pyx_n_u_full));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 7, ((PyObject*)__pyx_n_u_full))) <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L1_error)</span>;
  __pyx_t_10 = 0;
  __pyx_t_11 = 0;
  __pyx_t_9 = 0;
  __pyx_t_5 = 0;
  __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_4cssm_3test2, 0, __pyx_n_s_test2, NULL, __pyx_n_s_cssm, __pyx_d, ((PyObject *)__pyx_codeobj__26));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 218, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_7, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test2, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
/* … */
  __pyx_codeobj__26 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(12, 0, 0, 30, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__24, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_test2, 218, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__26)) __PYX_ERR(0, 218, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0219</span>:           np.ndarray[float, ndim = 1] a, # boundary separation</pre>
<pre class="cython line score-0">&#xA0;<span class="">0220</span>:           np.ndarray[float, ndim = 1] z,  # between 0 and 1</pre>
<pre class="cython line score-0">&#xA0;<span class="">0221</span>:           np.ndarray[float, ndim = 1] t, # non-decision time</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0222</span>:           float s = 1, # noise sigma</pre>
<pre class='cython code score-5 '>  __pyx_t_10 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)1.0));<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 222, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0223</span>:           float delta_t = 0.001, # timesteps fraction of seconds</pre>
<pre class='cython code score-5 '>  __pyx_t_11 = <span class='py_c_api'>PyFloat_FromDouble</span>(((double)0.001));<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 223, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0224</span>:           float max_t = 20, # maximum rt allowed</pre>
<pre class='cython code score-5 '>  __pyx_t_9 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)20.0));<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 224, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0225</span>:           int n_samples = 20000, # number of samples considered</pre>
<pre class='cython code score-2 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)0x4E20));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 225, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0226</span>:           int n_trials = 10,</pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)10));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 226, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0227</span>:           random_state = None,</pre>
<pre class='cython code score-2 '>    values[9] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
</pre><pre class="cython line score-228" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0228</span>:           smooth = False,</pre>
<pre class='cython code score-228 '>    values[10] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    values[11] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_full)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_v)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_a)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("test2", 0, 4, 12, 1); <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_z)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("test2", 0, 4, 12, 2); <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_t)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[3]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("test2", 0, 4, 12, 3); <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_s);
          if (value) { values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_delta_t);
          if (value) { values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_max_t);
          if (value) { values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_samples);
          if (value) { values[7] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_trials);
          if (value) { values[8] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  9:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_random_state);
          if (value) { values[9] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 10:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_smooth);
          if (value) { values[10] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 11:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_return_option);
          if (value) { values[11] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "test2") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_v = ((PyArrayObject *)values[0]);
    __pyx_v_a = ((PyArrayObject *)values[1]);
    __pyx_v_z = ((PyArrayObject *)values[2]);
    __pyx_v_t = ((PyArrayObject *)values[3]);
    if (values[4]) {
      __pyx_v_s = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[4]); if (unlikely((__pyx_v_s == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 222, __pyx_L3_error)</span>
    } else {
      __pyx_v_s = ((float)((float)1.0));
    }
    if (values[5]) {
      __pyx_v_delta_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[5]); if (unlikely((__pyx_v_delta_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 223, __pyx_L3_error)</span>
    } else {
      __pyx_v_delta_t = ((float)((double)0.001));
    }
    if (values[6]) {
      __pyx_v_max_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[6]); if (unlikely((__pyx_v_max_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 224, __pyx_L3_error)</span>
    } else {
      __pyx_v_max_t = ((float)((float)20.0));
    }
    if (values[7]) {
      __pyx_v_n_samples = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[7]); if (unlikely((__pyx_v_n_samples == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 225, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_samples = ((int)((int)0x4E20));
    }
    if (values[8]) {
      __pyx_v_n_trials = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[8]); if (unlikely((__pyx_v_n_trials == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 226, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_trials = ((int)((int)10));
    }
    __pyx_v_random_state = values[9];
    __pyx_v_smooth = values[10];
    __pyx_v_return_option = values[11];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("test2", 0, 4, 12, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.test2", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) <span class='error_goto'>__PYX_ERR(0, 219, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) <span class='error_goto'>__PYX_ERR(0, 220, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) <span class='error_goto'>__PYX_ERR(0, 221, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_4cssm_2test2(__pyx_self, __pyx_v_v, __pyx_v_a, __pyx_v_z, __pyx_v_t, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_random_state, __pyx_v_smooth, __pyx_v_return_option);
</pre><pre class="cython line score-0">&#xA0;<span class="">0229</span>:           return_option = 'full', # 'full' or 'minimal'</pre>
<pre class="cython line score-0">&#xA0;<span class="">0230</span>:           ):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0231</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0232</span>:     set_seed(random_state)</pre>
<pre class='cython code score-1 '>  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 232, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0233</span>:     # Param views</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0234</span>:     cdef float[:] v_view = v</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_v), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 234, __pyx_L1_error)</span>
  __pyx_v_v_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0235</span>:     cdef float[:] a_view = a</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_a), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 235, __pyx_L1_error)</span>
  __pyx_v_a_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0236</span>:     cdef float[:] z_view = z</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_z), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 236, __pyx_L1_error)</span>
  __pyx_v_z_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0237</span>:     cdef float[:] t_view = t</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_t), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 237, __pyx_L1_error)</span>
  __pyx_v_t_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0238</span>: </pre>
<pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0239</span>:     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)</pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 239, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 239, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 239, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 239, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 239, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 239, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 239, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 239, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 239, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 239, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 239, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 239, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 239, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 239, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_rts = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0240</span>:     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)</pre>
<pre class='cython code score-46 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 240, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 240, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 240, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 240, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 240, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 240, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 240, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 240, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 240, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 240, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 240, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 240, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_intc);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 240, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 240, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 240, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_choices = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0241</span>:     cdef float[:, :, :] rts_view = rts</pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_rts, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 241, __pyx_L1_error)</span>
  __pyx_v_rts_view = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0242</span>:     cdef int[:, :, :] choices_view = choices</pre>
<pre class='cython code score-2 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_int</span>(__pyx_v_choices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 242, __pyx_L1_error)</span>
  __pyx_v_choices_view = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0243</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0244</span>:     cdef float delta_t_sqrt = sqrt(delta_t)</pre>
<pre class='cython code score-0 '>  __pyx_v_delta_t_sqrt = sqrt(__pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0245</span>:     cdef float sqrt_st = delta_t_sqrt * s</pre>
<pre class='cython code score-0 '>  __pyx_v_sqrt_st = (__pyx_v_delta_t_sqrt * __pyx_v_s);
</pre><pre class="cython line score-0">&#xA0;<span class="">0246</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0247</span>:     cdef float y, t_particle, smooth_u</pre>
<pre class="cython line score-0">&#xA0;<span class="">0248</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0249</span>:     #cdef int n</pre>
<pre class="cython line score-0">&#xA0;<span class="">0250</span>:     cdef Py_ssize_t n, k</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0251</span>:     cdef int m = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_m = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0252</span>:     cdef int num_draws = int(max_t / delta_t + 1)</pre>
<pre class='cython code score-0 '>  __pyx_v_num_draws = ((int)((__pyx_v_max_t / __pyx_v_delta_t) + 1.0));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0253</span>:     cdef float[:] gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 253, __pyx_L1_error)</span>
  __pyx_v_gaussian_values = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0254</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0255</span>:     for k in range(n_trials):</pre>
<pre class='cython code score-0 '>  __pyx_t_9 = __pyx_v_n_trials;
  __pyx_t_10 = __pyx_t_9;
  for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
    __pyx_v_k = __pyx_t_11;
</pre><pre class="cython line score-0">&#xA0;<span class="">0256</span>:         # Loop over samples</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0257</span>:         for n in range(n_samples):</pre>
<pre class='cython code score-0 '>    __pyx_t_12 = __pyx_v_n_samples;
    __pyx_t_13 = __pyx_t_12;
    for (__pyx_t_14 = 0; __pyx_t_14 &lt; __pyx_t_13; __pyx_t_14+=1) {
      __pyx_v_n = __pyx_t_14;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0258</span>:             y = z_view[k] * a_view[k] # reset starting point</pre>
<pre class='cython code score-0 '>      __pyx_t_15 = __pyx_v_k;
      __pyx_t_16 = __pyx_v_k;
      __pyx_v_y = ((*((float *) ( /* dim=0 */ (__pyx_v_z_view.data + __pyx_t_15 * __pyx_v_z_view.strides[0]) ))) * (*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_16 * __pyx_v_a_view.strides[0]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0259</span>:             t_particle = 0.0 # reset time</pre>
<pre class='cython code score-0 '>      __pyx_v_t_particle = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0260</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0261</span>:             # Random walker</pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0262</span>:             while y &lt;= a_view[k] and y &gt;= 0 and t &lt;= max_t:</pre>
<pre class='cython code score-14 '>      while (1) {
        __pyx_t_16 = __pyx_v_k;
        __pyx_t_18 = (__pyx_v_y &lt;= (*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_16 * __pyx_v_a_view.strides[0]) ))));
        if (__pyx_t_18) {
        } else {
          __pyx_t_17 = __pyx_t_18;
          goto __pyx_L9_bool_binop_done;
        }
        __pyx_t_18 = (__pyx_v_y &gt;= 0.0);
        if (__pyx_t_18) {
        } else {
          __pyx_t_17 = __pyx_t_18;
          goto __pyx_L9_bool_binop_done;
        }
        __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_max_t);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 262, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(((PyObject *)__pyx_v_t), __pyx_t_6, Py_LE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 262, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely((__pyx_t_18 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 262, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_17 = __pyx_t_18;
        __pyx_L9_bool_binop_done:;
        if (!__pyx_t_17) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0263</span>:                 y += v_view[k] * delta_t + sqrt_st * gaussian_values[m] # update particle position</pre>
<pre class='cython code score-0 '>        __pyx_t_16 = __pyx_v_k;
        __pyx_t_15 = __pyx_v_m;
        __pyx_v_y = (__pyx_v_y + (((*((float *) ( /* dim=0 */ (__pyx_v_v_view.data + __pyx_t_16 * __pyx_v_v_view.strides[0]) ))) * __pyx_v_delta_t) + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_15 * __pyx_v_gaussian_values.strides[0]) ))))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0264</span>:                 t_particle += delta_t</pre>
<pre class='cython code score-0 '>        __pyx_v_t_particle = (__pyx_v_t_particle + __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0265</span>:                 m += 1</pre>
<pre class='cython code score-0 '>        __pyx_v_m = (__pyx_v_m + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0266</span>:                 if m == num_draws:</pre>
<pre class='cython code score-0 '>        __pyx_t_17 = (__pyx_v_m == __pyx_v_num_draws);
        if (__pyx_t_17) {
/* … */
        }
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0267</span>:                     gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 267, __pyx_L1_error)</span>
          __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
          __pyx_v_gaussian_values = __pyx_t_2;
          __pyx_t_2.memview = NULL;
          __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0268</span>:                     m = 0</pre>
<pre class='cython code score-0 '>          __pyx_v_m = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0269</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0270</span>:             # Note that for purposes of consistency with Navarro and Fuss,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0271</span>:             # the choice corresponding the lower barrier is +1, higher barrier is -1</pre>
<pre class="cython line score-0">&#xA0;<span class="">0272</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0273</span>:             # Apply smoothing with uniform if desired</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0274</span>:             if smooth:</pre>
<pre class='cython code score-2 '>      __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_smooth); if (unlikely((__pyx_t_17 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 274, __pyx_L1_error)</span>
      if (__pyx_t_17) {
/* … */
        goto __pyx_L13;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0275</span>:                 if t_particle == 0:</pre>
<pre class='cython code score-0 '>        __pyx_t_17 = (__pyx_v_t_particle == 0.0);
        if (__pyx_t_17) {
/* … */
          goto __pyx_L14;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0276</span>:                     smooth_u = random_uniform() * 0.5 * delta_t</pre>
<pre class='cython code score-5 '>          __pyx_t_19 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_19 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 276, __pyx_L1_error)</span>
          __pyx_v_smooth_u = ((__pyx_t_19 * 0.5) * __pyx_v_delta_t);
</pre><pre class="cython line score-0">&#xA0;<span class="">0277</span>:                 else:</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0278</span>:                     smooth_u = (0.5 - random_uniform()) * delta_t</pre>
<pre class='cython code score-5 '>        /*else*/ {
          __pyx_t_19 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_19 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 278, __pyx_L1_error)</span>
          __pyx_v_smooth_u = ((0.5 - __pyx_t_19) * __pyx_v_delta_t);
        }
        __pyx_L14:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0279</span>:             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0280</span>:                 smooth_u = 0.0</pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_v_smooth_u = 0.0;
      }
      __pyx_L13:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0281</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0282</span>:             rts_view[n, k, 0] = t_particle + t_view[k] + smooth_u # store rt</pre>
<pre class='cython code score-0 '>      __pyx_t_15 = __pyx_v_k;
      __pyx_t_16 = __pyx_v_n;
      __pyx_t_20 = __pyx_v_k;
      __pyx_t_21 = 0;
      *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_16 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_20 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_21 * __pyx_v_rts_view.strides[2]) )) = ((__pyx_v_t_particle + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_15 * __pyx_v_t_view.strides[0]) )))) + __pyx_v_smooth_u);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0283</span>:             choices_view[n, k, 0] = (-1) * sign(y) # store choice</pre>
<pre class='cython code score-5 '>      __pyx_t_22 = __pyx_f_4cssm_sign(__pyx_v_y); if (unlikely(__pyx_t_22 == ((int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 283, __pyx_L1_error)</span>
      __pyx_t_15 = __pyx_v_n;
      __pyx_t_21 = __pyx_v_k;
      __pyx_t_20 = 0;
      *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_15 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_21 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[2]) )) = (-1L * __pyx_t_22);
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0284</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0285</span>:     if return_option == 'full':</pre>
<pre class='cython code score-2 '>  __pyx_t_17 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_return_option, __pyx_n_u_full, Py_EQ)); if (unlikely((__pyx_t_17 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 285, __pyx_L1_error)</span>
  if (__pyx_t_17) {
/* … */
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0286</span>:         return {'rts': rts, 'choices': choices, 'metadata': {'v': v,</pre>
<pre class='cython code score-20 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 286, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 286, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 286, __pyx_L1_error)</span>
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(12);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 286, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_v, ((PyObject *)__pyx_v_v)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 286, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0287</span>:                                                             'a': a,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 286, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0288</span>:                                                             'z': z,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_z, ((PyObject *)__pyx_v_z)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 286, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0289</span>:                                                             't': t,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 286, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0290</span>:                                                             's': s,</pre>
<pre class='cython code score-11 '>    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_s);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 290, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_s, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 286, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0291</span>:                                                             'delta_t': delta_t,</pre>
<pre class='cython code score-11 '>    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_t);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 291, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_delta_t, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 286, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0292</span>:                                                             'max_t': max_t,</pre>
<pre class='cython code score-11 '>    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_max_t);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 292, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_max_t, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 286, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0293</span>:                                                             'n_samples': n_samples,</pre>
<pre class='cython code score-8 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 293, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_n_samples, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 286, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0294</span>:                                                             'n_trials': n_trials,</pre>
<pre class='cython code score-18 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 294, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_n_trials, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 286, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_simulator, __pyx_n_u_ddm) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 286, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_boundary_fun_type, __pyx_n_u_constant) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 286, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0295</span>:                                                             'simulator': 'ddm',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0296</span>:                                                             'boundary_fun_type': 'constant',</pre>
<pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0297</span>:                                                             'possible_choices': [-1, 1]}}</pre>
<pre class='cython code score-23 '>    __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 297, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_int_neg_1)) <span class='error_goto'>__PYX_ERR(0, 297, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 297, __pyx_L1_error)</span>;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_possible_choices, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 286, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_metadata, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 286, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0298</span>:     elif return_option == 'minimal':</pre>
<pre class='cython code score-2 '>  __pyx_t_17 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_return_option, __pyx_n_u_minimal, Py_EQ)); if (unlikely((__pyx_t_17 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 298, __pyx_L1_error)</span>
  if (likely(__pyx_t_17)) {
/* … */
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0299</span>:         return {'rts': rts, 'choices': choices, 'metadata': {'simulator': 'ddm',</pre>
<pre class='cython code score-20 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 299, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 299, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 299, __pyx_L1_error)</span>
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 299, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_simulator, __pyx_n_u_ddm) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 299, __pyx_L1_error)</span>
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0300</span>:                                                              'possible_choices': [-1, 1],</pre>
<pre class='cython code score-22 '>    __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 300, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_int_neg_1)) <span class='error_goto'>__PYX_ERR(0, 300, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 300, __pyx_L1_error)</span>;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_possible_choices, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 299, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_boundary_fun_type, __pyx_n_u_constant) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 299, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0301</span>:                                                              'boundary_fun_type': 'constant',</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0302</span>:                                                              'n_samples': n_samples,</pre>
<pre class='cython code score-8 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 302, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_n_samples, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 299, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0303</span>:                                                              'n_trials': n_trials,}}</pre>
<pre class='cython code score-14 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 303, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_n_trials, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 299, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_metadata, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 299, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0304</span>:     else:</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0305</span>:         raise ValueError('return_option must be either "full" or "minimal"')</pre>
<pre class='cython code score-5 '>  /*else*/ {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 305, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='error_goto'>__PYX_ERR(0, 305, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0306</span>: # ---------------------------------------------------------------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0307</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0308</span>: # Simulate (rt, choice) tuples from: Full DDM with flexible bounds --------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0309</span>: # @cythonboundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0310</span>: # @cythonwraparound(False)</pre>
<pre class="cython line score-122" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0311</span>: def full_ddm_hddm_base(np.ndarray[float, ndim = 1] v, # = 0,</pre>
<pre class='cython code score-122 '>/* Python wrapper */
static PyObject *__pyx_pw_4cssm_5full_ddm_hddm_base(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_4cssm_5full_ddm_hddm_base = {"full_ddm_hddm_base", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_4cssm_5full_ddm_hddm_base, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_4cssm_5full_ddm_hddm_base(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyArrayObject *__pyx_v_v = 0;
  PyArrayObject *__pyx_v_a = 0;
  PyArrayObject *__pyx_v_z = 0;
  PyArrayObject *__pyx_v_t = 0;
  PyArrayObject *__pyx_v_sz = 0;
  PyArrayObject *__pyx_v_sv = 0;
  PyArrayObject *__pyx_v_st = 0;
  PyArrayObject *__pyx_v_deadline = 0;
  float __pyx_v_s;
  float __pyx_v_delta_t;
  float __pyx_v_max_t;
  int __pyx_v_n_samples;
  int __pyx_v_n_trials;
  PyObject *__pyx_v_random_state = 0;
  PyObject *__pyx_v_smooth = 0;
  PyObject *__pyx_v_return_option = 0;
  CYTHON_UNUSED PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("full_ddm_hddm_base (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_v,&amp;__pyx_n_s_a,&amp;__pyx_n_s_z,&amp;__pyx_n_s_t,&amp;__pyx_n_s_sz,&amp;__pyx_n_s_sv,&amp;__pyx_n_s_st,&amp;__pyx_n_s_deadline,&amp;__pyx_n_s_s,&amp;__pyx_n_s_delta_t,&amp;__pyx_n_s_max_t,&amp;__pyx_n_s_n_samples,&amp;__pyx_n_s_n_trials,&amp;__pyx_n_s_random_state,&amp;__pyx_n_s_smooth,&amp;__pyx_n_s_return_option,0};
  PyObject* values[16] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs);
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4cssm_4full_ddm_hddm_base(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_t, PyArrayObject *__pyx_v_sz, PyArrayObject *__pyx_v_sv, PyArrayObject *__pyx_v_st, PyArrayObject *__pyx_v_deadline, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_random_state, PyObject *__pyx_v_smooth, PyObject *__pyx_v_return_option, CYTHON_UNUSED PyObject *__pyx_v_kwargs) {
  __Pyx_memviewslice __pyx_v_v_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_a_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_z_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_t_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_sz_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_sv_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_st_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_deadline_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_traj = NULL;
  __Pyx_memviewslice __pyx_v_traj_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_rts = NULL;
  PyObject *__pyx_v_choices = NULL;
  __Pyx_memviewslice __pyx_v_rts_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_choices_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  float __pyx_v_delta_t_sqrt;
  float __pyx_v_sqrt_st;
  int __pyx_v_num_draws;
  CYTHON_UNUSED PyObject *__pyx_v_t_s = NULL;
  float __pyx_v_y;
  float __pyx_v_t_particle;
  float __pyx_v_t_tmp;
  float __pyx_v_smooth_u;
  float __pyx_v_deadline_tmp;
  Py_ssize_t __pyx_v_n;
  Py_ssize_t __pyx_v_ix;
  Py_ssize_t __pyx_v_k;
  Py_ssize_t __pyx_v_m;
  float __pyx_v_drift_increment;
  __Pyx_memviewslice __pyx_v_gaussian_values = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_LocalBuf_ND __pyx_pybuffernd_a;
  __Pyx_Buffer __pyx_pybuffer_a;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_deadline;
  __Pyx_Buffer __pyx_pybuffer_deadline;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_st;
  __Pyx_Buffer __pyx_pybuffer_st;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_sv;
  __Pyx_Buffer __pyx_pybuffer_sv;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_sz;
  __Pyx_Buffer __pyx_pybuffer_sz;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_t;
  __Pyx_Buffer __pyx_pybuffer_t;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_v;
  __Pyx_Buffer __pyx_pybuffer_v;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_z;
  __Pyx_Buffer __pyx_pybuffer_z;
  PyObject *__pyx_r = NULL;
  __pyx_pybuffer_v.pybuffer.buf = NULL;
  __pyx_pybuffer_v.refcount = 0;
  __pyx_pybuffernd_v.data = NULL;
  __pyx_pybuffernd_v.rcbuffer = &amp;__pyx_pybuffer_v;
  __pyx_pybuffer_a.pybuffer.buf = NULL;
  __pyx_pybuffer_a.refcount = 0;
  __pyx_pybuffernd_a.data = NULL;
  __pyx_pybuffernd_a.rcbuffer = &amp;__pyx_pybuffer_a;
  __pyx_pybuffer_z.pybuffer.buf = NULL;
  __pyx_pybuffer_z.refcount = 0;
  __pyx_pybuffernd_z.data = NULL;
  __pyx_pybuffernd_z.rcbuffer = &amp;__pyx_pybuffer_z;
  __pyx_pybuffer_t.pybuffer.buf = NULL;
  __pyx_pybuffer_t.refcount = 0;
  __pyx_pybuffernd_t.data = NULL;
  __pyx_pybuffernd_t.rcbuffer = &amp;__pyx_pybuffer_t;
  __pyx_pybuffer_sz.pybuffer.buf = NULL;
  __pyx_pybuffer_sz.refcount = 0;
  __pyx_pybuffernd_sz.data = NULL;
  __pyx_pybuffernd_sz.rcbuffer = &amp;__pyx_pybuffer_sz;
  __pyx_pybuffer_sv.pybuffer.buf = NULL;
  __pyx_pybuffer_sv.refcount = 0;
  __pyx_pybuffernd_sv.data = NULL;
  __pyx_pybuffernd_sv.rcbuffer = &amp;__pyx_pybuffer_sv;
  __pyx_pybuffer_st.pybuffer.buf = NULL;
  __pyx_pybuffer_st.refcount = 0;
  __pyx_pybuffernd_st.data = NULL;
  __pyx_pybuffernd_st.rcbuffer = &amp;__pyx_pybuffer_st;
  __pyx_pybuffer_deadline.pybuffer.buf = NULL;
  __pyx_pybuffer_deadline.refcount = 0;
  __pyx_pybuffernd_deadline.data = NULL;
  __pyx_pybuffernd_deadline.rcbuffer = &amp;__pyx_pybuffer_deadline;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_v, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_v.diminfo[0].strides = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_v.diminfo[0].shape = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_a, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_z, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_z.diminfo[0].strides = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_z.diminfo[0].shape = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_t, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_t.diminfo[0].strides = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_t.diminfo[0].shape = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_sz.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_sz, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_sz.diminfo[0].strides = __pyx_pybuffernd_sz.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_sz.diminfo[0].shape = __pyx_pybuffernd_sz.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_sv.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_sv, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_sv.diminfo[0].strides = __pyx_pybuffernd_sv.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_sv.diminfo[0].shape = __pyx_pybuffernd_sv.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_st.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_st, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_st.diminfo[0].strides = __pyx_pybuffernd_st.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_st.diminfo[0].shape = __pyx_pybuffernd_st.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_deadline, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_deadline.diminfo[0].strides = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_deadline.diminfo[0].shape = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.shape[0];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_2, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_9, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_st.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_sv.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_sz.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.full_ddm_hddm_base", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_st.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_sv.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_sz.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_v_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_a_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_z_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_t_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_sz_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_sv_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_st_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_deadline_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_traj);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_traj_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_choices);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_rts_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_choices_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t_s);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__27 = <span class='py_c_api'>PyTuple_Pack</span>(46, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_t, __pyx_n_s_sz, __pyx_n_s_sv, __pyx_n_s_st, __pyx_n_s_deadline, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_random_state, __pyx_n_s_smooth, __pyx_n_s_return_option, __pyx_n_s_kwargs, __pyx_n_s_v_view, __pyx_n_s_a_view, __pyx_n_s_z_view, __pyx_n_s_t_view, __pyx_n_s_sz_view, __pyx_n_s_sv_view, __pyx_n_s_st_view, __pyx_n_s_deadline_view, __pyx_n_s_traj, __pyx_n_s_traj_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_num_draws, __pyx_n_s_t_s, __pyx_n_s_y, __pyx_n_s_t_particle, __pyx_n_s_t_tmp, __pyx_n_s_smooth_u, __pyx_n_s_deadline_tmp, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_drift_increment, __pyx_n_s_gaussian_values);<span class='error_goto'> if (unlikely(!__pyx_tuple__27)) __PYX_ERR(0, 311, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__27);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__27);
/* … */
  __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(8);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 311, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_10, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_10, 2, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_10, 3, __pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_10, 4, __pyx_t_11)) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_10, 5, Py_None)) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_False));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_False));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_10, 6, ((PyObject *)Py_False))) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject*)__pyx_n_u_full));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject*)__pyx_n_u_full));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_10, 7, ((PyObject*)__pyx_n_u_full))) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L1_error)</span>;
  __pyx_t_7 = 0;
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_9 = 0;
  __pyx_t_11 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_4cssm_5full_ddm_hddm_base, 0, __pyx_n_s_full_ddm_hddm_base, NULL, __pyx_n_s_cssm, __pyx_d, ((PyObject *)__pyx_codeobj__28));<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 311, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_11, __pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_full_ddm_hddm_base, __pyx_t_11) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_codeobj__28 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(16, 0, 0, 46, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__27, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_full_ddm_hddm_base, 311, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__28)) __PYX_ERR(0, 311, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0312</span>:                        np.ndarray[float, ndim = 1] a, # = 1,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0313</span>:                        np.ndarray[float, ndim = 1] z, # = 0.5,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0314</span>:                        np.ndarray[float, ndim = 1] t, # = 0.0,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0315</span>:                        np.ndarray[float, ndim = 1] sz, # = 0.05,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0316</span>:                        np.ndarray[float, ndim = 1] sv, # = 0.1,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0317</span>:                        np.ndarray[float, ndim = 1] st, # = 0.0,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0318</span>:                        np.ndarray[float, ndim = 1] deadline, # = 0.0,</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0319</span>:                        float s = 1,</pre>
<pre class='cython code score-5 '>  __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)1.0));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 319, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0320</span>:                        float delta_t = 0.001,</pre>
<pre class='cython code score-5 '>  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(((double)0.001));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 320, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0321</span>:                        float max_t = 20,</pre>
<pre class='cython code score-5 '>  __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)20.0));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 321, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0322</span>:                        int n_samples = 20000,</pre>
<pre class='cython code score-2 '>  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)0x4E20));<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 322, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0323</span>:                        int n_trials = 1,</pre>
<pre class='cython code score-2 '>  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)1));<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 323, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0324</span>:                        random_state = None,</pre>
<pre class='cython code score-2 '>    values[13] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
</pre><pre class="cython line score-297" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0325</span>:                        smooth = False,</pre>
<pre class='cython code score-297 '>    values[14] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    values[15] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_full)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case 16: values[15] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 15);
        CYTHON_FALLTHROUGH;
        case 15: values[14] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_v)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_a)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("full_ddm_hddm_base", 0, 8, 16, 1); <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_z)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("full_ddm_hddm_base", 0, 8, 16, 2); <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_t)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[3]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("full_ddm_hddm_base", 0, 8, 16, 3); <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_sz)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[4]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("full_ddm_hddm_base", 0, 8, 16, 4); <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_sv)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[5]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("full_ddm_hddm_base", 0, 8, 16, 5); <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_st)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[6]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("full_ddm_hddm_base", 0, 8, 16, 6); <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (likely((values[7] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_deadline)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[7]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("full_ddm_hddm_base", 0, 8, 16, 7); <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_s);
          if (value) { values[8] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  9:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_delta_t);
          if (value) { values[9] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 10:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_max_t);
          if (value) { values[10] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 11:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_samples);
          if (value) { values[11] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 12:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_trials);
          if (value) { values[12] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 13:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_random_state);
          if (value) { values[13] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 14:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_smooth);
          if (value) { values[14] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 15:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_return_option);
          if (value) { values[15] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values + 0, kwd_pos_args, "full_ddm_hddm_base") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case 16: values[15] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 15);
        CYTHON_FALLTHROUGH;
        case 15: values[14] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_v = ((PyArrayObject *)values[0]);
    __pyx_v_a = ((PyArrayObject *)values[1]);
    __pyx_v_z = ((PyArrayObject *)values[2]);
    __pyx_v_t = ((PyArrayObject *)values[3]);
    __pyx_v_sz = ((PyArrayObject *)values[4]);
    __pyx_v_sv = ((PyArrayObject *)values[5]);
    __pyx_v_st = ((PyArrayObject *)values[6]);
    __pyx_v_deadline = ((PyArrayObject *)values[7]);
    if (values[8]) {
      __pyx_v_s = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[8]); if (unlikely((__pyx_v_s == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 319, __pyx_L3_error)</span>
    } else {
      __pyx_v_s = ((float)((float)1.0));
    }
    if (values[9]) {
      __pyx_v_delta_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[9]); if (unlikely((__pyx_v_delta_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 320, __pyx_L3_error)</span>
    } else {
      __pyx_v_delta_t = ((float)((double)0.001));
    }
    if (values[10]) {
      __pyx_v_max_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[10]); if (unlikely((__pyx_v_max_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 321, __pyx_L3_error)</span>
    } else {
      __pyx_v_max_t = ((float)((float)20.0));
    }
    if (values[11]) {
      __pyx_v_n_samples = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[11]); if (unlikely((__pyx_v_n_samples == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 322, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_samples = ((int)((int)0x4E20));
    }
    if (values[12]) {
      __pyx_v_n_trials = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[12]); if (unlikely((__pyx_v_n_trials == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 323, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_trials = ((int)((int)1));
    }
    __pyx_v_random_state = values[13];
    __pyx_v_smooth = values[14];
    __pyx_v_return_option = values[15];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("full_ddm_hddm_base", 0, 8, 16, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.full_ddm_hddm_base", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) <span class='error_goto'>__PYX_ERR(0, 312, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) <span class='error_goto'>__PYX_ERR(0, 313, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) <span class='error_goto'>__PYX_ERR(0, 314, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_sz), __pyx_ptype_5numpy_ndarray, 1, "sz", 0))) <span class='error_goto'>__PYX_ERR(0, 315, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_sv), __pyx_ptype_5numpy_ndarray, 1, "sv", 0))) <span class='error_goto'>__PYX_ERR(0, 316, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_st), __pyx_ptype_5numpy_ndarray, 1, "st", 0))) <span class='error_goto'>__PYX_ERR(0, 317, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_deadline), __pyx_ptype_5numpy_ndarray, 1, "deadline", 0))) <span class='error_goto'>__PYX_ERR(0, 318, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_4cssm_4full_ddm_hddm_base(__pyx_self, __pyx_v_v, __pyx_v_a, __pyx_v_z, __pyx_v_t, __pyx_v_sz, __pyx_v_sv, __pyx_v_st, __pyx_v_deadline, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_random_state, __pyx_v_smooth, __pyx_v_return_option, __pyx_v_kwargs);
</pre><pre class="cython line score-0">&#xA0;<span class="">0326</span>:                        return_option = 'full', # 'full' or 'minimal'</pre>
<pre class="cython line score-0">&#xA0;<span class="">0327</span>:                        **kwargs,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0328</span>:                        ):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0329</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0330</span>:     set_seed(random_state)</pre>
<pre class='cython code score-1 '>  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 330, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0331</span>:     # cdef int cov_length = np.max([v.size, a.size, w.size, t.size]).astype(int)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0332</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0333</span>:     # Param views</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0334</span>:     cdef float[:] v_view  = v</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_v), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 334, __pyx_L1_error)</span>
  __pyx_v_v_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0335</span>:     cdef float[:] a_view = a</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_a), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 335, __pyx_L1_error)</span>
  __pyx_v_a_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0336</span>:     cdef float[:] z_view = z</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_z), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 336, __pyx_L1_error)</span>
  __pyx_v_z_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0337</span>:     cdef float[:] t_view = t</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_t), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 337, __pyx_L1_error)</span>
  __pyx_v_t_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0338</span>:     cdef float[:] sz_view = sz</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_sz), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 338, __pyx_L1_error)</span>
  __pyx_v_sz_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0339</span>:     cdef float[:] sv_view = sv</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_sv), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 339, __pyx_L1_error)</span>
  __pyx_v_sv_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0340</span>:     cdef float[:] st_view = st</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_st), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 340, __pyx_L1_error)</span>
  __pyx_v_st_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0341</span>:     cdef float[:] deadline_view = deadline</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_deadline), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 341, __pyx_L1_error)</span>
  __pyx_v_deadline_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0342</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0343</span>:     # Data-structs for trajectory storage</pre>
<pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0344</span>:     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)</pre>
<pre class='cython code score-42 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 344, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 344, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_FromDouble</span>((__pyx_v_max_t / __pyx_v_delta_t));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 344, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_1, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 344, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 344, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 344, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 344, __pyx_L1_error)</span>;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 344, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 344, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 344, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 344, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 344, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 344, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_traj = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0345</span>:     traj[:, :] = -999</pre>
<pre class='cython code score-10 '>  if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_traj, __pyx_tuple__12, __pyx_int_neg_999) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 345, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__12 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__5, __pyx_slice__5);<span class='error_goto'> if (unlikely(!__pyx_tuple__12)) __PYX_ERR(0, 345, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__12);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0346</span>:     cdef float[:, :] traj_view = traj</pre>
<pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(__pyx_v_traj, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 346, __pyx_L1_error)</span>
  __pyx_v_traj_view = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0347</span>: </pre>
<pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0348</span>:     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)</pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 348, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 348, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 348, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 348, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 348, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 348, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 348, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 348, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 348, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 348, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 348, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 348, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 348, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 348, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_rts = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0349</span>:     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)</pre>
<pre class='cython code score-46 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 349, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 349, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 349, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 349, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 349, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 349, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 349, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 349, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 349, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 349, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 349, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 349, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_intc);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 349, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 349, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 349, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_choices = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0350</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0351</span>:     cdef float[:, :, :] rts_view = rts</pre>
<pre class='cython code score-2 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_rts, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 351, __pyx_L1_error)</span>
  __pyx_v_rts_view = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0352</span>:     cdef int[:, :, :] choices_view = choices</pre>
<pre class='cython code score-2 '>  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_int</span>(__pyx_v_choices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 352, __pyx_L1_error)</span>
  __pyx_v_choices_view = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0353</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0354</span>:     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion</pre>
<pre class='cython code score-0 '>  __pyx_v_delta_t_sqrt = sqrt(__pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0355</span>:     cdef float sqrt_st = delta_t_sqrt * s # scalar to ensure the correct variance for the gaussian step</pre>
<pre class='cython code score-0 '>  __pyx_v_sqrt_st = (__pyx_v_delta_t_sqrt * __pyx_v_s);
</pre><pre class="cython line score-0">&#xA0;<span class="">0356</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0357</span>:     # Boundary storage for the upper bound</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0358</span>:     cdef int num_draws = int((max_t / delta_t) + 1)</pre>
<pre class='cython code score-0 '>  __pyx_v_num_draws = ((int)((__pyx_v_max_t / __pyx_v_delta_t) + 1.0));
</pre><pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0359</span>:     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)</pre>
<pre class='cython code score-51 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_max_t + __pyx_v_delta_t));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_t);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_10 = NULL;
  __pyx_t_11 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_10)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_11 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[4] = {__pyx_t_10, __pyx_int_0, __pyx_t_4, __pyx_t_5};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_11, 3+__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 359, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = NULL;
  __pyx_t_11 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_11 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_1};
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_11, 1+__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 359, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_v_t_s = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0360</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0361</span>:     cdef float y, t_particle, t_tmp, smooth_u, deadline_tmp</pre>
<pre class="cython line score-0">&#xA0;<span class="">0362</span>:     cdef Py_ssize_t n, ix, k</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0363</span>:     cdef Py_ssize_t m = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_m = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0364</span>:     cdef float drift_increment = 0.0</pre>
<pre class='cython code score-0 '>  __pyx_v_drift_increment = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0365</span>:     cdef float[:] gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 365, __pyx_L1_error)</span>
  __pyx_v_gaussian_values = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0366</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0367</span>:     # Loop over trials</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0368</span>:     for k in range(n_trials):</pre>
<pre class='cython code score-0 '>  __pyx_t_11 = __pyx_v_n_trials;
  __pyx_t_12 = __pyx_t_11;
  for (__pyx_t_13 = 0; __pyx_t_13 &lt; __pyx_t_12; __pyx_t_13+=1) {
    __pyx_v_k = __pyx_t_13;
</pre><pre class="cython line score-0">&#xA0;<span class="">0369</span>:         # Loop over samples</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0370</span>:         deadline_tmp = min(max_t, deadline_view[k] - t_view[k])</pre>
<pre class='cython code score-0 '>    __pyx_t_14 = __pyx_v_k;
    __pyx_t_15 = __pyx_v_k;
    __pyx_t_16 = ((*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_14 * __pyx_v_deadline_view.strides[0]) ))) - (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_15 * __pyx_v_t_view.strides[0]) ))));
    __pyx_t_17 = __pyx_v_max_t;
    __pyx_t_19 = (__pyx_t_16 &lt; __pyx_t_17);
    if (__pyx_t_19) {
      __pyx_t_18 = __pyx_t_16;
    } else {
      __pyx_t_18 = __pyx_t_17;
    }
    __pyx_v_deadline_tmp = __pyx_t_18;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0371</span>:         for n in range(n_samples):</pre>
<pre class='cython code score-0 '>    __pyx_t_20 = __pyx_v_n_samples;
    __pyx_t_21 = __pyx_t_20;
    for (__pyx_t_22 = 0; __pyx_t_22 &lt; __pyx_t_21; __pyx_t_22+=1) {
      __pyx_v_n = __pyx_t_22;
</pre><pre class="cython line score-0">&#xA0;<span class="">0372</span>:             # initialize starting point</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0373</span>:             y = (z_view[k] * (a_view[k]))  # reset starting position</pre>
<pre class='cython code score-0 '>      __pyx_t_15 = __pyx_v_k;
      __pyx_t_14 = __pyx_v_k;
      __pyx_v_y = ((*((float *) ( /* dim=0 */ (__pyx_v_z_view.data + __pyx_t_15 * __pyx_v_z_view.strides[0]) ))) * (*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_14 * __pyx_v_a_view.strides[0]) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0374</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0375</span>:             # get drift by random displacement of v</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0376</span>:             drift_increment = (v_view[k] + sv_view[k] * gaussian_values[m]) * delta_t</pre>
<pre class='cython code score-0 '>      __pyx_t_14 = __pyx_v_k;
      __pyx_t_15 = __pyx_v_k;
      __pyx_t_23 = __pyx_v_m;
      __pyx_v_drift_increment = (((*((float *) ( /* dim=0 */ (__pyx_v_v_view.data + __pyx_t_14 * __pyx_v_v_view.strides[0]) ))) + ((*((float *) ( /* dim=0 */ (__pyx_v_sv_view.data + __pyx_t_15 * __pyx_v_sv_view.strides[0]) ))) * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_23 * __pyx_v_gaussian_values.strides[0]) ))))) * __pyx_v_delta_t);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0377</span>:             t_tmp = t_view[k] + (2 * (random_uniform() - 0.5) * st_view[k])</pre>
<pre class='cython code score-5 '>      __pyx_t_23 = __pyx_v_k;
      __pyx_t_18 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_18 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 377, __pyx_L1_error)</span>
      __pyx_t_15 = __pyx_v_k;
      __pyx_v_t_tmp = ((*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_23 * __pyx_v_t_view.strides[0]) ))) + ((2.0 * (__pyx_t_18 - 0.5)) * (*((float *) ( /* dim=0 */ (__pyx_v_st_view.data + __pyx_t_15 * __pyx_v_st_view.strides[0]) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0378</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0379</span>:             # apply uniform displacement on y</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0380</span>:             y += 2 * (random_uniform() - 0.5) * sz_view[k]</pre>
<pre class='cython code score-5 '>      __pyx_t_18 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_18 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 380, __pyx_L1_error)</span>
      __pyx_t_15 = __pyx_v_k;
      __pyx_v_y = (__pyx_v_y + ((2.0 * (__pyx_t_18 - 0.5)) * (*((float *) ( /* dim=0 */ (__pyx_v_sz_view.data + __pyx_t_15 * __pyx_v_sz_view.strides[0]) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0381</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0382</span>:             # increment m appropriately</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0383</span>:             m += 1</pre>
<pre class='cython code score-0 '>      __pyx_v_m = (__pyx_v_m + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0384</span>:             if m == num_draws:</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = (__pyx_v_m == __pyx_v_num_draws);
      if (__pyx_t_19) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0385</span>:                 gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>        __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 385, __pyx_L1_error)</span>
        __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
        __pyx_v_gaussian_values = __pyx_t_2;
        __pyx_t_2.memview = NULL;
        __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0386</span>:                 m = 0</pre>
<pre class='cython code score-0 '>        __pyx_v_m = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0387</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0388</span>:             t_particle = 0.0 # reset time</pre>
<pre class='cython code score-0 '>      __pyx_v_t_particle = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0389</span>:             ix = 0 # reset boundary index</pre>
<pre class='cython code score-0 '>      __pyx_v_ix = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0390</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0391</span>:             if n == 0:</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = (__pyx_v_n == 0);
      if (__pyx_t_19) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0392</span>:                 if k == 0:</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = (__pyx_v_k == 0);
        if (__pyx_t_19) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0393</span>:                     traj_view[0, 0] = y</pre>
<pre class='cython code score-0 '>          __pyx_t_15 = 0;
          __pyx_t_23 = 0;
          *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_15 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_23 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y;
</pre><pre class="cython line score-0">&#xA0;<span class="">0394</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0395</span>:             # Random walker</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0396</span>:             while y &gt;= 0 and y &lt;= a_view[k] and t_particle &lt;= deadline_tmp:</pre>
<pre class='cython code score-0 '>      while (1) {
        __pyx_t_24 = (__pyx_v_y &gt;= 0.0);
        if (__pyx_t_24) {
        } else {
          __pyx_t_19 = __pyx_t_24;
          goto __pyx_L12_bool_binop_done;
        }
        __pyx_t_23 = __pyx_v_k;
        __pyx_t_24 = (__pyx_v_y &lt;= (*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_23 * __pyx_v_a_view.strides[0]) ))));
        if (__pyx_t_24) {
        } else {
          __pyx_t_19 = __pyx_t_24;
          goto __pyx_L12_bool_binop_done;
        }
        __pyx_t_24 = (__pyx_v_t_particle &lt;= __pyx_v_deadline_tmp);
        __pyx_t_19 = __pyx_t_24;
        __pyx_L12_bool_binop_done:;
        if (!__pyx_t_19) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0397</span>:                 y += drift_increment + (sqrt_st * gaussian_values[m])</pre>
<pre class='cython code score-0 '>        __pyx_t_23 = __pyx_v_m;
        __pyx_v_y = (__pyx_v_y + (__pyx_v_drift_increment + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_23 * __pyx_v_gaussian_values.strides[0]) ))))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0398</span>:                 t_particle += delta_t</pre>
<pre class='cython code score-0 '>        __pyx_v_t_particle = (__pyx_v_t_particle + __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0399</span>:                 ix += 1</pre>
<pre class='cython code score-0 '>        __pyx_v_ix = (__pyx_v_ix + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0400</span>:                 m += 1</pre>
<pre class='cython code score-0 '>        __pyx_v_m = (__pyx_v_m + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">0401</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0402</span>:                 if n == 0:</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = (__pyx_v_n == 0);
        if (__pyx_t_19) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0403</span>:                     if k == 0:</pre>
<pre class='cython code score-0 '>          __pyx_t_19 = (__pyx_v_k == 0);
          if (__pyx_t_19) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0404</span>:                         traj_view[ix, 0] = y</pre>
<pre class='cython code score-0 '>            __pyx_t_23 = __pyx_v_ix;
            __pyx_t_15 = 0;
            *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_23 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_15 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0405</span>:                 if m == num_draws:</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = (__pyx_v_m == __pyx_v_num_draws);
        if (__pyx_t_19) {
/* … */
        }
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0406</span>:                     gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 406, __pyx_L1_error)</span>
          __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
          __pyx_v_gaussian_values = __pyx_t_2;
          __pyx_t_2.memview = NULL;
          __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0407</span>:                     m = 0</pre>
<pre class='cython code score-0 '>          __pyx_v_m = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0408</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0409</span>:             # Apply smoothing with uniform if desired</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0410</span>:             if smooth:</pre>
<pre class='cython code score-2 '>      __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_smooth); if (unlikely((__pyx_t_19 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 410, __pyx_L1_error)</span>
      if (__pyx_t_19) {
/* … */
        goto __pyx_L18;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0411</span>:                 if t_particle == 0.0:</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = (__pyx_v_t_particle == 0.0);
        if (__pyx_t_19) {
/* … */
          goto __pyx_L19;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0412</span>:                     smooth_u = random_uniform() * 0.5 * delta_t</pre>
<pre class='cython code score-5 '>          __pyx_t_18 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_18 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 412, __pyx_L1_error)</span>
          __pyx_v_smooth_u = ((__pyx_t_18 * 0.5) * __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0413</span>:                 elif t_particle &lt; deadline_tmp:</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = (__pyx_v_t_particle &lt; __pyx_v_deadline_tmp);
        if (__pyx_t_19) {
/* … */
          goto __pyx_L19;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0414</span>:                     smooth_u = (0.5 - random_uniform()) * delta_t</pre>
<pre class='cython code score-5 '>          __pyx_t_18 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_18 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 414, __pyx_L1_error)</span>
          __pyx_v_smooth_u = ((0.5 - __pyx_t_18) * __pyx_v_delta_t);
</pre><pre class="cython line score-0">&#xA0;<span class="">0415</span>:                 else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0416</span>:                     smooth_u = 0.0</pre>
<pre class='cython code score-0 '>        /*else*/ {
          __pyx_v_smooth_u = 0.0;
        }
        __pyx_L19:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0417</span>:             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0418</span>:                 smooth_u = 0.0</pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_v_smooth_u = 0.0;
      }
      __pyx_L18:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0419</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0420</span>:             rts_view[n, k, 0] = t_particle + t_tmp + smooth_u # Store rt</pre>
<pre class='cython code score-0 '>      __pyx_t_15 = __pyx_v_n;
      __pyx_t_23 = __pyx_v_k;
      __pyx_t_14 = 0;
      *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_15 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_23 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_14 * __pyx_v_rts_view.strides[2]) )) = ((__pyx_v_t_particle + __pyx_v_t_tmp) + __pyx_v_smooth_u);
</pre><pre class="cython line score-0">&#xA0;<span class="">0421</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0422</span>:             if y &lt; 0:</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = (__pyx_v_y &lt; 0.0);
      if (__pyx_t_19) {
/* … */
        goto __pyx_L20;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0423</span>:                 choices_view[n, k, 0] = 0 # Store choice</pre>
<pre class='cython code score-0 '>        __pyx_t_14 = __pyx_v_n;
        __pyx_t_23 = __pyx_v_k;
        __pyx_t_15 = 0;
        *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_14 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_23 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_15 * __pyx_v_choices_view.strides[2]) )) = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0424</span>:             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0425</span>:                 choices_view[n, k, 0] = 1</pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_t_15 = __pyx_v_n;
        __pyx_t_23 = __pyx_v_k;
        __pyx_t_14 = 0;
        *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_15 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_23 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_14 * __pyx_v_choices_view.strides[2]) )) = 1;
      }
      __pyx_L20:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0426</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0427</span>:             # If the rt exceeds the deadline, set rt to -999 and choice to -1</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0428</span>:             if (rts_view[n, k, 0] &gt;= deadline_view[k]) | (deadline_view[k] &lt;= 0):</pre>
<pre class='cython code score-0 '>      __pyx_t_14 = __pyx_v_n;
      __pyx_t_23 = __pyx_v_k;
      __pyx_t_15 = 0;
      __pyx_t_25 = __pyx_v_k;
      __pyx_t_26 = __pyx_v_k;
      __pyx_t_19 = (((*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_14 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_23 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_15 * __pyx_v_rts_view.strides[2]) ))) &gt;= (*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_25 * __pyx_v_deadline_view.strides[0]) )))) | ((*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_26 * __pyx_v_deadline_view.strides[0]) ))) &lt;= 0.0));
      if (__pyx_t_19) {
/* … */
      }
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0429</span>:                 rts_view[n, k, 0] = -999</pre>
<pre class='cython code score-0 '>        __pyx_t_26 = __pyx_v_n;
        __pyx_t_25 = __pyx_v_k;
        __pyx_t_15 = 0;
        *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_26 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_25 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_15 * __pyx_v_rts_view.strides[2]) )) = -999.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0430</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0431</span>:     if return_option == 'full':</pre>
<pre class='cython code score-2 '>  __pyx_t_19 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_return_option, __pyx_n_u_full, Py_EQ)); if (unlikely((__pyx_t_19 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 431, __pyx_L1_error)</span>
  if (__pyx_t_19) {
/* … */
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0432</span>:         return {'rts': rts, 'choices': choices, 'metadata': {'v': v,</pre>
<pre class='cython code score-20 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 432, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 432, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 432, __pyx_L1_error)</span>
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(17);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 432, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_v, ((PyObject *)__pyx_v_v)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 432, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0433</span>:                                 'a': a,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 432, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0434</span>:                                 'z': z,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_z, ((PyObject *)__pyx_v_z)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 432, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0435</span>:                                 't': t,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 432, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0436</span>:                                 'sz': sz,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_sz, ((PyObject *)__pyx_v_sz)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 432, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0437</span>:                                 'sv': sv,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_sv, ((PyObject *)__pyx_v_sv)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 432, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0438</span>:                                 'st': st,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_st, ((PyObject *)__pyx_v_st)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 432, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0439</span>:                                 'deadline': deadline,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_deadline, ((PyObject *)__pyx_v_deadline)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 432, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0440</span>:                                 's': s,</pre>
<pre class='cython code score-11 '>    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_s);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 440, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_s, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 432, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0441</span>:                                 'delta_t': delta_t,</pre>
<pre class='cython code score-11 '>    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_t);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 441, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_delta_t, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 432, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0442</span>:                                 'max_t': max_t,</pre>
<pre class='cython code score-11 '>    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_max_t);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 442, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_max_t, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 432, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0443</span>:                                 'n_samples': n_samples,</pre>
<pre class='cython code score-8 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 443, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_n_samples, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 432, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0444</span>:                                 'n_trials': n_trials,</pre>
<pre class='cython code score-13 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 444, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_n_trials, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 432, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_simulator, __pyx_n_u_full_ddm_hddm_base) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 432, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0445</span>:                                 'simulator': 'full_ddm_hddm_base',</pre>
<pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0446</span>:                                 'possible_choices': [0, 1],</pre>
<pre class='cython code score-22 '>    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 446, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_int_0)) <span class='error_goto'>__PYX_ERR(0, 446, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 446, __pyx_L1_error)</span>;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_possible_choices, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 432, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_boundary_fun_type, __pyx_n_u_constant) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 432, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0447</span>:                                 'boundary_fun_type': 'constant',</pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0448</span>:                                 'trajectory': traj}}</pre>
<pre class='cython code score-11 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_trajectory, __pyx_v_traj) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 432, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_metadata, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 432, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_r = __pyx_t_7;
    __pyx_t_7 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0449</span>:     elif return_option == 'minimal':</pre>
<pre class='cython code score-2 '>  __pyx_t_19 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_return_option, __pyx_n_u_minimal, Py_EQ)); if (unlikely((__pyx_t_19 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 449, __pyx_L1_error)</span>
  if (likely(__pyx_t_19)) {
/* … */
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0450</span>:         return {'rts': rts, 'choices': choices, 'metadata': {'simulator': 'full_ddm_hddm_base',</pre>
<pre class='cython code score-20 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 450, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 450, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 450, __pyx_L1_error)</span>
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 450, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_simulator, __pyx_n_u_full_ddm_hddm_base) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 450, __pyx_L1_error)</span>
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0451</span>:                                                              'possible_choices': [0, 1],</pre>
<pre class='cython code score-17 '>    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 451, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_int_0)) <span class='error_goto'>__PYX_ERR(0, 451, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 451, __pyx_L1_error)</span>;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_possible_choices, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 450, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0452</span>:                                                              'n_samples': n_samples,</pre>
<pre class='cython code score-8 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 452, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_n_samples, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 450, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0453</span>:                                                              'n_trials': n_trials,</pre>
<pre class='cython code score-19 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 453, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_n_trials, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 450, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_boundary_fun_type, __pyx_n_u_constant) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 450, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_metadata, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 450, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_r = __pyx_t_7;
    __pyx_t_7 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0454</span>:                                                              'boundary_fun_type': 'constant'}}</pre>
<pre class="cython line score-0">&#xA0;<span class="">0455</span>:     else:</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0456</span>:         raise ValueError('return_option must be either "full" or "minimal"')</pre>
<pre class='cython code score-5 '>  /*else*/ {
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 456, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_7, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='error_goto'>__PYX_ERR(0, 456, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0457</span>: # -------------------------------------------------------------------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0458</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0459</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0460</span>: # Simulate (rt, choice) tuples from: SIMPLE DDM -----------------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0461</span>: # Simplest algorithm</pre>
<pre class="cython line score-0">&#xA0;<span class="">0462</span>: # delete random comment</pre>
<pre class="cython line score-0">&#xA0;<span class="">0463</span>: # delete random comment 2</pre>
<pre class="cython line score-0">&#xA0;<span class="">0464</span>: #@cython.boundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0465</span>: #@cython.wraparound(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0466</span>: </pre>
<pre class="cython line score-105" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0467</span>: def ddm(np.ndarray[float, ndim = 1] v, # drift by timestep 'delta_t'</pre>
<pre class='cython code score-105 '>/* Python wrapper */
static PyObject *__pyx_pw_4cssm_7ddm(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_4cssm_7ddm = {"ddm", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_4cssm_7ddm, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_4cssm_7ddm(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyArrayObject *__pyx_v_v = 0;
  PyArrayObject *__pyx_v_a = 0;
  PyArrayObject *__pyx_v_z = 0;
  PyArrayObject *__pyx_v_t = 0;
  PyArrayObject *__pyx_v_deadline = 0;
  PyObject *__pyx_v_max_t = 0;
  float __pyx_v_s;
  float __pyx_v_delta_t;
  int __pyx_v_n_samples;
  int __pyx_v_n_trials;
  PyObject *__pyx_v_random_state = 0;
  PyObject *__pyx_v_return_option = 0;
  PyObject *__pyx_v_smooth = 0;
  CYTHON_UNUSED PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("ddm (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_v,&amp;__pyx_n_s_a,&amp;__pyx_n_s_z,&amp;__pyx_n_s_t,&amp;__pyx_n_s_deadline,&amp;__pyx_n_s_max_t,&amp;__pyx_n_s_s,&amp;__pyx_n_s_delta_t,&amp;__pyx_n_s_n_samples,&amp;__pyx_n_s_n_trials,&amp;__pyx_n_s_random_state,&amp;__pyx_n_s_return_option,&amp;__pyx_n_s_smooth,0};
  PyObject* values[13] = {0,0,0,0,0,0,0,0,0,0,0,0,0};
    values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)__pyx_int_20)));
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs);
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4cssm_6ddm(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_t, PyArrayObject *__pyx_v_deadline, PyObject *__pyx_v_max_t, float __pyx_v_s, float __pyx_v_delta_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_random_state, PyObject *__pyx_v_return_option, PyObject *__pyx_v_smooth, CYTHON_UNUSED PyObject *__pyx_v_kwargs) {
  __Pyx_memviewslice __pyx_v_v_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_a_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_z_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_t_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_deadline_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_traj = NULL;
  __Pyx_memviewslice __pyx_v_traj_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_rts = NULL;
  PyObject *__pyx_v_choices = NULL;
  __Pyx_memviewslice __pyx_v_rts_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_choices_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  float __pyx_v_delta_t_sqrt;
  float __pyx_v_sqrt_st;
  float __pyx_v_y;
  float __pyx_v_t_particle;
  float __pyx_v_smooth_u;
  float __pyx_v_deadline_tmp;
  Py_ssize_t __pyx_v_n;
  Py_ssize_t __pyx_v_ix;
  Py_ssize_t __pyx_v_k;
  int __pyx_v_m;
  int __pyx_v_num_draws;
  __Pyx_memviewslice __pyx_v_gaussian_values = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_LocalBuf_ND __pyx_pybuffernd_a;
  __Pyx_Buffer __pyx_pybuffer_a;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_deadline;
  __Pyx_Buffer __pyx_pybuffer_deadline;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_t;
  __Pyx_Buffer __pyx_pybuffer_t;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_v;
  __Pyx_Buffer __pyx_pybuffer_v;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_z;
  __Pyx_Buffer __pyx_pybuffer_z;
  PyObject *__pyx_r = NULL;
  __pyx_pybuffer_v.pybuffer.buf = NULL;
  __pyx_pybuffer_v.refcount = 0;
  __pyx_pybuffernd_v.data = NULL;
  __pyx_pybuffernd_v.rcbuffer = &amp;__pyx_pybuffer_v;
  __pyx_pybuffer_a.pybuffer.buf = NULL;
  __pyx_pybuffer_a.refcount = 0;
  __pyx_pybuffernd_a.data = NULL;
  __pyx_pybuffernd_a.rcbuffer = &amp;__pyx_pybuffer_a;
  __pyx_pybuffer_z.pybuffer.buf = NULL;
  __pyx_pybuffer_z.refcount = 0;
  __pyx_pybuffernd_z.data = NULL;
  __pyx_pybuffernd_z.rcbuffer = &amp;__pyx_pybuffer_z;
  __pyx_pybuffer_t.pybuffer.buf = NULL;
  __pyx_pybuffer_t.refcount = 0;
  __pyx_pybuffernd_t.data = NULL;
  __pyx_pybuffernd_t.rcbuffer = &amp;__pyx_pybuffer_t;
  __pyx_pybuffer_deadline.pybuffer.buf = NULL;
  __pyx_pybuffer_deadline.refcount = 0;
  __pyx_pybuffernd_deadline.data = NULL;
  __pyx_pybuffernd_deadline.rcbuffer = &amp;__pyx_pybuffer_deadline;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_v, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 467, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_v.diminfo[0].strides = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_v.diminfo[0].shape = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_a, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 467, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_z, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 467, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_z.diminfo[0].strides = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_z.diminfo[0].shape = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_t, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 467, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_t.diminfo[0].strides = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_t.diminfo[0].shape = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_deadline, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 467, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_deadline.diminfo[0].strides = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_deadline.diminfo[0].shape = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.shape[0];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_2, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_9, 1);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.ddm", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_v_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_a_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_z_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_t_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_deadline_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_traj);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_traj_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_choices);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_rts_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_choices_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__29 = <span class='py_c_api'>PyTuple_Pack</span>(37, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_t, __pyx_n_s_deadline, __pyx_n_s_max_t, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_random_state, __pyx_n_s_return_option, __pyx_n_s_smooth, __pyx_n_s_kwargs, __pyx_n_s_v_view, __pyx_n_s_a_view, __pyx_n_s_z_view, __pyx_n_s_t_view, __pyx_n_s_deadline_view, __pyx_n_s_traj, __pyx_n_s_traj_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_y, __pyx_n_s_t_particle, __pyx_n_s_smooth_u, __pyx_n_s_deadline_tmp, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_num_draws, __pyx_n_s_gaussian_values);<span class='error_goto'> if (unlikely(!__pyx_tuple__29)) __PYX_ERR(0, 467, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__29);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__29);
/* … */
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(8);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 467, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_int_20));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_int_20));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, ((PyObject *)__pyx_int_20))) <span class='error_goto'>__PYX_ERR(0, 467, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_11)) <span class='error_goto'>__PYX_ERR(0, 467, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_t_10)) <span class='error_goto'>__PYX_ERR(0, 467, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 3, __pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 467, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 4, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 467, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 5, Py_None)) <span class='error_goto'>__PYX_ERR(0, 467, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject*)__pyx_n_u_full));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject*)__pyx_n_u_full));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 6, ((PyObject*)__pyx_n_u_full))) <span class='error_goto'>__PYX_ERR(0, 467, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_False));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_False));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 7, ((PyObject *)Py_False))) <span class='error_goto'>__PYX_ERR(0, 467, __pyx_L1_error)</span>;
  __pyx_t_11 = 0;
  __pyx_t_10 = 0;
  __pyx_t_9 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_4cssm_7ddm, 0, __pyx_n_s_ddm, NULL, __pyx_n_s_cssm, __pyx_d, ((PyObject *)__pyx_codeobj__30));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 467, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_5, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_ddm, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 467, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_codeobj__30 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(13, 0, 0, 37, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__29, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_ddm, 467, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__30)) __PYX_ERR(0, 467, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0468</span>:         np.ndarray[float, ndim = 1] a, # boundary separation</pre>
<pre class="cython line score-0">&#xA0;<span class="">0469</span>:         np.ndarray[float, ndim = 1] z,  # between 0 and 1</pre>
<pre class="cython line score-0">&#xA0;<span class="">0470</span>:         np.ndarray[float, ndim = 1] t, # non-decision time</pre>
<pre class="cython line score-0">&#xA0;<span class="">0471</span>:         np.ndarray[float, ndim = 1] deadline, # maximum rt allowed</pre>
<pre class="cython line score-0">&#xA0;<span class="">0472</span>:         max_t = 20, # maximum rt allowed</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0473</span>:         float s = 1, # noise sigma</pre>
<pre class='cython code score-5 '>  __pyx_t_11 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)1.0));<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 473, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0474</span>:         float delta_t = 0.001, # timesteps fraction of seconds</pre>
<pre class='cython code score-5 '>  __pyx_t_10 = <span class='py_c_api'>PyFloat_FromDouble</span>(((double)0.001));<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 474, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0475</span>:         int n_samples = 20000, # number of samples considered</pre>
<pre class='cython code score-2 '>  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)0x4E20));<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 475, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0476</span>:         int n_trials = 10,</pre>
<pre class='cython code score-2 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)10));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 476, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0477</span>:         random_state = None,</pre>
<pre class='cython code score-4 '>    values[10] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[11] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_full)));
</pre><pre class="cython line score-0">&#xA0;<span class="">0478</span>:         return_option = 'full', # 'full' or 'minimal'</pre>
<pre class="cython line score-234" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0479</span>:         smooth = False,</pre>
<pre class='cython code score-234 '>    values[12] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case 13: values[12] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_v)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 467, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_a)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 467, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm", 0, 5, 13, 1); <span class='error_goto'>__PYX_ERR(0, 467, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_z)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 467, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm", 0, 5, 13, 2); <span class='error_goto'>__PYX_ERR(0, 467, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_t)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[3]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 467, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm", 0, 5, 13, 3); <span class='error_goto'>__PYX_ERR(0, 467, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_deadline)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[4]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 467, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm", 0, 5, 13, 4); <span class='error_goto'>__PYX_ERR(0, 467, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_max_t);
          if (value) { values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 467, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_s);
          if (value) { values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 467, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_delta_t);
          if (value) { values[7] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 467, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_samples);
          if (value) { values[8] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 467, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  9:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_trials);
          if (value) { values[9] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 467, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 10:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_random_state);
          if (value) { values[10] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 467, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 11:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_return_option);
          if (value) { values[11] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 467, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 12:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_smooth);
          if (value) { values[12] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 467, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values + 0, kwd_pos_args, "ddm") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 467, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case 13: values[12] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_v = ((PyArrayObject *)values[0]);
    __pyx_v_a = ((PyArrayObject *)values[1]);
    __pyx_v_z = ((PyArrayObject *)values[2]);
    __pyx_v_t = ((PyArrayObject *)values[3]);
    __pyx_v_deadline = ((PyArrayObject *)values[4]);
    __pyx_v_max_t = values[5];
    if (values[6]) {
      __pyx_v_s = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[6]); if (unlikely((__pyx_v_s == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 473, __pyx_L3_error)</span>
    } else {
      __pyx_v_s = ((float)((float)1.0));
    }
    if (values[7]) {
      __pyx_v_delta_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[7]); if (unlikely((__pyx_v_delta_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 474, __pyx_L3_error)</span>
    } else {
      __pyx_v_delta_t = ((float)((double)0.001));
    }
    if (values[8]) {
      __pyx_v_n_samples = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[8]); if (unlikely((__pyx_v_n_samples == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 475, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_samples = ((int)((int)0x4E20));
    }
    if (values[9]) {
      __pyx_v_n_trials = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[9]); if (unlikely((__pyx_v_n_trials == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 476, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_trials = ((int)((int)10));
    }
    __pyx_v_random_state = values[10];
    __pyx_v_return_option = values[11];
    __pyx_v_smooth = values[12];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm", 0, 5, 13, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 467, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.ddm", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) <span class='error_goto'>__PYX_ERR(0, 467, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) <span class='error_goto'>__PYX_ERR(0, 468, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) <span class='error_goto'>__PYX_ERR(0, 469, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) <span class='error_goto'>__PYX_ERR(0, 470, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_deadline), __pyx_ptype_5numpy_ndarray, 1, "deadline", 0))) <span class='error_goto'>__PYX_ERR(0, 471, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_4cssm_6ddm(__pyx_self, __pyx_v_v, __pyx_v_a, __pyx_v_z, __pyx_v_t, __pyx_v_deadline, __pyx_v_max_t, __pyx_v_s, __pyx_v_delta_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_random_state, __pyx_v_return_option, __pyx_v_smooth, __pyx_v_kwargs);
</pre><pre class="cython line score-0">&#xA0;<span class="">0480</span>:         **kwargs):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0481</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0482</span>:     set_seed(random_state)</pre>
<pre class='cython code score-1 '>  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 482, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0483</span>:     # Param views</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0484</span>:     cdef float[:] v_view = v</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_v), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 484, __pyx_L1_error)</span>
  __pyx_v_v_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0485</span>:     cdef float[:] a_view = a</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_a), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 485, __pyx_L1_error)</span>
  __pyx_v_a_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0486</span>:     cdef float[:] z_view = z</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_z), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 486, __pyx_L1_error)</span>
  __pyx_v_z_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0487</span>:     cdef float[:] t_view = t</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_t), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 487, __pyx_L1_error)</span>
  __pyx_v_t_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0488</span>:     cdef float[:] deadline_view = deadline</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_deadline), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 488, __pyx_L1_error)</span>
  __pyx_v_deadline_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0489</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0490</span>:     # Data-structs for trajectory storage</pre>
<pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0491</span>:     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)</pre>
<pre class='cython code score-51 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 491, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 491, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_t);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 491, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_max_t, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 491, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_Int</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 491, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_1, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 491, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 491, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 491, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 491, __pyx_L1_error)</span>;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 491, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 491, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 491, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 491, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 491, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 491, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_traj = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0492</span>:     traj[:, :] = -999</pre>
<pre class='cython code score-5 '>  if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_traj, __pyx_tuple__12, __pyx_int_neg_999) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 492, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0493</span>:     cdef float[:, :] traj_view = traj</pre>
<pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(__pyx_v_traj, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 493, __pyx_L1_error)</span>
  __pyx_v_traj_view = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0494</span>: </pre>
<pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0495</span>:     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)</pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 495, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 495, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 495, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 495, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 495, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 495, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 495, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 495, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 495, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 495, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 495, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 495, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 495, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 495, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_rts = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0496</span>:     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)</pre>
<pre class='cython code score-46 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 496, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 496, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 496, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 496, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 496, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 496, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 496, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 496, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 496, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 496, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 496, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 496, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_intc);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 496, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 496, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 496, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_choices = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0497</span>:     cdef float[:, :, :] rts_view = rts</pre>
<pre class='cython code score-2 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_rts, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 497, __pyx_L1_error)</span>
  __pyx_v_rts_view = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0498</span>:     cdef int[:, :, :] choices_view = choices</pre>
<pre class='cython code score-2 '>  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_int</span>(__pyx_v_choices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 498, __pyx_L1_error)</span>
  __pyx_v_choices_view = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0499</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0500</span>:     cdef float delta_t_sqrt = sqrt(delta_t)</pre>
<pre class='cython code score-0 '>  __pyx_v_delta_t_sqrt = sqrt(__pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0501</span>:     cdef float sqrt_st = delta_t_sqrt * s</pre>
<pre class='cython code score-0 '>  __pyx_v_sqrt_st = (__pyx_v_delta_t_sqrt * __pyx_v_s);
</pre><pre class="cython line score-0">&#xA0;<span class="">0502</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0503</span>:     cdef float y, t_particle, smooth_u, deadline_tmp</pre>
<pre class="cython line score-0">&#xA0;<span class="">0504</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0505</span>:     #cdef int n</pre>
<pre class="cython line score-0">&#xA0;<span class="">0506</span>:     cdef Py_ssize_t n, ix, k</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0507</span>:     cdef int m = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_m = 0;
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0508</span>:     cdef int num_draws = int(max_t / delta_t + 1)</pre>
<pre class='cython code score-22 '>  __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_t);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 508, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_max_t, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 508, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_1, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 508, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_Int</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 508, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1); if (unlikely((__pyx_t_10 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 508, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_num_draws = __pyx_t_10;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0509</span>:     cdef float[:] gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 509, __pyx_L1_error)</span>
  __pyx_v_gaussian_values = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0510</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0511</span>:     for k in range(n_trials):</pre>
<pre class='cython code score-0 '>  __pyx_t_10 = __pyx_v_n_trials;
  __pyx_t_11 = __pyx_t_10;
  for (__pyx_t_12 = 0; __pyx_t_12 &lt; __pyx_t_11; __pyx_t_12+=1) {
    __pyx_v_k = __pyx_t_12;
</pre><pre class="cython line score-0">&#xA0;<span class="">0512</span>:         # Loop over samples</pre>
<pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0513</span>:         deadline_tmp = min(max_t, deadline_view[k] - t_view[k])</pre>
<pre class='cython code score-33 '>    __pyx_t_13 = __pyx_v_k;
    __pyx_t_14 = __pyx_v_k;
    __pyx_t_15 = ((*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_13 * __pyx_v_deadline_view.strides[0]) ))) - (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_14 * __pyx_v_t_view.strides[0]) ))));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_max_t);
    __pyx_t_1 = __pyx_v_max_t;
    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_t_15);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 513, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_4, __pyx_t_1, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 513, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely((__pyx_t_16 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 513, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (__pyx_t_16) {
      __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_t_15);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 513, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_7 = __pyx_t_3;
      __pyx_t_3 = 0;
    } else {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      __pyx_t_7 = __pyx_t_1;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_15 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_7); if (unlikely((__pyx_t_15 == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 513, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_v_deadline_tmp = __pyx_t_15;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0514</span>:         for n in range(n_samples):</pre>
<pre class='cython code score-0 '>    __pyx_t_17 = __pyx_v_n_samples;
    __pyx_t_18 = __pyx_t_17;
    for (__pyx_t_19 = 0; __pyx_t_19 &lt; __pyx_t_18; __pyx_t_19+=1) {
      __pyx_v_n = __pyx_t_19;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0515</span>:             y = z_view[k] * a_view[k] # reset starting point</pre>
<pre class='cython code score-0 '>      __pyx_t_14 = __pyx_v_k;
      __pyx_t_13 = __pyx_v_k;
      __pyx_v_y = ((*((float *) ( /* dim=0 */ (__pyx_v_z_view.data + __pyx_t_14 * __pyx_v_z_view.strides[0]) ))) * (*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_13 * __pyx_v_a_view.strides[0]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0516</span>:             t_particle = 0.0 # reset time</pre>
<pre class='cython code score-0 '>      __pyx_v_t_particle = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0517</span>:             ix = 0 # reset boundary index</pre>
<pre class='cython code score-0 '>      __pyx_v_ix = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0518</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0519</span>:             if n == 0:</pre>
<pre class='cython code score-0 '>      __pyx_t_16 = (__pyx_v_n == 0);
      if (__pyx_t_16) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0520</span>:                 if k == 0:</pre>
<pre class='cython code score-0 '>        __pyx_t_16 = (__pyx_v_k == 0);
        if (__pyx_t_16) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0521</span>:                     traj_view[0, 0] = y</pre>
<pre class='cython code score-0 '>          __pyx_t_13 = 0;
          __pyx_t_14 = 0;
          *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_13 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_14 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y;
</pre><pre class="cython line score-0">&#xA0;<span class="">0522</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0523</span>:             # Random walker</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0524</span>:             while y &lt;= a_view[k] and y &gt;= 0 and t_particle &lt;= deadline_tmp:</pre>
<pre class='cython code score-0 '>      while (1) {
        __pyx_t_14 = __pyx_v_k;
        __pyx_t_20 = (__pyx_v_y &lt;= (*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_14 * __pyx_v_a_view.strides[0]) ))));
        if (__pyx_t_20) {
        } else {
          __pyx_t_16 = __pyx_t_20;
          goto __pyx_L11_bool_binop_done;
        }
        __pyx_t_20 = (__pyx_v_y &gt;= 0.0);
        if (__pyx_t_20) {
        } else {
          __pyx_t_16 = __pyx_t_20;
          goto __pyx_L11_bool_binop_done;
        }
        __pyx_t_20 = (__pyx_v_t_particle &lt;= __pyx_v_deadline_tmp);
        __pyx_t_16 = __pyx_t_20;
        __pyx_L11_bool_binop_done:;
        if (!__pyx_t_16) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0525</span>:                 y += v_view[k] * delta_t + sqrt_st * gaussian_values[m] # update particle position</pre>
<pre class='cython code score-0 '>        __pyx_t_14 = __pyx_v_k;
        __pyx_t_13 = __pyx_v_m;
        __pyx_v_y = (__pyx_v_y + (((*((float *) ( /* dim=0 */ (__pyx_v_v_view.data + __pyx_t_14 * __pyx_v_v_view.strides[0]) ))) * __pyx_v_delta_t) + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_13 * __pyx_v_gaussian_values.strides[0]) ))))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0526</span>:                 t_particle += delta_t</pre>
<pre class='cython code score-0 '>        __pyx_v_t_particle = (__pyx_v_t_particle + __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0527</span>:                 m += 1</pre>
<pre class='cython code score-0 '>        __pyx_v_m = (__pyx_v_m + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0528</span>:                 ix += 1</pre>
<pre class='cython code score-0 '>        __pyx_v_ix = (__pyx_v_ix + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">0529</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0530</span>:                 if n == 0:</pre>
<pre class='cython code score-0 '>        __pyx_t_16 = (__pyx_v_n == 0);
        if (__pyx_t_16) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0531</span>:                     if k == 0:</pre>
<pre class='cython code score-0 '>          __pyx_t_16 = (__pyx_v_k == 0);
          if (__pyx_t_16) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0532</span>:                         traj_view[ix, 0] = y</pre>
<pre class='cython code score-0 '>            __pyx_t_13 = __pyx_v_ix;
            __pyx_t_14 = 0;
            *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_13 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_14 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y;
</pre><pre class="cython line score-0">&#xA0;<span class="">0533</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0534</span>:                 if m == num_draws:</pre>
<pre class='cython code score-0 '>        __pyx_t_16 = (__pyx_v_m == __pyx_v_num_draws);
        if (__pyx_t_16) {
/* … */
        }
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0535</span>:                     gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 535, __pyx_L1_error)</span>
          __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
          __pyx_v_gaussian_values = __pyx_t_2;
          __pyx_t_2.memview = NULL;
          __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0536</span>:                     m = 0</pre>
<pre class='cython code score-0 '>          __pyx_v_m = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0537</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0538</span>:             # Note that for purposes of consistency with Navarro and Fuss,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0539</span>:             # the choice corresponding the lower barrier is +1, higher barrier is -1</pre>
<pre class="cython line score-0">&#xA0;<span class="">0540</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0541</span>:             # Apply smoothing with uniform if desired</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0542</span>:             if smooth:</pre>
<pre class='cython code score-2 '>      __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_smooth); if (unlikely((__pyx_t_16 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 542, __pyx_L1_error)</span>
      if (__pyx_t_16) {
/* … */
        goto __pyx_L17;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0543</span>:                 if t_particle == 0.0:</pre>
<pre class='cython code score-0 '>        __pyx_t_16 = (__pyx_v_t_particle == 0.0);
        if (__pyx_t_16) {
/* … */
          goto __pyx_L18;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0544</span>:                     smooth_u = random_uniform() * 0.5 * delta_t</pre>
<pre class='cython code score-5 '>          __pyx_t_15 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_15 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 544, __pyx_L1_error)</span>
          __pyx_v_smooth_u = ((__pyx_t_15 * 0.5) * __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0545</span>:                 elif t_particle &lt; deadline_tmp:</pre>
<pre class='cython code score-0 '>        __pyx_t_16 = (__pyx_v_t_particle &lt; __pyx_v_deadline_tmp);
        if (__pyx_t_16) {
/* … */
          goto __pyx_L18;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0546</span>:                     smooth_u = (0.5 - random_uniform()) * delta_t</pre>
<pre class='cython code score-5 '>          __pyx_t_15 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_15 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 546, __pyx_L1_error)</span>
          __pyx_v_smooth_u = ((0.5 - __pyx_t_15) * __pyx_v_delta_t);
</pre><pre class="cython line score-0">&#xA0;<span class="">0547</span>:                 else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0548</span>:                     smooth_u = 0.0</pre>
<pre class='cython code score-0 '>        /*else*/ {
          __pyx_v_smooth_u = 0.0;
        }
        __pyx_L18:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0549</span>:             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0550</span>:                 smooth_u = 0.0</pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_v_smooth_u = 0.0;
      }
      __pyx_L17:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0551</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0552</span>:             rts_view[n, k, 0] = t_particle + t_view[k] + smooth_u # store rt</pre>
<pre class='cython code score-0 '>      __pyx_t_14 = __pyx_v_k;
      __pyx_t_13 = __pyx_v_n;
      __pyx_t_21 = __pyx_v_k;
      __pyx_t_22 = 0;
      *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_13 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_21 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_22 * __pyx_v_rts_view.strides[2]) )) = ((__pyx_v_t_particle + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_14 * __pyx_v_t_view.strides[0]) )))) + __pyx_v_smooth_u);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0553</span>:             choices_view[n, k, 0] = sign(y) # store choice</pre>
<pre class='cython code score-5 '>      __pyx_t_23 = __pyx_f_4cssm_sign(__pyx_v_y); if (unlikely(__pyx_t_23 == ((int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 553, __pyx_L1_error)</span>
      __pyx_t_14 = __pyx_v_n;
      __pyx_t_22 = __pyx_v_k;
      __pyx_t_21 = 0;
      *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_14 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_22 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_21 * __pyx_v_choices_view.strides[2]) )) = __pyx_t_23;
</pre><pre class="cython line score-0">&#xA0;<span class="">0554</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0555</span>:             # If the rt exceeds the deadline, set rt to -999 and choice to -1</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0556</span>:             if (rts_view[n, k, 0] &gt;= deadline_view[k]) | (deadline_view[k] &lt;= 0):</pre>
<pre class='cython code score-0 '>      __pyx_t_21 = __pyx_v_n;
      __pyx_t_22 = __pyx_v_k;
      __pyx_t_14 = 0;
      __pyx_t_13 = __pyx_v_k;
      __pyx_t_24 = __pyx_v_k;
      __pyx_t_16 = (((*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_21 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_22 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_14 * __pyx_v_rts_view.strides[2]) ))) &gt;= (*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_13 * __pyx_v_deadline_view.strides[0]) )))) | ((*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_24 * __pyx_v_deadline_view.strides[0]) ))) &lt;= 0.0));
      if (__pyx_t_16) {
/* … */
      }
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0557</span>:                 rts_view[n, k, 0] = -999</pre>
<pre class='cython code score-0 '>        __pyx_t_24 = __pyx_v_n;
        __pyx_t_13 = __pyx_v_k;
        __pyx_t_14 = 0;
        *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_24 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_13 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_14 * __pyx_v_rts_view.strides[2]) )) = -999.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0558</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0559</span>:     if return_option == 'full':</pre>
<pre class='cython code score-2 '>  __pyx_t_16 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_return_option, __pyx_n_u_full, Py_EQ)); if (unlikely((__pyx_t_16 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 559, __pyx_L1_error)</span>
  if (__pyx_t_16) {
/* … */
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0560</span>:         return {'rts': rts, 'choices': choices,  'metadata': {'v': v,</pre>
<pre class='cython code score-20 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 560, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 560, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 560, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(14);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 560, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_v, ((PyObject *)__pyx_v_v)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 560, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0561</span>:                                                             'a': a,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 560, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0562</span>:                                                             'z': z,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_z, ((PyObject *)__pyx_v_z)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 560, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0563</span>:                                                             't': t,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 560, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0564</span>:                                                             'deadline': deadline,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_deadline, ((PyObject *)__pyx_v_deadline)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 560, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0565</span>:                                                             's': s,</pre>
<pre class='cython code score-11 '>    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_s);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 565, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_s, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 560, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0566</span>:                                                             'delta_t': delta_t,</pre>
<pre class='cython code score-11 '>    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_t);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 566, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_delta_t, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 560, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0567</span>:                                                             'max_t': max_t,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_max_t, __pyx_v_max_t) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 560, __pyx_L1_error)</span>
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0568</span>:                                                             'n_samples': n_samples,</pre>
<pre class='cython code score-8 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 568, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_n_samples, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 560, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0569</span>:                                                             'n_trials': n_trials,</pre>
<pre class='cython code score-18 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 569, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_n_trials, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 560, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_simulator, __pyx_n_u_ddm) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 560, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_boundary_fun_type, __pyx_n_u_constant) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 560, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0570</span>:                                                             'simulator': 'ddm',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0571</span>:                                                             'boundary_fun_type': 'constant',</pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0572</span>:                                                             'possible_choices': [-1, 1],</pre>
<pre class='cython code score-17 '>    __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 572, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_int_neg_1)) <span class='error_goto'>__PYX_ERR(0, 572, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 572, __pyx_L1_error)</span>;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_possible_choices, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 560, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0573</span>:                                                             'trajectory': traj}}</pre>
<pre class='cython code score-11 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_trajectory, __pyx_v_traj) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 560, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_metadata, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 560, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_r = __pyx_t_7;
    __pyx_t_7 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0574</span>:     elif return_option == 'minimal':</pre>
<pre class='cython code score-2 '>  __pyx_t_16 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_return_option, __pyx_n_u_minimal, Py_EQ)); if (unlikely((__pyx_t_16 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 574, __pyx_L1_error)</span>
  if (likely(__pyx_t_16)) {
/* … */
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0575</span>:         return {'rts': rts, 'choices': choices,  'metadata': {'simulator': 'ddm',</pre>
<pre class='cython code score-20 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 575, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 575, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 575, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 575, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_simulator, __pyx_n_u_ddm) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 575, __pyx_L1_error)</span>
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0576</span>:                                                              'possible_choices': [-1, 1],</pre>
<pre class='cython code score-22 '>    __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 576, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_int_neg_1)) <span class='error_goto'>__PYX_ERR(0, 576, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 576, __pyx_L1_error)</span>;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_possible_choices, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 575, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_boundary_fun_type, __pyx_n_u_constant) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 575, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0577</span>:                                                              'boundary_fun_type': 'constant',</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0578</span>:                                                              'n_samples': n_samples,</pre>
<pre class='cython code score-8 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 578, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_n_samples, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 575, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0579</span>:                                                              'n_trials': n_trials,}}</pre>
<pre class='cython code score-14 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 579, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_n_trials, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 575, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_metadata, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 575, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_r = __pyx_t_7;
    __pyx_t_7 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0580</span>:     else:</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0581</span>:         raise ValueError('return_option must be either "full" or "minimal"')</pre>
<pre class='cython code score-5 '>  /*else*/ {
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 581, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_7, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='error_goto'>__PYX_ERR(0, 581, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0582</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0583</span>: # Simulate (rt, choice) tuples from: DDM WITH FLEXIBLE BOUNDARIES ------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0584</span>: # @cythonboundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0585</span>: # @cythonwraparound(False)</pre>
<pre class="cython line score-136" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0586</span>: def ddm_flexbound(np.ndarray[float, ndim = 1] v,</pre>
<pre class='cython code score-136 '>static PyObject *__pyx_pf_4cssm_46__defaults__(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_r = NULL;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
/* … */
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(11);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 586, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 2, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 3, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 4, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 5, Py_None)) <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_True));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_True));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 6, ((PyObject *)Py_True))) <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults, __pyx_self)-&gt;__pyx_arg_boundary_params);
  <span class='refnanny'>__Pyx_GIVEREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults, __pyx_self)-&gt;__pyx_arg_boundary_params);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 7, <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults, __pyx_self)-&gt;__pyx_arg_boundary_params)) <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 8, Py_None)) <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject*)__pyx_n_u_full));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject*)__pyx_n_u_full));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 9, ((PyObject*)__pyx_n_u_full))) <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_False));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_False));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 10, ((PyObject *)Py_False))) <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 586, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 1, Py_None)) <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L1_error)</span>;
  __pyx_t_6 = 0;
  __pyx_r = __pyx_t_5;
  __pyx_t_5 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.__defaults__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_4cssm_9ddm_flexbound(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_4cssm_9ddm_flexbound = {"ddm_flexbound", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_4cssm_9ddm_flexbound, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_4cssm_9ddm_flexbound(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyArrayObject *__pyx_v_v = 0;
  PyArrayObject *__pyx_v_a = 0;
  PyArrayObject *__pyx_v_z = 0;
  PyArrayObject *__pyx_v_t = 0;
  PyArrayObject *__pyx_v_deadline = 0;
  float __pyx_v_s;
  float __pyx_v_max_t;
  float __pyx_v_delta_t;
  int __pyx_v_n_samples;
  int __pyx_v_n_trials;
  PyObject *__pyx_v_boundary_fun = 0;
  PyObject *__pyx_v_boundary_multiplicative = 0;
  PyObject *__pyx_v_boundary_params = 0;
  PyObject *__pyx_v_random_state = 0;
  PyObject *__pyx_v_return_option = 0;
  PyObject *__pyx_v_smooth = 0;
  CYTHON_UNUSED PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("ddm_flexbound (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_v,&amp;__pyx_n_s_a,&amp;__pyx_n_s_z,&amp;__pyx_n_s_t,&amp;__pyx_n_s_deadline,&amp;__pyx_n_s_s,&amp;__pyx_n_s_max_t,&amp;__pyx_n_s_delta_t,&amp;__pyx_n_s_n_samples,&amp;__pyx_n_s_n_trials,&amp;__pyx_n_s_boundary_fun,&amp;__pyx_n_s_boundary_multiplicative,&amp;__pyx_n_s_boundary_params,&amp;__pyx_n_s_random_state,&amp;__pyx_n_s_return_option,&amp;__pyx_n_s_smooth,0};
  PyObject* values[16] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    __pyx_defaults *__pyx_dynamic_args = <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults, __pyx_self);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs);
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4cssm_8ddm_flexbound(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_t, PyArrayObject *__pyx_v_deadline, float __pyx_v_s, float __pyx_v_max_t, float __pyx_v_delta_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state, PyObject *__pyx_v_return_option, PyObject *__pyx_v_smooth, CYTHON_UNUSED PyObject *__pyx_v_kwargs) {
  __Pyx_memviewslice __pyx_v_v_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_a_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_z_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_t_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_deadline_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_traj = NULL;
  __Pyx_memviewslice __pyx_v_traj_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_rts = NULL;
  PyObject *__pyx_v_choices = NULL;
  __Pyx_memviewslice __pyx_v_rts_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_choices_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  float __pyx_v_delta_t_sqrt;
  float __pyx_v_sqrt_st;
  int __pyx_v_num_draws;
  PyObject *__pyx_v_t_s = NULL;
  PyObject *__pyx_v_boundary = NULL;
  float __pyx_v_y;
  float __pyx_v_t_particle;
  float __pyx_v_smooth_u;
  float __pyx_v_deadline_tmp;
  Py_ssize_t __pyx_v_n;
  Py_ssize_t __pyx_v_ix;
  Py_ssize_t __pyx_v_m;
  Py_ssize_t __pyx_v_k;
  __Pyx_memviewslice __pyx_v_gaussian_values = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_boundary_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_boundary_params_tmp = NULL;
  PyObject *__pyx_7genexpr__pyx_v_key = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_a;
  __Pyx_Buffer __pyx_pybuffer_a;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_deadline;
  __Pyx_Buffer __pyx_pybuffer_deadline;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_t;
  __Pyx_Buffer __pyx_pybuffer_t;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_v;
  __Pyx_Buffer __pyx_pybuffer_v;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_z;
  __Pyx_Buffer __pyx_pybuffer_z;
  PyObject *__pyx_r = NULL;
  __pyx_pybuffer_v.pybuffer.buf = NULL;
  __pyx_pybuffer_v.refcount = 0;
  __pyx_pybuffernd_v.data = NULL;
  __pyx_pybuffernd_v.rcbuffer = &amp;__pyx_pybuffer_v;
  __pyx_pybuffer_a.pybuffer.buf = NULL;
  __pyx_pybuffer_a.refcount = 0;
  __pyx_pybuffernd_a.data = NULL;
  __pyx_pybuffernd_a.rcbuffer = &amp;__pyx_pybuffer_a;
  __pyx_pybuffer_z.pybuffer.buf = NULL;
  __pyx_pybuffer_z.refcount = 0;
  __pyx_pybuffernd_z.data = NULL;
  __pyx_pybuffernd_z.rcbuffer = &amp;__pyx_pybuffer_z;
  __pyx_pybuffer_t.pybuffer.buf = NULL;
  __pyx_pybuffer_t.refcount = 0;
  __pyx_pybuffernd_t.data = NULL;
  __pyx_pybuffernd_t.rcbuffer = &amp;__pyx_pybuffer_t;
  __pyx_pybuffer_deadline.pybuffer.buf = NULL;
  __pyx_pybuffer_deadline.refcount = 0;
  __pyx_pybuffernd_deadline.data = NULL;
  __pyx_pybuffernd_deadline.rcbuffer = &amp;__pyx_pybuffer_deadline;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_v, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_v.diminfo[0].strides = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_v.diminfo[0].shape = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_a, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_z, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_z.diminfo[0].strides = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_z.diminfo[0].shape = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_t, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_t.diminfo[0].strides = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_t.diminfo[0].shape = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_deadline, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_deadline.diminfo[0].strides = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_deadline.diminfo[0].shape = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.shape[0];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_2, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_9, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.ddm_flexbound", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_v_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_a_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_z_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_t_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_deadline_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_traj);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_traj_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_choices);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_rts_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_choices_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t_s);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_boundary);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_boundary_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_boundary_params_tmp);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_7genexpr__pyx_v_key);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__31 = <span class='py_c_api'>PyTuple_Pack</span>(45, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_t, __pyx_n_s_deadline, __pyx_n_s_s, __pyx_n_s_max_t, __pyx_n_s_delta_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_boundary_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_random_state, __pyx_n_s_return_option, __pyx_n_s_smooth, __pyx_n_s_kwargs, __pyx_n_s_v_view, __pyx_n_s_a_view, __pyx_n_s_z_view, __pyx_n_s_t_view, __pyx_n_s_deadline_view, __pyx_n_s_traj, __pyx_n_s_traj_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_num_draws, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_y, __pyx_n_s_t_particle, __pyx_n_s_smooth_u, __pyx_n_s_deadline_tmp, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_m, __pyx_n_s_k, __pyx_n_s_gaussian_values, __pyx_n_s_boundary_view, __pyx_n_s_boundary_params_tmp, __pyx_n_s_key);<span class='error_goto'> if (unlikely(!__pyx_tuple__31)) __PYX_ERR(0, 586, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__31);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__31);
/* … */
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_4cssm_9ddm_flexbound, 0, __pyx_n_s_ddm_flexbound, NULL, __pyx_n_s_cssm, __pyx_d, ((PyObject *)__pyx_codeobj__32));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 586, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (!<span class='pyx_c_api'>__Pyx_CyFunction_InitDefaults</span>(__pyx_t_5, sizeof(__pyx_defaults), 1)) <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L1_error)</span>
  __pyx_codeobj__32 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(16, 0, 0, 45, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__31, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_ddm_flexbound, 586, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__32)) __PYX_ERR(0, 586, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0587</span>:                   np.ndarray[float, ndim = 1] a,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0588</span>:                   np.ndarray[float, ndim = 1] z,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0589</span>:                   np.ndarray[float, ndim = 1] t,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0590</span>:                   np.ndarray[float, ndim = 1] deadline,</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0591</span>:                   float s = 1,</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)1.0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 591, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0592</span>:                   float max_t = 20,</pre>
<pre class='cython code score-5 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)20.0));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 592, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0593</span>:                   float delta_t = 0.001,</pre>
<pre class='cython code score-5 '>  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(((double)0.001));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 593, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0594</span>:                   int n_samples = 20000,</pre>
<pre class='cython code score-2 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)0x4E20));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 594, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0595</span>:                   int n_trials = 1,</pre>
<pre class='cython code score-2 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)1));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 595, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0596</span>:                   boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)</pre>
<pre class='cython code score-6 '>    values[10] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[11] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_True)));
    values[12] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(__pyx_dynamic_args-&gt;__pyx_arg_boundary_params);
</pre><pre class="cython line score-0">&#xA0;<span class="">0597</span>:                   boundary_multiplicative = True,</pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0598</span>:                   boundary_params = {},</pre>
<pre class='cython code score-12 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 598, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults, __pyx_t_5)-&gt;__pyx_arg_boundary_params = __pyx_t_4;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_4 = 0;
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsGetter</span>(__pyx_t_5, __pyx_pf_4cssm_46__defaults__);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_ddm_flexbound, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-287" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0599</span>:                   random_state = None,</pre>
<pre class='cython code score-287 '>    values[13] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[14] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_full)));
    values[15] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case 16: values[15] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 15);
        CYTHON_FALLTHROUGH;
        case 15: values[14] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_v)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_a)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound", 0, 5, 16, 1); <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_z)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound", 0, 5, 16, 2); <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_t)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[3]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound", 0, 5, 16, 3); <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_deadline)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[4]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound", 0, 5, 16, 4); <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_s);
          if (value) { values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_max_t);
          if (value) { values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_delta_t);
          if (value) { values[7] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_samples);
          if (value) { values[8] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  9:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_trials);
          if (value) { values[9] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 10:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_fun);
          if (value) { values[10] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 11:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_multiplicative);
          if (value) { values[11] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 12:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_params);
          if (value) { values[12] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 13:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_random_state);
          if (value) { values[13] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 14:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_return_option);
          if (value) { values[14] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 15:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_smooth);
          if (value) { values[15] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values + 0, kwd_pos_args, "ddm_flexbound") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case 16: values[15] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 15);
        CYTHON_FALLTHROUGH;
        case 15: values[14] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_v = ((PyArrayObject *)values[0]);
    __pyx_v_a = ((PyArrayObject *)values[1]);
    __pyx_v_z = ((PyArrayObject *)values[2]);
    __pyx_v_t = ((PyArrayObject *)values[3]);
    __pyx_v_deadline = ((PyArrayObject *)values[4]);
    if (values[5]) {
      __pyx_v_s = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[5]); if (unlikely((__pyx_v_s == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 591, __pyx_L3_error)</span>
    } else {
      __pyx_v_s = ((float)((float)1.0));
    }
    if (values[6]) {
      __pyx_v_max_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[6]); if (unlikely((__pyx_v_max_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 592, __pyx_L3_error)</span>
    } else {
      __pyx_v_max_t = ((float)((float)20.0));
    }
    if (values[7]) {
      __pyx_v_delta_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[7]); if (unlikely((__pyx_v_delta_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 593, __pyx_L3_error)</span>
    } else {
      __pyx_v_delta_t = ((float)((double)0.001));
    }
    if (values[8]) {
      __pyx_v_n_samples = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[8]); if (unlikely((__pyx_v_n_samples == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 594, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_samples = ((int)((int)0x4E20));
    }
    if (values[9]) {
      __pyx_v_n_trials = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[9]); if (unlikely((__pyx_v_n_trials == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 595, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_trials = ((int)((int)1));
    }
    __pyx_v_boundary_fun = values[10];
    __pyx_v_boundary_multiplicative = values[11];
    __pyx_v_boundary_params = values[12];
    __pyx_v_random_state = values[13];
    __pyx_v_return_option = values[14];
    __pyx_v_smooth = values[15];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound", 0, 5, 16, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.ddm_flexbound", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) <span class='error_goto'>__PYX_ERR(0, 586, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) <span class='error_goto'>__PYX_ERR(0, 587, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) <span class='error_goto'>__PYX_ERR(0, 588, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) <span class='error_goto'>__PYX_ERR(0, 589, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_deadline), __pyx_ptype_5numpy_ndarray, 1, "deadline", 0))) <span class='error_goto'>__PYX_ERR(0, 590, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_4cssm_8ddm_flexbound(__pyx_self, __pyx_v_v, __pyx_v_a, __pyx_v_z, __pyx_v_t, __pyx_v_deadline, __pyx_v_s, __pyx_v_max_t, __pyx_v_delta_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state, __pyx_v_return_option, __pyx_v_smooth, __pyx_v_kwargs);
</pre><pre class="cython line score-0">&#xA0;<span class="">0600</span>:                   return_option = 'full',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0601</span>:                   smooth = False,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0602</span>:                   **kwargs,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0603</span>:                   ):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0604</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0605</span>:     set_seed(random_state)</pre>
<pre class='cython code score-1 '>  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 605, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0606</span>:     #cdef int cov_length = np.max([v.size, a.size, w.size, t.size]).astype(int)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0607</span>:     # Param views:</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0608</span>:     cdef float[:] v_view  = v</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_v), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 608, __pyx_L1_error)</span>
  __pyx_v_v_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0609</span>:     cdef float[:] a_view = a</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_a), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 609, __pyx_L1_error)</span>
  __pyx_v_a_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0610</span>:     cdef float[:] z_view = z</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_z), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 610, __pyx_L1_error)</span>
  __pyx_v_z_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0611</span>:     cdef float[:] t_view = t</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_t), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 611, __pyx_L1_error)</span>
  __pyx_v_t_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0612</span>:     cdef float[:] deadline_view = deadline</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_deadline), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 612, __pyx_L1_error)</span>
  __pyx_v_deadline_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0613</span>: </pre>
<pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0614</span>:     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)</pre>
<pre class='cython code score-42 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 614, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 614, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_FromDouble</span>((__pyx_v_max_t / __pyx_v_delta_t));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 614, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_1, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 614, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 614, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 614, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 614, __pyx_L1_error)</span>;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 614, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 614, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 614, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 614, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 614, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 614, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_traj = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0615</span>:     traj[:, :] = -999</pre>
<pre class='cython code score-5 '>  if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_traj, __pyx_tuple__12, __pyx_int_neg_999) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 615, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0616</span>:     cdef float[:,:] traj_view = traj</pre>
<pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(__pyx_v_traj, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 616, __pyx_L1_error)</span>
  __pyx_v_traj_view = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0617</span>: </pre>
<pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0618</span>:     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)</pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 618, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 618, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 618, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 618, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 618, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 618, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 618, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 618, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 618, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 618, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 618, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 618, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 618, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 618, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_rts = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0619</span>:     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)</pre>
<pre class='cython code score-46 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 619, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 619, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 619, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 619, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 619, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 619, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 619, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 619, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 619, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 619, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 619, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 619, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_intc);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 619, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 619, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 619, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_choices = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0620</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0621</span>:     cdef float[:, :, :] rts_view = rts</pre>
<pre class='cython code score-2 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_rts, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 621, __pyx_L1_error)</span>
  __pyx_v_rts_view = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0622</span>:     cdef int[:, :, :] choices_view = choices</pre>
<pre class='cython code score-2 '>  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_int</span>(__pyx_v_choices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 622, __pyx_L1_error)</span>
  __pyx_v_choices_view = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0623</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0624</span>:     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion</pre>
<pre class='cython code score-0 '>  __pyx_v_delta_t_sqrt = sqrt(__pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0625</span>:     cdef float sqrt_st = delta_t_sqrt * s # scalar to ensure the correct variance for the gaussian step</pre>
<pre class='cython code score-0 '>  __pyx_v_sqrt_st = (__pyx_v_delta_t_sqrt * __pyx_v_s);
</pre><pre class="cython line score-0">&#xA0;<span class="">0626</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0627</span>:     # Boundary storage for the upper bound</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0628</span>:     cdef int num_draws = int((max_t / delta_t) + 1)</pre>
<pre class='cython code score-0 '>  __pyx_v_num_draws = ((int)((__pyx_v_max_t / __pyx_v_delta_t) + 1.0));
</pre><pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0629</span>:     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)</pre>
<pre class='cython code score-51 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 629, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 629, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_max_t + __pyx_v_delta_t));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 629, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_t);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 629, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_10 = NULL;
  __pyx_t_11 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_10)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_11 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[4] = {__pyx_t_10, __pyx_int_0, __pyx_t_4, __pyx_t_5};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_11, 3+__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 629, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 629, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 629, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = NULL;
  __pyx_t_11 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_11 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_1};
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_11, 1+__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 629, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_v_t_s = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0630</span>:     boundary = np.zeros(t_s.shape, dtype = DTYPE)</pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 630, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 630, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_t_s, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 630, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 630, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 630, __pyx_L1_error)</span>;
  __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 630, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 630, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 630, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 630, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_v_boundary = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0631</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0632</span>:     cdef float y, t_particle, smooth_u, deadline_tmp</pre>
<pre class="cython line score-0">&#xA0;<span class="">0633</span>:     cdef Py_ssize_t n</pre>
<pre class="cython line score-0">&#xA0;<span class="">0634</span>:     cdef Py_ssize_t ix</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0635</span>:     cdef Py_ssize_t m = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_m = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0636</span>:     cdef Py_ssize_t k</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0637</span>:     cdef float[:] gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 637, __pyx_L1_error)</span>
  __pyx_v_gaussian_values = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0638</span>:     cdef float[:] boundary_view = boundary</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(__pyx_v_boundary, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 638, __pyx_L1_error)</span>
  __pyx_v_boundary_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0639</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0640</span>:     # Loop over samples</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0641</span>:     for k in range(n_trials):</pre>
<pre class='cython code score-0 '>  __pyx_t_11 = __pyx_v_n_trials;
  __pyx_t_12 = __pyx_t_11;
  for (__pyx_t_13 = 0; __pyx_t_13 &lt; __pyx_t_12; __pyx_t_13+=1) {
    __pyx_v_k = __pyx_t_13;
</pre><pre class="cython line score-0">&#xA0;<span class="">0642</span>:         # Precompute boundary evaluations</pre>
<pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0643</span>:         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}</pre>
<pre class='cython code score-27 '>    { /* enter inner scope */
      __pyx_t_5 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 643, __pyx_L7_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_14 = 0;
      if (unlikely(__pyx_v_boundary_params == Py_None)) {
        <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "keys");
        <span class='error_goto'>__PYX_ERR(0, 643, __pyx_L7_error)</span>
      }
      __pyx_t_1 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&amp;__pyx_t_15), (&amp;__pyx_t_16));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 643, __pyx_L7_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
      __pyx_t_7 = __pyx_t_1;
      __pyx_t_1 = 0;
      while (1) {
        __pyx_t_17 = __Pyx_dict_iter_next(__pyx_t_7, __pyx_t_15, &amp;__pyx_t_14, &amp;__pyx_t_1, NULL, NULL, __pyx_t_16);
        if (unlikely(__pyx_t_17 == 0)) break;
        if (unlikely(__pyx_t_17 == -1)) <span class='error_goto'>__PYX_ERR(0, 643, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_7genexpr__pyx_v_key, __pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_boundary_params, __pyx_7genexpr__pyx_v_key);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 643, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 643, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, (PyObject*)__pyx_7genexpr__pyx_v_key, (PyObject*)__pyx_t_3))) <span class='error_goto'>__PYX_ERR(0, 643, __pyx_L7_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_7genexpr__pyx_v_key); __pyx_7genexpr__pyx_v_key = 0;
      goto __pyx_L10_exit_scope;
      __pyx_L7_error:;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_7genexpr__pyx_v_key); __pyx_7genexpr__pyx_v_key = 0;
      goto __pyx_L1_error;
      __pyx_L10_exit_scope:;
    } /* exit inner scope */
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_boundary_params_tmp, ((PyObject*)__pyx_t_5));
    __pyx_t_5 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0644</span>:         if boundary_multiplicative:</pre>
<pre class='cython code score-2 '>    __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_boundary_multiplicative); if (unlikely((__pyx_t_18 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 644, __pyx_L1_error)</span>
    if (__pyx_t_18) {
/* … */
      goto __pyx_L11;
    }
</pre><pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0645</span>:             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)</pre>
<pre class='cython code score-61 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 645, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_multiply);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 645, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_19 * __pyx_v_a_view.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 645, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 645, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_t, __pyx_v_t_s) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 645, __pyx_L1_error)</span>
      __pyx_t_4 = __pyx_t_10;
      __pyx_t_10 = 0;
      if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_4, __pyx_v_boundary_params_tmp) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 645, __pyx_L1_error)</span>
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 645, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_4, __pyx_t_3, __pyx_t_10};
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_16, 2+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 645, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 645, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 645, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_10 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_10)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_10, __pyx_t_7};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_16, 1+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 645, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_boundary, __pyx_t_5, 0, 0, NULL, NULL, &amp;__pyx_slice__5, 0, 0, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 645, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0646</span>:         else:</pre>
<pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0647</span>:             boundary[:] = np.add(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)</pre>
<pre class='cython code score-61 '>    /*else*/ {
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 647, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_add);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 647, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_19 * __pyx_v_a_view.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 647, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 647, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_t, __pyx_v_t_s) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 647, __pyx_L1_error)</span>
      __pyx_t_3 = __pyx_t_4;
      __pyx_t_4 = 0;
      if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_3, __pyx_v_boundary_params_tmp) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 647, __pyx_L1_error)</span>
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 647, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
        __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
        if (likely(__pyx_t_3)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_t_7, __pyx_t_4};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_16, 2+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 647, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      }
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 647, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 647, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_4 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_1};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_16, 1+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 647, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      }
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_boundary, __pyx_t_5, 0, 0, NULL, NULL, &amp;__pyx_slice__5, 0, 0, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 647, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
    __pyx_L11:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0648</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0649</span>:         deadline_tmp = min(max_t, deadline_view[k] - t_view[k])</pre>
<pre class='cython code score-0 '>    __pyx_t_19 = __pyx_v_k;
    __pyx_t_20 = __pyx_v_k;
    __pyx_t_21 = ((*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_19 * __pyx_v_deadline_view.strides[0]) ))) - (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_20 * __pyx_v_t_view.strides[0]) ))));
    __pyx_t_22 = __pyx_v_max_t;
    __pyx_t_18 = (__pyx_t_21 &lt; __pyx_t_22);
    if (__pyx_t_18) {
      __pyx_t_23 = __pyx_t_21;
    } else {
      __pyx_t_23 = __pyx_t_22;
    }
    __pyx_v_deadline_tmp = __pyx_t_23;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0650</span>:         for n in range(n_samples):</pre>
<pre class='cython code score-0 '>    __pyx_t_16 = __pyx_v_n_samples;
    __pyx_t_17 = __pyx_t_16;
    for (__pyx_t_15 = 0; __pyx_t_15 &lt; __pyx_t_17; __pyx_t_15+=1) {
      __pyx_v_n = __pyx_t_15;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0651</span>:             y = (-1) * boundary_view[0] + (z_view[k] * 2 * (boundary_view[0]))  # reset starting position</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = 0;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_24 = 0;
      __pyx_v_y = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_z_view.data + __pyx_t_19 * __pyx_v_z_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_24 * __pyx_v_boundary_view.strides[0]) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0652</span>:             t_particle = 0.0 # reset time</pre>
<pre class='cython code score-0 '>      __pyx_v_t_particle = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0653</span>:             ix = 0 # reset boundary index</pre>
<pre class='cython code score-0 '>      __pyx_v_ix = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0654</span>:             # if deadline &gt;&gt; max_t, then deadline_tmp = max_t, regardless of t-value, otherwise deadline applies</pre>
<pre class="cython line score-0">&#xA0;<span class="">0655</span>:             # Can improve with less checks</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0656</span>:             if n == 0:</pre>
<pre class='cython code score-0 '>      __pyx_t_18 = (__pyx_v_n == 0);
      if (__pyx_t_18) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0657</span>:                 if k == 0:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (__pyx_v_k == 0);
        if (__pyx_t_18) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0658</span>:                     traj_view[0, 0] = y</pre>
<pre class='cython code score-0 '>          __pyx_t_24 = 0;
          __pyx_t_19 = 0;
          *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_24 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_19 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y;
</pre><pre class="cython line score-0">&#xA0;<span class="">0659</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0660</span>:             # Random walker</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0661</span>:             while (y &gt;= (-1) * boundary_view[ix]) and (y &lt;= boundary_view[ix]) and (t_particle &lt;= deadline_tmp):</pre>
<pre class='cython code score-0 '>      while (1) {
        __pyx_t_19 = __pyx_v_ix;
        __pyx_t_25 = (__pyx_v_y &gt;= (-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))));
        if (__pyx_t_25) {
        } else {
          __pyx_t_18 = __pyx_t_25;
          goto __pyx_L18_bool_binop_done;
        }
        __pyx_t_19 = __pyx_v_ix;
        __pyx_t_25 = (__pyx_v_y &lt;= (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) ))));
        if (__pyx_t_25) {
        } else {
          __pyx_t_18 = __pyx_t_25;
          goto __pyx_L18_bool_binop_done;
        }
        __pyx_t_25 = (__pyx_v_t_particle &lt;= __pyx_v_deadline_tmp);
        __pyx_t_18 = __pyx_t_25;
        __pyx_L18_bool_binop_done:;
        if (!__pyx_t_18) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0662</span>:                 y += (v_view[k] * delta_t) + (sqrt_st * gaussian_values[m])</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = __pyx_v_k;
        __pyx_t_24 = __pyx_v_m;
        __pyx_v_y = (__pyx_v_y + (((*((float *) ( /* dim=0 */ (__pyx_v_v_view.data + __pyx_t_19 * __pyx_v_v_view.strides[0]) ))) * __pyx_v_delta_t) + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_24 * __pyx_v_gaussian_values.strides[0]) ))))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0663</span>:                 t_particle += delta_t</pre>
<pre class='cython code score-0 '>        __pyx_v_t_particle = (__pyx_v_t_particle + __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0664</span>:                 ix += 1</pre>
<pre class='cython code score-0 '>        __pyx_v_ix = (__pyx_v_ix + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0665</span>:                 m += 1</pre>
<pre class='cython code score-0 '>        __pyx_v_m = (__pyx_v_m + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">0666</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0667</span>:                 # Can improve with less checks</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0668</span>:                 if n == 0:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (__pyx_v_n == 0);
        if (__pyx_t_18) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0669</span>:                     if k == 0:</pre>
<pre class='cython code score-0 '>          __pyx_t_18 = (__pyx_v_k == 0);
          if (__pyx_t_18) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0670</span>:                         traj_view[ix, 0] = y</pre>
<pre class='cython code score-0 '>            __pyx_t_24 = __pyx_v_ix;
            __pyx_t_19 = 0;
            *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_24 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_19 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y;
</pre><pre class="cython line score-0">&#xA0;<span class="">0671</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0672</span>:                 # Can improve with less checks</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0673</span>:                 if m == num_draws:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (__pyx_v_m == __pyx_v_num_draws);
        if (__pyx_t_18) {
/* … */
        }
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0674</span>:                     gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 674, __pyx_L1_error)</span>
          __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
          __pyx_v_gaussian_values = __pyx_t_2;
          __pyx_t_2.memview = NULL;
          __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0675</span>:                     m = 0</pre>
<pre class='cython code score-0 '>          __pyx_v_m = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0676</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0677</span>:             if smooth:</pre>
<pre class='cython code score-2 '>      __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_smooth); if (unlikely((__pyx_t_18 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 677, __pyx_L1_error)</span>
      if (__pyx_t_18) {
/* … */
        goto __pyx_L24;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0678</span>:                 if t_particle == 0.0:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (__pyx_v_t_particle == 0.0);
        if (__pyx_t_18) {
/* … */
          goto __pyx_L25;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0679</span>:                     smooth_u = random_uniform() * 0.5 * delta_t</pre>
<pre class='cython code score-5 '>          __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 679, __pyx_L1_error)</span>
          __pyx_v_smooth_u = ((__pyx_t_23 * 0.5) * __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0680</span>:                 elif t_particle &lt; deadline_tmp:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (__pyx_v_t_particle &lt; __pyx_v_deadline_tmp);
        if (__pyx_t_18) {
/* … */
          goto __pyx_L25;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0681</span>:                     smooth_u = (0.5 - random_uniform()) * delta_t</pre>
<pre class='cython code score-5 '>          __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 681, __pyx_L1_error)</span>
          __pyx_v_smooth_u = ((0.5 - __pyx_t_23) * __pyx_v_delta_t);
</pre><pre class="cython line score-0">&#xA0;<span class="">0682</span>:                 else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0683</span>:                     smooth_u = 0.0</pre>
<pre class='cython code score-0 '>        /*else*/ {
          __pyx_v_smooth_u = 0.0;
        }
        __pyx_L25:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0684</span>:             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0685</span>:                 smooth_u = 0.0</pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_v_smooth_u = 0.0;
      }
      __pyx_L24:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0686</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0687</span>:             rts_view[n, k, 0] = t_particle + t_view[k] + smooth_u # Store rt</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = __pyx_v_k;
      __pyx_t_24 = __pyx_v_n;
      __pyx_t_20 = __pyx_v_k;
      __pyx_t_26 = 0;
      *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_24 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_20 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_26 * __pyx_v_rts_view.strides[2]) )) = ((__pyx_v_t_particle + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_19 * __pyx_v_t_view.strides[0]) )))) + __pyx_v_smooth_u);
</pre><pre class="cython line score-0">&#xA0;<span class="">0688</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0689</span>:             #rts_view[n, k, 0] = t_particle + t_view[k] # Store rt</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0690</span>:             choices_view[n, k, 0] = sign(y) # Store choice</pre>
<pre class='cython code score-5 '>      __pyx_t_27 = __pyx_f_4cssm_sign(__pyx_v_y); if (unlikely(__pyx_t_27 == ((int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 690, __pyx_L1_error)</span>
      __pyx_t_19 = __pyx_v_n;
      __pyx_t_26 = __pyx_v_k;
      __pyx_t_20 = 0;
      *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_19 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_26 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[2]) )) = __pyx_t_27;
</pre><pre class="cython line score-0">&#xA0;<span class="">0691</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0692</span>:             if (rts_view[n, k, 0] &gt;= deadline_view[k]) | (deadline_view[k] &lt;= 0):</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = __pyx_v_n;
      __pyx_t_26 = __pyx_v_k;
      __pyx_t_19 = 0;
      __pyx_t_24 = __pyx_v_k;
      __pyx_t_28 = __pyx_v_k;
      __pyx_t_18 = (((*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_20 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_26 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_19 * __pyx_v_rts_view.strides[2]) ))) &gt;= (*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_24 * __pyx_v_deadline_view.strides[0]) )))) | ((*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_28 * __pyx_v_deadline_view.strides[0]) ))) &lt;= 0.0));
      if (__pyx_t_18) {
/* … */
      }
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0693</span>:                 rts_view[n, k, 0] = -999</pre>
<pre class='cython code score-0 '>        __pyx_t_28 = __pyx_v_n;
        __pyx_t_24 = __pyx_v_k;
        __pyx_t_19 = 0;
        *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_28 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_24 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_19 * __pyx_v_rts_view.strides[2]) )) = -999.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0694</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0695</span>:     if return_option == 'full':</pre>
<pre class='cython code score-2 '>  __pyx_t_18 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_return_option, __pyx_n_u_full, Py_EQ)); if (unlikely((__pyx_t_18 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 695, __pyx_L1_error)</span>
  if (__pyx_t_18) {
/* … */
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0696</span>:         return {'rts': rts, 'choices': choices,  'metadata': {'v': v,</pre>
<pre class='cython code score-20 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 696, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 696, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 696, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 696, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_v, ((PyObject *)__pyx_v_v)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 696, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0697</span>:                                                               'a': a,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 696, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0698</span>:                                                               'z': z,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_z, ((PyObject *)__pyx_v_z)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 696, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0699</span>:                                                               't': t,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 696, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0700</span>:                                                               's': s,</pre>
<pre class='cython code score-11 '>    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_s);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 700, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_s, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 696, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0701</span>:                                                               'deadline': deadline,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_deadline, ((PyObject *)__pyx_v_deadline)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 696, __pyx_L1_error)</span>
    __pyx_t_10 = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0702</span>:                                                               **boundary_params,</pre>
<pre class='cython code score-17 '>    if (unlikely(__pyx_v_boundary_params == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
      <span class='error_goto'>__PYX_ERR(0, 702, __pyx_L1_error)</span>
    }
    if (unlikely(<span class='py_c_api'>PyDict_Update</span>(__pyx_t_10, __pyx_v_boundary_params) &lt; 0)) {
      if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseMappingExpectedError</span>(__pyx_v_boundary_params);
      <span class='error_goto'>__PYX_ERR(0, 702, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0703</span>:                                                               'delta_t': delta_t,</pre>
<pre class='cython code score-11 '>    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_t);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 703, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_delta_t, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 703, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0704</span>:                                                               'max_t': max_t,</pre>
<pre class='cython code score-11 '>    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_max_t);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 704, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_max_t, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 704, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0705</span>:                                                               'n_samples': n_samples,</pre>
<pre class='cython code score-8 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 705, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_n_samples, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 705, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0706</span>:                                                               'n_trials': n_trials,</pre>
<pre class='cython code score-13 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 706, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_n_trials, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 706, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_simulator, __pyx_n_u_ddm_flexbound) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 707, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0707</span>:                                                               'simulator': 'ddm_flexbound',</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0708</span>:                                                               'boundary_fun_type': boundary_fun.__name__,</pre>
<pre class='cython code score-8 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_boundary_fun, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 708, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_boundary_fun_type, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 708, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0709</span>:                                                               'possible_choices': [-1, 1],</pre>
<pre class='cython code score-17 '>    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 709, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_int_neg_1)) <span class='error_goto'>__PYX_ERR(0, 709, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 709, __pyx_L1_error)</span>;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_possible_choices, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 709, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0710</span>:                                                               'trajectory': traj,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_trajectory, __pyx_v_traj) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 710, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0711</span>:                                                               'boundary': boundary,</pre>
<pre class='cython code score-11 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_boundary, __pyx_v_boundary) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 711, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_metadata, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 696, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_r = __pyx_t_5;
    __pyx_t_5 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0712</span>:                                                              }}</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0713</span>:     elif return_option == 'minimal':</pre>
<pre class='cython code score-2 '>  __pyx_t_18 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_return_option, __pyx_n_u_minimal, Py_EQ)); if (unlikely((__pyx_t_18 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 713, __pyx_L1_error)</span>
  if (likely(__pyx_t_18)) {
/* … */
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0714</span>:         return {'rts': rts, 'choices': choices,  'metadata': {'simulator': 'ddm_flexbound',</pre>
<pre class='cython code score-20 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 714, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 714, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 714, __pyx_L1_error)</span>
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 714, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_simulator, __pyx_n_u_ddm_flexbound) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 714, __pyx_L1_error)</span>
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0715</span>:                                                              'possible_choices': [-1, 1],</pre>
<pre class='cython code score-17 '>    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 715, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_int_neg_1)) <span class='error_goto'>__PYX_ERR(0, 715, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 715, __pyx_L1_error)</span>;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_possible_choices, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 714, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0716</span>:                                                              'boundary_fun_type': boundary_fun.__name__,</pre>
<pre class='cython code score-8 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_boundary_fun, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 716, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_boundary_fun_type, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 714, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0717</span>:                                                              'n_samples': n_samples,</pre>
<pre class='cython code score-8 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 717, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_n_samples, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 714, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0718</span>:                                                              'n_trials': n_trials,</pre>
<pre class='cython code score-14 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 718, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_n_trials, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 714, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_metadata, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 714, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_r = __pyx_t_5;
    __pyx_t_5 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0719</span>:                                                              }}</pre>
<pre class="cython line score-0">&#xA0;<span class="">0720</span>:     else:</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0721</span>:         raise ValueError('return_option must be either "full" or "minimal"')</pre>
<pre class='cython code score-5 '>  /*else*/ {
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 721, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_5, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='error_goto'>__PYX_ERR(0, 721, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0722</span>: ## ----------------------------------------------------------------------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0723</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0724</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0725</span>: # Simulate (rt, choice) tuples from: DDM WITH FLEXIBLE BOUNDARIES AND FLEXIBLE SLOPE -----------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0726</span>: # @cythonboundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0727</span>: # @cythonwraparound(False)</pre>
<pre class="cython line score-151" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0728</span>: def ddm_flex(np.ndarray[float, ndim = 1] v,</pre>
<pre class='cython code score-151 '>static PyObject *__pyx_pf_4cssm_48__defaults__(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_r = NULL;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
/* … */
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(13);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 728, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 2, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 3, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 4, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 5, Py_None)) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 6, Py_None)) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_True));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_True));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 7, ((PyObject *)Py_True))) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults1, __pyx_self)-&gt;__pyx_arg_boundary_params);
  <span class='refnanny'>__Pyx_GIVEREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults1, __pyx_self)-&gt;__pyx_arg_boundary_params);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 8, <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults1, __pyx_self)-&gt;__pyx_arg_boundary_params)) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults1, __pyx_self)-&gt;__pyx_arg_drift_params);
  <span class='refnanny'>__Pyx_GIVEREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults1, __pyx_self)-&gt;__pyx_arg_drift_params);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 9, <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults1, __pyx_self)-&gt;__pyx_arg_drift_params)) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 10, Py_None)) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject*)__pyx_n_u_full));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject*)__pyx_n_u_full));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 11, ((PyObject*)__pyx_n_u_full))) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_False));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_False));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 12, ((PyObject *)Py_False))) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 728, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 1, Py_None)) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L1_error)</span>;
  __pyx_t_6 = 0;
  __pyx_r = __pyx_t_5;
  __pyx_t_5 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.__defaults__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_4cssm_11ddm_flex(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_4cssm_11ddm_flex = {"ddm_flex", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_4cssm_11ddm_flex, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_4cssm_11ddm_flex(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyArrayObject *__pyx_v_v = 0;
  PyArrayObject *__pyx_v_a = 0;
  PyArrayObject *__pyx_v_z = 0;
  PyArrayObject *__pyx_v_t = 0;
  PyArrayObject *__pyx_v_deadline = 0;
  float __pyx_v_s;
  float __pyx_v_delta_t;
  float __pyx_v_max_t;
  int __pyx_v_n_samples;
  int __pyx_v_n_trials;
  PyObject *__pyx_v_boundary_fun = 0;
  PyObject *__pyx_v_drift_fun = 0;
  PyObject *__pyx_v_boundary_multiplicative = 0;
  PyObject *__pyx_v_boundary_params = 0;
  PyObject *__pyx_v_drift_params = 0;
  PyObject *__pyx_v_random_state = 0;
  PyObject *__pyx_v_return_option = 0;
  PyObject *__pyx_v_smooth = 0;
  CYTHON_UNUSED PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("ddm_flex (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_v,&amp;__pyx_n_s_a,&amp;__pyx_n_s_z,&amp;__pyx_n_s_t,&amp;__pyx_n_s_deadline,&amp;__pyx_n_s_s,&amp;__pyx_n_s_delta_t,&amp;__pyx_n_s_max_t,&amp;__pyx_n_s_n_samples,&amp;__pyx_n_s_n_trials,&amp;__pyx_n_s_boundary_fun,&amp;__pyx_n_s_drift_fun,&amp;__pyx_n_s_boundary_multiplicative,&amp;__pyx_n_s_boundary_params,&amp;__pyx_n_s_drift_params,&amp;__pyx_n_s_random_state,&amp;__pyx_n_s_return_option,&amp;__pyx_n_s_smooth,0};
  PyObject* values[18] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    __pyx_defaults1 *__pyx_dynamic_args = <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults1, __pyx_self);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs);
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4cssm_10ddm_flex(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_t, PyArrayObject *__pyx_v_deadline, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_drift_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_drift_params, PyObject *__pyx_v_random_state, PyObject *__pyx_v_return_option, PyObject *__pyx_v_smooth, CYTHON_UNUSED PyObject *__pyx_v_kwargs) {
  __Pyx_memviewslice __pyx_v_v_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_a_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_z_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_t_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_deadline_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_traj = NULL;
  __Pyx_memviewslice __pyx_v_traj_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_rts = NULL;
  PyObject *__pyx_v_choices = NULL;
  __Pyx_memviewslice __pyx_v_rts_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_choices_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  float __pyx_v_delta_t_sqrt;
  float __pyx_v_sqrt_st;
  int __pyx_v_num_draws;
  PyObject *__pyx_v_t_s = NULL;
  PyObject *__pyx_v_boundary = NULL;
  PyObject *__pyx_v_drift = NULL;
  float __pyx_v_y;
  float __pyx_v_t_particle;
  float __pyx_v_smooth_u;
  float __pyx_v_deadline_tmp;
  Py_ssize_t __pyx_v_n;
  Py_ssize_t __pyx_v_ix;
  Py_ssize_t __pyx_v_m;
  Py_ssize_t __pyx_v_k;
  __Pyx_memviewslice __pyx_v_gaussian_values = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_boundary_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_drift_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_drift_params_tmp = NULL;
  PyObject *__pyx_v_boundary_params_tmp = NULL;
  PyObject *__pyx_8genexpr1__pyx_v_key = NULL;
  PyObject *__pyx_8genexpr2__pyx_v_key = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_a;
  __Pyx_Buffer __pyx_pybuffer_a;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_deadline;
  __Pyx_Buffer __pyx_pybuffer_deadline;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_t;
  __Pyx_Buffer __pyx_pybuffer_t;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_v;
  __Pyx_Buffer __pyx_pybuffer_v;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_z;
  __Pyx_Buffer __pyx_pybuffer_z;
  PyObject *__pyx_r = NULL;
  __pyx_pybuffer_v.pybuffer.buf = NULL;
  __pyx_pybuffer_v.refcount = 0;
  __pyx_pybuffernd_v.data = NULL;
  __pyx_pybuffernd_v.rcbuffer = &amp;__pyx_pybuffer_v;
  __pyx_pybuffer_a.pybuffer.buf = NULL;
  __pyx_pybuffer_a.refcount = 0;
  __pyx_pybuffernd_a.data = NULL;
  __pyx_pybuffernd_a.rcbuffer = &amp;__pyx_pybuffer_a;
  __pyx_pybuffer_z.pybuffer.buf = NULL;
  __pyx_pybuffer_z.refcount = 0;
  __pyx_pybuffernd_z.data = NULL;
  __pyx_pybuffernd_z.rcbuffer = &amp;__pyx_pybuffer_z;
  __pyx_pybuffer_t.pybuffer.buf = NULL;
  __pyx_pybuffer_t.refcount = 0;
  __pyx_pybuffernd_t.data = NULL;
  __pyx_pybuffernd_t.rcbuffer = &amp;__pyx_pybuffer_t;
  __pyx_pybuffer_deadline.pybuffer.buf = NULL;
  __pyx_pybuffer_deadline.refcount = 0;
  __pyx_pybuffernd_deadline.data = NULL;
  __pyx_pybuffernd_deadline.rcbuffer = &amp;__pyx_pybuffer_deadline;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_v, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_v.diminfo[0].strides = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_v.diminfo[0].shape = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_a, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_z, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_z.diminfo[0].strides = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_z.diminfo[0].shape = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_t, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_t.diminfo[0].strides = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_t.diminfo[0].shape = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_deadline, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_deadline.diminfo[0].strides = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_deadline.diminfo[0].shape = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.shape[0];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_2, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_9, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.ddm_flex", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_v_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_a_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_z_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_t_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_deadline_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_traj);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_traj_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_choices);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_rts_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_choices_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t_s);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_boundary);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_drift);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_boundary_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_drift_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_drift_params_tmp);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_boundary_params_tmp);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr1__pyx_v_key);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr2__pyx_v_key);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__33 = <span class='py_c_api'>PyTuple_Pack</span>(51, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_t, __pyx_n_s_deadline, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_boundary_fun, __pyx_n_s_drift_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_drift_params, __pyx_n_s_random_state, __pyx_n_s_return_option, __pyx_n_s_smooth, __pyx_n_s_kwargs, __pyx_n_s_v_view, __pyx_n_s_a_view, __pyx_n_s_z_view, __pyx_n_s_t_view, __pyx_n_s_deadline_view, __pyx_n_s_traj, __pyx_n_s_traj_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_num_draws, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_drift, __pyx_n_s_y, __pyx_n_s_t_particle, __pyx_n_s_smooth_u, __pyx_n_s_deadline_tmp, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_m, __pyx_n_s_k, __pyx_n_s_gaussian_values, __pyx_n_s_boundary_view, __pyx_n_s_drift_view, __pyx_n_s_drift_params_tmp, __pyx_n_s_boundary_params_tmp, __pyx_n_s_key, __pyx_n_s_key);<span class='error_goto'> if (unlikely(!__pyx_tuple__33)) __PYX_ERR(0, 728, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__33);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__33);
/* … */
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_4cssm_11ddm_flex, 0, __pyx_n_s_ddm_flex, NULL, __pyx_n_s_cssm, __pyx_d, ((PyObject *)__pyx_codeobj__34));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 728, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (!<span class='pyx_c_api'>__Pyx_CyFunction_InitDefaults</span>(__pyx_t_5, sizeof(__pyx_defaults1), 2)) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L1_error)</span>
  __pyx_codeobj__34 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(18, 0, 0, 51, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__33, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_ddm_flex, 728, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__34)) __PYX_ERR(0, 728, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0729</span>:              np.ndarray[float, ndim = 1] a,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0730</span>:              np.ndarray[float, ndim = 1] z,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0731</span>:              np.ndarray[float, ndim = 1] t,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0732</span>:              np.ndarray[float, ndim = 1] deadline,</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0733</span>:              float s = 1,</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)1.0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 733, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0734</span>:              float delta_t = 0.001,</pre>
<pre class='cython code score-5 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(((double)0.001));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 734, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0735</span>:              float max_t = 20,</pre>
<pre class='cython code score-5 '>  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)20.0));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 735, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0736</span>:              int n_samples = 20000,</pre>
<pre class='cython code score-2 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)0x4E20));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 736, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0737</span>:              int n_trials = 1,</pre>
<pre class='cython code score-2 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)1));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 737, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0738</span>:              boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)</pre>
<pre class='cython code score-2 '>    values[10] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0739</span>:              drift_fun = None,</pre>
<pre class='cython code score-8 '>    values[11] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[12] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_True)));
    values[13] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(__pyx_dynamic_args-&gt;__pyx_arg_boundary_params);
    values[14] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(__pyx_dynamic_args-&gt;__pyx_arg_drift_params);
</pre><pre class="cython line score-0">&#xA0;<span class="">0740</span>:              boundary_multiplicative = True,</pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0741</span>:              boundary_params = {},</pre>
<pre class='cython code score-4 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 741, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults1, __pyx_t_5)-&gt;__pyx_arg_boundary_params = __pyx_t_4;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0742</span>:              drift_params = {},</pre>
<pre class='cython code score-12 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 742, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults1, __pyx_t_5)-&gt;__pyx_arg_drift_params = __pyx_t_4;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_4 = 0;
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsGetter</span>(__pyx_t_5, __pyx_pf_4cssm_48__defaults__);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_ddm_flex, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-313" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0743</span>:              random_state = None,</pre>
<pre class='cython code score-313 '>    values[15] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[16] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_full)));
    values[17] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case 18: values[17] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 17);
        CYTHON_FALLTHROUGH;
        case 17: values[16] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 16);
        CYTHON_FALLTHROUGH;
        case 16: values[15] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 15);
        CYTHON_FALLTHROUGH;
        case 15: values[14] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_v)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_a)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flex", 0, 5, 18, 1); <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_z)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flex", 0, 5, 18, 2); <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_t)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[3]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flex", 0, 5, 18, 3); <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_deadline)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[4]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flex", 0, 5, 18, 4); <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_s);
          if (value) { values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_delta_t);
          if (value) { values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_max_t);
          if (value) { values[7] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_samples);
          if (value) { values[8] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  9:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_trials);
          if (value) { values[9] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 10:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_fun);
          if (value) { values[10] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 11:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_drift_fun);
          if (value) { values[11] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 12:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_multiplicative);
          if (value) { values[12] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 13:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_params);
          if (value) { values[13] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 14:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_drift_params);
          if (value) { values[14] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 15:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_random_state);
          if (value) { values[15] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 16:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_return_option);
          if (value) { values[16] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 17:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_smooth);
          if (value) { values[17] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values + 0, kwd_pos_args, "ddm_flex") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case 18: values[17] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 17);
        CYTHON_FALLTHROUGH;
        case 17: values[16] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 16);
        CYTHON_FALLTHROUGH;
        case 16: values[15] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 15);
        CYTHON_FALLTHROUGH;
        case 15: values[14] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_v = ((PyArrayObject *)values[0]);
    __pyx_v_a = ((PyArrayObject *)values[1]);
    __pyx_v_z = ((PyArrayObject *)values[2]);
    __pyx_v_t = ((PyArrayObject *)values[3]);
    __pyx_v_deadline = ((PyArrayObject *)values[4]);
    if (values[5]) {
      __pyx_v_s = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[5]); if (unlikely((__pyx_v_s == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 733, __pyx_L3_error)</span>
    } else {
      __pyx_v_s = ((float)((float)1.0));
    }
    if (values[6]) {
      __pyx_v_delta_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[6]); if (unlikely((__pyx_v_delta_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 734, __pyx_L3_error)</span>
    } else {
      __pyx_v_delta_t = ((float)((double)0.001));
    }
    if (values[7]) {
      __pyx_v_max_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[7]); if (unlikely((__pyx_v_max_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 735, __pyx_L3_error)</span>
    } else {
      __pyx_v_max_t = ((float)((float)20.0));
    }
    if (values[8]) {
      __pyx_v_n_samples = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[8]); if (unlikely((__pyx_v_n_samples == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 736, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_samples = ((int)((int)0x4E20));
    }
    if (values[9]) {
      __pyx_v_n_trials = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[9]); if (unlikely((__pyx_v_n_trials == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 737, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_trials = ((int)((int)1));
    }
    __pyx_v_boundary_fun = values[10];
    __pyx_v_drift_fun = values[11];
    __pyx_v_boundary_multiplicative = values[12];
    __pyx_v_boundary_params = values[13];
    __pyx_v_drift_params = values[14];
    __pyx_v_random_state = values[15];
    __pyx_v_return_option = values[16];
    __pyx_v_smooth = values[17];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flex", 0, 5, 18, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.ddm_flex", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) <span class='error_goto'>__PYX_ERR(0, 728, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) <span class='error_goto'>__PYX_ERR(0, 729, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) <span class='error_goto'>__PYX_ERR(0, 730, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) <span class='error_goto'>__PYX_ERR(0, 731, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_deadline), __pyx_ptype_5numpy_ndarray, 1, "deadline", 0))) <span class='error_goto'>__PYX_ERR(0, 732, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_4cssm_10ddm_flex(__pyx_self, __pyx_v_v, __pyx_v_a, __pyx_v_z, __pyx_v_t, __pyx_v_deadline, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_boundary_fun, __pyx_v_drift_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_drift_params, __pyx_v_random_state, __pyx_v_return_option, __pyx_v_smooth, __pyx_v_kwargs);
</pre><pre class="cython line score-0">&#xA0;<span class="">0744</span>:              return_option = 'full',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0745</span>:              smooth = False,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0746</span>:              **kwargs):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0747</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0748</span>:     set_seed(random_state)</pre>
<pre class='cython code score-1 '>  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 748, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0749</span>:     # Param views:</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0750</span>:     cdef float[:] v_view  = v</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_v), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 750, __pyx_L1_error)</span>
  __pyx_v_v_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0751</span>:     cdef float[:] a_view = a</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_a), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 751, __pyx_L1_error)</span>
  __pyx_v_a_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0752</span>:     cdef float[:] z_view = z</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_z), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 752, __pyx_L1_error)</span>
  __pyx_v_z_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0753</span>:     cdef float[:] t_view = t</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_t), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 753, __pyx_L1_error)</span>
  __pyx_v_t_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0754</span>:     cdef float[:] deadline_view = deadline</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_deadline), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 754, __pyx_L1_error)</span>
  __pyx_v_deadline_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0755</span>: </pre>
<pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0756</span>:     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)</pre>
<pre class='cython code score-42 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 756, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 756, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_FromDouble</span>((__pyx_v_max_t / __pyx_v_delta_t));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 756, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_1, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 756, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 756, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 756, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 756, __pyx_L1_error)</span>;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 756, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 756, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 756, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 756, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 756, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 756, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_traj = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0757</span>:     traj[:, :] = -999</pre>
<pre class='cython code score-5 '>  if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_traj, __pyx_tuple__12, __pyx_int_neg_999) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 757, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0758</span>:     cdef float[:,:] traj_view = traj</pre>
<pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(__pyx_v_traj, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 758, __pyx_L1_error)</span>
  __pyx_v_traj_view = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0759</span>: </pre>
<pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0760</span>:     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)</pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 760, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 760, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 760, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 760, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 760, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 760, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 760, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 760, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 760, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 760, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 760, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 760, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 760, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 760, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_rts = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0761</span>:     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)</pre>
<pre class='cython code score-46 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 761, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 761, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 761, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 761, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 761, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 761, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 761, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 761, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 761, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 761, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 761, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 761, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_intc);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 761, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 761, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 761, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_choices = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0762</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0763</span>:     cdef float[:, :, :] rts_view = rts</pre>
<pre class='cython code score-2 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_rts, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 763, __pyx_L1_error)</span>
  __pyx_v_rts_view = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0764</span>:     cdef int[:, :, :] choices_view = choices</pre>
<pre class='cython code score-2 '>  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_int</span>(__pyx_v_choices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 764, __pyx_L1_error)</span>
  __pyx_v_choices_view = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0765</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0766</span>:     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion</pre>
<pre class='cython code score-0 '>  __pyx_v_delta_t_sqrt = sqrt(__pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0767</span>:     cdef float sqrt_st = delta_t_sqrt * s # scalar to ensure the correct variance for the gaussian step</pre>
<pre class='cython code score-0 '>  __pyx_v_sqrt_st = (__pyx_v_delta_t_sqrt * __pyx_v_s);
</pre><pre class="cython line score-0">&#xA0;<span class="">0768</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0769</span>:     # Boundary storage for the upper bound</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0770</span>:     cdef int num_draws = int((max_t / delta_t) + 1)</pre>
<pre class='cython code score-0 '>  __pyx_v_num_draws = ((int)((__pyx_v_max_t / __pyx_v_delta_t) + 1.0));
</pre><pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0771</span>:     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)</pre>
<pre class='cython code score-51 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 771, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 771, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_max_t + __pyx_v_delta_t));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 771, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_t);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 771, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_10 = NULL;
  __pyx_t_11 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_10)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_11 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[4] = {__pyx_t_10, __pyx_int_0, __pyx_t_4, __pyx_t_5};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_11, 3+__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 771, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 771, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 771, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = NULL;
  __pyx_t_11 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_11 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_1};
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_11, 1+__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 771, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_v_t_s = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0772</span>:     boundary = np.zeros(t_s.shape, dtype = DTYPE)</pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 772, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 772, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_t_s, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 772, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 772, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 772, __pyx_L1_error)</span>;
  __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 772, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 772, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 772, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 772, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_v_boundary = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0773</span>:     drift = np.zeros(t_s.shape, dtype = DTYPE)</pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 773, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 773, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_t_s, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 773, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 773, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 773, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 773, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 773, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 773, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_1, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 773, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_drift = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0774</span>:     cdef float y, t_particle, smooth_u, deadline_tmp</pre>
<pre class="cython line score-0">&#xA0;<span class="">0775</span>:     cdef Py_ssize_t n</pre>
<pre class="cython line score-0">&#xA0;<span class="">0776</span>:     cdef Py_ssize_t ix</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0777</span>:     cdef Py_ssize_t m = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_m = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0778</span>:     cdef Py_ssize_t k</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0779</span>:     cdef float[:] gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 779, __pyx_L1_error)</span>
  __pyx_v_gaussian_values = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0780</span>:     cdef float[:] boundary_view = boundary</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(__pyx_v_boundary, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 780, __pyx_L1_error)</span>
  __pyx_v_boundary_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0781</span>:     cdef float[:] drift_view = drift</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(__pyx_v_drift, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 781, __pyx_L1_error)</span>
  __pyx_v_drift_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0782</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0783</span>:     # Loop over samples</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0784</span>:     for k in range(n_trials):</pre>
<pre class='cython code score-0 '>  __pyx_t_11 = __pyx_v_n_trials;
  __pyx_t_12 = __pyx_t_11;
  for (__pyx_t_13 = 0; __pyx_t_13 &lt; __pyx_t_12; __pyx_t_13+=1) {
    __pyx_v_k = __pyx_t_13;
</pre><pre class="cython line score-0">&#xA0;<span class="">0785</span>:         # Precompute boundary evaluations and drift evaluations</pre>
<pre class="cython line score-0">&#xA0;<span class="">0786</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0787</span>:         # Drift</pre>
<pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0788</span>:         drift_params_tmp = {key: drift_params[key][k] for key in drift_params.keys()}</pre>
<pre class='cython code score-27 '>    { /* enter inner scope */
      __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 788, __pyx_L7_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_14 = 0;
      if (unlikely(__pyx_v_drift_params == Py_None)) {
        <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "keys");
        <span class='error_goto'>__PYX_ERR(0, 788, __pyx_L7_error)</span>
      }
      __pyx_t_1 = __Pyx_dict_iterator(__pyx_v_drift_params, 0, __pyx_n_s_keys, (&amp;__pyx_t_15), (&amp;__pyx_t_16));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 788, __pyx_L7_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
      __pyx_t_5 = __pyx_t_1;
      __pyx_t_1 = 0;
      while (1) {
        __pyx_t_17 = __Pyx_dict_iter_next(__pyx_t_5, __pyx_t_15, &amp;__pyx_t_14, &amp;__pyx_t_1, NULL, NULL, __pyx_t_16);
        if (unlikely(__pyx_t_17 == 0)) break;
        if (unlikely(__pyx_t_17 == -1)) <span class='error_goto'>__PYX_ERR(0, 788, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_8genexpr1__pyx_v_key, __pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_drift_params, __pyx_8genexpr1__pyx_v_key);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 788, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 788, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, (PyObject*)__pyx_8genexpr1__pyx_v_key, (PyObject*)__pyx_t_7))) <span class='error_goto'>__PYX_ERR(0, 788, __pyx_L7_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr1__pyx_v_key); __pyx_8genexpr1__pyx_v_key = 0;
      goto __pyx_L10_exit_scope;
      __pyx_L7_error:;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr1__pyx_v_key); __pyx_8genexpr1__pyx_v_key = 0;
      goto __pyx_L1_error;
      __pyx_L10_exit_scope:;
    } /* exit inner scope */
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_drift_params_tmp, ((PyObject*)__pyx_t_3));
    __pyx_t_3 = 0;
</pre><pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0789</span>:         drift[:] = np.add(v_view[k], drift_fun(t = t_s, **drift_params_tmp)).astype(DTYPE)</pre>
<pre class='cython code score-61 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 789, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_add);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 789, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_18 = __pyx_v_k;
    __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=0 */ (__pyx_v_v_view.data + __pyx_t_18 * __pyx_v_v_view.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 789, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 789, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_t, __pyx_v_t_s) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 789, __pyx_L1_error)</span>
    __pyx_t_4 = __pyx_t_10;
    __pyx_t_10 = 0;
    if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_4, __pyx_v_drift_params_tmp) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 789, __pyx_L1_error)</span>
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_drift_fun, __pyx_empty_tuple, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 789, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = NULL;
    __pyx_t_16 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_16 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[3] = {__pyx_t_4, __pyx_t_7, __pyx_t_10};
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_16, 2+__pyx_t_16);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 789, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 789, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 789, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_10 = NULL;
    __pyx_t_16 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_10)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_16 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_10, __pyx_t_5};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_16, 1+__pyx_t_16);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 789, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_drift, __pyx_t_3, 0, 0, NULL, NULL, &amp;__pyx_slice__5, 0, 0, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 789, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0790</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0791</span>:         # Boundary</pre>
<pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0792</span>:         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}</pre>
<pre class='cython code score-27 '>    { /* enter inner scope */
      __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 792, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_15 = 0;
      if (unlikely(__pyx_v_boundary_params == Py_None)) {
        <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "keys");
        <span class='error_goto'>__PYX_ERR(0, 792, __pyx_L13_error)</span>
      }
      __pyx_t_5 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&amp;__pyx_t_14), (&amp;__pyx_t_16));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 792, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
      __pyx_t_1 = __pyx_t_5;
      __pyx_t_5 = 0;
      while (1) {
        __pyx_t_17 = __Pyx_dict_iter_next(__pyx_t_1, __pyx_t_14, &amp;__pyx_t_15, &amp;__pyx_t_5, NULL, NULL, __pyx_t_16);
        if (unlikely(__pyx_t_17 == 0)) break;
        if (unlikely(__pyx_t_17 == -1)) <span class='error_goto'>__PYX_ERR(0, 792, __pyx_L13_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_8genexpr2__pyx_v_key, __pyx_t_5);
        __pyx_t_5 = 0;
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_boundary_params, __pyx_8genexpr2__pyx_v_key);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 792, __pyx_L13_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_5, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 792, __pyx_L13_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, (PyObject*)__pyx_8genexpr2__pyx_v_key, (PyObject*)__pyx_t_10))) <span class='error_goto'>__PYX_ERR(0, 792, __pyx_L13_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr2__pyx_v_key); __pyx_8genexpr2__pyx_v_key = 0;
      goto __pyx_L16_exit_scope;
      __pyx_L13_error:;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr2__pyx_v_key); __pyx_8genexpr2__pyx_v_key = 0;
      goto __pyx_L1_error;
      __pyx_L16_exit_scope:;
    } /* exit inner scope */
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_boundary_params_tmp, ((PyObject*)__pyx_t_3));
    __pyx_t_3 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0793</span>:         if boundary_multiplicative:</pre>
<pre class='cython code score-2 '>    __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_boundary_multiplicative); if (unlikely((__pyx_t_19 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 793, __pyx_L1_error)</span>
    if (__pyx_t_19) {
/* … */
      goto __pyx_L17;
    }
</pre><pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0794</span>:             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)</pre>
<pre class='cython code score-61 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_10, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 794, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_multiply);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 794, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_18 = __pyx_v_k;
      __pyx_t_10 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_18 * __pyx_v_a_view.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 794, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 794, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_t, __pyx_v_t_s) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 794, __pyx_L1_error)</span>
      __pyx_t_7 = __pyx_t_4;
      __pyx_t_4 = 0;
      if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_7, __pyx_v_boundary_params_tmp) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 794, __pyx_L1_error)</span>
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 794, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
        __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
        if (likely(__pyx_t_7)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_7, __pyx_t_10, __pyx_t_4};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_16, 2+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 794, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      }
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 794, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 794, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_4 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_1};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_16, 1+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 794, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      }
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_boundary, __pyx_t_3, 0, 0, NULL, NULL, &amp;__pyx_slice__5, 0, 0, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 794, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0795</span>:         else:</pre>
<pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0796</span>:             boundary[:] = np.add(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)</pre>
<pre class='cython code score-61 '>    /*else*/ {
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 796, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_add);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 796, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_18 = __pyx_v_k;
      __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_18 * __pyx_v_a_view.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 796, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 796, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_t, __pyx_v_t_s) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 796, __pyx_L1_error)</span>
      __pyx_t_10 = __pyx_t_7;
      __pyx_t_7 = 0;
      if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_10, __pyx_v_boundary_params_tmp) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 796, __pyx_L1_error)</span>
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 796, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
        __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
        if (likely(__pyx_t_10)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_10, __pyx_t_1, __pyx_t_7};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_16, 2+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 796, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      }
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 796, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 796, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_7 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
        __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
        if (likely(__pyx_t_7)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_t_5};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_16, 1+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 796, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      }
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_boundary, __pyx_t_3, 0, 0, NULL, NULL, &amp;__pyx_slice__5, 0, 0, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 796, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    __pyx_L17:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0797</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0798</span>:         deadline_tmp = min(max_t, deadline_view[k] - t_view[k])</pre>
<pre class='cython code score-0 '>    __pyx_t_18 = __pyx_v_k;
    __pyx_t_20 = __pyx_v_k;
    __pyx_t_21 = ((*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_18 * __pyx_v_deadline_view.strides[0]) ))) - (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_20 * __pyx_v_t_view.strides[0]) ))));
    __pyx_t_22 = __pyx_v_max_t;
    __pyx_t_19 = (__pyx_t_21 &lt; __pyx_t_22);
    if (__pyx_t_19) {
      __pyx_t_23 = __pyx_t_21;
    } else {
      __pyx_t_23 = __pyx_t_22;
    }
    __pyx_v_deadline_tmp = __pyx_t_23;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0799</span>:         for n in range(n_samples):</pre>
<pre class='cython code score-0 '>    __pyx_t_16 = __pyx_v_n_samples;
    __pyx_t_17 = __pyx_t_16;
    for (__pyx_t_14 = 0; __pyx_t_14 &lt; __pyx_t_17; __pyx_t_14+=1) {
      __pyx_v_n = __pyx_t_14;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0800</span>:             y = (-1) * boundary_view[0] + (z_view[k] * 2 * (boundary_view[0]))  # reset starting position</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = 0;
      __pyx_t_18 = __pyx_v_k;
      __pyx_t_24 = 0;
      __pyx_v_y = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_z_view.data + __pyx_t_18 * __pyx_v_z_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_24 * __pyx_v_boundary_view.strides[0]) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0801</span>:             t_particle = 0.0 # reset time</pre>
<pre class='cython code score-0 '>      __pyx_v_t_particle = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0802</span>:             ix = 0 # reset boundary index</pre>
<pre class='cython code score-0 '>      __pyx_v_ix = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0803</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0804</span>:             # Can improve with less checks</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0805</span>:             if n == 0:</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = (__pyx_v_n == 0);
      if (__pyx_t_19) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0806</span>:                 if k == 0:</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = (__pyx_v_k == 0);
        if (__pyx_t_19) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0807</span>:                     traj_view[0, 0] = y</pre>
<pre class='cython code score-0 '>          __pyx_t_24 = 0;
          __pyx_t_18 = 0;
          *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_24 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_18 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y;
</pre><pre class="cython line score-0">&#xA0;<span class="">0808</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0809</span>:             # Random walker</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0810</span>:             while (y &gt;= (-1) * boundary_view[ix]) and (y &lt;= boundary_view[ix]) and (t_particle &lt;= deadline_tmp):</pre>
<pre class='cython code score-0 '>      while (1) {
        __pyx_t_18 = __pyx_v_ix;
        __pyx_t_25 = (__pyx_v_y &gt;= (-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_18 * __pyx_v_boundary_view.strides[0]) )))));
        if (__pyx_t_25) {
        } else {
          __pyx_t_19 = __pyx_t_25;
          goto __pyx_L24_bool_binop_done;
        }
        __pyx_t_18 = __pyx_v_ix;
        __pyx_t_25 = (__pyx_v_y &lt;= (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_18 * __pyx_v_boundary_view.strides[0]) ))));
        if (__pyx_t_25) {
        } else {
          __pyx_t_19 = __pyx_t_25;
          goto __pyx_L24_bool_binop_done;
        }
        __pyx_t_25 = (__pyx_v_t_particle &lt;= __pyx_v_deadline_tmp);
        __pyx_t_19 = __pyx_t_25;
        __pyx_L24_bool_binop_done:;
        if (!__pyx_t_19) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0811</span>:                 y += (drift_view[ix] * delta_t) + (sqrt_st * gaussian_values[m])</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = __pyx_v_ix;
        __pyx_t_24 = __pyx_v_m;
        __pyx_v_y = (__pyx_v_y + (((*((float *) ( /* dim=0 */ (__pyx_v_drift_view.data + __pyx_t_18 * __pyx_v_drift_view.strides[0]) ))) * __pyx_v_delta_t) + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_24 * __pyx_v_gaussian_values.strides[0]) ))))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0812</span>:                 t_particle += delta_t</pre>
<pre class='cython code score-0 '>        __pyx_v_t_particle = (__pyx_v_t_particle + __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0813</span>:                 ix += 1</pre>
<pre class='cython code score-0 '>        __pyx_v_ix = (__pyx_v_ix + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0814</span>:                 m += 1</pre>
<pre class='cython code score-0 '>        __pyx_v_m = (__pyx_v_m + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">0815</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0816</span>:                 # Can improve with less checks</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0817</span>:                 if n == 0:</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = (__pyx_v_n == 0);
        if (__pyx_t_19) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0818</span>:                     if k == 0:</pre>
<pre class='cython code score-0 '>          __pyx_t_19 = (__pyx_v_k == 0);
          if (__pyx_t_19) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0819</span>:                         traj_view[ix, 0] = y</pre>
<pre class='cython code score-0 '>            __pyx_t_24 = __pyx_v_ix;
            __pyx_t_18 = 0;
            *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_24 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_18 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y;
</pre><pre class="cython line score-0">&#xA0;<span class="">0820</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0821</span>:                 # Can improve with less checks</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0822</span>:                 if m == num_draws:</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = (__pyx_v_m == __pyx_v_num_draws);
        if (__pyx_t_19) {
/* … */
        }
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0823</span>:                     gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 823, __pyx_L1_error)</span>
          __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
          __pyx_v_gaussian_values = __pyx_t_2;
          __pyx_t_2.memview = NULL;
          __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0824</span>:                     m = 0</pre>
<pre class='cython code score-0 '>          __pyx_v_m = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0825</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0826</span>:             if smooth:</pre>
<pre class='cython code score-2 '>      __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_smooth); if (unlikely((__pyx_t_19 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 826, __pyx_L1_error)</span>
      if (__pyx_t_19) {
/* … */
        goto __pyx_L30;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0827</span>:                 if t_particle == 0.0:</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = (__pyx_v_t_particle == 0.0);
        if (__pyx_t_19) {
/* … */
          goto __pyx_L31;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0828</span>:                     smooth_u = random_uniform() * 0.5 * delta_t</pre>
<pre class='cython code score-5 '>          __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 828, __pyx_L1_error)</span>
          __pyx_v_smooth_u = ((__pyx_t_23 * 0.5) * __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0829</span>:                 elif t_particle &lt; deadline_tmp:</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = (__pyx_v_t_particle &lt; __pyx_v_deadline_tmp);
        if (__pyx_t_19) {
/* … */
          goto __pyx_L31;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0830</span>:                     smooth_u = (0.5 - random_uniform()) * delta_t</pre>
<pre class='cython code score-5 '>          __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 830, __pyx_L1_error)</span>
          __pyx_v_smooth_u = ((0.5 - __pyx_t_23) * __pyx_v_delta_t);
</pre><pre class="cython line score-0">&#xA0;<span class="">0831</span>:                 else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0832</span>:                     smooth_u = 0.0</pre>
<pre class='cython code score-0 '>        /*else*/ {
          __pyx_v_smooth_u = 0.0;
        }
        __pyx_L31:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0833</span>:             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0834</span>:                 smooth_u = 0.0</pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_v_smooth_u = 0.0;
      }
      __pyx_L30:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0835</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0836</span>:             rts_view[n, k, 0] = t_particle + t_view[k] + smooth_u # Store rt</pre>
<pre class='cython code score-0 '>      __pyx_t_18 = __pyx_v_k;
      __pyx_t_24 = __pyx_v_n;
      __pyx_t_20 = __pyx_v_k;
      __pyx_t_26 = 0;
      *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_24 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_20 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_26 * __pyx_v_rts_view.strides[2]) )) = ((__pyx_v_t_particle + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_18 * __pyx_v_t_view.strides[0]) )))) + __pyx_v_smooth_u);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0837</span>:             choices_view[n, k, 0] = sign(y) # Store choice</pre>
<pre class='cython code score-5 '>      __pyx_t_27 = __pyx_f_4cssm_sign(__pyx_v_y); if (unlikely(__pyx_t_27 == ((int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 837, __pyx_L1_error)</span>
      __pyx_t_18 = __pyx_v_n;
      __pyx_t_26 = __pyx_v_k;
      __pyx_t_20 = 0;
      *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_18 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_26 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[2]) )) = __pyx_t_27;
</pre><pre class="cython line score-0">&#xA0;<span class="">0838</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0839</span>:             if (rts_view[n, k, 0] &gt;= deadline_view[k]) | (deadline_view[k] &lt;= 0):</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = __pyx_v_n;
      __pyx_t_26 = __pyx_v_k;
      __pyx_t_18 = 0;
      __pyx_t_24 = __pyx_v_k;
      __pyx_t_28 = __pyx_v_k;
      __pyx_t_19 = (((*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_20 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_26 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_18 * __pyx_v_rts_view.strides[2]) ))) &gt;= (*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_24 * __pyx_v_deadline_view.strides[0]) )))) | ((*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_28 * __pyx_v_deadline_view.strides[0]) ))) &lt;= 0.0));
      if (__pyx_t_19) {
/* … */
      }
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0840</span>:                 rts_view[n, k, 0] = -999</pre>
<pre class='cython code score-0 '>        __pyx_t_28 = __pyx_v_n;
        __pyx_t_24 = __pyx_v_k;
        __pyx_t_18 = 0;
        *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_28 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_24 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_18 * __pyx_v_rts_view.strides[2]) )) = -999.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0841</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0842</span>:     if return_option == 'full':</pre>
<pre class='cython code score-2 '>  __pyx_t_19 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_return_option, __pyx_n_u_full, Py_EQ)); if (unlikely((__pyx_t_19 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 842, __pyx_L1_error)</span>
  if (__pyx_t_19) {
/* … */
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0843</span>:         return {'rts': rts, 'choices': choices,  'metadata': {'v': v,</pre>
<pre class='cython code score-20 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 843, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 843, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 843, __pyx_L1_error)</span>
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 843, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_v, ((PyObject *)__pyx_v_v)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 843, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0844</span>:                                                             'a': a,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 843, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0845</span>:                                                             'z': z,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_z, ((PyObject *)__pyx_v_z)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 843, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0846</span>:                                                             't': t,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 843, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0847</span>:                                                             'deadline': deadline,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_deadline, ((PyObject *)__pyx_v_deadline)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 843, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0848</span>:                                                             's': s,</pre>
<pre class='cython code score-11 '>    __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_s);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 848, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_s, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 843, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_4 = __pyx_t_5;
    __pyx_t_5 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0849</span>:                                                             **boundary_params,</pre>
<pre class='cython code score-17 '>    if (unlikely(__pyx_v_boundary_params == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
      <span class='error_goto'>__PYX_ERR(0, 849, __pyx_L1_error)</span>
    }
    if (unlikely(<span class='py_c_api'>PyDict_Update</span>(__pyx_t_4, __pyx_v_boundary_params) &lt; 0)) {
      if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseMappingExpectedError</span>(__pyx_v_boundary_params);
      <span class='error_goto'>__PYX_ERR(0, 849, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0850</span>:                                                             **drift_params,</pre>
<pre class='cython code score-17 '>    if (unlikely(__pyx_v_drift_params == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
      <span class='error_goto'>__PYX_ERR(0, 850, __pyx_L1_error)</span>
    }
    if (unlikely(<span class='py_c_api'>PyDict_Update</span>(__pyx_t_4, __pyx_v_drift_params) &lt; 0)) {
      if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseMappingExpectedError</span>(__pyx_v_drift_params);
      <span class='error_goto'>__PYX_ERR(0, 850, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0851</span>:                                                             'delta_t': delta_t,</pre>
<pre class='cython code score-11 '>    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_t);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 851, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_delta_t, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 851, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0852</span>:                                                             'max_t': max_t,</pre>
<pre class='cython code score-11 '>    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_max_t);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 852, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_max_t, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 852, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0853</span>:                                                             'n_samples': n_samples,</pre>
<pre class='cython code score-8 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 853, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_n_samples, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 853, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0854</span>:                                                             'n_trials': n_trials,</pre>
<pre class='cython code score-13 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 854, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_n_trials, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 854, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_simulator, __pyx_n_u_ddm_flex) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 855, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0855</span>:                                                             'simulator': 'ddm_flex',</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0856</span>:                                                             'boundary_fun_type': boundary_fun.__name__,</pre>
<pre class='cython code score-8 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_boundary_fun, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 856, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_boundary_fun_type, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 856, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0857</span>:                                                             'drift_fun_type': boundary_fun.__name__,</pre>
<pre class='cython code score-8 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_boundary_fun, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 857, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_drift_fun_type, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 857, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0858</span>:                                                             'possible_choices': [-1, 1],</pre>
<pre class='cython code score-17 '>    __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 858, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_5, 0, __pyx_int_neg_1)) <span class='error_goto'>__PYX_ERR(0, 858, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_5, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 858, __pyx_L1_error)</span>;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_possible_choices, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 858, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0859</span>:                                                             'trajectory': traj,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_trajectory, __pyx_v_traj) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 859, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0860</span>:                                                             'drift': drift,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_drift, __pyx_v_drift) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 860, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0861</span>:                                                             'boundary': boundary}}</pre>
<pre class='cython code score-11 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_boundary, __pyx_v_boundary) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 861, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_metadata, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 843, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0862</span>:     elif return_option == 'minimal':</pre>
<pre class='cython code score-2 '>  __pyx_t_19 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_return_option, __pyx_n_u_minimal, Py_EQ)); if (unlikely((__pyx_t_19 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 862, __pyx_L1_error)</span>
  if (likely(__pyx_t_19)) {
/* … */
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0863</span>:         return {'rts': rts, 'choices': choices,  'metadata': {'simulator': 'ddm_flex',</pre>
<pre class='cython code score-20 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 863, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 863, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 863, __pyx_L1_error)</span>
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 863, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_simulator, __pyx_n_u_ddm_flex) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 863, __pyx_L1_error)</span>
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0864</span>:                                                              'possible_choices': [-1, 1],</pre>
<pre class='cython code score-17 '>    __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 864, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_5, 0, __pyx_int_neg_1)) <span class='error_goto'>__PYX_ERR(0, 864, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_5, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 864, __pyx_L1_error)</span>;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_possible_choices, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 863, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0865</span>:                                                              'boundary_fun_type': boundary_fun.__name__,</pre>
<pre class='cython code score-8 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_boundary_fun, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 865, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_boundary_fun_type, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 863, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0866</span>:                                                              'drift_fun_type': boundary_fun.__name__,</pre>
<pre class='cython code score-8 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_boundary_fun, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 866, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_drift_fun_type, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 863, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0867</span>:                                                              'n_samples': n_samples,</pre>
<pre class='cython code score-8 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 867, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_n_samples, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 863, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0868</span>:                                                              'n_trials': n_trials,</pre>
<pre class='cython code score-14 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 868, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_n_trials, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 863, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_metadata, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 863, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0869</span>:                                                              }}</pre>
<pre class="cython line score-0">&#xA0;<span class="">0870</span>:     else:</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0871</span>:         raise ValueError('return_option must be either "full" or "minimal"')</pre>
<pre class='cython code score-5 '>  /*else*/ {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 871, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='error_goto'>__PYX_ERR(0, 871, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0872</span>: # ----------------------------------------------------------------------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0873</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0874</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0875</span>: # ----------------------------------------------------------------------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0876</span>: # Simulate (rt, choice) tuples from: Levy Flight with Flex Bound -------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0877</span>: # @cythonboundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0878</span>: # @cythonwraparound(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0879</span>: #def glob_flexbound(np.ndarray[float, ndim = 1] v,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0880</span>: #                   np.ndarray[float, ndim = 1] a,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0881</span>: #                   np.ndarray[float, ndim = 1] z,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0882</span>: #                   np.ndarray[float, ndim = 1] alphar,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0883</span>: #                   np.ndarray[float, ndim = 1] g,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0884</span>: #                   np.ndarray[float, ndim = 1] t,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0885</span>: #                   np.ndarray[float, ndim = 1] deadline,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0886</span>: #                   float s = 1, # strictly speaking this is a variance multiplier here, not THE variance !</pre>
<pre class="cython line score-0">&#xA0;<span class="">0887</span>: #                   float delta_t = 0.001,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0888</span>: #                   float max_t = 20,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0889</span>: #                   int n_samples = 20000,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0890</span>: #                   int n_trials = 1,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0891</span>: #                   boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0892</span>: #                   boundary_multiplicative = True,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0893</span>: #                   boundary_params = {},</pre>
<pre class="cython line score-0">&#xA0;<span class="">0894</span>: #                   random_state = None,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0895</span>: #                   return_option = 'full',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0896</span>: #                   smooth = False,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0897</span>: #                   **kwargs):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0898</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">0899</span>: #    set_seed(random_state)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0900</span>: #    #cdef int cov_length = np.max([v.size, a.size, w.size, t.size]).astype(int)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0901</span>: #    # Param views:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0902</span>: #    cdef float[:] v_view  = v</pre>
<pre class="cython line score-0">&#xA0;<span class="">0903</span>: #    cdef float[:] a_view = a</pre>
<pre class="cython line score-0">&#xA0;<span class="">0904</span>: #    cdef float[:] z_view = z</pre>
<pre class="cython line score-0">&#xA0;<span class="">0905</span>: #    cdef float[:] alphar_view = alphar</pre>
<pre class="cython line score-0">&#xA0;<span class="">0906</span>: #    cdef float[:] g_view = g</pre>
<pre class="cython line score-0">&#xA0;<span class="">0907</span>: #    cdef float[:] t_view = t</pre>
<pre class="cython line score-0">&#xA0;<span class="">0908</span>: #    cdef float[:] deadline_view = deadline</pre>
<pre class="cython line score-0">&#xA0;<span class="">0909</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">0910</span>: #    # Data-struct for trajectory storage</pre>
<pre class="cython line score-0">&#xA0;<span class="">0911</span>: #    traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0912</span>: #    traj[:, :] = -999</pre>
<pre class="cython line score-0">&#xA0;<span class="">0913</span>: #    cdef float[:,:] traj_view = traj</pre>
<pre class="cython line score-0">&#xA0;<span class="">0914</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">0915</span>: #    rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0916</span>: #    choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0917</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">0918</span>: #    cdef float[:,:, :] rts_view = rts</pre>
<pre class="cython line score-0">&#xA0;<span class="">0919</span>: #    cdef int[:,:, :] choices_view = choices</pre>
<pre class="cython line score-0">&#xA0;<span class="">0920</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">0921</span>: #    cdef float delta_t_alpha # = pow(delta_t, 1.0 / alpha) # correct scalar so we can use standard normal samples for the brownian motion</pre>
<pre class="cython line score-0">&#xA0;<span class="">0922</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">0923</span>: #    # Boundary storage for the upper bound</pre>
<pre class="cython line score-0">&#xA0;<span class="">0924</span>: #    cdef int num_draws = int((max_t / delta_t) + 1)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0925</span>: #    t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0926</span>: #    boundary = np.zeros(t_s.shape, dtype = DTYPE)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0927</span>: #    cdef float[:] boundary_view = boundary</pre>
<pre class="cython line score-0">&#xA0;<span class="">0928</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">0929</span>: #    cdef float y, t_particle, smooth_u, deadline_tmp</pre>
<pre class="cython line score-0">&#xA0;<span class="">0930</span>: #    cdef Py_ssize_t n</pre>
<pre class="cython line score-0">&#xA0;<span class="">0931</span>: #    cdef Py_ssize_t ix</pre>
<pre class="cython line score-0">&#xA0;<span class="">0932</span>: #    cdef Py_ssize_t k</pre>
<pre class="cython line score-0">&#xA0;<span class="">0933</span>: #    cdef Py_ssize_t m = 0</pre>
<pre class="cython line score-0">&#xA0;<span class="">0934</span>: #    #cdef int n, ix</pre>
<pre class="cython line score-0">&#xA0;<span class="">0935</span>: #    #cdef int m = 0</pre>
<pre class="cython line score-0">&#xA0;<span class="">0936</span>: #    cdef float[:] alpha_stable_values = draw_random_stable(num_draws, alphar_view[0])</pre>
<pre class="cython line score-0">&#xA0;<span class="">0937</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">0938</span>: #    for k in range(n_trials):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0939</span>: #        delta_t_alpha = s * pow(delta_t, 1.0 / alphar_view[k])</pre>
<pre class="cython line score-0">&#xA0;<span class="">0940</span>: #        boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}</pre>
<pre class="cython line score-0">&#xA0;<span class="">0941</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">0942</span>: #        # Precompute boundary evaluations</pre>
<pre class="cython line score-0">&#xA0;<span class="">0943</span>: #        if boundary_multiplicative:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0944</span>: #            # print(a)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0945</span>: #            boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0946</span>: #        else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0947</span>: #            # print(a)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0948</span>: #            boundary[:] = np.add(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0949</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">0950</span>: #        deadline_tmp = min(max_t, deadline[k] - t_view[k])</pre>
<pre class="cython line score-0">&#xA0;<span class="">0951</span>: #        # Loop over samples</pre>
<pre class="cython line score-0">&#xA0;<span class="">0952</span>: #        for n in range(n_samples):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0953</span>: #            y = (-1) * boundary_view[0] + (z_view[k] * 2 * (boundary_view[0]))  # reset starting position</pre>
<pre class="cython line score-0">&#xA0;<span class="">0954</span>: #            t_particle = 0.0 # reset time</pre>
<pre class="cython line score-0">&#xA0;<span class="">0955</span>: #            ix = 0 # reset boundary index</pre>
<pre class="cython line score-0">&#xA0;<span class="">0956</span>: #            if n == 0:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0957</span>: #                if k == 0:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0958</span>: #                    traj_view[0, 0] = y</pre>
<pre class="cython line score-0">&#xA0;<span class="">0959</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">0960</span>: #            # Random walker</pre>
<pre class="cython line score-0">&#xA0;<span class="">0961</span>: #            while y &gt;= (-1) * boundary_view[ix] and y &lt;= boundary_view[ix] and t_particle &lt;= deadline_tmp:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0962</span>: #                y += ((v_view[k] - (g_view[k] * y)) * delta_t) + (delta_t_alpha * alpha_stable_values[m])</pre>
<pre class="cython line score-0">&#xA0;<span class="">0963</span>: #                t_particle += delta_t</pre>
<pre class="cython line score-0">&#xA0;<span class="">0964</span>: #                ix += 1</pre>
<pre class="cython line score-0">&#xA0;<span class="">0965</span>: #                m += 1</pre>
<pre class="cython line score-0">&#xA0;<span class="">0966</span>: #                if n == 0:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0967</span>: #                    if k == 0:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0968</span>: #                        traj_view[ix, 0] = y</pre>
<pre class="cython line score-0">&#xA0;<span class="">0969</span>: #                if m == num_draws:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0970</span>: #                    alpha_stable_values = draw_random_stable(num_draws, alphar_view[k])</pre>
<pre class="cython line score-0">&#xA0;<span class="">0971</span>: #                    m = 0</pre>
<pre class="cython line score-0">&#xA0;<span class="">0972</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">0973</span>: #            if smooth:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0974</span>: #                if t_particle == 0:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0975</span>: #                    smooth_u = random_uniform() * 0.5 * delta_t</pre>
<pre class="cython line score-0">&#xA0;<span class="">0976</span>: #                else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0977</span>: #                    smooth_u = (0.5 - random_uniform()) * delta_t</pre>
<pre class="cython line score-0">&#xA0;<span class="">0978</span>: #            else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0979</span>: #                smooth_u = 0.0</pre>
<pre class="cython line score-0">&#xA0;<span class="">0980</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">0981</span>: #            rts_view[n, k, 0] = t_particle + t_view[k] + smooth_u # Store rt</pre>
<pre class="cython line score-0">&#xA0;<span class="">0982</span>: #            choices_view[n, k, 0] = sign(y) # Store choice</pre>
<pre class="cython line score-0">&#xA0;<span class="">0983</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">0984</span>: #            if rts_view[n, k, 0] &gt; deadline_view[k]:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0985</span>: #                rts_view[n, k, 0] = -999</pre>
<pre class="cython line score-0">&#xA0;<span class="">0986</span>: #                choices_view[n, k, 0] = -1</pre>
<pre class="cython line score-0">&#xA0;<span class="">0987</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">0988</span>: #    if return_option == 'full':</pre>
<pre class="cython line score-0">&#xA0;<span class="">0989</span>: #        return {'rts': rts, 'choices': choices,  'metadata': {'v': v,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0990</span>: #                                                            'a': a,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0991</span>: #                                                            'z': z,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0992</span>: #                                                            't': t,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0993</span>: #                                                            'alphar': alphar,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0994</span>: #                                                            'g': g,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0995</span>: #                                                            's': s,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0996</span>: #                                                            'deadline': deadline,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0997</span>: #                                                            **boundary_params,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0998</span>: #                                                            'delta_t': delta_t,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0999</span>: #                                                            'max_t': max_t,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1000</span>: #                                                            'n_samples': n_samples,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1001</span>: #                                                            'n_trials': n_trials,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1002</span>: #                                                            'simulator': 'glob_flexbound',</pre>
<pre class="cython line score-0">&#xA0;<span class="">1003</span>: #                                                            'boundary_fun_type': boundary_fun.__name__,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1004</span>: #                                                            'possible_choices': [-1, 1],</pre>
<pre class="cython line score-0">&#xA0;<span class="">1005</span>: #                                                            'trajectory': traj,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1006</span>: #                                                            'boundary': boundary}}</pre>
<pre class="cython line score-0">&#xA0;<span class="">1007</span>: #    elif return_option == 'minimal':</pre>
<pre class="cython line score-0">&#xA0;<span class="">1008</span>: #        return {'rts': rts, 'choices': choices,  'metadata': {'simulator': 'glob_flexbound',</pre>
<pre class="cython line score-0">&#xA0;<span class="">1009</span>: #                                                             'possible_choices': [-1, 1],</pre>
<pre class="cython line score-0">&#xA0;<span class="">1010</span>: #                                                             'boundary_fun_type': boundary_fun.__name__,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1011</span>: #                                                             'n_samples': n_samples,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1012</span>: #                                                             'n_trials': n_trials,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1013</span>: #                                                             }}</pre>
<pre class="cython line score-0">&#xA0;<span class="">1014</span>: #    else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">1015</span>: #        raise ValueError('return_option must be either "full" or "minimal"')</pre>
<pre class="cython line score-0">&#xA0;<span class="">1016</span>: # -------------------------------------------------------------------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1017</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1018</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1019</span>: # Simulate (rt, choice) tuples from: Levy Flight with Flex Bound -------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1020</span>: # @cythonboundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1021</span>: # @cythonwraparound(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1022</span>: </pre>
<pre class="cython line score-142" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1023</span>: def levy_flexbound(np.ndarray[float, ndim = 1] v,</pre>
<pre class='cython code score-142 '>static PyObject *__pyx_pf_4cssm_50__defaults__(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_r = NULL;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
/* … */
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(11);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1023, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 2, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 3, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 4, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 5, Py_None)) <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_True));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_True));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 6, ((PyObject *)Py_True))) <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults2, __pyx_self)-&gt;__pyx_arg_boundary_params);
  <span class='refnanny'>__Pyx_GIVEREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults2, __pyx_self)-&gt;__pyx_arg_boundary_params);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 7, <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults2, __pyx_self)-&gt;__pyx_arg_boundary_params)) <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 8, Py_None)) <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject*)__pyx_n_u_full));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject*)__pyx_n_u_full));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 9, ((PyObject*)__pyx_n_u_full))) <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_False));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_False));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 10, ((PyObject *)Py_False))) <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1023, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 1, Py_None)) <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L1_error)</span>;
  __pyx_t_6 = 0;
  __pyx_r = __pyx_t_5;
  __pyx_t_5 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.__defaults__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_4cssm_13levy_flexbound(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_4cssm_13levy_flexbound = {"levy_flexbound", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_4cssm_13levy_flexbound, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_4cssm_13levy_flexbound(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyArrayObject *__pyx_v_v = 0;
  PyArrayObject *__pyx_v_a = 0;
  PyArrayObject *__pyx_v_z = 0;
  PyArrayObject *__pyx_v_alpha = 0;
  PyArrayObject *__pyx_v_t = 0;
  PyArrayObject *__pyx_v_deadline = 0;
  float __pyx_v_s;
  float __pyx_v_delta_t;
  float __pyx_v_max_t;
  int __pyx_v_n_samples;
  int __pyx_v_n_trials;
  PyObject *__pyx_v_boundary_fun = 0;
  PyObject *__pyx_v_boundary_multiplicative = 0;
  PyObject *__pyx_v_boundary_params = 0;
  PyObject *__pyx_v_random_state = 0;
  PyObject *__pyx_v_return_option = 0;
  PyObject *__pyx_v_smooth = 0;
  CYTHON_UNUSED PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("levy_flexbound (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_v,&amp;__pyx_n_s_a,&amp;__pyx_n_s_z,&amp;__pyx_n_s_alpha,&amp;__pyx_n_s_t,&amp;__pyx_n_s_deadline,&amp;__pyx_n_s_s,&amp;__pyx_n_s_delta_t,&amp;__pyx_n_s_max_t,&amp;__pyx_n_s_n_samples,&amp;__pyx_n_s_n_trials,&amp;__pyx_n_s_boundary_fun,&amp;__pyx_n_s_boundary_multiplicative,&amp;__pyx_n_s_boundary_params,&amp;__pyx_n_s_random_state,&amp;__pyx_n_s_return_option,&amp;__pyx_n_s_smooth,0};
  PyObject* values[17] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    __pyx_defaults2 *__pyx_dynamic_args = <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults2, __pyx_self);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs);
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4cssm_12levy_flexbound(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_alpha, PyArrayObject *__pyx_v_t, PyArrayObject *__pyx_v_deadline, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state, PyObject *__pyx_v_return_option, PyObject *__pyx_v_smooth, CYTHON_UNUSED PyObject *__pyx_v_kwargs) {
  __Pyx_memviewslice __pyx_v_v_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_a_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_z_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_alpha_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_t_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_deadline_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_traj = NULL;
  __Pyx_memviewslice __pyx_v_traj_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_rts = NULL;
  PyObject *__pyx_v_choices = NULL;
  __Pyx_memviewslice __pyx_v_rts_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_choices_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  float __pyx_v_delta_t_alpha;
  int __pyx_v_num_draws;
  PyObject *__pyx_v_t_s = NULL;
  PyObject *__pyx_v_boundary = NULL;
  __Pyx_memviewslice __pyx_v_boundary_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  float __pyx_v_y;
  float __pyx_v_t_particle;
  float __pyx_v_smooth_u;
  float __pyx_v_deadline_tmp;
  Py_ssize_t __pyx_v_n;
  Py_ssize_t __pyx_v_ix;
  Py_ssize_t __pyx_v_k;
  Py_ssize_t __pyx_v_m;
  __Pyx_memviewslice __pyx_v_alpha_stable_values = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_boundary_params_tmp = NULL;
  PyObject *__pyx_8genexpr3__pyx_v_key = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_a;
  __Pyx_Buffer __pyx_pybuffer_a;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_alpha;
  __Pyx_Buffer __pyx_pybuffer_alpha;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_deadline;
  __Pyx_Buffer __pyx_pybuffer_deadline;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_t;
  __Pyx_Buffer __pyx_pybuffer_t;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_v;
  __Pyx_Buffer __pyx_pybuffer_v;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_z;
  __Pyx_Buffer __pyx_pybuffer_z;
  PyObject *__pyx_r = NULL;
  __pyx_pybuffer_v.pybuffer.buf = NULL;
  __pyx_pybuffer_v.refcount = 0;
  __pyx_pybuffernd_v.data = NULL;
  __pyx_pybuffernd_v.rcbuffer = &amp;__pyx_pybuffer_v;
  __pyx_pybuffer_a.pybuffer.buf = NULL;
  __pyx_pybuffer_a.refcount = 0;
  __pyx_pybuffernd_a.data = NULL;
  __pyx_pybuffernd_a.rcbuffer = &amp;__pyx_pybuffer_a;
  __pyx_pybuffer_z.pybuffer.buf = NULL;
  __pyx_pybuffer_z.refcount = 0;
  __pyx_pybuffernd_z.data = NULL;
  __pyx_pybuffernd_z.rcbuffer = &amp;__pyx_pybuffer_z;
  __pyx_pybuffer_alpha.pybuffer.buf = NULL;
  __pyx_pybuffer_alpha.refcount = 0;
  __pyx_pybuffernd_alpha.data = NULL;
  __pyx_pybuffernd_alpha.rcbuffer = &amp;__pyx_pybuffer_alpha;
  __pyx_pybuffer_t.pybuffer.buf = NULL;
  __pyx_pybuffer_t.refcount = 0;
  __pyx_pybuffernd_t.data = NULL;
  __pyx_pybuffernd_t.rcbuffer = &amp;__pyx_pybuffer_t;
  __pyx_pybuffer_deadline.pybuffer.buf = NULL;
  __pyx_pybuffer_deadline.refcount = 0;
  __pyx_pybuffernd_deadline.data = NULL;
  __pyx_pybuffernd_deadline.rcbuffer = &amp;__pyx_pybuffer_deadline;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_v, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_v.diminfo[0].strides = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_v.diminfo[0].shape = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_a, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_z, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_z.diminfo[0].strides = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_z.diminfo[0].shape = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_alpha.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_alpha, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_alpha.diminfo[0].strides = __pyx_pybuffernd_alpha.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_alpha.diminfo[0].shape = __pyx_pybuffernd_alpha.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_t, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_t.diminfo[0].strides = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_t.diminfo[0].shape = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_deadline, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_deadline.diminfo[0].strides = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_deadline.diminfo[0].shape = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.shape[0];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_2, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_9, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_alpha.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.levy_flexbound", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_alpha.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_v_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_a_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_z_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_alpha_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_t_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_deadline_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_traj);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_traj_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_choices);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_rts_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_choices_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t_s);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_boundary);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_boundary_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_alpha_stable_values, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_boundary_params_tmp);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr3__pyx_v_key);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__35 = <span class='py_c_api'>PyTuple_Pack</span>(46, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_alpha, __pyx_n_s_t, __pyx_n_s_deadline, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_boundary_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_random_state, __pyx_n_s_return_option, __pyx_n_s_smooth, __pyx_n_s_kwargs, __pyx_n_s_v_view, __pyx_n_s_a_view, __pyx_n_s_z_view, __pyx_n_s_alpha_view, __pyx_n_s_t_view, __pyx_n_s_deadline_view, __pyx_n_s_traj, __pyx_n_s_traj_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_alpha, __pyx_n_s_num_draws, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_boundary_view, __pyx_n_s_y, __pyx_n_s_t_particle, __pyx_n_s_smooth_u, __pyx_n_s_deadline_tmp, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_alpha_stable_values, __pyx_n_s_boundary_params_tmp, __pyx_n_s_key);<span class='error_goto'> if (unlikely(!__pyx_tuple__35)) __PYX_ERR(0, 1023, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__35);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__35);
/* … */
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_4cssm_13levy_flexbound, 0, __pyx_n_s_levy_flexbound, NULL, __pyx_n_s_cssm, __pyx_d, ((PyObject *)__pyx_codeobj__36));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1023, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (!<span class='pyx_c_api'>__Pyx_CyFunction_InitDefaults</span>(__pyx_t_5, sizeof(__pyx_defaults2), 1)) <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L1_error)</span>
  __pyx_codeobj__36 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(17, 0, 0, 46, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__35, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_levy_flexbound, 1023, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__36)) __PYX_ERR(0, 1023, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1024</span>:                    np.ndarray[float, ndim = 1] a,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1025</span>:                    np.ndarray[float, ndim = 1] z,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1026</span>:                    np.ndarray[float, ndim = 1] alpha,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1027</span>:                    np.ndarray[float, ndim = 1] t,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1028</span>:                    np.ndarray[float, ndim = 1] deadline,</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1029</span>:                    float s = 1, # strictly speaking this is a variance multiplier here, not THE variance !</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)1.0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1029, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1030</span>:                    float delta_t = 0.001,</pre>
<pre class='cython code score-5 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(((double)0.001));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1030, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1031</span>:                    float max_t = 20,</pre>
<pre class='cython code score-5 '>  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)20.0));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1031, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1032</span>:                    int n_samples = 20000,</pre>
<pre class='cython code score-2 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)0x4E20));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1032, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1033</span>:                    int n_trials = 1,</pre>
<pre class='cython code score-2 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)1));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1033, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1034</span>:                    boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)</pre>
<pre class='cython code score-6 '>    values[11] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[12] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_True)));
    values[13] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(__pyx_dynamic_args-&gt;__pyx_arg_boundary_params);
</pre><pre class="cython line score-0">&#xA0;<span class="">1035</span>:                    boundary_multiplicative = True,</pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1036</span>:                    boundary_params = {},</pre>
<pre class='cython code score-12 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1036, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults2, __pyx_t_5)-&gt;__pyx_arg_boundary_params = __pyx_t_4;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_4 = 0;
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsGetter</span>(__pyx_t_5, __pyx_pf_4cssm_50__defaults__);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_levy_flexbound, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-304" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1037</span>:                    random_state = None,</pre>
<pre class='cython code score-304 '>    values[14] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[15] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_full)));
    values[16] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case 17: values[16] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 16);
        CYTHON_FALLTHROUGH;
        case 16: values[15] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 15);
        CYTHON_FALLTHROUGH;
        case 15: values[14] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_v)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_a)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("levy_flexbound", 0, 6, 17, 1); <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_z)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("levy_flexbound", 0, 6, 17, 2); <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_alpha)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[3]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("levy_flexbound", 0, 6, 17, 3); <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_t)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[4]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("levy_flexbound", 0, 6, 17, 4); <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_deadline)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[5]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("levy_flexbound", 0, 6, 17, 5); <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_s);
          if (value) { values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_delta_t);
          if (value) { values[7] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_max_t);
          if (value) { values[8] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  9:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_samples);
          if (value) { values[9] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 10:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_trials);
          if (value) { values[10] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 11:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_fun);
          if (value) { values[11] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 12:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_multiplicative);
          if (value) { values[12] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 13:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_params);
          if (value) { values[13] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 14:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_random_state);
          if (value) { values[14] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 15:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_return_option);
          if (value) { values[15] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 16:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_smooth);
          if (value) { values[16] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values + 0, kwd_pos_args, "levy_flexbound") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case 17: values[16] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 16);
        CYTHON_FALLTHROUGH;
        case 16: values[15] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 15);
        CYTHON_FALLTHROUGH;
        case 15: values[14] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_v = ((PyArrayObject *)values[0]);
    __pyx_v_a = ((PyArrayObject *)values[1]);
    __pyx_v_z = ((PyArrayObject *)values[2]);
    __pyx_v_alpha = ((PyArrayObject *)values[3]);
    __pyx_v_t = ((PyArrayObject *)values[4]);
    __pyx_v_deadline = ((PyArrayObject *)values[5]);
    if (values[6]) {
      __pyx_v_s = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[6]); if (unlikely((__pyx_v_s == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1029, __pyx_L3_error)</span>
    } else {
      __pyx_v_s = ((float)((float)1.0));
    }
    if (values[7]) {
      __pyx_v_delta_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[7]); if (unlikely((__pyx_v_delta_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1030, __pyx_L3_error)</span>
    } else {
      __pyx_v_delta_t = ((float)((double)0.001));
    }
    if (values[8]) {
      __pyx_v_max_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[8]); if (unlikely((__pyx_v_max_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1031, __pyx_L3_error)</span>
    } else {
      __pyx_v_max_t = ((float)((float)20.0));
    }
    if (values[9]) {
      __pyx_v_n_samples = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[9]); if (unlikely((__pyx_v_n_samples == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1032, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_samples = ((int)((int)0x4E20));
    }
    if (values[10]) {
      __pyx_v_n_trials = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[10]); if (unlikely((__pyx_v_n_trials == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1033, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_trials = ((int)((int)1));
    }
    __pyx_v_boundary_fun = values[11];
    __pyx_v_boundary_multiplicative = values[12];
    __pyx_v_boundary_params = values[13];
    __pyx_v_random_state = values[14];
    __pyx_v_return_option = values[15];
    __pyx_v_smooth = values[16];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("levy_flexbound", 0, 6, 17, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.levy_flexbound", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) <span class='error_goto'>__PYX_ERR(0, 1023, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) <span class='error_goto'>__PYX_ERR(0, 1024, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) <span class='error_goto'>__PYX_ERR(0, 1025, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_alpha), __pyx_ptype_5numpy_ndarray, 1, "alpha", 0))) <span class='error_goto'>__PYX_ERR(0, 1026, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) <span class='error_goto'>__PYX_ERR(0, 1027, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_deadline), __pyx_ptype_5numpy_ndarray, 1, "deadline", 0))) <span class='error_goto'>__PYX_ERR(0, 1028, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_4cssm_12levy_flexbound(__pyx_self, __pyx_v_v, __pyx_v_a, __pyx_v_z, __pyx_v_alpha, __pyx_v_t, __pyx_v_deadline, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state, __pyx_v_return_option, __pyx_v_smooth, __pyx_v_kwargs);
</pre><pre class="cython line score-0">&#xA0;<span class="">1038</span>:                    return_option = 'full',</pre>
<pre class="cython line score-0">&#xA0;<span class="">1039</span>:                    smooth = False,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1040</span>:                    **kwargs):</pre>
<pre class="cython line score-0">&#xA0;<span class="">1041</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1042</span>:     set_seed(random_state)</pre>
<pre class='cython code score-1 '>  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1042, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1043</span>:     #cdef int cov_length = np.max([v.size, a.size, w.size, t.size]).astype(int)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1044</span>:     # Param views:</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1045</span>:     cdef float[:] v_view  = v</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_v), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1045, __pyx_L1_error)</span>
  __pyx_v_v_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1046</span>:     cdef float[:] a_view = a</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_a), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1046, __pyx_L1_error)</span>
  __pyx_v_a_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1047</span>:     cdef float[:] z_view = z</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_z), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1047, __pyx_L1_error)</span>
  __pyx_v_z_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1048</span>:     cdef float[:] alpha_view = alpha</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_alpha), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1048, __pyx_L1_error)</span>
  __pyx_v_alpha_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1049</span>:     cdef float[:] t_view = t</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_t), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1049, __pyx_L1_error)</span>
  __pyx_v_t_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1050</span>:     cdef float[:] deadline_view = deadline</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_deadline), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1050, __pyx_L1_error)</span>
  __pyx_v_deadline_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1051</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1052</span>:     # Data-struct for trajectory storage</pre>
<pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1053</span>:     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)</pre>
<pre class='cython code score-42 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1053, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1053, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_FromDouble</span>((__pyx_v_max_t / __pyx_v_delta_t));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1053, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_1, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1053, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1053, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1053, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 1053, __pyx_L1_error)</span>;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1053, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1053, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1053, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1053, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1053, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1053, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_traj = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1054</span>:     traj[:, :] = -999</pre>
<pre class='cython code score-5 '>  if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_traj, __pyx_tuple__12, __pyx_int_neg_999) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1054, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1055</span>:     cdef float[:,:] traj_view = traj</pre>
<pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(__pyx_v_traj, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1055, __pyx_L1_error)</span>
  __pyx_v_traj_view = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1056</span>: </pre>
<pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1057</span>:     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)</pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1057, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1057, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1057, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1057, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1057, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 1057, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1057, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 1057, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1057, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1057, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1057, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1057, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1057, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1057, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_rts = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1058</span>:     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)</pre>
<pre class='cython code score-46 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1058, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1058, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1058, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1058, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1058, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 1058, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1058, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 1058, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1058, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1058, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1058, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1058, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_intc);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1058, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1058, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1058, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_choices = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1059</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1060</span>:     cdef float[:,:, :] rts_view = rts</pre>
<pre class='cython code score-2 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_rts, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1060, __pyx_L1_error)</span>
  __pyx_v_rts_view = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1061</span>:     cdef int[:,:, :] choices_view = choices</pre>
<pre class='cython code score-2 '>  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_int</span>(__pyx_v_choices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1061, __pyx_L1_error)</span>
  __pyx_v_choices_view = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1062</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1063</span>:     cdef float delta_t_alpha # = pow(delta_t, 1.0 / alpha) # correct scalar so we can use standard normal samples for the brownian motion</pre>
<pre class="cython line score-0">&#xA0;<span class="">1064</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1065</span>:     # Boundary storage for the upper bound</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1066</span>:     cdef int num_draws = int((max_t / delta_t) + 1)</pre>
<pre class='cython code score-0 '>  __pyx_v_num_draws = ((int)((__pyx_v_max_t / __pyx_v_delta_t) + 1.0));
</pre><pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1067</span>:     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)</pre>
<pre class='cython code score-51 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1067, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1067, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_max_t + __pyx_v_delta_t));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1067, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_t);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1067, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_10 = NULL;
  __pyx_t_11 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_10)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_11 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[4] = {__pyx_t_10, __pyx_int_0, __pyx_t_4, __pyx_t_5};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_11, 3+__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1067, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1067, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1067, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = NULL;
  __pyx_t_11 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_11 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_1};
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_11, 1+__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 1067, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_v_t_s = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1068</span>:     boundary = np.zeros(t_s.shape, dtype = DTYPE)</pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1068, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1068, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_t_s, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1068, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1068, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 1068, __pyx_L1_error)</span>;
  __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1068, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1068, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1068, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1068, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_v_boundary = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1069</span>:     cdef float[:] boundary_view = boundary</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(__pyx_v_boundary, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1069, __pyx_L1_error)</span>
  __pyx_v_boundary_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1070</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1071</span>:     cdef float y, t_particle, smooth_u, deadline_tmp</pre>
<pre class="cython line score-0">&#xA0;<span class="">1072</span>:     cdef Py_ssize_t n</pre>
<pre class="cython line score-0">&#xA0;<span class="">1073</span>:     cdef Py_ssize_t ix</pre>
<pre class="cython line score-0">&#xA0;<span class="">1074</span>:     cdef Py_ssize_t k</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1075</span>:     cdef Py_ssize_t m = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_m = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1076</span>:     #cdef int n, ix</pre>
<pre class="cython line score-0">&#xA0;<span class="">1077</span>:     #cdef int m = 0</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1078</span>:     cdef float[:] alpha_stable_values = draw_random_stable(num_draws, alpha_view[0])</pre>
<pre class='cython code score-0 '>  __pyx_t_12 = 0;
  __pyx_t_2 = __pyx_f_4cssm_draw_random_stable(__pyx_v_num_draws, (*((float *) ( /* dim=0 */ (__pyx_v_alpha_view.data + __pyx_t_12 * __pyx_v_alpha_view.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1078, __pyx_L1_error)</span>
  __pyx_v_alpha_stable_values = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1079</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1080</span>:     for k in range(n_trials):</pre>
<pre class='cython code score-0 '>  __pyx_t_11 = __pyx_v_n_trials;
  __pyx_t_13 = __pyx_t_11;
  for (__pyx_t_14 = 0; __pyx_t_14 &lt; __pyx_t_13; __pyx_t_14+=1) {
    __pyx_v_k = __pyx_t_14;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1081</span>:         delta_t_alpha = s * pow(delta_t, 1.0 / alpha_view[k])</pre>
<pre class='cython code score-0 '>    __pyx_t_12 = __pyx_v_k;
    __pyx_v_delta_t_alpha = (__pyx_v_s * pow(__pyx_v_delta_t, (1.0 / ((double)(*((float *) ( /* dim=0 */ (__pyx_v_alpha_view.data + __pyx_t_12 * __pyx_v_alpha_view.strides[0]) )))))));
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1082</span>:         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}</pre>
<pre class='cython code score-27 '>    { /* enter inner scope */
      __pyx_t_5 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1082, __pyx_L7_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_15 = 0;
      if (unlikely(__pyx_v_boundary_params == Py_None)) {
        <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "keys");
        <span class='error_goto'>__PYX_ERR(0, 1082, __pyx_L7_error)</span>
      }
      __pyx_t_1 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&amp;__pyx_t_16), (&amp;__pyx_t_17));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1082, __pyx_L7_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
      __pyx_t_7 = __pyx_t_1;
      __pyx_t_1 = 0;
      while (1) {
        __pyx_t_18 = __Pyx_dict_iter_next(__pyx_t_7, __pyx_t_16, &amp;__pyx_t_15, &amp;__pyx_t_1, NULL, NULL, __pyx_t_17);
        if (unlikely(__pyx_t_18 == 0)) break;
        if (unlikely(__pyx_t_18 == -1)) <span class='error_goto'>__PYX_ERR(0, 1082, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_8genexpr3__pyx_v_key, __pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_boundary_params, __pyx_8genexpr3__pyx_v_key);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1082, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1082, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, (PyObject*)__pyx_8genexpr3__pyx_v_key, (PyObject*)__pyx_t_3))) <span class='error_goto'>__PYX_ERR(0, 1082, __pyx_L7_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr3__pyx_v_key); __pyx_8genexpr3__pyx_v_key = 0;
      goto __pyx_L10_exit_scope;
      __pyx_L7_error:;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr3__pyx_v_key); __pyx_8genexpr3__pyx_v_key = 0;
      goto __pyx_L1_error;
      __pyx_L10_exit_scope:;
    } /* exit inner scope */
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_boundary_params_tmp, ((PyObject*)__pyx_t_5));
    __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1083</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1084</span>:         # Precompute boundary evaluations</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1085</span>:         if boundary_multiplicative:</pre>
<pre class='cython code score-2 '>    __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_boundary_multiplicative); if (unlikely((__pyx_t_19 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1085, __pyx_L1_error)</span>
    if (__pyx_t_19) {
/* … */
      goto __pyx_L11;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1086</span>:             # print(a)</pre>
<pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1087</span>:             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)</pre>
<pre class='cython code score-61 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1087, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_multiply);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1087, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_12 = __pyx_v_k;
      __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_12 * __pyx_v_a_view.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1087, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1087, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_t, __pyx_v_t_s) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1087, __pyx_L1_error)</span>
      __pyx_t_4 = __pyx_t_10;
      __pyx_t_10 = 0;
      if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_4, __pyx_v_boundary_params_tmp) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1087, __pyx_L1_error)</span>
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1087, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = NULL;
      __pyx_t_17 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
          __pyx_t_17 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_4, __pyx_t_3, __pyx_t_10};
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_17, 2+__pyx_t_17);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 1087, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1087, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1087, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_10 = NULL;
      __pyx_t_17 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_10)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
          __pyx_t_17 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_10, __pyx_t_7};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_17, 1+__pyx_t_17);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 1087, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_boundary, __pyx_t_5, 0, 0, NULL, NULL, &amp;__pyx_slice__5, 0, 0, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1087, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1088</span>:         else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">1089</span>:             # print(a)</pre>
<pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1090</span>:             boundary[:] = np.add(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)</pre>
<pre class='cython code score-61 '>    /*else*/ {
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1090, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_add);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1090, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_12 = __pyx_v_k;
      __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_12 * __pyx_v_a_view.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1090, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1090, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_t, __pyx_v_t_s) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1090, __pyx_L1_error)</span>
      __pyx_t_3 = __pyx_t_4;
      __pyx_t_4 = 0;
      if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_3, __pyx_v_boundary_params_tmp) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1090, __pyx_L1_error)</span>
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1090, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = NULL;
      __pyx_t_17 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
        __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
        if (likely(__pyx_t_3)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
          __pyx_t_17 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_t_7, __pyx_t_4};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_17, 2+__pyx_t_17);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1090, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      }
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1090, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1090, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_4 = NULL;
      __pyx_t_17 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
          __pyx_t_17 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_1};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_17, 1+__pyx_t_17);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 1090, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      }
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_boundary, __pyx_t_5, 0, 0, NULL, NULL, &amp;__pyx_slice__5, 0, 0, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1090, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
    __pyx_L11:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1091</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1092</span>:         deadline_tmp = min(max_t, deadline_view[k] - t_view[k])</pre>
<pre class='cython code score-0 '>    __pyx_t_12 = __pyx_v_k;
    __pyx_t_20 = __pyx_v_k;
    __pyx_t_21 = ((*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_12 * __pyx_v_deadline_view.strides[0]) ))) - (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_20 * __pyx_v_t_view.strides[0]) ))));
    __pyx_t_22 = __pyx_v_max_t;
    __pyx_t_19 = (__pyx_t_21 &lt; __pyx_t_22);
    if (__pyx_t_19) {
      __pyx_t_23 = __pyx_t_21;
    } else {
      __pyx_t_23 = __pyx_t_22;
    }
    __pyx_v_deadline_tmp = __pyx_t_23;
</pre><pre class="cython line score-0">&#xA0;<span class="">1093</span>:         # Loop over samples</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1094</span>:         for n in range(n_samples):</pre>
<pre class='cython code score-0 '>    __pyx_t_17 = __pyx_v_n_samples;
    __pyx_t_18 = __pyx_t_17;
    for (__pyx_t_16 = 0; __pyx_t_16 &lt; __pyx_t_18; __pyx_t_16+=1) {
      __pyx_v_n = __pyx_t_16;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1095</span>:             y = (-1) * boundary_view[0] + (z_view[k] * 2 * (boundary_view[0]))  # reset starting position</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = 0;
      __pyx_t_12 = __pyx_v_k;
      __pyx_t_24 = 0;
      __pyx_v_y = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_z_view.data + __pyx_t_12 * __pyx_v_z_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_24 * __pyx_v_boundary_view.strides[0]) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1096</span>:             t_particle = 0.0 # reset time</pre>
<pre class='cython code score-0 '>      __pyx_v_t_particle = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1097</span>:             ix = 0 # reset boundary index</pre>
<pre class='cython code score-0 '>      __pyx_v_ix = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1098</span>:             if n == 0:</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = (__pyx_v_n == 0);
      if (__pyx_t_19) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1099</span>:                 if k == 0:</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = (__pyx_v_k == 0);
        if (__pyx_t_19) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1100</span>:                     traj_view[0, 0] = y</pre>
<pre class='cython code score-0 '>          __pyx_t_24 = 0;
          __pyx_t_12 = 0;
          *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_24 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_12 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y;
</pre><pre class="cython line score-0">&#xA0;<span class="">1101</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1102</span>:             # Random walker</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1103</span>:             while y &gt;= (-1) * boundary_view[ix] and y &lt;= boundary_view[ix] and t_particle &lt;= deadline_tmp:</pre>
<pre class='cython code score-0 '>      while (1) {
        __pyx_t_12 = __pyx_v_ix;
        __pyx_t_25 = (__pyx_v_y &gt;= (-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_12 * __pyx_v_boundary_view.strides[0]) )))));
        if (__pyx_t_25) {
        } else {
          __pyx_t_19 = __pyx_t_25;
          goto __pyx_L18_bool_binop_done;
        }
        __pyx_t_12 = __pyx_v_ix;
        __pyx_t_25 = (__pyx_v_y &lt;= (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_12 * __pyx_v_boundary_view.strides[0]) ))));
        if (__pyx_t_25) {
        } else {
          __pyx_t_19 = __pyx_t_25;
          goto __pyx_L18_bool_binop_done;
        }
        __pyx_t_25 = (__pyx_v_t_particle &lt;= __pyx_v_deadline_tmp);
        __pyx_t_19 = __pyx_t_25;
        __pyx_L18_bool_binop_done:;
        if (!__pyx_t_19) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1104</span>:                 y += (v_view[k] * delta_t) + (delta_t_alpha * alpha_stable_values[m])</pre>
<pre class='cython code score-0 '>        __pyx_t_12 = __pyx_v_k;
        __pyx_t_24 = __pyx_v_m;
        __pyx_v_y = (__pyx_v_y + (((*((float *) ( /* dim=0 */ (__pyx_v_v_view.data + __pyx_t_12 * __pyx_v_v_view.strides[0]) ))) * __pyx_v_delta_t) + (__pyx_v_delta_t_alpha * (*((float *) ( /* dim=0 */ (__pyx_v_alpha_stable_values.data + __pyx_t_24 * __pyx_v_alpha_stable_values.strides[0]) ))))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1105</span>:                 t_particle += delta_t</pre>
<pre class='cython code score-0 '>        __pyx_v_t_particle = (__pyx_v_t_particle + __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1106</span>:                 ix += 1</pre>
<pre class='cython code score-0 '>        __pyx_v_ix = (__pyx_v_ix + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1107</span>:                 m += 1</pre>
<pre class='cython code score-0 '>        __pyx_v_m = (__pyx_v_m + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1108</span>:                 if n == 0:</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = (__pyx_v_n == 0);
        if (__pyx_t_19) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1109</span>:                     if k == 0:</pre>
<pre class='cython code score-0 '>          __pyx_t_19 = (__pyx_v_k == 0);
          if (__pyx_t_19) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1110</span>:                         traj_view[ix, 0] = y</pre>
<pre class='cython code score-0 '>            __pyx_t_24 = __pyx_v_ix;
            __pyx_t_12 = 0;
            *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_24 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_12 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1111</span>:                 if m == num_draws:</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = (__pyx_v_m == __pyx_v_num_draws);
        if (__pyx_t_19) {
/* … */
        }
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1112</span>:                     alpha_stable_values = draw_random_stable(num_draws, alpha_view[k])</pre>
<pre class='cython code score-0 '>          __pyx_t_12 = __pyx_v_k;
          __pyx_t_2 = __pyx_f_4cssm_draw_random_stable(__pyx_v_num_draws, (*((float *) ( /* dim=0 */ (__pyx_v_alpha_view.data + __pyx_t_12 * __pyx_v_alpha_view.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1112, __pyx_L1_error)</span>
          __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_alpha_stable_values, 1);
          __pyx_v_alpha_stable_values = __pyx_t_2;
          __pyx_t_2.memview = NULL;
          __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1113</span>:                     m = 0</pre>
<pre class='cython code score-0 '>          __pyx_v_m = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1114</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1115</span>:             if smooth:</pre>
<pre class='cython code score-2 '>      __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_smooth); if (unlikely((__pyx_t_19 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1115, __pyx_L1_error)</span>
      if (__pyx_t_19) {
/* … */
        goto __pyx_L24;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1116</span>:                 if t_particle == 0.0:</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = (__pyx_v_t_particle == 0.0);
        if (__pyx_t_19) {
/* … */
          goto __pyx_L25;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1117</span>:                     smooth_u = random_uniform() * 0.5 * delta_t</pre>
<pre class='cython code score-5 '>          __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1117, __pyx_L1_error)</span>
          __pyx_v_smooth_u = ((__pyx_t_23 * 0.5) * __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1118</span>:                 elif t_particle &lt; deadline_tmp:</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = (__pyx_v_t_particle &lt; __pyx_v_deadline_tmp);
        if (__pyx_t_19) {
/* … */
          goto __pyx_L25;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1119</span>:                     smooth_u = (0.5 - random_uniform()) * delta_t</pre>
<pre class='cython code score-5 '>          __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1119, __pyx_L1_error)</span>
          __pyx_v_smooth_u = ((0.5 - __pyx_t_23) * __pyx_v_delta_t);
</pre><pre class="cython line score-0">&#xA0;<span class="">1120</span>:                 else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1121</span>:                     smooth_u = 0.0</pre>
<pre class='cython code score-0 '>        /*else*/ {
          __pyx_v_smooth_u = 0.0;
        }
        __pyx_L25:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1122</span>:             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1123</span>:                 smooth_u = 0.0</pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_v_smooth_u = 0.0;
      }
      __pyx_L24:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1124</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1125</span>:             rts_view[n, k, 0] = t_particle + t_view[k] + smooth_u # Store rt</pre>
<pre class='cython code score-0 '>      __pyx_t_12 = __pyx_v_k;
      __pyx_t_24 = __pyx_v_n;
      __pyx_t_20 = __pyx_v_k;
      __pyx_t_26 = 0;
      *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_24 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_20 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_26 * __pyx_v_rts_view.strides[2]) )) = ((__pyx_v_t_particle + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_12 * __pyx_v_t_view.strides[0]) )))) + __pyx_v_smooth_u);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1126</span>:             choices_view[n, k, 0] = sign(y) # Store choice</pre>
<pre class='cython code score-5 '>      __pyx_t_27 = __pyx_f_4cssm_sign(__pyx_v_y); if (unlikely(__pyx_t_27 == ((int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1126, __pyx_L1_error)</span>
      __pyx_t_12 = __pyx_v_n;
      __pyx_t_26 = __pyx_v_k;
      __pyx_t_20 = 0;
      *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_12 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_26 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[2]) )) = __pyx_t_27;
</pre><pre class="cython line score-0">&#xA0;<span class="">1127</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1128</span>:             if (rts_view[n, k, 0] &gt;= deadline_view[k]) | (deadline_view[k] &lt;= 0):</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = __pyx_v_n;
      __pyx_t_26 = __pyx_v_k;
      __pyx_t_12 = 0;
      __pyx_t_24 = __pyx_v_k;
      __pyx_t_28 = __pyx_v_k;
      __pyx_t_19 = (((*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_20 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_26 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_12 * __pyx_v_rts_view.strides[2]) ))) &gt;= (*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_24 * __pyx_v_deadline_view.strides[0]) )))) | ((*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_28 * __pyx_v_deadline_view.strides[0]) ))) &lt;= 0.0));
      if (__pyx_t_19) {
/* … */
      }
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1129</span>:                 rts_view[n, k, 0] = -999</pre>
<pre class='cython code score-0 '>        __pyx_t_28 = __pyx_v_n;
        __pyx_t_24 = __pyx_v_k;
        __pyx_t_12 = 0;
        *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_28 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_24 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_12 * __pyx_v_rts_view.strides[2]) )) = -999.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1130</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1131</span>:     if return_option == 'full':</pre>
<pre class='cython code score-2 '>  __pyx_t_19 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_return_option, __pyx_n_u_full, Py_EQ)); if (unlikely((__pyx_t_19 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1131, __pyx_L1_error)</span>
  if (__pyx_t_19) {
/* … */
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1132</span>:         return {'rts': rts, 'choices': choices, 'metadata': {'v': v,</pre>
<pre class='cython code score-20 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1132, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1132, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1132, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1132, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_v, ((PyObject *)__pyx_v_v)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1132, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1133</span>:                                                             'a': a,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1132, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1134</span>:                                                             'z': z,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_z, ((PyObject *)__pyx_v_z)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1132, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1135</span>:                                                             't': t,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1132, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1136</span>:                                                             'alpha': alpha,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_alpha, ((PyObject *)__pyx_v_alpha)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1132, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1137</span>:                                                             's': s,</pre>
<pre class='cython code score-11 '>    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_s);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1137, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_s, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1132, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_10 = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1138</span>:                                                             **boundary_params,</pre>
<pre class='cython code score-17 '>    if (unlikely(__pyx_v_boundary_params == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
      <span class='error_goto'>__PYX_ERR(0, 1138, __pyx_L1_error)</span>
    }
    if (unlikely(<span class='py_c_api'>PyDict_Update</span>(__pyx_t_10, __pyx_v_boundary_params) &lt; 0)) {
      if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseMappingExpectedError</span>(__pyx_v_boundary_params);
      <span class='error_goto'>__PYX_ERR(0, 1138, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1139</span>:                                                             'delta_t': delta_t,</pre>
<pre class='cython code score-11 '>    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_t);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1139, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_delta_t, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1139, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1140</span>:                                                             'max_t': max_t,</pre>
<pre class='cython code score-11 '>    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_max_t);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1140, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_max_t, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1140, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1141</span>:                                                             'n_samples': n_samples,</pre>
<pre class='cython code score-8 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1141, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_n_samples, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1141, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1142</span>:                                                             'n_trials': n_trials,</pre>
<pre class='cython code score-13 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1142, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_n_trials, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1142, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_simulator, __pyx_n_u_levy_flexbound) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1143, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1143</span>:                                                             'simulator': 'levy_flexbound',</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1144</span>:                                                             'boundary_fun_type': boundary_fun.__name__,</pre>
<pre class='cython code score-8 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_boundary_fun, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1144, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_boundary_fun_type, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1144, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1145</span>:                                                             'possible_choices': [-1, 1],</pre>
<pre class='cython code score-17 '>    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1145, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_int_neg_1)) <span class='error_goto'>__PYX_ERR(0, 1145, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 1145, __pyx_L1_error)</span>;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_possible_choices, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1145, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1146</span>:                                                             'trajectory': traj,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_trajectory, __pyx_v_traj) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1146, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1147</span>:                                                             'boundary': boundary}}</pre>
<pre class='cython code score-11 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_boundary, __pyx_v_boundary) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1147, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_metadata, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1132, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_r = __pyx_t_5;
    __pyx_t_5 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1148</span>:     elif return_option == 'minimal':</pre>
<pre class='cython code score-2 '>  __pyx_t_19 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_return_option, __pyx_n_u_minimal, Py_EQ)); if (unlikely((__pyx_t_19 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1148, __pyx_L1_error)</span>
  if (likely(__pyx_t_19)) {
/* … */
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1149</span>:         return {'rts': rts, 'choices': choices,  'metadata': {'simulator': 'levy_flexbound',</pre>
<pre class='cython code score-20 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1149, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1149, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1149, __pyx_L1_error)</span>
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1149, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_simulator, __pyx_n_u_levy_flexbound) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1149, __pyx_L1_error)</span>
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1150</span>:                                                              'possible_choices': [-1, 1],</pre>
<pre class='cython code score-17 '>    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1150, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_int_neg_1)) <span class='error_goto'>__PYX_ERR(0, 1150, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 1150, __pyx_L1_error)</span>;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_possible_choices, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1149, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1151</span>:                                                              'boundary_fun_type': boundary_fun.__name__,</pre>
<pre class='cython code score-8 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_boundary_fun, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1151, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_boundary_fun_type, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1149, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1152</span>:                                                              'n_samples': n_samples,</pre>
<pre class='cython code score-8 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1152, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_n_samples, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1149, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1153</span>:                                                              'n_trials': n_trials,</pre>
<pre class='cython code score-14 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1153, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_n_trials, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1149, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_metadata, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1149, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_r = __pyx_t_5;
    __pyx_t_5 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1154</span>:                                                              }}</pre>
<pre class="cython line score-0">&#xA0;<span class="">1155</span>:     else:</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1156</span>:         raise ValueError('return_option must be either "full" or "minimal"')</pre>
<pre class='cython code score-5 '>  /*else*/ {
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1156, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_5, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1156, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1157</span>: # -------------------------------------------------------------------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1158</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1159</span>: # Simulate (rt, choice) tuples from: Full DDM with flexible bounds --------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1160</span>: # @cythonboundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1161</span>: # @cythonwraparound(False)</pre>
<pre class="cython line score-154" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1162</span>: def full_ddm(np.ndarray[float, ndim = 1] v, # = 0,</pre>
<pre class='cython code score-154 '>static PyObject *__pyx_pf_4cssm_52__defaults__(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_r = NULL;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
/* … */
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(11);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1162, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 2, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 3, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 4, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 5, Py_None)) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_True));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_True));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 6, ((PyObject *)Py_True))) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults3, __pyx_self)-&gt;__pyx_arg_boundary_params);
  <span class='refnanny'>__Pyx_GIVEREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults3, __pyx_self)-&gt;__pyx_arg_boundary_params);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 7, <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults3, __pyx_self)-&gt;__pyx_arg_boundary_params)) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 8, Py_None)) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject*)__pyx_n_u_full));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject*)__pyx_n_u_full));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 9, ((PyObject*)__pyx_n_u_full))) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_False));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_False));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 10, ((PyObject *)Py_False))) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1162, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 1, Py_None)) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L1_error)</span>;
  __pyx_t_6 = 0;
  __pyx_r = __pyx_t_5;
  __pyx_t_5 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.__defaults__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_4cssm_15full_ddm(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_4cssm_15full_ddm = {"full_ddm", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_4cssm_15full_ddm, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_4cssm_15full_ddm(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyArrayObject *__pyx_v_v = 0;
  PyArrayObject *__pyx_v_a = 0;
  PyArrayObject *__pyx_v_z = 0;
  PyArrayObject *__pyx_v_t = 0;
  PyArrayObject *__pyx_v_sz = 0;
  PyArrayObject *__pyx_v_sv = 0;
  PyArrayObject *__pyx_v_st = 0;
  PyArrayObject *__pyx_v_deadline = 0;
  float __pyx_v_s;
  float __pyx_v_delta_t;
  float __pyx_v_max_t;
  int __pyx_v_n_samples;
  int __pyx_v_n_trials;
  PyObject *__pyx_v_boundary_fun = 0;
  PyObject *__pyx_v_boundary_multiplicative = 0;
  PyObject *__pyx_v_boundary_params = 0;
  PyObject *__pyx_v_random_state = 0;
  PyObject *__pyx_v_return_option = 0;
  PyObject *__pyx_v_smooth = 0;
  CYTHON_UNUSED PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("full_ddm (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_v,&amp;__pyx_n_s_a,&amp;__pyx_n_s_z,&amp;__pyx_n_s_t,&amp;__pyx_n_s_sz,&amp;__pyx_n_s_sv,&amp;__pyx_n_s_st,&amp;__pyx_n_s_deadline,&amp;__pyx_n_s_s,&amp;__pyx_n_s_delta_t,&amp;__pyx_n_s_max_t,&amp;__pyx_n_s_n_samples,&amp;__pyx_n_s_n_trials,&amp;__pyx_n_s_boundary_fun,&amp;__pyx_n_s_boundary_multiplicative,&amp;__pyx_n_s_boundary_params,&amp;__pyx_n_s_random_state,&amp;__pyx_n_s_return_option,&amp;__pyx_n_s_smooth,0};
  PyObject* values[19] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    __pyx_defaults3 *__pyx_dynamic_args = <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults3, __pyx_self);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs);
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4cssm_14full_ddm(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_t, PyArrayObject *__pyx_v_sz, PyArrayObject *__pyx_v_sv, PyArrayObject *__pyx_v_st, PyArrayObject *__pyx_v_deadline, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state, PyObject *__pyx_v_return_option, PyObject *__pyx_v_smooth, CYTHON_UNUSED PyObject *__pyx_v_kwargs) {
  __Pyx_memviewslice __pyx_v_v_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_a_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_z_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_t_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_sz_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_sv_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_st_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_deadline_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_traj = NULL;
  __Pyx_memviewslice __pyx_v_traj_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_rts = NULL;
  PyObject *__pyx_v_choices = NULL;
  __Pyx_memviewslice __pyx_v_rts_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_choices_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  float __pyx_v_delta_t_sqrt;
  float __pyx_v_sqrt_st;
  int __pyx_v_num_draws;
  PyObject *__pyx_v_t_s = NULL;
  PyObject *__pyx_v_boundary = NULL;
  __Pyx_memviewslice __pyx_v_boundary_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  float __pyx_v_y;
  float __pyx_v_t_particle;
  float __pyx_v_t_tmp;
  float __pyx_v_smooth_u;
  float __pyx_v_deadline_tmp;
  Py_ssize_t __pyx_v_n;
  Py_ssize_t __pyx_v_ix;
  Py_ssize_t __pyx_v_k;
  Py_ssize_t __pyx_v_m;
  float __pyx_v_drift_increment;
  __Pyx_memviewslice __pyx_v_gaussian_values = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_boundary_params_tmp = NULL;
  PyObject *__pyx_8genexpr4__pyx_v_key = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_a;
  __Pyx_Buffer __pyx_pybuffer_a;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_deadline;
  __Pyx_Buffer __pyx_pybuffer_deadline;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_st;
  __Pyx_Buffer __pyx_pybuffer_st;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_sv;
  __Pyx_Buffer __pyx_pybuffer_sv;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_sz;
  __Pyx_Buffer __pyx_pybuffer_sz;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_t;
  __Pyx_Buffer __pyx_pybuffer_t;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_v;
  __Pyx_Buffer __pyx_pybuffer_v;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_z;
  __Pyx_Buffer __pyx_pybuffer_z;
  PyObject *__pyx_r = NULL;
  __pyx_pybuffer_v.pybuffer.buf = NULL;
  __pyx_pybuffer_v.refcount = 0;
  __pyx_pybuffernd_v.data = NULL;
  __pyx_pybuffernd_v.rcbuffer = &amp;__pyx_pybuffer_v;
  __pyx_pybuffer_a.pybuffer.buf = NULL;
  __pyx_pybuffer_a.refcount = 0;
  __pyx_pybuffernd_a.data = NULL;
  __pyx_pybuffernd_a.rcbuffer = &amp;__pyx_pybuffer_a;
  __pyx_pybuffer_z.pybuffer.buf = NULL;
  __pyx_pybuffer_z.refcount = 0;
  __pyx_pybuffernd_z.data = NULL;
  __pyx_pybuffernd_z.rcbuffer = &amp;__pyx_pybuffer_z;
  __pyx_pybuffer_t.pybuffer.buf = NULL;
  __pyx_pybuffer_t.refcount = 0;
  __pyx_pybuffernd_t.data = NULL;
  __pyx_pybuffernd_t.rcbuffer = &amp;__pyx_pybuffer_t;
  __pyx_pybuffer_sz.pybuffer.buf = NULL;
  __pyx_pybuffer_sz.refcount = 0;
  __pyx_pybuffernd_sz.data = NULL;
  __pyx_pybuffernd_sz.rcbuffer = &amp;__pyx_pybuffer_sz;
  __pyx_pybuffer_sv.pybuffer.buf = NULL;
  __pyx_pybuffer_sv.refcount = 0;
  __pyx_pybuffernd_sv.data = NULL;
  __pyx_pybuffernd_sv.rcbuffer = &amp;__pyx_pybuffer_sv;
  __pyx_pybuffer_st.pybuffer.buf = NULL;
  __pyx_pybuffer_st.refcount = 0;
  __pyx_pybuffernd_st.data = NULL;
  __pyx_pybuffernd_st.rcbuffer = &amp;__pyx_pybuffer_st;
  __pyx_pybuffer_deadline.pybuffer.buf = NULL;
  __pyx_pybuffer_deadline.refcount = 0;
  __pyx_pybuffernd_deadline.data = NULL;
  __pyx_pybuffernd_deadline.rcbuffer = &amp;__pyx_pybuffer_deadline;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_v, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_v.diminfo[0].strides = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_v.diminfo[0].shape = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_a, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_z, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_z.diminfo[0].strides = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_z.diminfo[0].shape = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_t, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_t.diminfo[0].strides = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_t.diminfo[0].shape = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_sz.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_sz, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_sz.diminfo[0].strides = __pyx_pybuffernd_sz.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_sz.diminfo[0].shape = __pyx_pybuffernd_sz.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_sv.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_sv, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_sv.diminfo[0].strides = __pyx_pybuffernd_sv.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_sv.diminfo[0].shape = __pyx_pybuffernd_sv.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_st.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_st, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_st.diminfo[0].strides = __pyx_pybuffernd_st.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_st.diminfo[0].shape = __pyx_pybuffernd_st.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_deadline, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_deadline.diminfo[0].strides = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_deadline.diminfo[0].shape = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.shape[0];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_2, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_9, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_st.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_sv.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_sz.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.full_ddm", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_st.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_sv.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_sz.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_v_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_a_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_z_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_t_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_sz_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_sv_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_st_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_deadline_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_traj);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_traj_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_choices);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_rts_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_choices_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t_s);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_boundary);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_boundary_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_boundary_params_tmp);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr4__pyx_v_key);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__37 = <span class='py_c_api'>PyTuple_Pack</span>(53, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_t, __pyx_n_s_sz, __pyx_n_s_sv, __pyx_n_s_st, __pyx_n_s_deadline, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_boundary_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_random_state, __pyx_n_s_return_option, __pyx_n_s_smooth, __pyx_n_s_kwargs, __pyx_n_s_v_view, __pyx_n_s_a_view, __pyx_n_s_z_view, __pyx_n_s_t_view, __pyx_n_s_sz_view, __pyx_n_s_sv_view, __pyx_n_s_st_view, __pyx_n_s_deadline_view, __pyx_n_s_traj, __pyx_n_s_traj_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_num_draws, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_boundary_view, __pyx_n_s_y, __pyx_n_s_t_particle, __pyx_n_s_t_tmp, __pyx_n_s_smooth_u, __pyx_n_s_deadline_tmp, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_drift_increment, __pyx_n_s_gaussian_values, __pyx_n_s_boundary_params_tmp, __pyx_n_s_key);<span class='error_goto'> if (unlikely(!__pyx_tuple__37)) __PYX_ERR(0, 1162, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__37);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__37);
/* … */
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_4cssm_15full_ddm, 0, __pyx_n_s_full_ddm, NULL, __pyx_n_s_cssm, __pyx_d, ((PyObject *)__pyx_codeobj__38));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1162, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (!<span class='pyx_c_api'>__Pyx_CyFunction_InitDefaults</span>(__pyx_t_5, sizeof(__pyx_defaults3), 1)) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L1_error)</span>
  __pyx_codeobj__38 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(19, 0, 0, 53, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__37, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_full_ddm, 1162, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__38)) __PYX_ERR(0, 1162, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1163</span>:              np.ndarray[float, ndim = 1] a, # = 1,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1164</span>:              np.ndarray[float, ndim = 1] z, # = 0.5,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1165</span>:              np.ndarray[float, ndim = 1] t, # = 0.0,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1166</span>:              np.ndarray[float, ndim = 1] sz, # = 0.05,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1167</span>:              np.ndarray[float, ndim = 1] sv, # = 0.1,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1168</span>:              np.ndarray[float, ndim = 1] st, # = 0.0,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1169</span>:              np.ndarray[float, ndim = 1] deadline,</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1170</span>:              float s = 1,</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)1.0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1170, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1171</span>:              float delta_t = 0.001,</pre>
<pre class='cython code score-5 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(((double)0.001));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1171, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1172</span>:              float max_t = 20,</pre>
<pre class='cython code score-5 '>  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)20.0));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1172, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1173</span>:              int n_samples = 20000,</pre>
<pre class='cython code score-2 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)0x4E20));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1173, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1174</span>:              int n_trials = 1,</pre>
<pre class='cython code score-2 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)1));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1174, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1175</span>:              boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)</pre>
<pre class='cython code score-6 '>    values[13] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[14] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_True)));
    values[15] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(__pyx_dynamic_args-&gt;__pyx_arg_boundary_params);
</pre><pre class="cython line score-0">&#xA0;<span class="">1176</span>:              boundary_multiplicative = True,</pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1177</span>:              boundary_params = {},</pre>
<pre class='cython code score-12 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1177, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults3, __pyx_t_5)-&gt;__pyx_arg_boundary_params = __pyx_t_4;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_4 = 0;
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsGetter</span>(__pyx_t_5, __pyx_pf_4cssm_52__defaults__);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_full_ddm, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-338" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1178</span>:              random_state = None,</pre>
<pre class='cython code score-338 '>    values[16] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[17] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_full)));
    values[18] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case 19: values[18] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 18);
        CYTHON_FALLTHROUGH;
        case 18: values[17] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 17);
        CYTHON_FALLTHROUGH;
        case 17: values[16] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 16);
        CYTHON_FALLTHROUGH;
        case 16: values[15] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 15);
        CYTHON_FALLTHROUGH;
        case 15: values[14] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_v)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_a)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("full_ddm", 0, 8, 19, 1); <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_z)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("full_ddm", 0, 8, 19, 2); <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_t)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[3]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("full_ddm", 0, 8, 19, 3); <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_sz)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[4]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("full_ddm", 0, 8, 19, 4); <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_sv)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[5]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("full_ddm", 0, 8, 19, 5); <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_st)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[6]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("full_ddm", 0, 8, 19, 6); <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (likely((values[7] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_deadline)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[7]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("full_ddm", 0, 8, 19, 7); <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_s);
          if (value) { values[8] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  9:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_delta_t);
          if (value) { values[9] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 10:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_max_t);
          if (value) { values[10] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 11:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_samples);
          if (value) { values[11] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 12:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_trials);
          if (value) { values[12] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 13:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_fun);
          if (value) { values[13] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 14:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_multiplicative);
          if (value) { values[14] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 15:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_params);
          if (value) { values[15] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 16:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_random_state);
          if (value) { values[16] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 17:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_return_option);
          if (value) { values[17] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 18:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_smooth);
          if (value) { values[18] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values + 0, kwd_pos_args, "full_ddm") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case 19: values[18] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 18);
        CYTHON_FALLTHROUGH;
        case 18: values[17] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 17);
        CYTHON_FALLTHROUGH;
        case 17: values[16] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 16);
        CYTHON_FALLTHROUGH;
        case 16: values[15] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 15);
        CYTHON_FALLTHROUGH;
        case 15: values[14] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_v = ((PyArrayObject *)values[0]);
    __pyx_v_a = ((PyArrayObject *)values[1]);
    __pyx_v_z = ((PyArrayObject *)values[2]);
    __pyx_v_t = ((PyArrayObject *)values[3]);
    __pyx_v_sz = ((PyArrayObject *)values[4]);
    __pyx_v_sv = ((PyArrayObject *)values[5]);
    __pyx_v_st = ((PyArrayObject *)values[6]);
    __pyx_v_deadline = ((PyArrayObject *)values[7]);
    if (values[8]) {
      __pyx_v_s = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[8]); if (unlikely((__pyx_v_s == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1170, __pyx_L3_error)</span>
    } else {
      __pyx_v_s = ((float)((float)1.0));
    }
    if (values[9]) {
      __pyx_v_delta_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[9]); if (unlikely((__pyx_v_delta_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1171, __pyx_L3_error)</span>
    } else {
      __pyx_v_delta_t = ((float)((double)0.001));
    }
    if (values[10]) {
      __pyx_v_max_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[10]); if (unlikely((__pyx_v_max_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1172, __pyx_L3_error)</span>
    } else {
      __pyx_v_max_t = ((float)((float)20.0));
    }
    if (values[11]) {
      __pyx_v_n_samples = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[11]); if (unlikely((__pyx_v_n_samples == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1173, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_samples = ((int)((int)0x4E20));
    }
    if (values[12]) {
      __pyx_v_n_trials = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[12]); if (unlikely((__pyx_v_n_trials == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1174, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_trials = ((int)((int)1));
    }
    __pyx_v_boundary_fun = values[13];
    __pyx_v_boundary_multiplicative = values[14];
    __pyx_v_boundary_params = values[15];
    __pyx_v_random_state = values[16];
    __pyx_v_return_option = values[17];
    __pyx_v_smooth = values[18];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("full_ddm", 0, 8, 19, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.full_ddm", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) <span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) <span class='error_goto'>__PYX_ERR(0, 1163, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) <span class='error_goto'>__PYX_ERR(0, 1164, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) <span class='error_goto'>__PYX_ERR(0, 1165, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_sz), __pyx_ptype_5numpy_ndarray, 1, "sz", 0))) <span class='error_goto'>__PYX_ERR(0, 1166, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_sv), __pyx_ptype_5numpy_ndarray, 1, "sv", 0))) <span class='error_goto'>__PYX_ERR(0, 1167, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_st), __pyx_ptype_5numpy_ndarray, 1, "st", 0))) <span class='error_goto'>__PYX_ERR(0, 1168, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_deadline), __pyx_ptype_5numpy_ndarray, 1, "deadline", 0))) <span class='error_goto'>__PYX_ERR(0, 1169, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_4cssm_14full_ddm(__pyx_self, __pyx_v_v, __pyx_v_a, __pyx_v_z, __pyx_v_t, __pyx_v_sz, __pyx_v_sv, __pyx_v_st, __pyx_v_deadline, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state, __pyx_v_return_option, __pyx_v_smooth, __pyx_v_kwargs);
</pre><pre class="cython line score-0">&#xA0;<span class="">1179</span>:              return_option = 'full',</pre>
<pre class="cython line score-0">&#xA0;<span class="">1180</span>:              smooth = False,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1181</span>:              **kwargs):</pre>
<pre class="cython line score-0">&#xA0;<span class="">1182</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1183</span>:     set_seed(random_state)</pre>
<pre class='cython code score-1 '>  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1183, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1184</span>:     # cdef int cov_length = np.max([v.size, a.size, w.size, t.size]).astype(int)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1185</span>:     # Param views</pre>
<pre class="cython line score-0">&#xA0;<span class="">1186</span>:     #set_random_state(random_state)</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1187</span>:     cdef float[:] v_view  = v</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_v), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1187, __pyx_L1_error)</span>
  __pyx_v_v_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1188</span>:     cdef float[:] a_view = a</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_a), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1188, __pyx_L1_error)</span>
  __pyx_v_a_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1189</span>:     cdef float[:] z_view = z</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_z), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1189, __pyx_L1_error)</span>
  __pyx_v_z_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1190</span>:     cdef float[:] t_view = t</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_t), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1190, __pyx_L1_error)</span>
  __pyx_v_t_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1191</span>:     cdef float[:] sz_view = sz</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_sz), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1191, __pyx_L1_error)</span>
  __pyx_v_sz_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1192</span>:     cdef float[:] sv_view = sv</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_sv), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1192, __pyx_L1_error)</span>
  __pyx_v_sv_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1193</span>:     cdef float[:] st_view = st</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_st), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1193, __pyx_L1_error)</span>
  __pyx_v_st_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1194</span>:     cdef float[:] deadline_view = deadline</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_deadline), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1194, __pyx_L1_error)</span>
  __pyx_v_deadline_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1195</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1196</span>:     # Data-structs for trajectory storage</pre>
<pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1197</span>:     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)</pre>
<pre class='cython code score-42 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1197, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1197, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_FromDouble</span>((__pyx_v_max_t / __pyx_v_delta_t));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1197, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_1, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1197, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1197, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1197, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 1197, __pyx_L1_error)</span>;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1197, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1197, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1197, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1197, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1197, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1197, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_traj = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1198</span>:     traj[:, :] = -999</pre>
<pre class='cython code score-5 '>  if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_traj, __pyx_tuple__12, __pyx_int_neg_999) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1198, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1199</span>:     cdef float[:, :] traj_view = traj</pre>
<pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(__pyx_v_traj, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1199, __pyx_L1_error)</span>
  __pyx_v_traj_view = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1200</span>: </pre>
<pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1201</span>:     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)</pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1201, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1201, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1201, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1201, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1201, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 1201, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1201, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 1201, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1201, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1201, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1201, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1201, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1201, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1201, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_rts = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1202</span>:     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)</pre>
<pre class='cython code score-46 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1202, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1202, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1202, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1202, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1202, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 1202, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1202, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 1202, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1202, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1202, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1202, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1202, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_intc);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1202, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1202, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1202, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_choices = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1203</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1204</span>:     cdef float[:, :, :] rts_view = rts</pre>
<pre class='cython code score-2 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_rts, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1204, __pyx_L1_error)</span>
  __pyx_v_rts_view = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1205</span>:     cdef int[:, :, :] choices_view = choices</pre>
<pre class='cython code score-2 '>  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_int</span>(__pyx_v_choices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1205, __pyx_L1_error)</span>
  __pyx_v_choices_view = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1206</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1207</span>:     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion</pre>
<pre class='cython code score-0 '>  __pyx_v_delta_t_sqrt = sqrt(__pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1208</span>:     cdef float sqrt_st = delta_t_sqrt * s # scalar to ensure the correct variance for the gaussian step</pre>
<pre class='cython code score-0 '>  __pyx_v_sqrt_st = (__pyx_v_delta_t_sqrt * __pyx_v_s);
</pre><pre class="cython line score-0">&#xA0;<span class="">1209</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1210</span>:     # Boundary storage for the upper bound</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1211</span>:     cdef int num_draws = int((max_t / delta_t) + 1)</pre>
<pre class='cython code score-0 '>  __pyx_v_num_draws = ((int)((__pyx_v_max_t / __pyx_v_delta_t) + 1.0));
</pre><pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1212</span>:     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)</pre>
<pre class='cython code score-51 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1212, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1212, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_max_t + __pyx_v_delta_t));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1212, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_t);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1212, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_10 = NULL;
  __pyx_t_11 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_10)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_11 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[4] = {__pyx_t_10, __pyx_int_0, __pyx_t_4, __pyx_t_5};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_11, 3+__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1212, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1212, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1212, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = NULL;
  __pyx_t_11 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_11 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_1};
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_11, 1+__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 1212, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_v_t_s = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1213</span>:     boundary = np.zeros(t_s.shape, dtype = DTYPE)</pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1213, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1213, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_t_s, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1213, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1213, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 1213, __pyx_L1_error)</span>;
  __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1213, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1213, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1213, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1213, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_v_boundary = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1214</span>:     cdef float[:] boundary_view = boundary</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(__pyx_v_boundary, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1214, __pyx_L1_error)</span>
  __pyx_v_boundary_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1215</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1216</span>:     cdef float y, t_particle, t_tmp, smooth_u, deadline_tmp</pre>
<pre class="cython line score-0">&#xA0;<span class="">1217</span>:     cdef Py_ssize_t n, ix, k</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1218</span>:     cdef Py_ssize_t m = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_m = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1219</span>:     cdef float drift_increment = 0.0</pre>
<pre class='cython code score-0 '>  __pyx_v_drift_increment = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1220</span>:     cdef float[:] gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1220, __pyx_L1_error)</span>
  __pyx_v_gaussian_values = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1221</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1222</span>:     # Loop over trials</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1223</span>:     for k in range(n_trials):</pre>
<pre class='cython code score-0 '>  __pyx_t_11 = __pyx_v_n_trials;
  __pyx_t_12 = __pyx_t_11;
  for (__pyx_t_13 = 0; __pyx_t_13 &lt; __pyx_t_12; __pyx_t_13+=1) {
    __pyx_v_k = __pyx_t_13;
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1224</span>:         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}</pre>
<pre class='cython code score-27 '>    { /* enter inner scope */
      __pyx_t_5 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1224, __pyx_L7_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_14 = 0;
      if (unlikely(__pyx_v_boundary_params == Py_None)) {
        <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "keys");
        <span class='error_goto'>__PYX_ERR(0, 1224, __pyx_L7_error)</span>
      }
      __pyx_t_1 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&amp;__pyx_t_15), (&amp;__pyx_t_16));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1224, __pyx_L7_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
      __pyx_t_7 = __pyx_t_1;
      __pyx_t_1 = 0;
      while (1) {
        __pyx_t_17 = __Pyx_dict_iter_next(__pyx_t_7, __pyx_t_15, &amp;__pyx_t_14, &amp;__pyx_t_1, NULL, NULL, __pyx_t_16);
        if (unlikely(__pyx_t_17 == 0)) break;
        if (unlikely(__pyx_t_17 == -1)) <span class='error_goto'>__PYX_ERR(0, 1224, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_8genexpr4__pyx_v_key, __pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_boundary_params, __pyx_8genexpr4__pyx_v_key);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1224, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1224, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, (PyObject*)__pyx_8genexpr4__pyx_v_key, (PyObject*)__pyx_t_3))) <span class='error_goto'>__PYX_ERR(0, 1224, __pyx_L7_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr4__pyx_v_key); __pyx_8genexpr4__pyx_v_key = 0;
      goto __pyx_L10_exit_scope;
      __pyx_L7_error:;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr4__pyx_v_key); __pyx_8genexpr4__pyx_v_key = 0;
      goto __pyx_L1_error;
      __pyx_L10_exit_scope:;
    } /* exit inner scope */
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_boundary_params_tmp, ((PyObject*)__pyx_t_5));
    __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1225</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1226</span>:         # Precompute boundary evaluations</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1227</span>:         if boundary_multiplicative:</pre>
<pre class='cython code score-2 '>    __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_boundary_multiplicative); if (unlikely((__pyx_t_18 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1227, __pyx_L1_error)</span>
    if (__pyx_t_18) {
/* … */
      goto __pyx_L11;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1228</span>:             # print(a)</pre>
<pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1229</span>:             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)</pre>
<pre class='cython code score-61 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1229, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_multiply);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1229, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_19 * __pyx_v_a_view.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1229, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1229, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_t, __pyx_v_t_s) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1229, __pyx_L1_error)</span>
      __pyx_t_4 = __pyx_t_10;
      __pyx_t_10 = 0;
      if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_4, __pyx_v_boundary_params_tmp) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1229, __pyx_L1_error)</span>
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1229, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_4, __pyx_t_3, __pyx_t_10};
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_16, 2+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 1229, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1229, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1229, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_10 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_10)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_10, __pyx_t_7};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_16, 1+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 1229, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_boundary, __pyx_t_5, 0, 0, NULL, NULL, &amp;__pyx_slice__5, 0, 0, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1229, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1230</span>:         else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">1231</span>:             # print(a)</pre>
<pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1232</span>:             boundary[:] = np.add(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)</pre>
<pre class='cython code score-61 '>    /*else*/ {
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1232, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_add);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1232, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_19 * __pyx_v_a_view.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1232, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1232, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_t, __pyx_v_t_s) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1232, __pyx_L1_error)</span>
      __pyx_t_3 = __pyx_t_4;
      __pyx_t_4 = 0;
      if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_3, __pyx_v_boundary_params_tmp) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1232, __pyx_L1_error)</span>
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1232, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
        __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
        if (likely(__pyx_t_3)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_t_7, __pyx_t_4};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_16, 2+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1232, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      }
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1232, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1232, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_4 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_1};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_16, 1+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 1232, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      }
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_boundary, __pyx_t_5, 0, 0, NULL, NULL, &amp;__pyx_slice__5, 0, 0, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1232, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
    __pyx_L11:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1233</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1234</span>:         deadline_tmp = min(max_t, deadline_view[k] - t_view[k])</pre>
<pre class='cython code score-0 '>    __pyx_t_19 = __pyx_v_k;
    __pyx_t_20 = __pyx_v_k;
    __pyx_t_21 = ((*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_19 * __pyx_v_deadline_view.strides[0]) ))) - (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_20 * __pyx_v_t_view.strides[0]) ))));
    __pyx_t_22 = __pyx_v_max_t;
    __pyx_t_18 = (__pyx_t_21 &lt; __pyx_t_22);
    if (__pyx_t_18) {
      __pyx_t_23 = __pyx_t_21;
    } else {
      __pyx_t_23 = __pyx_t_22;
    }
    __pyx_v_deadline_tmp = __pyx_t_23;
</pre><pre class="cython line score-0">&#xA0;<span class="">1235</span>:         # Loop over samples</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1236</span>:         for n in range(n_samples):</pre>
<pre class='cython code score-0 '>    __pyx_t_16 = __pyx_v_n_samples;
    __pyx_t_17 = __pyx_t_16;
    for (__pyx_t_15 = 0; __pyx_t_15 &lt; __pyx_t_17; __pyx_t_15+=1) {
      __pyx_v_n = __pyx_t_15;
</pre><pre class="cython line score-0">&#xA0;<span class="">1237</span>:             # initialize starting point</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1238</span>:             y = ((-1) * boundary_view[0]) + (z_view[k] * 2.0 * (boundary_view[0]))  # reset starting position</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = 0;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_24 = 0;
      __pyx_v_y = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_z_view.data + __pyx_t_19 * __pyx_v_z_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_24 * __pyx_v_boundary_view.strides[0]) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">1239</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1240</span>:             # get drift by random displacement of v</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1241</span>:             drift_increment = (v_view[k] + sv_view[k] * gaussian_values[m]) * delta_t</pre>
<pre class='cython code score-0 '>      __pyx_t_24 = __pyx_v_k;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_20 = __pyx_v_m;
      __pyx_v_drift_increment = (((*((float *) ( /* dim=0 */ (__pyx_v_v_view.data + __pyx_t_24 * __pyx_v_v_view.strides[0]) ))) + ((*((float *) ( /* dim=0 */ (__pyx_v_sv_view.data + __pyx_t_19 * __pyx_v_sv_view.strides[0]) ))) * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_20 * __pyx_v_gaussian_values.strides[0]) ))))) * __pyx_v_delta_t);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1242</span>:             t_tmp = t_view[k] + (2 * (random_uniform() - 0.5) * st_view[k])</pre>
<pre class='cython code score-5 '>      __pyx_t_20 = __pyx_v_k;
      __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1242, __pyx_L1_error)</span>
      __pyx_t_19 = __pyx_v_k;
      __pyx_v_t_tmp = ((*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_20 * __pyx_v_t_view.strides[0]) ))) + ((2.0 * (__pyx_t_23 - 0.5)) * (*((float *) ( /* dim=0 */ (__pyx_v_st_view.data + __pyx_t_19 * __pyx_v_st_view.strides[0]) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">1243</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1244</span>:             # apply uniform displacement on y</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1245</span>:             y += 2 * (random_uniform() - 0.5) * sz_view[k]</pre>
<pre class='cython code score-5 '>      __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1245, __pyx_L1_error)</span>
      __pyx_t_19 = __pyx_v_k;
      __pyx_v_y = (__pyx_v_y + ((2.0 * (__pyx_t_23 - 0.5)) * (*((float *) ( /* dim=0 */ (__pyx_v_sz_view.data + __pyx_t_19 * __pyx_v_sz_view.strides[0]) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">1246</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1247</span>:             # increment m appropriately</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1248</span>:             m += 1</pre>
<pre class='cython code score-0 '>      __pyx_v_m = (__pyx_v_m + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1249</span>:             if m == num_draws:</pre>
<pre class='cython code score-0 '>      __pyx_t_18 = (__pyx_v_m == __pyx_v_num_draws);
      if (__pyx_t_18) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1250</span>:                     gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>        __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1250, __pyx_L1_error)</span>
        __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
        __pyx_v_gaussian_values = __pyx_t_2;
        __pyx_t_2.memview = NULL;
        __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1251</span>:                     m = 0</pre>
<pre class='cython code score-0 '>        __pyx_v_m = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1252</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1253</span>:             t_particle = 0.0 # reset time</pre>
<pre class='cython code score-0 '>      __pyx_v_t_particle = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1254</span>:             ix = 0 # reset boundary index</pre>
<pre class='cython code score-0 '>      __pyx_v_ix = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1255</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1256</span>:             if n == 0:</pre>
<pre class='cython code score-0 '>      __pyx_t_18 = (__pyx_v_n == 0);
      if (__pyx_t_18) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1257</span>:                 if k == 0:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (__pyx_v_k == 0);
        if (__pyx_t_18) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1258</span>:                     traj_view[0, 0] = y</pre>
<pre class='cython code score-0 '>          __pyx_t_19 = 0;
          __pyx_t_20 = 0;
          *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_19 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_20 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y;
</pre><pre class="cython line score-0">&#xA0;<span class="">1259</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1260</span>:             # Random walker</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1261</span>:             while y &gt;= (-1) * boundary_view[ix] and y &lt;= boundary_view[ix] and t_particle &lt;= deadline_tmp:</pre>
<pre class='cython code score-0 '>      while (1) {
        __pyx_t_20 = __pyx_v_ix;
        __pyx_t_25 = (__pyx_v_y &gt;= (-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))));
        if (__pyx_t_25) {
        } else {
          __pyx_t_18 = __pyx_t_25;
          goto __pyx_L19_bool_binop_done;
        }
        __pyx_t_20 = __pyx_v_ix;
        __pyx_t_25 = (__pyx_v_y &lt;= (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) ))));
        if (__pyx_t_25) {
        } else {
          __pyx_t_18 = __pyx_t_25;
          goto __pyx_L19_bool_binop_done;
        }
        __pyx_t_25 = (__pyx_v_t_particle &lt;= __pyx_v_deadline_tmp);
        __pyx_t_18 = __pyx_t_25;
        __pyx_L19_bool_binop_done:;
        if (!__pyx_t_18) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1262</span>:                 y += drift_increment + (sqrt_st * gaussian_values[m])</pre>
<pre class='cython code score-0 '>        __pyx_t_20 = __pyx_v_m;
        __pyx_v_y = (__pyx_v_y + (__pyx_v_drift_increment + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_20 * __pyx_v_gaussian_values.strides[0]) ))))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1263</span>:                 t_particle += delta_t</pre>
<pre class='cython code score-0 '>        __pyx_v_t_particle = (__pyx_v_t_particle + __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1264</span>:                 ix += 1</pre>
<pre class='cython code score-0 '>        __pyx_v_ix = (__pyx_v_ix + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1265</span>:                 m += 1</pre>
<pre class='cython code score-0 '>        __pyx_v_m = (__pyx_v_m + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">1266</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1267</span>:                 if n == 0:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (__pyx_v_n == 0);
        if (__pyx_t_18) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1268</span>:                     if k == 0:</pre>
<pre class='cython code score-0 '>          __pyx_t_18 = (__pyx_v_k == 0);
          if (__pyx_t_18) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1269</span>:                         traj_view[ix, 0] = y</pre>
<pre class='cython code score-0 '>            __pyx_t_20 = __pyx_v_ix;
            __pyx_t_19 = 0;
            *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_20 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_19 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1270</span>:                 if m == num_draws:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (__pyx_v_m == __pyx_v_num_draws);
        if (__pyx_t_18) {
/* … */
        }
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1271</span>:                     gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1271, __pyx_L1_error)</span>
          __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
          __pyx_v_gaussian_values = __pyx_t_2;
          __pyx_t_2.memview = NULL;
          __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1272</span>:                     m = 0</pre>
<pre class='cython code score-0 '>          __pyx_v_m = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1273</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1274</span>:             if smooth:</pre>
<pre class='cython code score-2 '>      __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_smooth); if (unlikely((__pyx_t_18 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1274, __pyx_L1_error)</span>
      if (__pyx_t_18) {
/* … */
        goto __pyx_L25;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1275</span>:                 if t_particle == 0.0:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (__pyx_v_t_particle == 0.0);
        if (__pyx_t_18) {
/* … */
          goto __pyx_L26;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1276</span>:                     smooth_u = random_uniform() * 0.5 * delta_t</pre>
<pre class='cython code score-5 '>          __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1276, __pyx_L1_error)</span>
          __pyx_v_smooth_u = ((__pyx_t_23 * 0.5) * __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1277</span>:                 elif t_particle &lt; deadline_tmp:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (__pyx_v_t_particle &lt; __pyx_v_deadline_tmp);
        if (__pyx_t_18) {
/* … */
          goto __pyx_L26;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1278</span>:                     smooth_u = (0.5 - random_uniform()) * delta_t</pre>
<pre class='cython code score-5 '>          __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1278, __pyx_L1_error)</span>
          __pyx_v_smooth_u = ((0.5 - __pyx_t_23) * __pyx_v_delta_t);
</pre><pre class="cython line score-0">&#xA0;<span class="">1279</span>:                 else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1280</span>:                     smooth_u = 0.0</pre>
<pre class='cython code score-0 '>        /*else*/ {
          __pyx_v_smooth_u = 0.0;
        }
        __pyx_L26:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1281</span>:             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1282</span>:                 smooth_u = 0.0</pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_v_smooth_u = 0.0;
      }
      __pyx_L25:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1283</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1284</span>:             rts_view[n, k, 0] = t_particle + t_tmp + smooth_u # Store rt</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = __pyx_v_n;
      __pyx_t_20 = __pyx_v_k;
      __pyx_t_24 = 0;
      *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_19 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_20 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_24 * __pyx_v_rts_view.strides[2]) )) = ((__pyx_v_t_particle + __pyx_v_t_tmp) + __pyx_v_smooth_u);
</pre><pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1285</span>:             choices_view[n, k, 0] = np.sign(y) # Store choice</pre>
<pre class='cython code score-33 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_10, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1285, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_sign);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1285, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_y);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1285, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      __pyx_t_4 = NULL;
      __pyx_t_26 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
          __pyx_t_26 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_10};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_26, 1+__pyx_t_26);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 1285, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      __pyx_t_26 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_5); if (unlikely((__pyx_t_26 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1285, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_24 = __pyx_v_n;
      __pyx_t_20 = __pyx_v_k;
      __pyx_t_19 = 0;
      *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_24 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[2]) )) = __pyx_t_26;
</pre><pre class="cython line score-0">&#xA0;<span class="">1286</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1287</span>:             if (rts_view[n, k, 0] &gt;= deadline_view[k]) | (deadline_view[k] &lt;= 0):</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = __pyx_v_n;
      __pyx_t_20 = __pyx_v_k;
      __pyx_t_24 = 0;
      __pyx_t_27 = __pyx_v_k;
      __pyx_t_28 = __pyx_v_k;
      __pyx_t_18 = (((*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_19 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_20 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_24 * __pyx_v_rts_view.strides[2]) ))) &gt;= (*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_27 * __pyx_v_deadline_view.strides[0]) )))) | ((*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_28 * __pyx_v_deadline_view.strides[0]) ))) &lt;= 0.0));
      if (__pyx_t_18) {
/* … */
      }
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1288</span>:                 rts_view[n, k, 0] = -999</pre>
<pre class='cython code score-0 '>        __pyx_t_28 = __pyx_v_n;
        __pyx_t_27 = __pyx_v_k;
        __pyx_t_24 = 0;
        *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_28 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_27 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_24 * __pyx_v_rts_view.strides[2]) )) = -999.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1289</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1290</span>:     if return_option == 'full':</pre>
<pre class='cython code score-2 '>  __pyx_t_18 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_return_option, __pyx_n_u_full, Py_EQ)); if (unlikely((__pyx_t_18 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1290, __pyx_L1_error)</span>
  if (__pyx_t_18) {
/* … */
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1291</span>:         return {'rts': rts, 'choices': choices, 'metadata': {'v': v,</pre>
<pre class='cython code score-20 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1291, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1291, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1291, __pyx_L1_error)</span>
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(9);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1291, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_v, ((PyObject *)__pyx_v_v)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1291, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1292</span>:                                                             'a': a,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1291, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1293</span>:                                                             'z': z,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_z, ((PyObject *)__pyx_v_z)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1291, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1294</span>:                                                             't': t,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1291, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1295</span>:                                                             'sz': sz,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_sz, ((PyObject *)__pyx_v_sz)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1291, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1296</span>:                                                             'sv': sv,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_sv, ((PyObject *)__pyx_v_sv)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1291, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1297</span>:                                                             'st': st,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_st, ((PyObject *)__pyx_v_st)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1291, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1298</span>:                                                             'deadline': deadline,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_deadline, ((PyObject *)__pyx_v_deadline)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1291, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1299</span>:                                                             's': s,</pre>
<pre class='cython code score-11 '>    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_s);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1299, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_s, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1291, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_1 = __pyx_t_10;
    __pyx_t_10 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1300</span>:                                                             **boundary_params,</pre>
<pre class='cython code score-17 '>    if (unlikely(__pyx_v_boundary_params == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
      <span class='error_goto'>__PYX_ERR(0, 1300, __pyx_L1_error)</span>
    }
    if (unlikely(<span class='py_c_api'>PyDict_Update</span>(__pyx_t_1, __pyx_v_boundary_params) &lt; 0)) {
      if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseMappingExpectedError</span>(__pyx_v_boundary_params);
      <span class='error_goto'>__PYX_ERR(0, 1300, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1301</span>:                                                             'delta_t': delta_t,</pre>
<pre class='cython code score-11 '>    __pyx_t_10 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_t);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1301, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_delta_t, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1301, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1302</span>:                                                             'max_t': max_t,</pre>
<pre class='cython code score-11 '>    __pyx_t_10 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_max_t);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1302, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_max_t, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1302, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1303</span>:                                                             'n_samples': n_samples,</pre>
<pre class='cython code score-8 '>    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1303, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_n_samples, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1303, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1304</span>:                                                             'n_trials': n_trials,</pre>
<pre class='cython code score-13 '>    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1304, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_n_trials, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1304, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_simulator, __pyx_n_u_full_ddm) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1305, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1305</span>:                                                             'simulator': 'full_ddm',</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1306</span>:                                                             'boundary_fun_type': boundary_fun.__name__,</pre>
<pre class='cython code score-8 '>    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_boundary_fun, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1306, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_boundary_fun_type, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1306, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1307</span>:                                                             'possible_choices': [-1, 1],</pre>
<pre class='cython code score-17 '>    __pyx_t_10 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1307, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_10, 0, __pyx_int_neg_1)) <span class='error_goto'>__PYX_ERR(0, 1307, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_10, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 1307, __pyx_L1_error)</span>;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_possible_choices, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1307, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1308</span>:                                                             'trajectory': traj,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_trajectory, __pyx_v_traj) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1308, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1309</span>:                                                             'boundary': boundary}}</pre>
<pre class='cython code score-11 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_boundary, __pyx_v_boundary) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1309, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_metadata, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1291, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_r = __pyx_t_5;
    __pyx_t_5 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1310</span>:     elif return_option == 'minimal':</pre>
<pre class='cython code score-2 '>  __pyx_t_18 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_return_option, __pyx_n_u_minimal, Py_EQ)); if (unlikely((__pyx_t_18 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1310, __pyx_L1_error)</span>
  if (likely(__pyx_t_18)) {
/* … */
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1311</span>:         return {'rts': rts, 'choices': choices,  'metadata': {'simulator': 'full_ddm',</pre>
<pre class='cython code score-20 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1311, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1311, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1311, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1311, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_simulator, __pyx_n_u_full_ddm) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1311, __pyx_L1_error)</span>
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1312</span>:                                                              'possible_choices': [-1, 1],</pre>
<pre class='cython code score-17 '>    __pyx_t_10 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1312, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_10, 0, __pyx_int_neg_1)) <span class='error_goto'>__PYX_ERR(0, 1312, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_10, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 1312, __pyx_L1_error)</span>;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_possible_choices, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1311, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1313</span>:                                                              'boundary_fun_type': boundary_fun.__name__,</pre>
<pre class='cython code score-8 '>    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_boundary_fun, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1313, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_boundary_fun_type, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1311, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1314</span>:                                                              'n_samples': n_samples,</pre>
<pre class='cython code score-8 '>    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1314, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_n_samples, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1311, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1315</span>:                                                              'n_trials': n_trials,</pre>
<pre class='cython code score-14 '>    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1315, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_n_trials, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1311, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_metadata, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1311, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_r = __pyx_t_5;
    __pyx_t_5 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1316</span>:                                                              }}</pre>
<pre class="cython line score-0">&#xA0;<span class="">1317</span>:     else:</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1318</span>:         raise ValueError('return_option must be either "full" or "minimal"')</pre>
<pre class='cython code score-5 '>  /*else*/ {
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1318, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_5, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1318, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1319</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1320</span>: # -------------------------------------------------------------------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1321</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1322</span>: # Simulate (rt, choice) tuples from: Full DDM with flexible bounds --------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1323</span>: # @cythonboundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1324</span>: # @cythonwraparound(False)</pre>
<pre class="cython line score-142" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1325</span>: def ddm_sdv(np.ndarray[float, ndim = 1] v,</pre>
<pre class='cython code score-142 '>static PyObject *__pyx_pf_4cssm_54__defaults__(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_r = NULL;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
/* … */
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(11);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1325, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 2, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 3, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 4, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 5, Py_None)) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_True));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_True));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 6, ((PyObject *)Py_True))) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults4, __pyx_self)-&gt;__pyx_arg_boundary_params);
  <span class='refnanny'>__Pyx_GIVEREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults4, __pyx_self)-&gt;__pyx_arg_boundary_params);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 7, <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults4, __pyx_self)-&gt;__pyx_arg_boundary_params)) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 8, Py_None)) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject*)__pyx_n_u_full));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject*)__pyx_n_u_full));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 9, ((PyObject*)__pyx_n_u_full))) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_False));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_False));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 10, ((PyObject *)Py_False))) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1325, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 1, Py_None)) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L1_error)</span>;
  __pyx_t_6 = 0;
  __pyx_r = __pyx_t_5;
  __pyx_t_5 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.__defaults__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_4cssm_17ddm_sdv(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_4cssm_17ddm_sdv = {"ddm_sdv", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_4cssm_17ddm_sdv, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_4cssm_17ddm_sdv(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyArrayObject *__pyx_v_v = 0;
  PyArrayObject *__pyx_v_a = 0;
  PyArrayObject *__pyx_v_z = 0;
  PyArrayObject *__pyx_v_t = 0;
  PyArrayObject *__pyx_v_sv = 0;
  PyArrayObject *__pyx_v_deadline = 0;
  float __pyx_v_s;
  float __pyx_v_delta_t;
  float __pyx_v_max_t;
  int __pyx_v_n_samples;
  int __pyx_v_n_trials;
  PyObject *__pyx_v_boundary_fun = 0;
  PyObject *__pyx_v_boundary_multiplicative = 0;
  PyObject *__pyx_v_boundary_params = 0;
  PyObject *__pyx_v_random_state = 0;
  PyObject *__pyx_v_return_option = 0;
  PyObject *__pyx_v_smooth = 0;
  CYTHON_UNUSED PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("ddm_sdv (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_v,&amp;__pyx_n_s_a,&amp;__pyx_n_s_z,&amp;__pyx_n_s_t,&amp;__pyx_n_s_sv,&amp;__pyx_n_s_deadline,&amp;__pyx_n_s_s,&amp;__pyx_n_s_delta_t,&amp;__pyx_n_s_max_t,&amp;__pyx_n_s_n_samples,&amp;__pyx_n_s_n_trials,&amp;__pyx_n_s_boundary_fun,&amp;__pyx_n_s_boundary_multiplicative,&amp;__pyx_n_s_boundary_params,&amp;__pyx_n_s_random_state,&amp;__pyx_n_s_return_option,&amp;__pyx_n_s_smooth,0};
  PyObject* values[17] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    __pyx_defaults4 *__pyx_dynamic_args = <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults4, __pyx_self);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs);
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4cssm_16ddm_sdv(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_t, PyArrayObject *__pyx_v_sv, PyArrayObject *__pyx_v_deadline, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state, PyObject *__pyx_v_return_option, PyObject *__pyx_v_smooth, CYTHON_UNUSED PyObject *__pyx_v_kwargs) {
  PyObject *__pyx_v_traj = NULL;
  __Pyx_memviewslice __pyx_v_traj_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_v_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_a_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_z_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_t_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_sv_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_deadline_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_rts = NULL;
  PyObject *__pyx_v_choices = NULL;
  __Pyx_memviewslice __pyx_v_rts_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_choices_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  float __pyx_v_delta_t_sqrt;
  float __pyx_v_sqrt_st;
  int __pyx_v_num_draws;
  PyObject *__pyx_v_t_s = NULL;
  PyObject *__pyx_v_boundary = NULL;
  __Pyx_memviewslice __pyx_v_boundary_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  float __pyx_v_y;
  float __pyx_v_t_particle;
  float __pyx_v_smooth_u;
  float __pyx_v_deadline_tmp;
  Py_ssize_t __pyx_v_n;
  Py_ssize_t __pyx_v_ix;
  Py_ssize_t __pyx_v_k;
  Py_ssize_t __pyx_v_m;
  float __pyx_v_drift_increment;
  __Pyx_memviewslice __pyx_v_gaussian_values = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_boundary_params_tmp = NULL;
  PyObject *__pyx_8genexpr5__pyx_v_key = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_a;
  __Pyx_Buffer __pyx_pybuffer_a;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_deadline;
  __Pyx_Buffer __pyx_pybuffer_deadline;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_sv;
  __Pyx_Buffer __pyx_pybuffer_sv;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_t;
  __Pyx_Buffer __pyx_pybuffer_t;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_v;
  __Pyx_Buffer __pyx_pybuffer_v;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_z;
  __Pyx_Buffer __pyx_pybuffer_z;
  PyObject *__pyx_r = NULL;
  __pyx_pybuffer_v.pybuffer.buf = NULL;
  __pyx_pybuffer_v.refcount = 0;
  __pyx_pybuffernd_v.data = NULL;
  __pyx_pybuffernd_v.rcbuffer = &amp;__pyx_pybuffer_v;
  __pyx_pybuffer_a.pybuffer.buf = NULL;
  __pyx_pybuffer_a.refcount = 0;
  __pyx_pybuffernd_a.data = NULL;
  __pyx_pybuffernd_a.rcbuffer = &amp;__pyx_pybuffer_a;
  __pyx_pybuffer_z.pybuffer.buf = NULL;
  __pyx_pybuffer_z.refcount = 0;
  __pyx_pybuffernd_z.data = NULL;
  __pyx_pybuffernd_z.rcbuffer = &amp;__pyx_pybuffer_z;
  __pyx_pybuffer_t.pybuffer.buf = NULL;
  __pyx_pybuffer_t.refcount = 0;
  __pyx_pybuffernd_t.data = NULL;
  __pyx_pybuffernd_t.rcbuffer = &amp;__pyx_pybuffer_t;
  __pyx_pybuffer_sv.pybuffer.buf = NULL;
  __pyx_pybuffer_sv.refcount = 0;
  __pyx_pybuffernd_sv.data = NULL;
  __pyx_pybuffernd_sv.rcbuffer = &amp;__pyx_pybuffer_sv;
  __pyx_pybuffer_deadline.pybuffer.buf = NULL;
  __pyx_pybuffer_deadline.refcount = 0;
  __pyx_pybuffernd_deadline.data = NULL;
  __pyx_pybuffernd_deadline.rcbuffer = &amp;__pyx_pybuffer_deadline;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_v, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_v.diminfo[0].strides = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_v.diminfo[0].shape = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_a, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_z, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_z.diminfo[0].strides = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_z.diminfo[0].shape = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_t, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_t.diminfo[0].strides = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_t.diminfo[0].shape = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_sv.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_sv, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_sv.diminfo[0].strides = __pyx_pybuffernd_sv.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_sv.diminfo[0].shape = __pyx_pybuffernd_sv.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_deadline, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_deadline.diminfo[0].strides = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_deadline.diminfo[0].shape = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.shape[0];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_5, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_9, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_sv.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.ddm_sdv", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_sv.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_traj);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_traj_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_v_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_a_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_z_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_t_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_sv_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_deadline_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_choices);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_rts_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_choices_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t_s);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_boundary);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_boundary_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_boundary_params_tmp);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr5__pyx_v_key);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__39 = <span class='py_c_api'>PyTuple_Pack</span>(48, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_t, __pyx_n_s_sv, __pyx_n_s_deadline, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_boundary_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_random_state, __pyx_n_s_return_option, __pyx_n_s_smooth, __pyx_n_s_kwargs, __pyx_n_s_traj, __pyx_n_s_traj_view, __pyx_n_s_v_view, __pyx_n_s_a_view, __pyx_n_s_z_view, __pyx_n_s_t_view, __pyx_n_s_sv_view, __pyx_n_s_deadline_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_num_draws, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_boundary_view, __pyx_n_s_y, __pyx_n_s_t_particle, __pyx_n_s_smooth_u, __pyx_n_s_deadline_tmp, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_drift_increment, __pyx_n_s_gaussian_values, __pyx_n_s_boundary_params_tmp, __pyx_n_s_key);<span class='error_goto'> if (unlikely(!__pyx_tuple__39)) __PYX_ERR(0, 1325, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__39);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__39);
/* … */
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_4cssm_17ddm_sdv, 0, __pyx_n_s_ddm_sdv, NULL, __pyx_n_s_cssm, __pyx_d, ((PyObject *)__pyx_codeobj__40));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1325, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (!<span class='pyx_c_api'>__Pyx_CyFunction_InitDefaults</span>(__pyx_t_5, sizeof(__pyx_defaults4), 1)) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L1_error)</span>
  __pyx_codeobj__40 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(17, 0, 0, 48, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__39, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_ddm_sdv, 1325, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__40)) __PYX_ERR(0, 1325, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1326</span>:             np.ndarray[float, ndim = 1] a,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1327</span>:             np.ndarray[float, ndim = 1] z,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1328</span>:             np.ndarray[float, ndim = 1] t,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1329</span>:             np.ndarray[float, ndim = 1] sv,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1330</span>:             np.ndarray[float, ndim = 1] deadline,</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1331</span>:             float s = 1,</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)1.0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1331, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1332</span>:             float delta_t = 0.001,</pre>
<pre class='cython code score-5 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(((double)0.001));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1332, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1333</span>:             float max_t = 20,</pre>
<pre class='cython code score-5 '>  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)20.0));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1333, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1334</span>:             int n_samples = 20000,</pre>
<pre class='cython code score-2 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)0x4E20));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1334, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1335</span>:             int n_trials = 1,</pre>
<pre class='cython code score-2 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)1));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1335, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1336</span>:             boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)</pre>
<pre class='cython code score-6 '>    values[11] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[12] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_True)));
    values[13] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(__pyx_dynamic_args-&gt;__pyx_arg_boundary_params);
</pre><pre class="cython line score-0">&#xA0;<span class="">1337</span>:             boundary_multiplicative = True,</pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1338</span>:             boundary_params = {},</pre>
<pre class='cython code score-12 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1338, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults4, __pyx_t_5)-&gt;__pyx_arg_boundary_params = __pyx_t_4;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_4 = 0;
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsGetter</span>(__pyx_t_5, __pyx_pf_4cssm_54__defaults__);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_ddm_sdv, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-304" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1339</span>:             random_state = None,</pre>
<pre class='cython code score-304 '>    values[14] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[15] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_full)));
    values[16] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case 17: values[16] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 16);
        CYTHON_FALLTHROUGH;
        case 16: values[15] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 15);
        CYTHON_FALLTHROUGH;
        case 15: values[14] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_v)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_a)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_sdv", 0, 6, 17, 1); <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_z)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_sdv", 0, 6, 17, 2); <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_t)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[3]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_sdv", 0, 6, 17, 3); <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_sv)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[4]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_sdv", 0, 6, 17, 4); <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_deadline)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[5]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_sdv", 0, 6, 17, 5); <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_s);
          if (value) { values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_delta_t);
          if (value) { values[7] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_max_t);
          if (value) { values[8] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  9:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_samples);
          if (value) { values[9] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 10:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_trials);
          if (value) { values[10] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 11:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_fun);
          if (value) { values[11] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 12:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_multiplicative);
          if (value) { values[12] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 13:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_params);
          if (value) { values[13] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 14:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_random_state);
          if (value) { values[14] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 15:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_return_option);
          if (value) { values[15] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 16:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_smooth);
          if (value) { values[16] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values + 0, kwd_pos_args, "ddm_sdv") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case 17: values[16] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 16);
        CYTHON_FALLTHROUGH;
        case 16: values[15] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 15);
        CYTHON_FALLTHROUGH;
        case 15: values[14] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_v = ((PyArrayObject *)values[0]);
    __pyx_v_a = ((PyArrayObject *)values[1]);
    __pyx_v_z = ((PyArrayObject *)values[2]);
    __pyx_v_t = ((PyArrayObject *)values[3]);
    __pyx_v_sv = ((PyArrayObject *)values[4]);
    __pyx_v_deadline = ((PyArrayObject *)values[5]);
    if (values[6]) {
      __pyx_v_s = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[6]); if (unlikely((__pyx_v_s == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1331, __pyx_L3_error)</span>
    } else {
      __pyx_v_s = ((float)((float)1.0));
    }
    if (values[7]) {
      __pyx_v_delta_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[7]); if (unlikely((__pyx_v_delta_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1332, __pyx_L3_error)</span>
    } else {
      __pyx_v_delta_t = ((float)((double)0.001));
    }
    if (values[8]) {
      __pyx_v_max_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[8]); if (unlikely((__pyx_v_max_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1333, __pyx_L3_error)</span>
    } else {
      __pyx_v_max_t = ((float)((float)20.0));
    }
    if (values[9]) {
      __pyx_v_n_samples = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[9]); if (unlikely((__pyx_v_n_samples == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1334, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_samples = ((int)((int)0x4E20));
    }
    if (values[10]) {
      __pyx_v_n_trials = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[10]); if (unlikely((__pyx_v_n_trials == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1335, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_trials = ((int)((int)1));
    }
    __pyx_v_boundary_fun = values[11];
    __pyx_v_boundary_multiplicative = values[12];
    __pyx_v_boundary_params = values[13];
    __pyx_v_random_state = values[14];
    __pyx_v_return_option = values[15];
    __pyx_v_smooth = values[16];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_sdv", 0, 6, 17, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.ddm_sdv", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) <span class='error_goto'>__PYX_ERR(0, 1326, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) <span class='error_goto'>__PYX_ERR(0, 1327, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) <span class='error_goto'>__PYX_ERR(0, 1328, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_sv), __pyx_ptype_5numpy_ndarray, 1, "sv", 0))) <span class='error_goto'>__PYX_ERR(0, 1329, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_deadline), __pyx_ptype_5numpy_ndarray, 1, "deadline", 0))) <span class='error_goto'>__PYX_ERR(0, 1330, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_4cssm_16ddm_sdv(__pyx_self, __pyx_v_v, __pyx_v_a, __pyx_v_z, __pyx_v_t, __pyx_v_sv, __pyx_v_deadline, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state, __pyx_v_return_option, __pyx_v_smooth, __pyx_v_kwargs);
</pre><pre class="cython line score-0">&#xA0;<span class="">1340</span>:             return_option = 'full',</pre>
<pre class="cython line score-0">&#xA0;<span class="">1341</span>:             smooth = False,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1342</span>:             **kwargs):</pre>
<pre class="cython line score-0">&#xA0;<span class="">1343</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1344</span>:     set_seed(random_state)</pre>
<pre class='cython code score-1 '>  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1344, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1345</span>:     # Data-structs for trajectory storage</pre>
<pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1346</span>:     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)</pre>
<pre class='cython code score-42 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1346, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1346, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_FromDouble</span>((__pyx_v_max_t / __pyx_v_delta_t));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1346, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_1, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1346, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1346, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1346, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 1346, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1346, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1346, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1346, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1346, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1346, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1346, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_traj = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1347</span>:     traj[:, :] = -999</pre>
<pre class='cython code score-5 '>  if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_traj, __pyx_tuple__12, __pyx_int_neg_999) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1347, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1348</span>:     cdef float[:,:] traj_view = traj</pre>
<pre class='cython code score-2 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(__pyx_v_traj, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1348, __pyx_L1_error)</span>
  __pyx_v_traj_view = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1349</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1350</span>:     # Param views</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1351</span>:     cdef float[:] v_view  = v</pre>
<pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_v), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1351, __pyx_L1_error)</span>
  __pyx_v_v_view = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1352</span>:     cdef float[:] a_view = a</pre>
<pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_a), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1352, __pyx_L1_error)</span>
  __pyx_v_a_view = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1353</span>:     cdef float[:] z_view = z</pre>
<pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_z), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1353, __pyx_L1_error)</span>
  __pyx_v_z_view = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1354</span>:     cdef float[:] t_view = t</pre>
<pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_t), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1354, __pyx_L1_error)</span>
  __pyx_v_t_view = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1355</span>:     cdef float[:] sv_view = sv</pre>
<pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_sv), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1355, __pyx_L1_error)</span>
  __pyx_v_sv_view = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1356</span>:     cdef float[:] deadline_view = deadline</pre>
<pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_deadline), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1356, __pyx_L1_error)</span>
  __pyx_v_deadline_view = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1357</span>: </pre>
<pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1358</span>:     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)</pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1358, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1358, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1358, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1358, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1358, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1358, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1358, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 1358, __pyx_L1_error)</span>;
  __pyx_t_4 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1358, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1358, __pyx_L1_error)</span>;
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1358, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1358, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1358, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1358, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_rts = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1359</span>:     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)</pre>
<pre class='cython code score-46 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1359, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1359, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 1359, __pyx_L1_error)</span>;
  __pyx_t_4 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1359, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_intc);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1359, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_choices = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1360</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1361</span>:     cdef float[:, :, :] rts_view = rts</pre>
<pre class='cython code score-2 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_rts, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1361, __pyx_L1_error)</span>
  __pyx_v_rts_view = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1362</span>:     cdef int[:, :, :] choices_view = choices</pre>
<pre class='cython code score-2 '>  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_int</span>(__pyx_v_choices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1362, __pyx_L1_error)</span>
  __pyx_v_choices_view = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1363</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1364</span>:     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion</pre>
<pre class='cython code score-0 '>  __pyx_v_delta_t_sqrt = sqrt(__pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1365</span>:     cdef float sqrt_st = delta_t_sqrt * s # scalar to ensure the correct variance for the gaussian step</pre>
<pre class='cython code score-0 '>  __pyx_v_sqrt_st = (__pyx_v_delta_t_sqrt * __pyx_v_s);
</pre><pre class="cython line score-0">&#xA0;<span class="">1366</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1367</span>:     # Boundary storage for the upper bound</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1368</span>:     cdef int num_draws = int((max_t / delta_t) + 1)</pre>
<pre class='cython code score-0 '>  __pyx_v_num_draws = ((int)((__pyx_v_max_t / __pyx_v_delta_t) + 1.0));
</pre><pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1369</span>:     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)</pre>
<pre class='cython code score-51 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1369, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1369, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_max_t + __pyx_v_delta_t));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1369, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_t);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1369, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_10 = NULL;
  __pyx_t_11 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_10)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_11 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[4] = {__pyx_t_10, __pyx_int_0, __pyx_t_3, __pyx_t_4};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_11, 3+__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1369, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1369, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1369, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = NULL;
  __pyx_t_11 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_11 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_1};
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_11, 1+__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 1369, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_v_t_s = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1370</span>:     boundary = np.zeros(t_s.shape, dtype = DTYPE)</pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1370, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1370, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_t_s, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1370, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1370, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 1370, __pyx_L1_error)</span>;
  __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1370, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1370, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1370, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1370, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_v_boundary = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1371</span>:     cdef float[:] boundary_view = boundary</pre>
<pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(__pyx_v_boundary, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1371, __pyx_L1_error)</span>
  __pyx_v_boundary_view = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1372</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1373</span>:     cdef float y, t_particle, smooth_u, deadline_tmp</pre>
<pre class="cython line score-0">&#xA0;<span class="">1374</span>:     cdef Py_ssize_t n, ix, k</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1375</span>:     cdef Py_ssize_t m = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_m = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1376</span>:     cdef float drift_increment = 0.0</pre>
<pre class='cython code score-0 '>  __pyx_v_drift_increment = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1377</span>:     cdef float[:] gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1377, __pyx_L1_error)</span>
  __pyx_v_gaussian_values = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1378</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1379</span>:     for k in range(n_trials):</pre>
<pre class='cython code score-0 '>  __pyx_t_11 = __pyx_v_n_trials;
  __pyx_t_12 = __pyx_t_11;
  for (__pyx_t_13 = 0; __pyx_t_13 &lt; __pyx_t_12; __pyx_t_13+=1) {
    __pyx_v_k = __pyx_t_13;
</pre><pre class="cython line score-0">&#xA0;<span class="">1380</span>:         # Precompute boundary evaluations</pre>
<pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1381</span>:         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}</pre>
<pre class='cython code score-27 '>    { /* enter inner scope */
      __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1381, __pyx_L7_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_14 = 0;
      if (unlikely(__pyx_v_boundary_params == Py_None)) {
        <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "keys");
        <span class='error_goto'>__PYX_ERR(0, 1381, __pyx_L7_error)</span>
      }
      __pyx_t_1 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&amp;__pyx_t_15), (&amp;__pyx_t_16));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1381, __pyx_L7_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
      __pyx_t_7 = __pyx_t_1;
      __pyx_t_1 = 0;
      while (1) {
        __pyx_t_17 = __Pyx_dict_iter_next(__pyx_t_7, __pyx_t_15, &amp;__pyx_t_14, &amp;__pyx_t_1, NULL, NULL, __pyx_t_16);
        if (unlikely(__pyx_t_17 == 0)) break;
        if (unlikely(__pyx_t_17 == -1)) <span class='error_goto'>__PYX_ERR(0, 1381, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_8genexpr5__pyx_v_key, __pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_boundary_params, __pyx_8genexpr5__pyx_v_key);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1381, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1381, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, (PyObject*)__pyx_8genexpr5__pyx_v_key, (PyObject*)__pyx_t_2))) <span class='error_goto'>__PYX_ERR(0, 1381, __pyx_L7_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr5__pyx_v_key); __pyx_8genexpr5__pyx_v_key = 0;
      goto __pyx_L10_exit_scope;
      __pyx_L7_error:;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr5__pyx_v_key); __pyx_8genexpr5__pyx_v_key = 0;
      goto __pyx_L1_error;
      __pyx_L10_exit_scope:;
    } /* exit inner scope */
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_boundary_params_tmp, ((PyObject*)__pyx_t_4));
    __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1382</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1383</span>:         if boundary_multiplicative:</pre>
<pre class='cython code score-2 '>    __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_boundary_multiplicative); if (unlikely((__pyx_t_18 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1383, __pyx_L1_error)</span>
    if (__pyx_t_18) {
/* … */
      goto __pyx_L11;
    }
</pre><pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1384</span>:             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)</pre>
<pre class='cython code score-61 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1384, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_multiply);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1384, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_19 * __pyx_v_a_view.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1384, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1384, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_t, __pyx_v_t_s) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1384, __pyx_L1_error)</span>
      __pyx_t_3 = __pyx_t_10;
      __pyx_t_10 = 0;
      if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_3, __pyx_v_boundary_params_tmp) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1384, __pyx_L1_error)</span>
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1384, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_3)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_t_2, __pyx_t_10};
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_16, 2+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 1384, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1384, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1384, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_10 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_10)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_10, __pyx_t_7};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_16, 1+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1384, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_boundary, __pyx_t_4, 0, 0, NULL, NULL, &amp;__pyx_slice__5, 0, 0, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1384, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1385</span>:         else:</pre>
<pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1386</span>:             boundary[:] = np.add(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)</pre>
<pre class='cython code score-61 '>    /*else*/ {
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1386, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_add);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1386, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_19 * __pyx_v_a_view.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1386, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1386, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_t, __pyx_v_t_s) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1386, __pyx_L1_error)</span>
      __pyx_t_2 = __pyx_t_3;
      __pyx_t_3 = 0;
      if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_2, __pyx_v_boundary_params_tmp) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1386, __pyx_L1_error)</span>
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1386, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
        __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
        if (likely(__pyx_t_2)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_2, __pyx_t_7, __pyx_t_3};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_16, 2+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1386, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      }
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1386, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1386, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_3 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
        __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
        if (likely(__pyx_t_3)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_1};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_16, 1+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1386, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      }
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_boundary, __pyx_t_4, 0, 0, NULL, NULL, &amp;__pyx_slice__5, 0, 0, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1386, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    __pyx_L11:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1387</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1388</span>:         deadline_tmp = min(max_t, deadline_view[k] - t_view[k])</pre>
<pre class='cython code score-0 '>    __pyx_t_19 = __pyx_v_k;
    __pyx_t_20 = __pyx_v_k;
    __pyx_t_21 = ((*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_19 * __pyx_v_deadline_view.strides[0]) ))) - (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_20 * __pyx_v_t_view.strides[0]) ))));
    __pyx_t_22 = __pyx_v_max_t;
    __pyx_t_18 = (__pyx_t_21 &lt; __pyx_t_22);
    if (__pyx_t_18) {
      __pyx_t_23 = __pyx_t_21;
    } else {
      __pyx_t_23 = __pyx_t_22;
    }
    __pyx_v_deadline_tmp = __pyx_t_23;
</pre><pre class="cython line score-0">&#xA0;<span class="">1389</span>:         # Loop over samples</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1390</span>:         for n in range(n_samples):</pre>
<pre class='cython code score-0 '>    __pyx_t_16 = __pyx_v_n_samples;
    __pyx_t_17 = __pyx_t_16;
    for (__pyx_t_15 = 0; __pyx_t_15 &lt; __pyx_t_17; __pyx_t_15+=1) {
      __pyx_v_n = __pyx_t_15;
</pre><pre class="cython line score-0">&#xA0;<span class="">1391</span>:             # initialize starting point</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1392</span>:             y = ((-1) * boundary_view[0]) + (z_view[k] * 2.0 * (boundary_view[0]))  # reset starting position</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = 0;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_24 = 0;
      __pyx_v_y = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_z_view.data + __pyx_t_19 * __pyx_v_z_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_24 * __pyx_v_boundary_view.strides[0]) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">1393</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1394</span>:             # get drift by random displacement of v</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1395</span>:             drift_increment = (v_view[k] + sv_view[k] * gaussian_values[m]) * delta_t</pre>
<pre class='cython code score-0 '>      __pyx_t_24 = __pyx_v_k;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_20 = __pyx_v_m;
      __pyx_v_drift_increment = (((*((float *) ( /* dim=0 */ (__pyx_v_v_view.data + __pyx_t_24 * __pyx_v_v_view.strides[0]) ))) + ((*((float *) ( /* dim=0 */ (__pyx_v_sv_view.data + __pyx_t_19 * __pyx_v_sv_view.strides[0]) ))) * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_20 * __pyx_v_gaussian_values.strides[0]) ))))) * __pyx_v_delta_t);
</pre><pre class="cython line score-0">&#xA0;<span class="">1396</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1397</span>:             # increment m appropriately</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1398</span>:             m += 1</pre>
<pre class='cython code score-0 '>      __pyx_v_m = (__pyx_v_m + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1399</span>:             if m == num_draws:</pre>
<pre class='cython code score-0 '>      __pyx_t_18 = (__pyx_v_m == __pyx_v_num_draws);
      if (__pyx_t_18) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1400</span>:                     gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>        __pyx_t_6 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1400, __pyx_L1_error)</span>
        __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
        __pyx_v_gaussian_values = __pyx_t_6;
        __pyx_t_6.memview = NULL;
        __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1401</span>:                     m = 0</pre>
<pre class='cython code score-0 '>        __pyx_v_m = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1402</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1403</span>:             t_particle = 0.0 # reset time</pre>
<pre class='cython code score-0 '>      __pyx_v_t_particle = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1404</span>:             ix = 0 # reset boundary index</pre>
<pre class='cython code score-0 '>      __pyx_v_ix = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1405</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1406</span>:             if n == 0:</pre>
<pre class='cython code score-0 '>      __pyx_t_18 = (__pyx_v_n == 0);
      if (__pyx_t_18) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1407</span>:                 if k == 0:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (__pyx_v_k == 0);
        if (__pyx_t_18) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1408</span>:                     traj_view[0, 0] = y</pre>
<pre class='cython code score-0 '>          __pyx_t_20 = 0;
          __pyx_t_19 = 0;
          *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_20 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_19 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y;
</pre><pre class="cython line score-0">&#xA0;<span class="">1409</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1410</span>:             # Random walker</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1411</span>:             while y &gt;= (-1) * boundary_view[ix] and y &lt;= boundary_view[ix] and t_particle &lt;= deadline_tmp:</pre>
<pre class='cython code score-0 '>      while (1) {
        __pyx_t_19 = __pyx_v_ix;
        __pyx_t_25 = (__pyx_v_y &gt;= (-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))));
        if (__pyx_t_25) {
        } else {
          __pyx_t_18 = __pyx_t_25;
          goto __pyx_L19_bool_binop_done;
        }
        __pyx_t_19 = __pyx_v_ix;
        __pyx_t_25 = (__pyx_v_y &lt;= (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) ))));
        if (__pyx_t_25) {
        } else {
          __pyx_t_18 = __pyx_t_25;
          goto __pyx_L19_bool_binop_done;
        }
        __pyx_t_25 = (__pyx_v_t_particle &lt;= __pyx_v_deadline_tmp);
        __pyx_t_18 = __pyx_t_25;
        __pyx_L19_bool_binop_done:;
        if (!__pyx_t_18) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1412</span>:                 y += drift_increment + (sqrt_st * gaussian_values[m])</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = __pyx_v_m;
        __pyx_v_y = (__pyx_v_y + (__pyx_v_drift_increment + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_19 * __pyx_v_gaussian_values.strides[0]) ))))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1413</span>:                 t_particle += delta_t</pre>
<pre class='cython code score-0 '>        __pyx_v_t_particle = (__pyx_v_t_particle + __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1414</span>:                 ix += 1</pre>
<pre class='cython code score-0 '>        __pyx_v_ix = (__pyx_v_ix + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1415</span>:                 m += 1</pre>
<pre class='cython code score-0 '>        __pyx_v_m = (__pyx_v_m + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">1416</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1417</span>:                 if n == 0:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (__pyx_v_n == 0);
        if (__pyx_t_18) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1418</span>:                     if k == 0:</pre>
<pre class='cython code score-0 '>          __pyx_t_18 = (__pyx_v_k == 0);
          if (__pyx_t_18) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1419</span>:                         traj_view[ix, 0] = y</pre>
<pre class='cython code score-0 '>            __pyx_t_19 = __pyx_v_ix;
            __pyx_t_20 = 0;
            *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_19 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_20 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y;
</pre><pre class="cython line score-0">&#xA0;<span class="">1420</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1421</span>:                 if m == num_draws:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (__pyx_v_m == __pyx_v_num_draws);
        if (__pyx_t_18) {
/* … */
        }
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1422</span>:                     gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>          __pyx_t_6 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1422, __pyx_L1_error)</span>
          __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
          __pyx_v_gaussian_values = __pyx_t_6;
          __pyx_t_6.memview = NULL;
          __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1423</span>:                     m = 0</pre>
<pre class='cython code score-0 '>          __pyx_v_m = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1424</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1425</span>:             if smooth:</pre>
<pre class='cython code score-2 '>      __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_smooth); if (unlikely((__pyx_t_18 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1425, __pyx_L1_error)</span>
      if (__pyx_t_18) {
/* … */
        goto __pyx_L25;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1426</span>:                 if t_particle == 0.0:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (__pyx_v_t_particle == 0.0);
        if (__pyx_t_18) {
/* … */
          goto __pyx_L26;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1427</span>:                     smooth_u = random_uniform() * 0.5 * delta_t</pre>
<pre class='cython code score-5 '>          __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1427, __pyx_L1_error)</span>
          __pyx_v_smooth_u = ((__pyx_t_23 * 0.5) * __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1428</span>:                 elif t_particle &lt; deadline_tmp:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (__pyx_v_t_particle &lt; __pyx_v_deadline_tmp);
        if (__pyx_t_18) {
/* … */
          goto __pyx_L26;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1429</span>:                     smooth_u = (0.5 - random_uniform()) * delta_t</pre>
<pre class='cython code score-5 '>          __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1429, __pyx_L1_error)</span>
          __pyx_v_smooth_u = ((0.5 - __pyx_t_23) * __pyx_v_delta_t);
</pre><pre class="cython line score-0">&#xA0;<span class="">1430</span>:                 else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1431</span>:                     smooth_u = 0.0</pre>
<pre class='cython code score-0 '>        /*else*/ {
          __pyx_v_smooth_u = 0.0;
        }
        __pyx_L26:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1432</span>:             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1433</span>:                 smooth_u = 0.0</pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_v_smooth_u = 0.0;
      }
      __pyx_L25:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1434</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1435</span>:             rts_view[n, k, 0] = t_particle + t_view[k] + smooth_u # Store rt</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = __pyx_v_k;
      __pyx_t_19 = __pyx_v_n;
      __pyx_t_24 = __pyx_v_k;
      __pyx_t_26 = 0;
      *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_19 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_24 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_26 * __pyx_v_rts_view.strides[2]) )) = ((__pyx_v_t_particle + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_20 * __pyx_v_t_view.strides[0]) )))) + __pyx_v_smooth_u);
</pre><pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1436</span>:             choices_view[n, k, 0] = np.sign(y) # Store choice</pre>
<pre class='cython code score-33 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_10, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1436, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_sign);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1436, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_y);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1436, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      __pyx_t_3 = NULL;
      __pyx_t_27 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_3)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
          __pyx_t_27 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_10};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_27, 1+__pyx_t_27);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1436, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      __pyx_t_27 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_4); if (unlikely((__pyx_t_27 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1436, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_20 = __pyx_v_n;
      __pyx_t_26 = __pyx_v_k;
      __pyx_t_24 = 0;
      *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_20 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_26 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[2]) )) = __pyx_t_27;
</pre><pre class="cython line score-0">&#xA0;<span class="">1437</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1438</span>:             if (rts_view[n, k, 0] &gt;= deadline_view[k]) | (deadline_view[k] &lt;= 0):</pre>
<pre class='cython code score-0 '>      __pyx_t_24 = __pyx_v_n;
      __pyx_t_26 = __pyx_v_k;
      __pyx_t_20 = 0;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_28 = __pyx_v_k;
      __pyx_t_18 = (((*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_24 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_26 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_20 * __pyx_v_rts_view.strides[2]) ))) &gt;= (*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_19 * __pyx_v_deadline_view.strides[0]) )))) | ((*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_28 * __pyx_v_deadline_view.strides[0]) ))) &lt;= 0.0));
      if (__pyx_t_18) {
/* … */
      }
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1439</span>:                 rts_view[n, k, 0] = -999</pre>
<pre class='cython code score-0 '>        __pyx_t_28 = __pyx_v_n;
        __pyx_t_19 = __pyx_v_k;
        __pyx_t_20 = 0;
        *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_28 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_19 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_20 * __pyx_v_rts_view.strides[2]) )) = -999.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1440</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1441</span>:     if return_option == 'full':</pre>
<pre class='cython code score-2 '>  __pyx_t_18 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_return_option, __pyx_n_u_full, Py_EQ)); if (unlikely((__pyx_t_18 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1441, __pyx_L1_error)</span>
  if (__pyx_t_18) {
/* … */
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1442</span>:         return { 'rts': rts, 'choices': choices, 'metadata': {'v': v,</pre>
<pre class='cython code score-20 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1442, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1442, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1442, __pyx_L1_error)</span>
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1442, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_v, ((PyObject *)__pyx_v_v)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1442, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1443</span>:                                                             'a': a,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1442, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1444</span>:                                                             'z': z,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_z, ((PyObject *)__pyx_v_z)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1442, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1445</span>:                                                             't': t,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1442, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1446</span>:                                                             'sv': sv,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_sv, ((PyObject *)__pyx_v_sv)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1442, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1447</span>:                                                             'deadline': deadline,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_deadline, ((PyObject *)__pyx_v_deadline)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1442, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1448</span>:                                                             's': s,</pre>
<pre class='cython code score-11 '>    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_s);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1448, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_s, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1442, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_1 = __pyx_t_10;
    __pyx_t_10 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1449</span>:                                                             **boundary_params,</pre>
<pre class='cython code score-17 '>    if (unlikely(__pyx_v_boundary_params == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
      <span class='error_goto'>__PYX_ERR(0, 1449, __pyx_L1_error)</span>
    }
    if (unlikely(<span class='py_c_api'>PyDict_Update</span>(__pyx_t_1, __pyx_v_boundary_params) &lt; 0)) {
      if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseMappingExpectedError</span>(__pyx_v_boundary_params);
      <span class='error_goto'>__PYX_ERR(0, 1449, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1450</span>:                                                             'delta_t': delta_t,</pre>
<pre class='cython code score-11 '>    __pyx_t_10 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_t);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1450, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_delta_t, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1450, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1451</span>:                                                             'max_t': max_t,</pre>
<pre class='cython code score-11 '>    __pyx_t_10 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_max_t);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1451, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_max_t, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1451, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1452</span>:                                                             'n_samples': n_samples,</pre>
<pre class='cython code score-8 '>    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1452, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_n_samples, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1452, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1453</span>:                                                             'n_trials': n_trials,</pre>
<pre class='cython code score-13 '>    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1453, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_n_trials, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1453, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_simulator, __pyx_n_u_ddm_sdv) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1454, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1454</span>:                                                             'simulator': 'ddm_sdv',</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1455</span>:                                                             'boundary_fun_type': boundary_fun.__name__,</pre>
<pre class='cython code score-8 '>    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_boundary_fun, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1455, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_boundary_fun_type, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1455, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1456</span>:                                                             'possible_choices': [-1, 1],</pre>
<pre class='cython code score-17 '>    __pyx_t_10 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1456, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_10, 0, __pyx_int_neg_1)) <span class='error_goto'>__PYX_ERR(0, 1456, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_10, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 1456, __pyx_L1_error)</span>;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_possible_choices, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1456, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1457</span>:                                                             'trajectory': traj,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_trajectory, __pyx_v_traj) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1457, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1458</span>:                                                             'boundary': boundary}}</pre>
<pre class='cython code score-11 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_boundary, __pyx_v_boundary) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1458, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_metadata, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1442, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1459</span>:     elif return_option == 'minimal':</pre>
<pre class='cython code score-2 '>  __pyx_t_18 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_return_option, __pyx_n_u_minimal, Py_EQ)); if (unlikely((__pyx_t_18 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1459, __pyx_L1_error)</span>
  if (likely(__pyx_t_18)) {
/* … */
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1460</span>:         return {'rts': rts, 'choices': choices,  'metadata': {'simulator': 'ddm_sdv',</pre>
<pre class='cython code score-20 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1460, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1460, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1460, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1460, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_simulator, __pyx_n_u_ddm_sdv) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1460, __pyx_L1_error)</span>
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1461</span>:                                                              'possible_choices': [-1, 1],</pre>
<pre class='cython code score-17 '>    __pyx_t_10 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1461, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_10, 0, __pyx_int_neg_1)) <span class='error_goto'>__PYX_ERR(0, 1461, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_10, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 1461, __pyx_L1_error)</span>;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_possible_choices, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1460, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1462</span>:                                                              'boundary_fun_type': boundary_fun.__name__,</pre>
<pre class='cython code score-8 '>    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_boundary_fun, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1462, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_boundary_fun_type, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1460, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1463</span>:                                                              'n_samples': n_samples,</pre>
<pre class='cython code score-8 '>    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1463, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_n_samples, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1460, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1464</span>:                                                              'n_trials': n_trials,</pre>
<pre class='cython code score-14 '>    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1464, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_n_trials, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1460, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_metadata, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1460, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1465</span>:                                                              }}</pre>
<pre class="cython line score-0">&#xA0;<span class="">1466</span>:     else:</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1467</span>:         raise ValueError('return_option must be either "full" or "minimal"')</pre>
<pre class='cython code score-5 '>  /*else*/ {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1467, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_4, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1467, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1468</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1469</span>: # -------------------------------------------------------------------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1470</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1471</span>: # Simulate (rt, choice) tuples from: Onstein-Uhlenbeck with flexible bounds -----------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1472</span>: # @cythonboundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1473</span>: # @cythonwraparound(False)</pre>
<pre class="cython line score-142" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1474</span>: def ornstein_uhlenbeck(np.ndarray[float, ndim = 1] v, # drift parameter</pre>
<pre class='cython code score-142 '>static PyObject *__pyx_pf_4cssm_56__defaults__(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_r = NULL;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
/* … */
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(11);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1474, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 2, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 3, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 4, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 5, Py_None)) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_True));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_True));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 6, ((PyObject *)Py_True))) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults5, __pyx_self)-&gt;__pyx_arg_boundary_params);
  <span class='refnanny'>__Pyx_GIVEREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults5, __pyx_self)-&gt;__pyx_arg_boundary_params);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 7, <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults5, __pyx_self)-&gt;__pyx_arg_boundary_params)) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 8, Py_None)) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject*)__pyx_n_u_full));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject*)__pyx_n_u_full));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 9, ((PyObject*)__pyx_n_u_full))) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_False));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_False));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 10, ((PyObject *)Py_False))) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1474, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 1, Py_None)) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L1_error)</span>;
  __pyx_t_6 = 0;
  __pyx_r = __pyx_t_5;
  __pyx_t_5 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.__defaults__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_4cssm_19ornstein_uhlenbeck(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_4cssm_19ornstein_uhlenbeck = {"ornstein_uhlenbeck", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_4cssm_19ornstein_uhlenbeck, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_4cssm_19ornstein_uhlenbeck(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyArrayObject *__pyx_v_v = 0;
  PyArrayObject *__pyx_v_a = 0;
  PyArrayObject *__pyx_v_z = 0;
  PyArrayObject *__pyx_v_g = 0;
  PyArrayObject *__pyx_v_t = 0;
  PyArrayObject *__pyx_v_deadline = 0;
  float __pyx_v_s;
  float __pyx_v_delta_t;
  float __pyx_v_max_t;
  int __pyx_v_n_samples;
  int __pyx_v_n_trials;
  PyObject *__pyx_v_boundary_fun = 0;
  PyObject *__pyx_v_boundary_multiplicative = 0;
  PyObject *__pyx_v_boundary_params = 0;
  PyObject *__pyx_v_random_state = 0;
  PyObject *__pyx_v_return_option = 0;
  PyObject *__pyx_v_smooth = 0;
  CYTHON_UNUSED PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("ornstein_uhlenbeck (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_v,&amp;__pyx_n_s_a,&amp;__pyx_n_s_z,&amp;__pyx_n_s_g,&amp;__pyx_n_s_t,&amp;__pyx_n_s_deadline,&amp;__pyx_n_s_s,&amp;__pyx_n_s_delta_t,&amp;__pyx_n_s_max_t,&amp;__pyx_n_s_n_samples,&amp;__pyx_n_s_n_trials,&amp;__pyx_n_s_boundary_fun,&amp;__pyx_n_s_boundary_multiplicative,&amp;__pyx_n_s_boundary_params,&amp;__pyx_n_s_random_state,&amp;__pyx_n_s_return_option,&amp;__pyx_n_s_smooth,0};
  PyObject* values[17] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    __pyx_defaults5 *__pyx_dynamic_args = <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults5, __pyx_self);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs);
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4cssm_18ornstein_uhlenbeck(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_g, PyArrayObject *__pyx_v_t, PyArrayObject *__pyx_v_deadline, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state, PyObject *__pyx_v_return_option, PyObject *__pyx_v_smooth, CYTHON_UNUSED PyObject *__pyx_v_kwargs) {
  PyObject *__pyx_v_traj = NULL;
  __Pyx_memviewslice __pyx_v_traj_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_v_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_a_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_z_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_g_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_t_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_deadline_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_rts = NULL;
  PyObject *__pyx_v_choices = NULL;
  __Pyx_memviewslice __pyx_v_rts_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_choices_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  float __pyx_v_delta_t_sqrt;
  float __pyx_v_sqrt_st;
  int __pyx_v_num_draws;
  PyObject *__pyx_v_t_s = NULL;
  PyObject *__pyx_v_boundary = NULL;
  __Pyx_memviewslice __pyx_v_boundary_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  float __pyx_v_y;
  float __pyx_v_t_particle;
  float __pyx_v_smooth_u;
  float __pyx_v_deadline_tmp;
  Py_ssize_t __pyx_v_n;
  Py_ssize_t __pyx_v_ix;
  Py_ssize_t __pyx_v_k;
  Py_ssize_t __pyx_v_m;
  __Pyx_memviewslice __pyx_v_gaussian_values = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_boundary_params_tmp = NULL;
  PyObject *__pyx_8genexpr6__pyx_v_key = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_a;
  __Pyx_Buffer __pyx_pybuffer_a;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_deadline;
  __Pyx_Buffer __pyx_pybuffer_deadline;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_g;
  __Pyx_Buffer __pyx_pybuffer_g;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_t;
  __Pyx_Buffer __pyx_pybuffer_t;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_v;
  __Pyx_Buffer __pyx_pybuffer_v;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_z;
  __Pyx_Buffer __pyx_pybuffer_z;
  PyObject *__pyx_r = NULL;
  __pyx_pybuffer_v.pybuffer.buf = NULL;
  __pyx_pybuffer_v.refcount = 0;
  __pyx_pybuffernd_v.data = NULL;
  __pyx_pybuffernd_v.rcbuffer = &amp;__pyx_pybuffer_v;
  __pyx_pybuffer_a.pybuffer.buf = NULL;
  __pyx_pybuffer_a.refcount = 0;
  __pyx_pybuffernd_a.data = NULL;
  __pyx_pybuffernd_a.rcbuffer = &amp;__pyx_pybuffer_a;
  __pyx_pybuffer_z.pybuffer.buf = NULL;
  __pyx_pybuffer_z.refcount = 0;
  __pyx_pybuffernd_z.data = NULL;
  __pyx_pybuffernd_z.rcbuffer = &amp;__pyx_pybuffer_z;
  __pyx_pybuffer_g.pybuffer.buf = NULL;
  __pyx_pybuffer_g.refcount = 0;
  __pyx_pybuffernd_g.data = NULL;
  __pyx_pybuffernd_g.rcbuffer = &amp;__pyx_pybuffer_g;
  __pyx_pybuffer_t.pybuffer.buf = NULL;
  __pyx_pybuffer_t.refcount = 0;
  __pyx_pybuffernd_t.data = NULL;
  __pyx_pybuffernd_t.rcbuffer = &amp;__pyx_pybuffer_t;
  __pyx_pybuffer_deadline.pybuffer.buf = NULL;
  __pyx_pybuffer_deadline.refcount = 0;
  __pyx_pybuffernd_deadline.data = NULL;
  __pyx_pybuffernd_deadline.rcbuffer = &amp;__pyx_pybuffer_deadline;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_v, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_v.diminfo[0].strides = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_v.diminfo[0].shape = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_a, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_z, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_z.diminfo[0].strides = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_z.diminfo[0].shape = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_g.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_g, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_g.diminfo[0].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_g.diminfo[0].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_t, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_t.diminfo[0].strides = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_t.diminfo[0].shape = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_deadline, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_deadline.diminfo[0].strides = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_deadline.diminfo[0].shape = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.shape[0];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_5, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_9, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_g.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.ornstein_uhlenbeck", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_g.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_traj);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_traj_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_v_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_a_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_z_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_g_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_t_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_deadline_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_choices);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_rts_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_choices_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t_s);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_boundary);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_boundary_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_boundary_params_tmp);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr6__pyx_v_key);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__41 = <span class='py_c_api'>PyTuple_Pack</span>(47, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_g, __pyx_n_s_t, __pyx_n_s_deadline, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_boundary_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_random_state, __pyx_n_s_return_option, __pyx_n_s_smooth, __pyx_n_s_kwargs, __pyx_n_s_traj, __pyx_n_s_traj_view, __pyx_n_s_v_view, __pyx_n_s_a_view, __pyx_n_s_z_view, __pyx_n_s_g_view, __pyx_n_s_t_view, __pyx_n_s_deadline_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_num_draws, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_boundary_view, __pyx_n_s_y, __pyx_n_s_t_particle, __pyx_n_s_smooth_u, __pyx_n_s_deadline_tmp, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_gaussian_values, __pyx_n_s_boundary_params_tmp, __pyx_n_s_key);<span class='error_goto'> if (unlikely(!__pyx_tuple__41)) __PYX_ERR(0, 1474, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__41);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__41);
/* … */
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_4cssm_19ornstein_uhlenbeck, 0, __pyx_n_s_ornstein_uhlenbeck, NULL, __pyx_n_s_cssm, __pyx_d, ((PyObject *)__pyx_codeobj__42));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1474, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (!<span class='pyx_c_api'>__Pyx_CyFunction_InitDefaults</span>(__pyx_t_5, sizeof(__pyx_defaults5), 1)) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L1_error)</span>
  __pyx_codeobj__42 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(17, 0, 0, 47, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__41, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_ornstein_uhlenbeck, 1474, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__42)) __PYX_ERR(0, 1474, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1475</span>:                        np.ndarray[float, ndim = 1] a, # initial boundary separation</pre>
<pre class="cython line score-0">&#xA0;<span class="">1476</span>:                        np.ndarray[float, ndim = 1] z, # starting point bias</pre>
<pre class="cython line score-0">&#xA0;<span class="">1477</span>:                        np.ndarray[float, ndim = 1] g, # decay parameter</pre>
<pre class="cython line score-0">&#xA0;<span class="">1478</span>:                        np.ndarray[float, ndim = 1] t,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1479</span>:                        np.ndarray[float, ndim = 1] deadline,</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1480</span>:                        float s = 1, # standard deviation</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)1.0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1480, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1481</span>:                        float delta_t = 0.001, # size of timestep</pre>
<pre class='cython code score-5 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(((double)0.001));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1481, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1482</span>:                        float max_t = 20, # maximal time in trial</pre>
<pre class='cython code score-5 '>  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)20.0));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1482, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1483</span>:                        int n_samples = 20000, # number of samples from process</pre>
<pre class='cython code score-2 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)0x4E20));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1483, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1484</span>:                        int n_trials = 1,</pre>
<pre class='cython code score-2 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)1));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1484, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1485</span>:                        boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)</pre>
<pre class='cython code score-6 '>    values[11] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[12] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_True)));
    values[13] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(__pyx_dynamic_args-&gt;__pyx_arg_boundary_params);
</pre><pre class="cython line score-0">&#xA0;<span class="">1486</span>:                        boundary_multiplicative = True,</pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1487</span>:                        boundary_params = {},</pre>
<pre class='cython code score-12 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1487, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults5, __pyx_t_5)-&gt;__pyx_arg_boundary_params = __pyx_t_4;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_4 = 0;
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsGetter</span>(__pyx_t_5, __pyx_pf_4cssm_56__defaults__);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_ornstein_uhlenbeck, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-304" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1488</span>:                        random_state = None,</pre>
<pre class='cython code score-304 '>    values[14] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[15] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_full)));
    values[16] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case 17: values[16] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 16);
        CYTHON_FALLTHROUGH;
        case 16: values[15] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 15);
        CYTHON_FALLTHROUGH;
        case 15: values[14] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_v)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_a)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ornstein_uhlenbeck", 0, 6, 17, 1); <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_z)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ornstein_uhlenbeck", 0, 6, 17, 2); <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_g)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[3]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ornstein_uhlenbeck", 0, 6, 17, 3); <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_t)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[4]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ornstein_uhlenbeck", 0, 6, 17, 4); <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_deadline)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[5]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ornstein_uhlenbeck", 0, 6, 17, 5); <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_s);
          if (value) { values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_delta_t);
          if (value) { values[7] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_max_t);
          if (value) { values[8] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  9:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_samples);
          if (value) { values[9] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 10:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_trials);
          if (value) { values[10] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 11:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_fun);
          if (value) { values[11] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 12:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_multiplicative);
          if (value) { values[12] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 13:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_params);
          if (value) { values[13] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 14:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_random_state);
          if (value) { values[14] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 15:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_return_option);
          if (value) { values[15] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 16:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_smooth);
          if (value) { values[16] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values + 0, kwd_pos_args, "ornstein_uhlenbeck") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case 17: values[16] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 16);
        CYTHON_FALLTHROUGH;
        case 16: values[15] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 15);
        CYTHON_FALLTHROUGH;
        case 15: values[14] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_v = ((PyArrayObject *)values[0]);
    __pyx_v_a = ((PyArrayObject *)values[1]);
    __pyx_v_z = ((PyArrayObject *)values[2]);
    __pyx_v_g = ((PyArrayObject *)values[3]);
    __pyx_v_t = ((PyArrayObject *)values[4]);
    __pyx_v_deadline = ((PyArrayObject *)values[5]);
    if (values[6]) {
      __pyx_v_s = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[6]); if (unlikely((__pyx_v_s == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1480, __pyx_L3_error)</span>
    } else {
      __pyx_v_s = ((float)((float)1.0));
    }
    if (values[7]) {
      __pyx_v_delta_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[7]); if (unlikely((__pyx_v_delta_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1481, __pyx_L3_error)</span>
    } else {
      __pyx_v_delta_t = ((float)((double)0.001));
    }
    if (values[8]) {
      __pyx_v_max_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[8]); if (unlikely((__pyx_v_max_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1482, __pyx_L3_error)</span>
    } else {
      __pyx_v_max_t = ((float)((float)20.0));
    }
    if (values[9]) {
      __pyx_v_n_samples = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[9]); if (unlikely((__pyx_v_n_samples == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1483, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_samples = ((int)((int)0x4E20));
    }
    if (values[10]) {
      __pyx_v_n_trials = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[10]); if (unlikely((__pyx_v_n_trials == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1484, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_trials = ((int)((int)1));
    }
    __pyx_v_boundary_fun = values[11];
    __pyx_v_boundary_multiplicative = values[12];
    __pyx_v_boundary_params = values[13];
    __pyx_v_random_state = values[14];
    __pyx_v_return_option = values[15];
    __pyx_v_smooth = values[16];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ornstein_uhlenbeck", 0, 6, 17, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.ornstein_uhlenbeck", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) <span class='error_goto'>__PYX_ERR(0, 1475, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) <span class='error_goto'>__PYX_ERR(0, 1476, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_g), __pyx_ptype_5numpy_ndarray, 1, "g", 0))) <span class='error_goto'>__PYX_ERR(0, 1477, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) <span class='error_goto'>__PYX_ERR(0, 1478, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_deadline), __pyx_ptype_5numpy_ndarray, 1, "deadline", 0))) <span class='error_goto'>__PYX_ERR(0, 1479, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_4cssm_18ornstein_uhlenbeck(__pyx_self, __pyx_v_v, __pyx_v_a, __pyx_v_z, __pyx_v_g, __pyx_v_t, __pyx_v_deadline, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state, __pyx_v_return_option, __pyx_v_smooth, __pyx_v_kwargs);
</pre><pre class="cython line score-0">&#xA0;<span class="">1489</span>:                        return_option = 'full',</pre>
<pre class="cython line score-0">&#xA0;<span class="">1490</span>:                        smooth = False,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1491</span>:                        **kwargs):</pre>
<pre class="cython line score-0">&#xA0;<span class="">1492</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1493</span>:     set_seed(random_state)</pre>
<pre class='cython code score-1 '>  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1493, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1494</span>:     # Data-structs for trajectory storage</pre>
<pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1495</span>:     traj = np.zeros((int(max_t / delta_t) + 1, 1), dtype = DTYPE)</pre>
<pre class='cython code score-42 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1495, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1495, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_FromDouble</span>((__pyx_v_max_t / __pyx_v_delta_t));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1495, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_1, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1495, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1495, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1495, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 1495, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1495, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1495, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1495, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1495, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1495, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1495, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_traj = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1496</span>:     traj[:, :] = -999</pre>
<pre class='cython code score-5 '>  if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_traj, __pyx_tuple__12, __pyx_int_neg_999) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1496, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1497</span>:     cdef float[:,:] traj_view = traj</pre>
<pre class='cython code score-2 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(__pyx_v_traj, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1497, __pyx_L1_error)</span>
  __pyx_v_traj_view = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1498</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1499</span>:     # Param views</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1500</span>:     cdef float[:] v_view  = v</pre>
<pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_v), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1500, __pyx_L1_error)</span>
  __pyx_v_v_view = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1501</span>:     cdef float[:] a_view = a</pre>
<pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_a), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1501, __pyx_L1_error)</span>
  __pyx_v_a_view = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1502</span>:     cdef float[:] z_view = z</pre>
<pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_z), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1502, __pyx_L1_error)</span>
  __pyx_v_z_view = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1503</span>:     cdef float[:] g_view = g</pre>
<pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_g), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1503, __pyx_L1_error)</span>
  __pyx_v_g_view = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1504</span>:     cdef float[:] t_view = t</pre>
<pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_t), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1504, __pyx_L1_error)</span>
  __pyx_v_t_view = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1505</span>:     cdef float[:] deadline_view = deadline</pre>
<pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_deadline), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1505, __pyx_L1_error)</span>
  __pyx_v_deadline_view = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1506</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1507</span>:     # Initializations</pre>
<pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1508</span>:     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE) # rt storage</pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1508, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1508, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1508, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1508, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1508, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1508, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1508, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 1508, __pyx_L1_error)</span>;
  __pyx_t_4 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1508, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1508, __pyx_L1_error)</span>;
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1508, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1508, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1508, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1508, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_rts = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1509</span>:     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc) # choice storage</pre>
<pre class='cython code score-46 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1509, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1509, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1509, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1509, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1509, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1509, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1509, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 1509, __pyx_L1_error)</span>;
  __pyx_t_4 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1509, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1509, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1509, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1509, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_intc);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1509, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1509, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1509, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_choices = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1510</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1511</span>:     cdef float[:, :, :] rts_view = rts</pre>
<pre class='cython code score-2 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_rts, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1511, __pyx_L1_error)</span>
  __pyx_v_rts_view = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1512</span>:     cdef int[:, :, :] choices_view = choices</pre>
<pre class='cython code score-2 '>  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_int</span>(__pyx_v_choices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1512, __pyx_L1_error)</span>
  __pyx_v_choices_view = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1513</span>: </pre>
<pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1514</span>:     cdef float delta_t_sqrt = np.sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion</pre>
<pre class='cython code score-36 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1514, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_sqrt);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1514, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_t);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1514, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = NULL;
  __pyx_t_10 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_10 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_t_1};
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_10, 1+__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 1514, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_t_11 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_7); if (unlikely((__pyx_t_11 == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1514, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_v_delta_t_sqrt = __pyx_t_11;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1515</span>:     cdef float sqrt_st = s * delta_t_sqrt</pre>
<pre class='cython code score-0 '>  __pyx_v_sqrt_st = (__pyx_v_s * __pyx_v_delta_t_sqrt);
</pre><pre class="cython line score-0">&#xA0;<span class="">1516</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1517</span>:     # Boundary Storage</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1518</span>:     cdef int num_draws = int((max_t / delta_t) + 1)</pre>
<pre class='cython code score-0 '>  __pyx_v_num_draws = ((int)((__pyx_v_max_t / __pyx_v_delta_t) + 1.0));
</pre><pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1519</span>:     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)</pre>
<pre class='cython code score-51 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1519, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1519, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_max_t + __pyx_v_delta_t));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1519, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_t);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1519, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_12 = NULL;
  __pyx_t_10 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_12)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_10 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[4] = {__pyx_t_12, __pyx_int_0, __pyx_t_1, __pyx_t_4};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_10, 3+__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1519, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1519, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1519, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = NULL;
  __pyx_t_10 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_10 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_3};
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_10, 1+__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 1519, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_v_t_s = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1520</span>:     boundary = np.zeros(t_s.shape, dtype = DTYPE)</pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1520, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1520, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_t_s, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1520, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1520, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 1520, __pyx_L1_error)</span>;
  __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1520, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1520, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1520, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1520, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_v_boundary = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1521</span>:     cdef float[:] boundary_view = boundary</pre>
<pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(__pyx_v_boundary, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1521, __pyx_L1_error)</span>
  __pyx_v_boundary_view = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1522</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1523</span>:     cdef float y, t_particle, smooth_u, deadline_tmp</pre>
<pre class="cython line score-0">&#xA0;<span class="">1524</span>:     cdef Py_ssize_t n, ix, k</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1525</span>:     cdef Py_ssize_t m = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_m = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1526</span>:     cdef float[:] gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1526, __pyx_L1_error)</span>
  __pyx_v_gaussian_values = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1527</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1528</span>:     for k in range(n_trials):</pre>
<pre class='cython code score-0 '>  __pyx_t_10 = __pyx_v_n_trials;
  __pyx_t_13 = __pyx_t_10;
  for (__pyx_t_14 = 0; __pyx_t_14 &lt; __pyx_t_13; __pyx_t_14+=1) {
    __pyx_v_k = __pyx_t_14;
</pre><pre class="cython line score-0">&#xA0;<span class="">1529</span>:         # Precompute boundary evaluations</pre>
<pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1530</span>:         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}</pre>
<pre class='cython code score-27 '>    { /* enter inner scope */
      __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1530, __pyx_L7_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_15 = 0;
      if (unlikely(__pyx_v_boundary_params == Py_None)) {
        <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "keys");
        <span class='error_goto'>__PYX_ERR(0, 1530, __pyx_L7_error)</span>
      }
      __pyx_t_3 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&amp;__pyx_t_16), (&amp;__pyx_t_17));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1530, __pyx_L7_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
      __pyx_t_7 = __pyx_t_3;
      __pyx_t_3 = 0;
      while (1) {
        __pyx_t_18 = __Pyx_dict_iter_next(__pyx_t_7, __pyx_t_16, &amp;__pyx_t_15, &amp;__pyx_t_3, NULL, NULL, __pyx_t_17);
        if (unlikely(__pyx_t_18 == 0)) break;
        if (unlikely(__pyx_t_18 == -1)) <span class='error_goto'>__PYX_ERR(0, 1530, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_8genexpr6__pyx_v_key, __pyx_t_3);
        __pyx_t_3 = 0;
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_boundary_params, __pyx_8genexpr6__pyx_v_key);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1530, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1530, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, (PyObject*)__pyx_8genexpr6__pyx_v_key, (PyObject*)__pyx_t_2))) <span class='error_goto'>__PYX_ERR(0, 1530, __pyx_L7_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr6__pyx_v_key); __pyx_8genexpr6__pyx_v_key = 0;
      goto __pyx_L10_exit_scope;
      __pyx_L7_error:;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr6__pyx_v_key); __pyx_8genexpr6__pyx_v_key = 0;
      goto __pyx_L1_error;
      __pyx_L10_exit_scope:;
    } /* exit inner scope */
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_boundary_params_tmp, ((PyObject*)__pyx_t_4));
    __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1531</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1532</span>:         # Precompute boundary evaluations</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1533</span>:         if boundary_multiplicative:</pre>
<pre class='cython code score-2 '>    __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_boundary_multiplicative); if (unlikely((__pyx_t_19 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1533, __pyx_L1_error)</span>
    if (__pyx_t_19) {
/* … */
      goto __pyx_L11;
    }
</pre><pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1534</span>:             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)</pre>
<pre class='cython code score-61 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1534, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_multiply);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1534, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_20 = __pyx_v_k;
      __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_20 * __pyx_v_a_view.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1534, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1534, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_12, __pyx_n_s_t, __pyx_v_t_s) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1534, __pyx_L1_error)</span>
      __pyx_t_1 = __pyx_t_12;
      __pyx_t_12 = 0;
      if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_1, __pyx_v_boundary_params_tmp) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1534, __pyx_L1_error)</span>
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1534, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = NULL;
      __pyx_t_17 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_1)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          __pyx_t_17 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_1, __pyx_t_2, __pyx_t_12};
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_17, 2+__pyx_t_17);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 1534, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      }
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1534, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1534, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_12 = NULL;
      __pyx_t_17 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_12)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          __pyx_t_17 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_12, __pyx_t_7};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_17, 1+__pyx_t_17);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1534, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      }
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_boundary, __pyx_t_4, 0, 0, NULL, NULL, &amp;__pyx_slice__5, 0, 0, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1534, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1535</span>:         else:</pre>
<pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1536</span>:             boundary[:] = np.add(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)</pre>
<pre class='cython code score-61 '>    /*else*/ {
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1536, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_add);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1536, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_20 = __pyx_v_k;
      __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_20 * __pyx_v_a_view.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1536, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1536, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_t, __pyx_v_t_s) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1536, __pyx_L1_error)</span>
      __pyx_t_2 = __pyx_t_1;
      __pyx_t_1 = 0;
      if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_2, __pyx_v_boundary_params_tmp) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1536, __pyx_L1_error)</span>
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1536, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = NULL;
      __pyx_t_17 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
        __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
        if (likely(__pyx_t_2)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
          __pyx_t_17 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_2, __pyx_t_7, __pyx_t_1};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_12, __pyx_callargs+1-__pyx_t_17, 2+__pyx_t_17);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1536, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      }
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1536, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1536, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_1 = NULL;
      __pyx_t_17 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
        __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
        if (likely(__pyx_t_1)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
          __pyx_t_17 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_3};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_12, __pyx_callargs+1-__pyx_t_17, 1+__pyx_t_17);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1536, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      }
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_boundary, __pyx_t_4, 0, 0, NULL, NULL, &amp;__pyx_slice__5, 0, 0, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1536, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    __pyx_L11:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1537</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1538</span>:         deadline_tmp = min(max_t, deadline_view[k] - t_view[k])</pre>
<pre class='cython code score-0 '>    __pyx_t_20 = __pyx_v_k;
    __pyx_t_21 = __pyx_v_k;
    __pyx_t_11 = ((*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_20 * __pyx_v_deadline_view.strides[0]) ))) - (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_21 * __pyx_v_t_view.strides[0]) ))));
    __pyx_t_22 = __pyx_v_max_t;
    __pyx_t_19 = (__pyx_t_11 &lt; __pyx_t_22);
    if (__pyx_t_19) {
      __pyx_t_23 = __pyx_t_11;
    } else {
      __pyx_t_23 = __pyx_t_22;
    }
    __pyx_v_deadline_tmp = __pyx_t_23;
</pre><pre class="cython line score-0">&#xA0;<span class="">1539</span>:         # Loop over samples</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1540</span>:         for n in range(n_samples):</pre>
<pre class='cython code score-0 '>    __pyx_t_17 = __pyx_v_n_samples;
    __pyx_t_18 = __pyx_t_17;
    for (__pyx_t_16 = 0; __pyx_t_16 &lt; __pyx_t_18; __pyx_t_16+=1) {
      __pyx_v_n = __pyx_t_16;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1541</span>:             y = (-1) * boundary_view[0] + (z_view[k] * 2 * boundary_view[0])</pre>
<pre class='cython code score-0 '>      __pyx_t_21 = 0;
      __pyx_t_20 = __pyx_v_k;
      __pyx_t_24 = 0;
      __pyx_v_y = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_21 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_z_view.data + __pyx_t_20 * __pyx_v_z_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_24 * __pyx_v_boundary_view.strides[0]) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1542</span>:             t_particle = 0.0</pre>
<pre class='cython code score-0 '>      __pyx_v_t_particle = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1543</span>:             ix = 0</pre>
<pre class='cython code score-0 '>      __pyx_v_ix = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1544</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1545</span>:             if n == 0:</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = (__pyx_v_n == 0);
      if (__pyx_t_19) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1546</span>:                 if k == 0:</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = (__pyx_v_k == 0);
        if (__pyx_t_19) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1547</span>:                     traj_view[0, 0] = y</pre>
<pre class='cython code score-0 '>          __pyx_t_24 = 0;
          __pyx_t_20 = 0;
          *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_24 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_20 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y;
</pre><pre class="cython line score-0">&#xA0;<span class="">1548</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1549</span>:             # Random walker</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1550</span>:             while y &gt;= (-1) * boundary_view[ix] and y &lt;= boundary_view[ix] and t_particle &lt;= deadline_tmp:</pre>
<pre class='cython code score-0 '>      while (1) {
        __pyx_t_20 = __pyx_v_ix;
        __pyx_t_25 = (__pyx_v_y &gt;= (-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))));
        if (__pyx_t_25) {
        } else {
          __pyx_t_19 = __pyx_t_25;
          goto __pyx_L18_bool_binop_done;
        }
        __pyx_t_20 = __pyx_v_ix;
        __pyx_t_25 = (__pyx_v_y &lt;= (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) ))));
        if (__pyx_t_25) {
        } else {
          __pyx_t_19 = __pyx_t_25;
          goto __pyx_L18_bool_binop_done;
        }
        __pyx_t_25 = (__pyx_v_t_particle &lt;= __pyx_v_deadline_tmp);
        __pyx_t_19 = __pyx_t_25;
        __pyx_L18_bool_binop_done:;
        if (!__pyx_t_19) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1551</span>:                 y += ((v_view[k] - (g_view[k] * y)) * delta_t) + sqrt_st * gaussian_values[m]</pre>
<pre class='cython code score-0 '>        __pyx_t_20 = __pyx_v_k;
        __pyx_t_24 = __pyx_v_k;
        __pyx_t_21 = __pyx_v_m;
        __pyx_v_y = (__pyx_v_y + ((((*((float *) ( /* dim=0 */ (__pyx_v_v_view.data + __pyx_t_20 * __pyx_v_v_view.strides[0]) ))) - ((*((float *) ( /* dim=0 */ (__pyx_v_g_view.data + __pyx_t_24 * __pyx_v_g_view.strides[0]) ))) * __pyx_v_y)) * __pyx_v_delta_t) + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_21 * __pyx_v_gaussian_values.strides[0]) ))))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1552</span>:                 t_particle += delta_t</pre>
<pre class='cython code score-0 '>        __pyx_v_t_particle = (__pyx_v_t_particle + __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1553</span>:                 ix += 1</pre>
<pre class='cython code score-0 '>        __pyx_v_ix = (__pyx_v_ix + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1554</span>:                 m += 1</pre>
<pre class='cython code score-0 '>        __pyx_v_m = (__pyx_v_m + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">1555</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1556</span>:                 if n == 0:</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = (__pyx_v_n == 0);
        if (__pyx_t_19) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1557</span>:                     if k == 0:</pre>
<pre class='cython code score-0 '>          __pyx_t_19 = (__pyx_v_k == 0);
          if (__pyx_t_19) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1558</span>:                         traj_view[ix, 0] = y</pre>
<pre class='cython code score-0 '>            __pyx_t_21 = __pyx_v_ix;
            __pyx_t_24 = 0;
            *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_21 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_24 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y;
</pre><pre class="cython line score-0">&#xA0;<span class="">1559</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1560</span>:                 if m == num_draws:</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = (__pyx_v_m == __pyx_v_num_draws);
        if (__pyx_t_19) {
/* … */
        }
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1561</span>:                     gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>          __pyx_t_6 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1561, __pyx_L1_error)</span>
          __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
          __pyx_v_gaussian_values = __pyx_t_6;
          __pyx_t_6.memview = NULL;
          __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1562</span>:                     m = 0</pre>
<pre class='cython code score-0 '>          __pyx_v_m = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1563</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1564</span>:             if smooth:</pre>
<pre class='cython code score-2 '>      __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_smooth); if (unlikely((__pyx_t_19 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1564, __pyx_L1_error)</span>
      if (__pyx_t_19) {
/* … */
        goto __pyx_L24;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1565</span>:                 if t_particle == 0.0:</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = (__pyx_v_t_particle == 0.0);
        if (__pyx_t_19) {
/* … */
          goto __pyx_L25;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1566</span>:                     smooth_u = random_uniform() * 0.5 * delta_t</pre>
<pre class='cython code score-5 '>          __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1566, __pyx_L1_error)</span>
          __pyx_v_smooth_u = ((__pyx_t_23 * 0.5) * __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1567</span>:                 elif t_particle &lt; deadline_tmp:</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = (__pyx_v_t_particle &lt; __pyx_v_deadline_tmp);
        if (__pyx_t_19) {
/* … */
          goto __pyx_L25;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1568</span>:                     smooth_u = (0.5 - random_uniform()) * delta_t</pre>
<pre class='cython code score-5 '>          __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1568, __pyx_L1_error)</span>
          __pyx_v_smooth_u = ((0.5 - __pyx_t_23) * __pyx_v_delta_t);
</pre><pre class="cython line score-0">&#xA0;<span class="">1569</span>:                 else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1570</span>:                     smooth_u = 0.0</pre>
<pre class='cython code score-0 '>        /*else*/ {
          __pyx_v_smooth_u = 0.0;
        }
        __pyx_L25:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1571</span>:             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1572</span>:                 smooth_u = 0.0</pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_v_smooth_u = 0.0;
      }
      __pyx_L24:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1573</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1574</span>:             rts_view[n, k, 0] = t_particle + t_view[k] + smooth_u</pre>
<pre class='cython code score-0 '>      __pyx_t_24 = __pyx_v_k;
      __pyx_t_21 = __pyx_v_n;
      __pyx_t_20 = __pyx_v_k;
      __pyx_t_26 = 0;
      *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_21 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_20 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_26 * __pyx_v_rts_view.strides[2]) )) = ((__pyx_v_t_particle + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_24 * __pyx_v_t_view.strides[0]) )))) + __pyx_v_smooth_u);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1575</span>:             choices_view[n, k, 0] = sign(y)</pre>
<pre class='cython code score-5 '>      __pyx_t_27 = __pyx_f_4cssm_sign(__pyx_v_y); if (unlikely(__pyx_t_27 == ((int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1575, __pyx_L1_error)</span>
      __pyx_t_24 = __pyx_v_n;
      __pyx_t_26 = __pyx_v_k;
      __pyx_t_20 = 0;
      *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_24 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_26 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[2]) )) = __pyx_t_27;
</pre><pre class="cython line score-0">&#xA0;<span class="">1576</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1577</span>:             if (rts_view[n, k, 0] &gt;= deadline_view[k]) | (deadline_view[k] &lt;= 0):</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = __pyx_v_n;
      __pyx_t_26 = __pyx_v_k;
      __pyx_t_24 = 0;
      __pyx_t_21 = __pyx_v_k;
      __pyx_t_28 = __pyx_v_k;
      __pyx_t_19 = (((*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_20 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_26 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_24 * __pyx_v_rts_view.strides[2]) ))) &gt;= (*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_21 * __pyx_v_deadline_view.strides[0]) )))) | ((*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_28 * __pyx_v_deadline_view.strides[0]) ))) &lt;= 0.0));
      if (__pyx_t_19) {
/* … */
      }
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1578</span>:                 rts_view[n, k, 0] = -999</pre>
<pre class='cython code score-0 '>        __pyx_t_28 = __pyx_v_n;
        __pyx_t_21 = __pyx_v_k;
        __pyx_t_24 = 0;
        *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_28 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_21 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_24 * __pyx_v_rts_view.strides[2]) )) = -999.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1579</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1580</span>:     if return_option == 'full':</pre>
<pre class='cython code score-2 '>  __pyx_t_19 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_return_option, __pyx_n_u_full, Py_EQ)); if (unlikely((__pyx_t_19 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1580, __pyx_L1_error)</span>
  if (__pyx_t_19) {
/* … */
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1581</span>:         return { 'rts': rts, 'choices': choices, 'metadata': {'v': v,</pre>
<pre class='cython code score-20 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1581, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1581, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1581, __pyx_L1_error)</span>
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1581, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_v, ((PyObject *)__pyx_v_v)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1581, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1582</span>:                                                             'a': a,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1581, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1583</span>:                                                             'z': z,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_z, ((PyObject *)__pyx_v_z)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1581, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1584</span>:                                                             'g': g,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_g, ((PyObject *)__pyx_v_g)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1581, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1585</span>:                                                             't': t,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1581, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1586</span>:                                                             'deadline': deadline,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_deadline, ((PyObject *)__pyx_v_deadline)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1581, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1587</span>:                                                             's': s,</pre>
<pre class='cython code score-11 '>    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_s);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1587, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_s, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1581, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_12 = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1588</span>:                                                             **boundary_params,</pre>
<pre class='cython code score-17 '>    if (unlikely(__pyx_v_boundary_params == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
      <span class='error_goto'>__PYX_ERR(0, 1588, __pyx_L1_error)</span>
    }
    if (unlikely(<span class='py_c_api'>PyDict_Update</span>(__pyx_t_12, __pyx_v_boundary_params) &lt; 0)) {
      if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseMappingExpectedError</span>(__pyx_v_boundary_params);
      <span class='error_goto'>__PYX_ERR(0, 1588, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1589</span>:                                                             'delta_t': delta_t,</pre>
<pre class='cython code score-11 '>    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_t);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1589, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_12, __pyx_n_u_delta_t, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1589, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1590</span>:                                                             'max_t': max_t,</pre>
<pre class='cython code score-11 '>    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_max_t);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1590, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_12, __pyx_n_u_max_t, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1590, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1591</span>:                                                             'n_samples': n_samples,</pre>
<pre class='cython code score-8 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1591, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_12, __pyx_n_u_n_samples, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1591, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1592</span>:                                                             'n_trials': n_trials,</pre>
<pre class='cython code score-13 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1592, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_12, __pyx_n_u_n_trials, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1592, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_12, __pyx_n_u_simulator, __pyx_n_u_ornstein_uhlenbeck) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1593, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1593</span>:                                                             'simulator': 'ornstein_uhlenbeck',</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1594</span>:                                                             'boundary_fun_type': boundary_fun.__name__,</pre>
<pre class='cython code score-8 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_boundary_fun, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1594, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_12, __pyx_n_u_boundary_fun_type, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1594, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1595</span>:                                                             'possible_choices': [-1, 1],</pre>
<pre class='cython code score-17 '>    __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1595, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_int_neg_1)) <span class='error_goto'>__PYX_ERR(0, 1595, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 1595, __pyx_L1_error)</span>;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_12, __pyx_n_u_possible_choices, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1595, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1596</span>:                                                             'trajectory': traj,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_12, __pyx_n_u_trajectory, __pyx_v_traj) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1596, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1597</span>:                                                             'boundary': boundary}}</pre>
<pre class='cython code score-11 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_12, __pyx_n_u_boundary, __pyx_v_boundary) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1597, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_metadata, __pyx_t_12) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1581, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1598</span>:     elif return_option == 'minimal':</pre>
<pre class='cython code score-2 '>  __pyx_t_19 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_return_option, __pyx_n_u_minimal, Py_EQ)); if (unlikely((__pyx_t_19 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1598, __pyx_L1_error)</span>
  if (likely(__pyx_t_19)) {
/* … */
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1599</span>:         return {'rts': rts, 'choices': choices,  'metadata': {'simulator': 'ornstein_uhlenbeck',</pre>
<pre class='cython code score-20 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1599, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1599, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1599, __pyx_L1_error)</span>
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1599, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_12, __pyx_n_u_simulator, __pyx_n_u_ornstein_uhlenbeck) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1599, __pyx_L1_error)</span>
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1600</span>:                                                              'possible_choices': [-1, 1],</pre>
<pre class='cython code score-17 '>    __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1600, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_int_neg_1)) <span class='error_goto'>__PYX_ERR(0, 1600, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 1600, __pyx_L1_error)</span>;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_12, __pyx_n_u_possible_choices, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1599, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1601</span>:                                                              'boundary_fun_type': boundary_fun.__name__,</pre>
<pre class='cython code score-8 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_boundary_fun, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1601, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_12, __pyx_n_u_boundary_fun_type, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1599, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1602</span>:                                                              'n_samples': n_samples,</pre>
<pre class='cython code score-8 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1602, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_12, __pyx_n_u_n_samples, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1599, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1603</span>:                                                              'n_trials': n_trials,</pre>
<pre class='cython code score-14 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1603, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_12, __pyx_n_u_n_trials, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1599, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_metadata, __pyx_t_12) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1599, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1604</span>:                                                              }}</pre>
<pre class="cython line score-0">&#xA0;<span class="">1605</span>:     else:</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1606</span>:         raise ValueError('return_option must be either "full" or "minimal"')</pre>
<pre class='cython code score-5 '>  /*else*/ {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1606, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_4, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1606, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1607</span>: # --------------------------------------------------------------------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1608</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1609</span>: # Simulate (rt, choice) tuples from: RACE MODEL WITH N SAMPLES ----------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1610</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1611</span>: # Check if any of the particles in the race model have crossed</pre>
<pre class="cython line score-0">&#xA0;<span class="">1612</span>: # @cythonboundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1613</span>: # @cythonwraparound(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1614</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1615</span>: # Function that checks boundary crossing of particles</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1616</span>: cdef bint check_finished(float[:] particles, float boundary, int n):</pre>
<pre class='cython code score-0 '>static int __pyx_f_4cssm_check_finished(__Pyx_memviewslice __pyx_v_particles, float __pyx_v_boundary, int __pyx_v_n) {
  int __pyx_v_i;
  int __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1617</span>:     cdef int i # ,n</pre>
<pre class="cython line score-0">&#xA0;<span class="">1618</span>:     #n = particles.shape[0]</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1619</span>:     for i in range(n):</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_n;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1620</span>:         if particles[i] &gt; boundary:</pre>
<pre class='cython code score-0 '>    __pyx_t_4 = __pyx_v_i;
    __pyx_t_5 = ((*((float *) ( /* dim=0 */ (__pyx_v_particles.data + __pyx_t_4 * __pyx_v_particles.strides[0]) ))) &gt; __pyx_v_boundary);
    if (__pyx_t_5) {
/* … */
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1621</span>:             return True</pre>
<pre class='cython code score-0 '>      __pyx_r = 1;
      goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1622</span>:     return False</pre>
<pre class='cython code score-0 '>  __pyx_r = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1623</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1624</span>: #def test_check():</pre>
<pre class="cython line score-0">&#xA0;<span class="">1625</span>: #    # Quick sanity check for the check_finished function</pre>
<pre class="cython line score-0">&#xA0;<span class="">1626</span>: #    temp = np.random.normal(0,1, 10).astype(DTYPE)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1627</span>: #    cdef float[:] temp_view = temp</pre>
<pre class="cython line score-0">&#xA0;<span class="">1628</span>: #    start = time()</pre>
<pre class="cython line score-0">&#xA0;<span class="">1629</span>: #    [check_finished(temp_view, 3) for _ in range(1000000)]</pre>
<pre class="cython line score-0">&#xA0;<span class="">1630</span>: #    print(check_finished(temp_view, 3))</pre>
<pre class="cython line score-0">&#xA0;<span class="">1631</span>: #    end = time()</pre>
<pre class="cython line score-0">&#xA0;<span class="">1632</span>: #    print("cython check: {}".format(start - end))</pre>
<pre class="cython line score-0">&#xA0;<span class="">1633</span>: #    start = time()</pre>
<pre class="cython line score-0">&#xA0;<span class="">1634</span>: #    [(temp &gt; 3).any() for _ in range(1000000)]</pre>
<pre class="cython line score-0">&#xA0;<span class="">1635</span>: #    end = time()</pre>
<pre class="cython line score-0">&#xA0;<span class="">1636</span>: #    print("numpy check: {}".format(start - end))</pre>
<pre class="cython line score-0">&#xA0;<span class="">1637</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1638</span>: # @cythonboundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1639</span>: # @cythonwraparound(False)</pre>
<pre class="cython line score-144" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1640</span>: def race_model(np.ndarray[float, ndim = 2] v,  # np.array expected, one column of floats</pre>
<pre class='cython code score-144 '>static PyObject *__pyx_pf_4cssm_58__defaults__(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_r = NULL;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
/* … */
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(10);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1640, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 3, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 4, Py_None)) <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_True));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_True));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 5, ((PyObject *)Py_True))) <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults6, __pyx_self)-&gt;__pyx_arg_boundary_params);
  <span class='refnanny'>__Pyx_GIVEREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults6, __pyx_self)-&gt;__pyx_arg_boundary_params);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 6, <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults6, __pyx_self)-&gt;__pyx_arg_boundary_params)) <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 7, Py_None)) <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject*)__pyx_n_u_full));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject*)__pyx_n_u_full));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 8, ((PyObject*)__pyx_n_u_full))) <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_False));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_False));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 9, ((PyObject *)Py_False))) <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1640, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 1, Py_None)) <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.__defaults__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_4cssm_21race_model(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_4cssm_21race_model = {"race_model", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_4cssm_21race_model, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_4cssm_21race_model(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyArrayObject *__pyx_v_v = 0;
  PyArrayObject *__pyx_v_a = 0;
  PyArrayObject *__pyx_v_z = 0;
  PyArrayObject *__pyx_v_t = 0;
  PyArrayObject *__pyx_v_s = 0;
  PyArrayObject *__pyx_v_deadline = 0;
  float __pyx_v_delta_t;
  float __pyx_v_max_t;
  int __pyx_v_n_samples;
  int __pyx_v_n_trials;
  PyObject *__pyx_v_boundary_fun = 0;
  PyObject *__pyx_v_boundary_multiplicative = 0;
  PyObject *__pyx_v_boundary_params = 0;
  PyObject *__pyx_v_random_state = 0;
  PyObject *__pyx_v_return_option = 0;
  PyObject *__pyx_v_smooth = 0;
  CYTHON_UNUSED PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("race_model (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_v,&amp;__pyx_n_s_a,&amp;__pyx_n_s_z,&amp;__pyx_n_s_t,&amp;__pyx_n_s_s,&amp;__pyx_n_s_deadline,&amp;__pyx_n_s_delta_t,&amp;__pyx_n_s_max_t,&amp;__pyx_n_s_n_samples,&amp;__pyx_n_s_n_trials,&amp;__pyx_n_s_boundary_fun,&amp;__pyx_n_s_boundary_multiplicative,&amp;__pyx_n_s_boundary_params,&amp;__pyx_n_s_random_state,&amp;__pyx_n_s_return_option,&amp;__pyx_n_s_smooth,0};
  PyObject* values[16] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    __pyx_defaults6 *__pyx_dynamic_args = <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults6, __pyx_self);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs);
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4cssm_20race_model(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_t, PyArrayObject *__pyx_v_s, PyArrayObject *__pyx_v_deadline, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state, PyObject *__pyx_v_return_option, PyObject *__pyx_v_smooth, CYTHON_UNUSED PyObject *__pyx_v_kwargs) {
  __Pyx_memviewslice __pyx_v_v_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_z_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_a_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_t_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  CYTHON_UNUSED __Pyx_memviewslice __pyx_v_s_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_deadline_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  float __pyx_v_delta_t_sqrt;
  PyObject *__pyx_v_sqrt_st = NULL;
  __Pyx_memviewslice __pyx_v_sqrt_st_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_n_particles;
  PyObject *__pyx_v_rts = NULL;
  __Pyx_memviewslice __pyx_v_rts_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_choices = NULL;
  __Pyx_memviewslice __pyx_v_choices_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_particles = NULL;
  __Pyx_memviewslice __pyx_v_particles_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_traj = NULL;
  __Pyx_memviewslice __pyx_v_traj_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_num_steps;
  PyObject *__pyx_v_t_s = NULL;
  PyObject *__pyx_v_boundary = NULL;
  __Pyx_memviewslice __pyx_v_boundary_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  float __pyx_v_t_particle;
  float __pyx_v_smooth_u;
  float __pyx_v_deadline_tmp;
  Py_ssize_t __pyx_v_n;
  Py_ssize_t __pyx_v_ix;
  Py_ssize_t __pyx_v_j;
  Py_ssize_t __pyx_v_k;
  Py_ssize_t __pyx_v_m;
  int __pyx_v_num_draws;
  __Pyx_memviewslice __pyx_v_gaussian_values = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_boundary_params_tmp = NULL;
  PyObject *__pyx_v_v_dict = NULL;
  PyObject *__pyx_v_z_dict = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_8genexpr7__pyx_v_key = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_a;
  __Pyx_Buffer __pyx_pybuffer_a;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_deadline;
  __Pyx_Buffer __pyx_pybuffer_deadline;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_s;
  __Pyx_Buffer __pyx_pybuffer_s;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_t;
  __Pyx_Buffer __pyx_pybuffer_t;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_v;
  __Pyx_Buffer __pyx_pybuffer_v;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_z;
  __Pyx_Buffer __pyx_pybuffer_z;
  PyObject *__pyx_r = NULL;
  __pyx_pybuffer_v.pybuffer.buf = NULL;
  __pyx_pybuffer_v.refcount = 0;
  __pyx_pybuffernd_v.data = NULL;
  __pyx_pybuffernd_v.rcbuffer = &amp;__pyx_pybuffer_v;
  __pyx_pybuffer_a.pybuffer.buf = NULL;
  __pyx_pybuffer_a.refcount = 0;
  __pyx_pybuffernd_a.data = NULL;
  __pyx_pybuffernd_a.rcbuffer = &amp;__pyx_pybuffer_a;
  __pyx_pybuffer_z.pybuffer.buf = NULL;
  __pyx_pybuffer_z.refcount = 0;
  __pyx_pybuffernd_z.data = NULL;
  __pyx_pybuffernd_z.rcbuffer = &amp;__pyx_pybuffer_z;
  __pyx_pybuffer_t.pybuffer.buf = NULL;
  __pyx_pybuffer_t.refcount = 0;
  __pyx_pybuffernd_t.data = NULL;
  __pyx_pybuffernd_t.rcbuffer = &amp;__pyx_pybuffer_t;
  __pyx_pybuffer_s.pybuffer.buf = NULL;
  __pyx_pybuffer_s.refcount = 0;
  __pyx_pybuffernd_s.data = NULL;
  __pyx_pybuffernd_s.rcbuffer = &amp;__pyx_pybuffer_s;
  __pyx_pybuffer_deadline.pybuffer.buf = NULL;
  __pyx_pybuffer_deadline.refcount = 0;
  __pyx_pybuffernd_deadline.data = NULL;
  __pyx_pybuffernd_deadline.rcbuffer = &amp;__pyx_pybuffer_deadline;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_v, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_v.diminfo[0].strides = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_v.diminfo[0].shape = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_v.diminfo[1].strides = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_v.diminfo[1].shape = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_a, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_a.diminfo[1].strides = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_a.diminfo[1].shape = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_z, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_z.diminfo[0].strides = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_z.diminfo[0].shape = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_z.diminfo[1].strides = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_z.diminfo[1].shape = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_t, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_t.diminfo[0].strides = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_t.diminfo[0].shape = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_t.diminfo[1].strides = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_t.diminfo[1].shape = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_s.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_s, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_s.diminfo[0].strides = __pyx_pybuffernd_s.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_s.diminfo[0].shape = __pyx_pybuffernd_s.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_s.diminfo[1].strides = __pyx_pybuffernd_s.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_s.diminfo[1].shape = __pyx_pybuffernd_s.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_deadline, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_deadline.diminfo[0].strides = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_deadline.diminfo[0].shape = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.shape[0];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_2, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_3, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_10, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_s.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.race_model", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_s.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_v_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_z_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_a_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_t_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_s_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_deadline_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sqrt_st);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_sqrt_st_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rts);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_rts_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_choices);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_choices_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_particles);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_particles_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_traj);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_traj_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t_s);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_boundary);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_boundary_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_boundary_params_tmp);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_v_dict);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_z_dict);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr7__pyx_v_key);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__43 = <span class='py_c_api'>PyTuple_Pack</span>(54, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_t, __pyx_n_s_s, __pyx_n_s_deadline, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_boundary_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_random_state, __pyx_n_s_return_option, __pyx_n_s_smooth, __pyx_n_s_kwargs, __pyx_n_s_v_view, __pyx_n_s_z_view, __pyx_n_s_a_view, __pyx_n_s_t_view, __pyx_n_s_s_view, __pyx_n_s_deadline_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_sqrt_st_view, __pyx_n_s_n_particles, __pyx_n_s_rts, __pyx_n_s_rts_view, __pyx_n_s_choices, __pyx_n_s_choices_view, __pyx_n_s_particles, __pyx_n_s_particles_view, __pyx_n_s_traj, __pyx_n_s_traj_view, __pyx_n_s_num_steps, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_boundary_view, __pyx_n_s_t_particle, __pyx_n_s_smooth_u, __pyx_n_s_deadline_tmp, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_j, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_num_draws, __pyx_n_s_gaussian_values, __pyx_n_s_boundary_params_tmp, __pyx_n_s_v_dict, __pyx_n_s_z_dict, __pyx_n_s_i, __pyx_n_s_key);<span class='error_goto'> if (unlikely(!__pyx_tuple__43)) __PYX_ERR(0, 1640, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__43);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__43);
/* … */
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_4cssm_21race_model, 0, __pyx_n_s_race_model, NULL, __pyx_n_s_cssm, __pyx_d, ((PyObject *)__pyx_codeobj__44));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1640, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (!<span class='pyx_c_api'>__Pyx_CyFunction_InitDefaults</span>(__pyx_t_5, sizeof(__pyx_defaults6), 1)) <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L1_error)</span>
  __pyx_codeobj__44 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(16, 0, 0, 54, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__43, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_race_model, 1640, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__44)) __PYX_ERR(0, 1640, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1641</span>:                np.ndarray[float, ndim = 2] a, # initial boundary separation</pre>
<pre class="cython line score-0">&#xA0;<span class="">1642</span>:                np.ndarray[float, ndim = 2] z, # np.array expected, one column of floats</pre>
<pre class="cython line score-0">&#xA0;<span class="">1643</span>:                np.ndarray[float, ndim = 2] t, # for now we we don't allow t by choice</pre>
<pre class="cython line score-0">&#xA0;<span class="">1644</span>:                np.ndarray[float, ndim = 2] s, # np.array expected, one column of floats</pre>
<pre class="cython line score-0">&#xA0;<span class="">1645</span>:                np.ndarray[float, ndim = 1] deadline,</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1646</span>:                float delta_t = 0.001, # time increment step</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(((double)0.001));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1646, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1647</span>:                float max_t = 20, # maximum rt allowed</pre>
<pre class='cython code score-5 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)20.0));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1647, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1648</span>:                int n_samples = 2000,</pre>
<pre class='cython code score-2 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)0x7D0));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1648, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1649</span>:                int n_trials = 1,</pre>
<pre class='cython code score-2 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)1));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1649, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1650</span>:                boundary_fun = None,</pre>
<pre class='cython code score-6 '>    values[10] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[11] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_True)));
    values[12] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(__pyx_dynamic_args-&gt;__pyx_arg_boundary_params);
</pre><pre class="cython line score-0">&#xA0;<span class="">1651</span>:                boundary_multiplicative = True,</pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1652</span>:                boundary_params = {},</pre>
<pre class='cython code score-12 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1652, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults6, __pyx_t_5)-&gt;__pyx_arg_boundary_params = __pyx_t_4;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_4 = 0;
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsGetter</span>(__pyx_t_5, __pyx_pf_4cssm_58__defaults__);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_race_model, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-281" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1653</span>:                random_state = None,</pre>
<pre class='cython code score-281 '>    values[13] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[14] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_full)));
    values[15] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case 16: values[15] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 15);
        CYTHON_FALLTHROUGH;
        case 15: values[14] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_v)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_a)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("race_model", 0, 6, 16, 1); <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_z)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("race_model", 0, 6, 16, 2); <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_t)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[3]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("race_model", 0, 6, 16, 3); <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_s)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[4]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("race_model", 0, 6, 16, 4); <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_deadline)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[5]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("race_model", 0, 6, 16, 5); <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_delta_t);
          if (value) { values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_max_t);
          if (value) { values[7] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_samples);
          if (value) { values[8] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  9:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_trials);
          if (value) { values[9] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 10:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_fun);
          if (value) { values[10] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 11:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_multiplicative);
          if (value) { values[11] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 12:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_params);
          if (value) { values[12] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 13:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_random_state);
          if (value) { values[13] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 14:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_return_option);
          if (value) { values[14] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 15:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_smooth);
          if (value) { values[15] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values + 0, kwd_pos_args, "race_model") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case 16: values[15] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 15);
        CYTHON_FALLTHROUGH;
        case 15: values[14] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_v = ((PyArrayObject *)values[0]);
    __pyx_v_a = ((PyArrayObject *)values[1]);
    __pyx_v_z = ((PyArrayObject *)values[2]);
    __pyx_v_t = ((PyArrayObject *)values[3]);
    __pyx_v_s = ((PyArrayObject *)values[4]);
    __pyx_v_deadline = ((PyArrayObject *)values[5]);
    if (values[6]) {
      __pyx_v_delta_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[6]); if (unlikely((__pyx_v_delta_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1646, __pyx_L3_error)</span>
    } else {
      __pyx_v_delta_t = ((float)((double)0.001));
    }
    if (values[7]) {
      __pyx_v_max_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[7]); if (unlikely((__pyx_v_max_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1647, __pyx_L3_error)</span>
    } else {
      __pyx_v_max_t = ((float)((float)20.0));
    }
    if (values[8]) {
      __pyx_v_n_samples = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[8]); if (unlikely((__pyx_v_n_samples == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1648, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_samples = ((int)((int)0x7D0));
    }
    if (values[9]) {
      __pyx_v_n_trials = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[9]); if (unlikely((__pyx_v_n_trials == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1649, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_trials = ((int)((int)1));
    }
    __pyx_v_boundary_fun = values[10];
    __pyx_v_boundary_multiplicative = values[11];
    __pyx_v_boundary_params = values[12];
    __pyx_v_random_state = values[13];
    __pyx_v_return_option = values[14];
    __pyx_v_smooth = values[15];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("race_model", 0, 6, 16, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.race_model", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) <span class='error_goto'>__PYX_ERR(0, 1640, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) <span class='error_goto'>__PYX_ERR(0, 1641, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) <span class='error_goto'>__PYX_ERR(0, 1642, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) <span class='error_goto'>__PYX_ERR(0, 1643, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_s), __pyx_ptype_5numpy_ndarray, 1, "s", 0))) <span class='error_goto'>__PYX_ERR(0, 1644, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_deadline), __pyx_ptype_5numpy_ndarray, 1, "deadline", 0))) <span class='error_goto'>__PYX_ERR(0, 1645, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_4cssm_20race_model(__pyx_self, __pyx_v_v, __pyx_v_a, __pyx_v_z, __pyx_v_t, __pyx_v_s, __pyx_v_deadline, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state, __pyx_v_return_option, __pyx_v_smooth, __pyx_v_kwargs);
</pre><pre class="cython line score-0">&#xA0;<span class="">1654</span>:                return_option = 'full',</pre>
<pre class="cython line score-0">&#xA0;<span class="">1655</span>:                smooth = False,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1656</span>:                **kwargs):</pre>
<pre class="cython line score-0">&#xA0;<span class="">1657</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1658</span>:     set_seed(random_state)</pre>
<pre class='cython code score-1 '>  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1658, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1659</span>:     # Param views</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1660</span>:     cdef float[:, :] v_view = v</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(((PyObject *)__pyx_v_v), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1660, __pyx_L1_error)</span>
  __pyx_v_v_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1661</span>:     cdef float[:, :] z_view = z</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(((PyObject *)__pyx_v_z), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1661, __pyx_L1_error)</span>
  __pyx_v_z_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1662</span>:     cdef float[:, :] a_view = a</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(((PyObject *)__pyx_v_a), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1662, __pyx_L1_error)</span>
  __pyx_v_a_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1663</span>:     cdef float[:, :] t_view = t</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(((PyObject *)__pyx_v_t), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1663, __pyx_L1_error)</span>
  __pyx_v_t_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1664</span>:     cdef float[:, :] s_view = s</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(((PyObject *)__pyx_v_s), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1664, __pyx_L1_error)</span>
  __pyx_v_s_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1665</span>:     cdef float[:] deadline_view = deadline</pre>
<pre class='cython code score-2 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_deadline), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 1665, __pyx_L1_error)</span>
  __pyx_v_deadline_view = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1666</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1667</span>:     cdef float delta_t_sqrt = sqrt(delta_t)</pre>
<pre class='cython code score-0 '>  __pyx_v_delta_t_sqrt = sqrt(__pyx_v_delta_t);
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1668</span>:     sqrt_st = delta_t_sqrt * s</pre>
<pre class='cython code score-11 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_t_sqrt);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1668, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, ((PyObject *)__pyx_v_s));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1668, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_sqrt_st = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1669</span>:     cdef float[:, :] sqrt_st_view = sqrt_st</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(__pyx_v_sqrt_st, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1669, __pyx_L1_error)</span>
  __pyx_v_sqrt_st_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1670</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1671</span>:     cdef int n_particles = v.shape[1]</pre>
<pre class='cython code score-5 '>  __pyx_t_5 = __pyx_f_5numpy_7ndarray_5shape_shape(((PyArrayObject *)__pyx_v_v)); if (unlikely(__pyx_t_5 == ((npy_intp *)NULL) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1671, __pyx_L1_error)</span>
  __pyx_v_n_particles = (__pyx_t_5[1]);
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1672</span>:     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)</pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1672, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1672, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1672, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1672, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1672, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1672, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 1672, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_7, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 1672, __pyx_L1_error)</span>;
  __pyx_t_4 = 0;
  __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1672, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 1672, __pyx_L1_error)</span>;
  __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1672, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1672, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1672, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_6, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1672, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_v_rts = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1673</span>:     cdef float[:, :, :] rts_view = rts</pre>
<pre class='cython code score-2 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_rts, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1673, __pyx_L1_error)</span>
  __pyx_v_rts_view = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1674</span>:     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)</pre>
<pre class='cython code score-46 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1674, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1674, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1674, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1674, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1674, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1674, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 1674, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 1674, __pyx_L1_error)</span>;
  __pyx_t_4 = 0;
  __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1674, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1674, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1674, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1674, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_intc);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1674, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_9) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1674, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_6, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1674, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_choices = __pyx_t_9;
  __pyx_t_9 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1675</span>:     cdef int[:, :, :] choices_view = choices</pre>
<pre class='cython code score-2 '>  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_int</span>(__pyx_v_choices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 1675, __pyx_L1_error)</span>
  __pyx_v_choices_view = __pyx_t_10;
  __pyx_t_10.memview = NULL;
  __pyx_t_10.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1676</span>: </pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1677</span>:     particles = np.zeros((n_particles), dtype = DTYPE)</pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1677, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1677, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_particles);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1677, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1677, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 1677, __pyx_L1_error)</span>;
  __pyx_t_9 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1677, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1677, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_s_dtype, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1677, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_6, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1677, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_v_particles = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1678</span>:     cdef float [:] particles_view = particles</pre>
<pre class='cython code score-2 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(__pyx_v_particles, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 1678, __pyx_L1_error)</span>
  __pyx_v_particles_view = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1679</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1680</span>:     # TD: Add Trajectory</pre>
<pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1681</span>:     traj = np.zeros((int(max_t / delta_t) + 1, n_particles), dtype = DTYPE)</pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1681, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1681, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_FromDouble</span>((__pyx_v_max_t / __pyx_v_delta_t));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1681, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_7, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1681, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_particles);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1681, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1681, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 1681, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 1681, __pyx_L1_error)</span>;
  __pyx_t_6 = 0;
  __pyx_t_7 = 0;
  __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1681, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1681, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1681, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1681, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1681, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_7, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1681, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_traj = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1682</span>:     traj[:, :] = -999</pre>
<pre class='cython code score-5 '>  if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_traj, __pyx_tuple__12, __pyx_int_neg_999) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1682, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1683</span>:     cdef float[:, :] traj_view = traj</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(__pyx_v_traj, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1683, __pyx_L1_error)</span>
  __pyx_v_traj_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1684</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1685</span>:     # Boundary storage</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1686</span>:     cdef int num_steps = int((max_t / delta_t) + 1)</pre>
<pre class='cython code score-0 '>  __pyx_v_num_steps = ((int)((__pyx_v_max_t / __pyx_v_delta_t) + 1.0));
</pre><pre class="cython line score-0">&#xA0;<span class="">1687</span>: </pre>
<pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1688</span>:     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)</pre>
<pre class='cython code score-51 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1688, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1688, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_max_t + __pyx_v_delta_t));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1688, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_t);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1688, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_11 = NULL;
  __pyx_t_12 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
    __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
    if (likely(__pyx_t_11)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
      __pyx_t_12 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[4] = {__pyx_t_11, __pyx_int_0, __pyx_t_7, __pyx_t_4};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+1-__pyx_t_12, 3+__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1688, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  }
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1688, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1688, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = NULL;
  __pyx_t_12 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
      __pyx_t_12 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_1};
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+1-__pyx_t_12, 1+__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 1688, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  }
  __pyx_v_t_s = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1689</span>:     boundary = np.zeros(t_s.shape, dtype = DTYPE)</pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1689, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1689, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_t_s, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1689, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1689, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 1689, __pyx_L1_error)</span>;
  __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1689, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1689, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1689, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_1, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1689, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_boundary = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1690</span>:     cdef float[:] boundary_view = boundary</pre>
<pre class='cython code score-2 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(__pyx_v_boundary, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 1690, __pyx_L1_error)</span>
  __pyx_v_boundary_view = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1691</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1692</span>:     # Initialize variables needed for for loop</pre>
<pre class="cython line score-0">&#xA0;<span class="">1693</span>:     cdef float t_particle, smooth_u, deadline_tmp</pre>
<pre class="cython line score-0">&#xA0;<span class="">1694</span>:     cdef Py_ssize_t n, ix, j, k</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1695</span>:     cdef Py_ssize_t m = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_m = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1696</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1697</span>:     cdef int num_draws = num_steps * n_particles</pre>
<pre class='cython code score-0 '>  __pyx_v_num_draws = (__pyx_v_num_steps * __pyx_v_n_particles);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1698</span>:     cdef float[:] gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>  __pyx_t_3 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 1698, __pyx_L1_error)</span>
  __pyx_v_gaussian_values = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1699</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1700</span>:     for k in range(n_trials):</pre>
<pre class='cython code score-0 '>  __pyx_t_12 = __pyx_v_n_trials;
  __pyx_t_13 = __pyx_t_12;
  for (__pyx_t_14 = 0; __pyx_t_14 &lt; __pyx_t_13; __pyx_t_14+=1) {
    __pyx_v_k = __pyx_t_14;
</pre><pre class="cython line score-0">&#xA0;<span class="">1701</span>:         # Precompute boundary evaluations</pre>
<pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1702</span>:         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}</pre>
<pre class='cython code score-27 '>    { /* enter inner scope */
      __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1702, __pyx_L7_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_15 = 0;
      if (unlikely(__pyx_v_boundary_params == Py_None)) {
        <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "keys");
        <span class='error_goto'>__PYX_ERR(0, 1702, __pyx_L7_error)</span>
      }
      __pyx_t_1 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&amp;__pyx_t_16), (&amp;__pyx_t_17));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1702, __pyx_L7_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
      __pyx_t_6 = __pyx_t_1;
      __pyx_t_1 = 0;
      while (1) {
        __pyx_t_18 = __Pyx_dict_iter_next(__pyx_t_6, __pyx_t_16, &amp;__pyx_t_15, &amp;__pyx_t_1, NULL, NULL, __pyx_t_17);
        if (unlikely(__pyx_t_18 == 0)) break;
        if (unlikely(__pyx_t_18 == -1)) <span class='error_goto'>__PYX_ERR(0, 1702, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_8genexpr7__pyx_v_key, __pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_boundary_params, __pyx_8genexpr7__pyx_v_key);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1702, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1702, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, (PyObject*)__pyx_8genexpr7__pyx_v_key, (PyObject*)__pyx_t_9))) <span class='error_goto'>__PYX_ERR(0, 1702, __pyx_L7_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr7__pyx_v_key); __pyx_8genexpr7__pyx_v_key = 0;
      goto __pyx_L10_exit_scope;
      __pyx_L7_error:;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr7__pyx_v_key); __pyx_8genexpr7__pyx_v_key = 0;
      goto __pyx_L1_error;
      __pyx_L10_exit_scope:;
    } /* exit inner scope */
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_boundary_params_tmp, ((PyObject*)__pyx_t_4));
    __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1703</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1704</span>:         # Precompute boundary evaluations</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1705</span>:         if boundary_multiplicative:</pre>
<pre class='cython code score-2 '>    __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_boundary_multiplicative); if (unlikely((__pyx_t_19 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1705, __pyx_L1_error)</span>
    if (__pyx_t_19) {
/* … */
      goto __pyx_L11;
    }
</pre><pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1706</span>:             boundary[:] = np.multiply(a_view[k, 0], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)</pre>
<pre class='cython code score-61 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1706, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_multiply);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1706, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_20 = __pyx_v_k;
      __pyx_t_21 = 0;
      __pyx_t_9 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_20 * __pyx_v_a_view.strides[0]) ) + __pyx_t_21 * __pyx_v_a_view.strides[1]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1706, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1706, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_11, __pyx_n_s_t, __pyx_v_t_s) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1706, __pyx_L1_error)</span>
      __pyx_t_7 = __pyx_t_11;
      __pyx_t_11 = 0;
      if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_7, __pyx_v_boundary_params_tmp) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1706, __pyx_L1_error)</span>
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1706, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = NULL;
      __pyx_t_17 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_7)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
          __pyx_t_17 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_7, __pyx_t_9, __pyx_t_11};
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_17, 2+__pyx_t_17);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 1706, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1706, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1706, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_11 = NULL;
      __pyx_t_17 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_11)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
          __pyx_t_17 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_11, __pyx_t_6};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_17, 1+__pyx_t_17);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1706, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_boundary, __pyx_t_4, 0, 0, NULL, NULL, &amp;__pyx_slice__5, 0, 0, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1706, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1707</span>:         else:</pre>
<pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1708</span>:             boundary[:] = np.add(a_view[k, 0], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)</pre>
<pre class='cython code score-61 '>    /*else*/ {
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1708, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_add);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1708, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_21 = __pyx_v_k;
      __pyx_t_20 = 0;
      __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_21 * __pyx_v_a_view.strides[0]) ) + __pyx_t_20 * __pyx_v_a_view.strides[1]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1708, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1708, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_t, __pyx_v_t_s) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1708, __pyx_L1_error)</span>
      __pyx_t_9 = __pyx_t_7;
      __pyx_t_7 = 0;
      if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_9, __pyx_v_boundary_params_tmp) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1708, __pyx_L1_error)</span>
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1708, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = NULL;
      __pyx_t_17 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
        __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
        if (likely(__pyx_t_9)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
          __pyx_t_17 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_9, __pyx_t_6, __pyx_t_7};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_11, __pyx_callargs+1-__pyx_t_17, 2+__pyx_t_17);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1708, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      }
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1708, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1708, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_7 = NULL;
      __pyx_t_17 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
        __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
        if (likely(__pyx_t_7)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
          __pyx_t_17 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_t_1};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_11, __pyx_callargs+1-__pyx_t_17, 1+__pyx_t_17);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1708, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      }
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_boundary, __pyx_t_4, 0, 0, NULL, NULL, &amp;__pyx_slice__5, 0, 0, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1708, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    __pyx_L11:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1709</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1710</span>:         deadline_tmp = min(max_t, deadline_view[k] - t_view[k, 0])</pre>
<pre class='cython code score-0 '>    __pyx_t_20 = __pyx_v_k;
    __pyx_t_21 = __pyx_v_k;
    __pyx_t_22 = 0;
    __pyx_t_23 = ((*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_20 * __pyx_v_deadline_view.strides[0]) ))) - (*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_21 * __pyx_v_t_view.strides[0]) ) + __pyx_t_22 * __pyx_v_t_view.strides[1]) ))));
    __pyx_t_24 = __pyx_v_max_t;
    __pyx_t_19 = (__pyx_t_23 &lt; __pyx_t_24);
    if (__pyx_t_19) {
      __pyx_t_25 = __pyx_t_23;
    } else {
      __pyx_t_25 = __pyx_t_24;
    }
    __pyx_v_deadline_tmp = __pyx_t_25;
</pre><pre class="cython line score-0">&#xA0;<span class="">1711</span>:         # Loop over samples</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1712</span>:         for n in range(n_samples):</pre>
<pre class='cython code score-0 '>    __pyx_t_17 = __pyx_v_n_samples;
    __pyx_t_18 = __pyx_t_17;
    for (__pyx_t_16 = 0; __pyx_t_16 &lt; __pyx_t_18; __pyx_t_16+=1) {
      __pyx_v_n = __pyx_t_16;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1713</span>:             for j in range(n_particles):</pre>
<pre class='cython code score-0 '>      __pyx_t_26 = __pyx_v_n_particles;
      __pyx_t_27 = __pyx_t_26;
      for (__pyx_t_15 = 0; __pyx_t_15 &lt; __pyx_t_27; __pyx_t_15+=1) {
        __pyx_v_j = __pyx_t_15;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1714</span>:                 particles_view[j] = z_view[k, j] * boundary_view[0] # Reset particle starting points</pre>
<pre class='cython code score-0 '>        __pyx_t_22 = __pyx_v_k;
        __pyx_t_21 = __pyx_v_j;
        __pyx_t_20 = 0;
        __pyx_t_28 = __pyx_v_j;
        *((float *) ( /* dim=0 */ (__pyx_v_particles_view.data + __pyx_t_28 * __pyx_v_particles_view.strides[0]) )) = ((*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_z_view.data + __pyx_t_22 * __pyx_v_z_view.strides[0]) ) + __pyx_t_21 * __pyx_v_z_view.strides[1]) ))) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) ))));
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">1715</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1716</span>:             t_particle = 0.0 # reset time</pre>
<pre class='cython code score-0 '>      __pyx_v_t_particle = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1717</span>:             ix = 0</pre>
<pre class='cython code score-0 '>      __pyx_v_ix = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1718</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1719</span>:             if n == 0:</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = (__pyx_v_n == 0);
      if (__pyx_t_19) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1720</span>:                 if k == 0:</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = (__pyx_v_k == 0);
        if (__pyx_t_19) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1721</span>:                     for j in range(n_particles):</pre>
<pre class='cython code score-0 '>          __pyx_t_26 = __pyx_v_n_particles;
          __pyx_t_27 = __pyx_t_26;
          for (__pyx_t_15 = 0; __pyx_t_15 &lt; __pyx_t_27; __pyx_t_15+=1) {
            __pyx_v_j = __pyx_t_15;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1722</span>:                         traj_view[0, j] = particles[j]</pre>
<pre class='cython code score-13 '>            __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_particles, __pyx_v_j, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1722, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            __pyx_t_25 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_4); if (unlikely((__pyx_t_25 == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1722, __pyx_L1_error)</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
            __pyx_t_20 = 0;
            __pyx_t_21 = __pyx_v_j;
            *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_20 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_21 * __pyx_v_traj_view.strides[1]) )) = __pyx_t_25;
          }
</pre><pre class="cython line score-0">&#xA0;<span class="">1723</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1724</span>:             # Random walker</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1725</span>:             while not check_finished(particles_view, boundary_view[ix], n_particles) and t_particle &lt;= deadline_tmp:</pre>
<pre class='cython code score-5 '>      while (1) {
        __pyx_t_21 = __pyx_v_ix;
        __pyx_t_29 = __pyx_f_4cssm_check_finished(__pyx_v_particles_view, (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_21 * __pyx_v_boundary_view.strides[0]) ))), __pyx_v_n_particles); if (unlikely(__pyx_t_29 == ((int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1725, __pyx_L1_error)</span>
        __pyx_t_30 = (!__pyx_t_29);
        if (__pyx_t_30) {
        } else {
          __pyx_t_19 = __pyx_t_30;
          goto __pyx_L22_bool_binop_done;
        }
        __pyx_t_30 = (__pyx_v_t_particle &lt;= __pyx_v_deadline_tmp);
        __pyx_t_19 = __pyx_t_30;
        __pyx_L22_bool_binop_done:;
        if (!__pyx_t_19) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1726</span>:                 for j in range(n_particles):</pre>
<pre class='cython code score-0 '>        __pyx_t_26 = __pyx_v_n_particles;
        __pyx_t_27 = __pyx_t_26;
        for (__pyx_t_15 = 0; __pyx_t_15 &lt; __pyx_t_27; __pyx_t_15+=1) {
          __pyx_v_j = __pyx_t_15;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1727</span>:                     particles_view[j] += (v_view[k, j] * delta_t) + sqrt_st_view[k, j] * gaussian_values[m]</pre>
<pre class='cython code score-0 '>          __pyx_t_21 = __pyx_v_k;
          __pyx_t_20 = __pyx_v_j;
          __pyx_t_22 = __pyx_v_k;
          __pyx_t_28 = __pyx_v_j;
          __pyx_t_31 = __pyx_v_m;
          __pyx_t_32 = __pyx_v_j;
          *((float *) ( /* dim=0 */ (__pyx_v_particles_view.data + __pyx_t_32 * __pyx_v_particles_view.strides[0]) )) += (((*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v_view.data + __pyx_t_21 * __pyx_v_v_view.strides[0]) ) + __pyx_t_20 * __pyx_v_v_view.strides[1]) ))) * __pyx_v_delta_t) + ((*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_sqrt_st_view.data + __pyx_t_22 * __pyx_v_sqrt_st_view.strides[0]) ) + __pyx_t_28 * __pyx_v_sqrt_st_view.strides[1]) ))) * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_31 * __pyx_v_gaussian_values.strides[0]) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1728</span>:                     particles_view[j] = fmax(0.0, particles_view[j]) # Cut off particles at 0</pre>
<pre class='cython code score-0 '>          __pyx_t_31 = __pyx_v_j;
          __pyx_t_28 = __pyx_v_j;
          *((float *) ( /* dim=0 */ (__pyx_v_particles_view.data + __pyx_t_28 * __pyx_v_particles_view.strides[0]) )) = fmax(0.0, (*((float *) ( /* dim=0 */ (__pyx_v_particles_view.data + __pyx_t_31 * __pyx_v_particles_view.strides[0]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1729</span>:                     m += 1</pre>
<pre class='cython code score-0 '>          __pyx_v_m = (__pyx_v_m + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1730</span>:                     if m == num_draws:</pre>
<pre class='cython code score-0 '>          __pyx_t_19 = (__pyx_v_m == __pyx_v_num_draws);
          if (__pyx_t_19) {
/* … */
          }
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1731</span>:                         m = 0</pre>
<pre class='cython code score-0 '>            __pyx_v_m = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1732</span>:                         gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>            __pyx_t_3 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 1732, __pyx_L1_error)</span>
            __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
            __pyx_v_gaussian_values = __pyx_t_3;
            __pyx_t_3.memview = NULL;
            __pyx_t_3.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1733</span>:                 t_particle += delta_t</pre>
<pre class='cython code score-0 '>        __pyx_v_t_particle = (__pyx_v_t_particle + __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1734</span>:                 ix += 1</pre>
<pre class='cython code score-0 '>        __pyx_v_ix = (__pyx_v_ix + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1735</span>:                 if n == 0:</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = (__pyx_v_n == 0);
        if (__pyx_t_19) {
/* … */
        }
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1736</span>:                     if k == 0:</pre>
<pre class='cython code score-0 '>          __pyx_t_19 = (__pyx_v_k == 0);
          if (__pyx_t_19) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1737</span>:                         for j in range(n_particles):</pre>
<pre class='cython code score-0 '>            __pyx_t_26 = __pyx_v_n_particles;
            __pyx_t_27 = __pyx_t_26;
            for (__pyx_t_15 = 0; __pyx_t_15 &lt; __pyx_t_27; __pyx_t_15+=1) {
              __pyx_v_j = __pyx_t_15;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1738</span>:                             traj_view[ix, j] = particles[j]</pre>
<pre class='cython code score-13 '>              __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_particles, __pyx_v_j, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1738, __pyx_L1_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
              __pyx_t_25 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_4); if (unlikely((__pyx_t_25 == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1738, __pyx_L1_error)</span>
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
              __pyx_t_31 = __pyx_v_ix;
              __pyx_t_28 = __pyx_v_j;
              *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_31 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_28 * __pyx_v_traj_view.strides[1]) )) = __pyx_t_25;
            }
</pre><pre class="cython line score-0">&#xA0;<span class="">1739</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1740</span>:             if smooth:</pre>
<pre class='cython code score-2 '>      __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_smooth); if (unlikely((__pyx_t_19 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1740, __pyx_L1_error)</span>
      if (__pyx_t_19) {
/* … */
        goto __pyx_L31;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1741</span>:                 if t_particle == 0.0:</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = (__pyx_v_t_particle == 0.0);
        if (__pyx_t_19) {
/* … */
          goto __pyx_L32;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1742</span>:                     smooth_u = random_uniform() * 0.5 * delta_t</pre>
<pre class='cython code score-5 '>          __pyx_t_25 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_25 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1742, __pyx_L1_error)</span>
          __pyx_v_smooth_u = ((__pyx_t_25 * 0.5) * __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1743</span>:                 elif t_particle &lt; deadline_tmp:</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = (__pyx_v_t_particle &lt; __pyx_v_deadline_tmp);
        if (__pyx_t_19) {
/* … */
          goto __pyx_L32;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1744</span>:                     smooth_u = (0.5 - random_uniform()) * delta_t</pre>
<pre class='cython code score-5 '>          __pyx_t_25 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_25 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1744, __pyx_L1_error)</span>
          __pyx_v_smooth_u = ((0.5 - __pyx_t_25) * __pyx_v_delta_t);
</pre><pre class="cython line score-0">&#xA0;<span class="">1745</span>:                 else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1746</span>:                     smooth_u = 0.0</pre>
<pre class='cython code score-0 '>        /*else*/ {
          __pyx_v_smooth_u = 0.0;
        }
        __pyx_L32:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1747</span>:             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1748</span>:                 smooth_u = 0.0</pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_v_smooth_u = 0.0;
      }
      __pyx_L31:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1749</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1750</span>:             rts_view[n , k, 0] = t_particle + t[k, 0] + smooth_u # for now no t per choice option</pre>
<pre class='cython code score-0 '>      __pyx_t_28 = __pyx_v_k;
      __pyx_t_31 = 0;
      __pyx_t_22 = __pyx_v_n;
      __pyx_t_20 = __pyx_v_k;
      __pyx_t_21 = 0;
      *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_22 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_20 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_21 * __pyx_v_rts_view.strides[2]) )) = ((__pyx_v_t_particle + (*__Pyx_BufPtrStrided2d(float *, __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.buf, __pyx_t_28, __pyx_pybuffernd_t.diminfo[0].strides, __pyx_t_31, __pyx_pybuffernd_t.diminfo[1].strides))) + __pyx_v_smooth_u);
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1751</span>:             choices_view[n, k, 0] = np.argmax(particles)</pre>
<pre class='cython code score-27 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_11, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1751, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_11, __pyx_n_s_argmax);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1751, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      __pyx_t_11 = NULL;
      __pyx_t_26 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_11)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
          __pyx_t_26 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_11, __pyx_v_particles};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_26, 1+__pyx_t_26);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1751, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      __pyx_t_26 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_4); if (unlikely((__pyx_t_26 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1751, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_31 = __pyx_v_n;
      __pyx_t_28 = __pyx_v_k;
      __pyx_t_21 = 0;
      *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_31 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_28 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_21 * __pyx_v_choices_view.strides[2]) )) = __pyx_t_26;
</pre><pre class="cython line score-0">&#xA0;<span class="">1752</span>:             #rts_view[n, 0] = t + t[choices_view[n, 0]]</pre>
<pre class="cython line score-0">&#xA0;<span class="">1753</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1754</span>:             if (rts_view[n, k, 0] &gt;= deadline_view[k]) | (deadline_view[k] &lt;= 0):</pre>
<pre class='cython code score-0 '>      __pyx_t_21 = __pyx_v_n;
      __pyx_t_28 = __pyx_v_k;
      __pyx_t_31 = 0;
      __pyx_t_20 = __pyx_v_k;
      __pyx_t_22 = __pyx_v_k;
      __pyx_t_19 = (((*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_21 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_28 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_31 * __pyx_v_rts_view.strides[2]) ))) &gt;= (*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_20 * __pyx_v_deadline_view.strides[0]) )))) | ((*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_22 * __pyx_v_deadline_view.strides[0]) ))) &lt;= 0.0));
      if (__pyx_t_19) {
/* … */
      }
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1755</span>:                 rts_view[n, k, 0] = -999</pre>
<pre class='cython code score-0 '>        __pyx_t_22 = __pyx_v_n;
        __pyx_t_20 = __pyx_v_k;
        __pyx_t_31 = 0;
        *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_22 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_20 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_31 * __pyx_v_rts_view.strides[2]) )) = -999.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1756</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1757</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1758</span>:         # Create some dics</pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1759</span>:         v_dict = {}</pre>
<pre class='cython code score-3 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1759, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_v_dict, ((PyObject*)__pyx_t_4));
    __pyx_t_4 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1760</span>:         z_dict = {}</pre>
<pre class='cython code score-3 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1760, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_z_dict, ((PyObject*)__pyx_t_4));
    __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1761</span>:         #t_dict = {}</pre>
<pre class="cython line score-55" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1762</span>:         for i in range(n_particles):</pre>
<pre class='cython code score-55 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_particles);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1762, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1762, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
      __pyx_t_4 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      __pyx_t_16 = 0;
      __pyx_t_33 = NULL;
    } else {
      __pyx_t_16 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1762, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_33 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_33)) __PYX_ERR(0, 1762, __pyx_L1_error)</span>
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    for (;;) {
      if (likely(!__pyx_t_33)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_4);
            #if !CYTHON_ASSUME_SAFE_MACROS
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1762, __pyx_L1_error)</span>
            #endif
            if (__pyx_t_16 &gt;= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_16); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_16++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1762, __pyx_L1_error)</span>
          #else
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_4, __pyx_t_16); __pyx_t_16++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1762, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        } else {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_4);
            #if !CYTHON_ASSUME_SAFE_MACROS
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1762, __pyx_L1_error)</span>
            #endif
            if (__pyx_t_16 &gt;= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_16); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_16++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1762, __pyx_L1_error)</span>
          #else
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_4, __pyx_t_16); __pyx_t_16++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1762, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        }
      } else {
        __pyx_t_1 = __pyx_t_33(__pyx_t_4);
        if (unlikely(!__pyx_t_1)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>__PYX_ERR(0, 1762, __pyx_L1_error)</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_1);
      __pyx_t_1 = 0;
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1763</span>:             v_dict['v' + str(i)] = v[:, i]</pre>
<pre class='cython code score-29 '>      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1763, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__5);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_slice__5)) <span class='error_goto'>__PYX_ERR(0, 1763, __pyx_L1_error)</span>;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_i)) <span class='error_goto'>__PYX_ERR(0, 1763, __pyx_L1_error)</span>;
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_v), __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1763, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Str</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1763, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_7 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_n_u_v, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1763, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely((<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_v_dict, __pyx_t_7, __pyx_t_11) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1763, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1764</span>:             z_dict['z' + str(i)] = z[:, i]</pre>
<pre class='cython code score-29 '>      __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1764, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__5);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_slice__5)) <span class='error_goto'>__PYX_ERR(0, 1764, __pyx_L1_error)</span>;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_11, 1, __pyx_v_i)) <span class='error_goto'>__PYX_ERR(0, 1764, __pyx_L1_error)</span>;
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_z), __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1764, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Str</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1764, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_n_u_z, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1764, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      if (unlikely((<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_z_dict, __pyx_t_1, __pyx_t_7) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1764, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1765</span>:             #t_dict['t_' + str(i)] = t[i] # for now no t by choice</pre>
<pre class="cython line score-0">&#xA0;<span class="">1766</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1767</span>:     if return_option == 'full':</pre>
<pre class='cython code score-2 '>  __pyx_t_19 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_return_option, __pyx_n_u_full, Py_EQ)); if (unlikely((__pyx_t_19 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1767, __pyx_L1_error)</span>
  if (__pyx_t_19) {
/* … */
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1768</span>:         return {'rts': rts, 'choices': choices, 'metadata': {**v_dict,</pre>
<pre class='cython code score-20 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1768, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1768, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1768, __pyx_L1_error)</span>
    if (unlikely(!__pyx_v_v_dict)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("v_dict"); <span class='error_goto'>__PYX_ERR(0, 1768, __pyx_L1_error)</span> }
    __pyx_t_7 = <span class='py_c_api'>PyDict_Copy</span>(__pyx_v_v_dict);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1768, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1769</span>:                                                             'a': a,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1769, __pyx_L1_error)</span>
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1770</span>:                                                             **z_dict,</pre>
<pre class='cython code score-14 '>    if (unlikely(!__pyx_v_z_dict)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("z_dict"); <span class='error_goto'>__PYX_ERR(0, 1770, __pyx_L1_error)</span> }
    if (unlikely(<span class='py_c_api'>PyDict_Update</span>(__pyx_t_7, __pyx_v_z_dict) &lt; 0)) {
      if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseMappingExpectedError</span>(__pyx_v_z_dict);
      <span class='error_goto'>__PYX_ERR(0, 1770, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1771</span>:                                                             't': t,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1771, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1772</span>:                                                             'deadline': deadline,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_deadline, ((PyObject *)__pyx_v_deadline)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1772, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1773</span>:                                                             # **t_dict, # for now no t by choice</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1774</span>:                                                             's': s,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_s, ((PyObject *)__pyx_v_s)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1774, __pyx_L1_error)</span>
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1775</span>:                                                             **boundary_params,</pre>
<pre class='cython code score-17 '>    if (unlikely(__pyx_v_boundary_params == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
      <span class='error_goto'>__PYX_ERR(0, 1775, __pyx_L1_error)</span>
    }
    if (unlikely(<span class='py_c_api'>PyDict_Update</span>(__pyx_t_7, __pyx_v_boundary_params) &lt; 0)) {
      if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseMappingExpectedError</span>(__pyx_v_boundary_params);
      <span class='error_goto'>__PYX_ERR(0, 1775, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1776</span>:                                                             'delta_t': delta_t,</pre>
<pre class='cython code score-11 '>    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_t);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1776, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_delta_t, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1776, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1777</span>:                                                             'max_t': max_t,</pre>
<pre class='cython code score-11 '>    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_max_t);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1777, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_max_t, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1777, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1778</span>:                                                             'n_samples': n_samples,</pre>
<pre class='cython code score-8 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1778, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_n_samples, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1778, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1779</span>:                                                             'n_trials': n_trials,</pre>
<pre class='cython code score-13 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1779, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_n_trials, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1779, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_simulator, __pyx_n_u_race_model) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1780, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1780</span>:                                                             'simulator': 'race_model',</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1781</span>:                                                             'boundary_fun_type': boundary_fun.__name__,</pre>
<pre class='cython code score-8 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_boundary_fun, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1781, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_boundary_fun_type, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1781, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1782</span>:                                                             'possible_choices': list(np.arange(0, n_particles, 1)),</pre>
<pre class='cython code score-31 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_11, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1782, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_11, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1782, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_particles);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1782, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    __pyx_t_9 = NULL;
    __pyx_t_12 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_9)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
        __pyx_t_12 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[4] = {__pyx_t_9, __pyx_int_0, __pyx_t_11, __pyx_int_1};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_12, 3+__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1782, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    }
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PySequence_ListKeepNew</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1782, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_possible_choices, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1782, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1783</span>:                                                             'trajectory': traj,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_trajectory, __pyx_v_traj) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1783, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1784</span>:                                                             'boundary': boundary}}</pre>
<pre class='cython code score-11 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_boundary, __pyx_v_boundary) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1784, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_metadata, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1768, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1785</span>:     elif return_option == 'minimal':</pre>
<pre class='cython code score-2 '>  __pyx_t_19 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_return_option, __pyx_n_u_minimal, Py_EQ)); if (unlikely((__pyx_t_19 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1785, __pyx_L1_error)</span>
  if (likely(__pyx_t_19)) {
/* … */
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1786</span>:         return {'rts': rts, 'choices': choices, 'metadata': {'simulator': 'race_model',</pre>
<pre class='cython code score-20 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1786, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1786, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1786, __pyx_L1_error)</span>
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1786, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_simulator, __pyx_n_u_race_model) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1786, __pyx_L1_error)</span>
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1787</span>:                                                              'possible_choices': [-1, 1],</pre>
<pre class='cython code score-17 '>    __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1787, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 0, __pyx_int_neg_1)) <span class='error_goto'>__PYX_ERR(0, 1787, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 1787, __pyx_L1_error)</span>;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_possible_choices, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1786, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1788</span>:                                                              'boundary_fun_type': boundary_fun.__name__,</pre>
<pre class='cython code score-8 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_boundary_fun, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1788, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_boundary_fun_type, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1786, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1789</span>:                                                              'n_samples': n_samples,</pre>
<pre class='cython code score-8 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1789, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_n_samples, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1786, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1790</span>:                                                              'n_trials': n_trials,</pre>
<pre class='cython code score-14 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1790, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_n_trials, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1786, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_metadata, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1786, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1791</span>:                                                              }}</pre>
<pre class="cython line score-0">&#xA0;<span class="">1792</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1793</span>:     else:</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1794</span>:         raise ValueError('return_option must be either "full" or "minimal"')</pre>
<pre class='cython code score-5 '>  /*else*/ {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1794, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_4, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1794, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1795</span>:     # -------------------------------------------------------------------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1796</span>: # @cythonboundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1797</span>: # @cythonwraparound(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1798</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1799</span>: # Simulate (rt, choice) tuples from: Leaky Competing Accumulator Model -----------------------------</pre>
<pre class="cython line score-156" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1800</span>: def lca(np.ndarray[float, ndim = 2] v, # drift parameters (np.array expect: one column of floats)</pre>
<pre class='cython code score-156 '>static PyObject *__pyx_pf_4cssm_60__defaults__(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_r = NULL;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
/* … */
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(10);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1800, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 3, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 4, Py_None)) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_True));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_True));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 5, ((PyObject *)Py_True))) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults7, __pyx_self)-&gt;__pyx_arg_boundary_params);
  <span class='refnanny'>__Pyx_GIVEREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults7, __pyx_self)-&gt;__pyx_arg_boundary_params);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 6, <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults7, __pyx_self)-&gt;__pyx_arg_boundary_params)) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 7, Py_None)) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject*)__pyx_n_u_full));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject*)__pyx_n_u_full));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 8, ((PyObject*)__pyx_n_u_full))) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_False));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_False));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 9, ((PyObject *)Py_False))) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1800, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 1, Py_None)) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.__defaults__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_4cssm_23lca(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_4cssm_23lca = {"lca", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_4cssm_23lca, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_4cssm_23lca(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyArrayObject *__pyx_v_v = 0;
  PyArrayObject *__pyx_v_a = 0;
  PyArrayObject *__pyx_v_z = 0;
  PyArrayObject *__pyx_v_g = 0;
  PyArrayObject *__pyx_v_b = 0;
  PyArrayObject *__pyx_v_t = 0;
  PyArrayObject *__pyx_v_s = 0;
  PyArrayObject *__pyx_v_deadline = 0;
  float __pyx_v_delta_t;
  float __pyx_v_max_t;
  int __pyx_v_n_samples;
  int __pyx_v_n_trials;
  PyObject *__pyx_v_boundary_fun = 0;
  PyObject *__pyx_v_boundary_multiplicative = 0;
  PyObject *__pyx_v_boundary_params = 0;
  PyObject *__pyx_v_random_state = 0;
  PyObject *__pyx_v_return_option = 0;
  PyObject *__pyx_v_smooth = 0;
  CYTHON_UNUSED PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lca (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_v,&amp;__pyx_n_s_a,&amp;__pyx_n_s_z,&amp;__pyx_n_s_g,&amp;__pyx_n_s_b,&amp;__pyx_n_s_t,&amp;__pyx_n_s_s,&amp;__pyx_n_s_deadline,&amp;__pyx_n_s_delta_t,&amp;__pyx_n_s_max_t,&amp;__pyx_n_s_n_samples,&amp;__pyx_n_s_n_trials,&amp;__pyx_n_s_boundary_fun,&amp;__pyx_n_s_boundary_multiplicative,&amp;__pyx_n_s_boundary_params,&amp;__pyx_n_s_random_state,&amp;__pyx_n_s_return_option,&amp;__pyx_n_s_smooth,0};
  PyObject* values[18] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    __pyx_defaults7 *__pyx_dynamic_args = <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults7, __pyx_self);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs);
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4cssm_22lca(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_g, PyArrayObject *__pyx_v_b, PyArrayObject *__pyx_v_t, PyArrayObject *__pyx_v_s, PyArrayObject *__pyx_v_deadline, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state, PyObject *__pyx_v_return_option, PyObject *__pyx_v_smooth, CYTHON_UNUSED PyObject *__pyx_v_kwargs) {
  __Pyx_memviewslice __pyx_v_v_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_a_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_z_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_g_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_b_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_t_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  CYTHON_UNUSED __Pyx_memviewslice __pyx_v_s_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_deadline_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_n_particles;
  PyObject *__pyx_v_traj = NULL;
  __Pyx_memviewslice __pyx_v_traj_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_rts = NULL;
  __Pyx_memviewslice __pyx_v_rts_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_choices = NULL;
  __Pyx_memviewslice __pyx_v_choices_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_particles = NULL;
  __Pyx_memviewslice __pyx_v_particles_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_particles_reduced_sum = NULL;
  __Pyx_memviewslice __pyx_v_particles_reduced_sum_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  float __pyx_v_delta_t_sqrt;
  PyObject *__pyx_v_sqrt_st = NULL;
  __Pyx_memviewslice __pyx_v_sqrt_st_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  Py_ssize_t __pyx_v_n;
  Py_ssize_t __pyx_v_i;
  Py_ssize_t __pyx_v_ix;
  Py_ssize_t __pyx_v_k;
  Py_ssize_t __pyx_v_m;
  float __pyx_v_particles_sum;
  float __pyx_v_smooth_u;
  float __pyx_v_deadline_tmp;
  int __pyx_v_num_steps;
  PyObject *__pyx_v_t_s = NULL;
  PyObject *__pyx_v_boundary = NULL;
  __Pyx_memviewslice __pyx_v_boundary_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_num_draws;
  __Pyx_memviewslice __pyx_v_gaussian_values = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_boundary_params_tmp = NULL;
  double __pyx_v_t_particle;
  PyObject *__pyx_v_v_dict = NULL;
  PyObject *__pyx_v_z_dict = NULL;
  PyObject *__pyx_8genexpr8__pyx_v_key = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_a;
  __Pyx_Buffer __pyx_pybuffer_a;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_b;
  __Pyx_Buffer __pyx_pybuffer_b;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_deadline;
  __Pyx_Buffer __pyx_pybuffer_deadline;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_g;
  __Pyx_Buffer __pyx_pybuffer_g;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_s;
  __Pyx_Buffer __pyx_pybuffer_s;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_t;
  __Pyx_Buffer __pyx_pybuffer_t;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_v;
  __Pyx_Buffer __pyx_pybuffer_v;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_z;
  __Pyx_Buffer __pyx_pybuffer_z;
  PyObject *__pyx_r = NULL;
  __pyx_pybuffer_v.pybuffer.buf = NULL;
  __pyx_pybuffer_v.refcount = 0;
  __pyx_pybuffernd_v.data = NULL;
  __pyx_pybuffernd_v.rcbuffer = &amp;__pyx_pybuffer_v;
  __pyx_pybuffer_a.pybuffer.buf = NULL;
  __pyx_pybuffer_a.refcount = 0;
  __pyx_pybuffernd_a.data = NULL;
  __pyx_pybuffernd_a.rcbuffer = &amp;__pyx_pybuffer_a;
  __pyx_pybuffer_z.pybuffer.buf = NULL;
  __pyx_pybuffer_z.refcount = 0;
  __pyx_pybuffernd_z.data = NULL;
  __pyx_pybuffernd_z.rcbuffer = &amp;__pyx_pybuffer_z;
  __pyx_pybuffer_g.pybuffer.buf = NULL;
  __pyx_pybuffer_g.refcount = 0;
  __pyx_pybuffernd_g.data = NULL;
  __pyx_pybuffernd_g.rcbuffer = &amp;__pyx_pybuffer_g;
  __pyx_pybuffer_b.pybuffer.buf = NULL;
  __pyx_pybuffer_b.refcount = 0;
  __pyx_pybuffernd_b.data = NULL;
  __pyx_pybuffernd_b.rcbuffer = &amp;__pyx_pybuffer_b;
  __pyx_pybuffer_t.pybuffer.buf = NULL;
  __pyx_pybuffer_t.refcount = 0;
  __pyx_pybuffernd_t.data = NULL;
  __pyx_pybuffernd_t.rcbuffer = &amp;__pyx_pybuffer_t;
  __pyx_pybuffer_s.pybuffer.buf = NULL;
  __pyx_pybuffer_s.refcount = 0;
  __pyx_pybuffernd_s.data = NULL;
  __pyx_pybuffernd_s.rcbuffer = &amp;__pyx_pybuffer_s;
  __pyx_pybuffer_deadline.pybuffer.buf = NULL;
  __pyx_pybuffer_deadline.refcount = 0;
  __pyx_pybuffernd_deadline.data = NULL;
  __pyx_pybuffernd_deadline.rcbuffer = &amp;__pyx_pybuffer_deadline;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_v, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_v.diminfo[0].strides = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_v.diminfo[0].shape = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_v.diminfo[1].strides = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_v.diminfo[1].shape = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_a, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_a.diminfo[1].strides = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_a.diminfo[1].shape = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_z, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_z.diminfo[0].strides = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_z.diminfo[0].shape = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_z.diminfo[1].strides = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_z.diminfo[1].shape = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_g.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_g, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_g.diminfo[0].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_g.diminfo[0].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_g.diminfo[1].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_g.diminfo[1].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_b.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_b, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_b.diminfo[0].strides = __pyx_pybuffernd_b.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_b.diminfo[0].shape = __pyx_pybuffernd_b.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_b.diminfo[1].strides = __pyx_pybuffernd_b.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_b.diminfo[1].shape = __pyx_pybuffernd_b.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_t, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_t.diminfo[0].strides = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_t.diminfo[0].shape = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_t.diminfo[1].strides = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_t.diminfo[1].shape = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_s.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_s, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_s.diminfo[0].strides = __pyx_pybuffernd_s.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_s.diminfo[0].shape = __pyx_pybuffernd_s.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_s.diminfo[1].strides = __pyx_pybuffernd_s.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_s.diminfo[1].shape = __pyx_pybuffernd_s.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_deadline, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_deadline.diminfo[0].strides = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_deadline.diminfo[0].shape = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.shape[0];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_2, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_3, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_10, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_b.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_g.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_s.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.lca", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_b.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_g.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_s.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_v_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_a_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_z_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_g_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_b_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_t_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_s_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_deadline_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_traj);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_traj_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rts);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_rts_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_choices);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_choices_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_particles);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_particles_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_particles_reduced_sum);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_particles_reduced_sum_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sqrt_st);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_sqrt_st_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t_s);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_boundary);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_boundary_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_boundary_params_tmp);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_v_dict);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_z_dict);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr8__pyx_v_key);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__45 = <span class='py_c_api'>PyTuple_Pack</span>(61, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_g, __pyx_n_s_b, __pyx_n_s_t, __pyx_n_s_s, __pyx_n_s_deadline, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_boundary_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_random_state, __pyx_n_s_return_option, __pyx_n_s_smooth, __pyx_n_s_kwargs, __pyx_n_s_v_view, __pyx_n_s_a_view, __pyx_n_s_z_view, __pyx_n_s_g_view, __pyx_n_s_b_view, __pyx_n_s_t_view, __pyx_n_s_s_view, __pyx_n_s_deadline_view, __pyx_n_s_n_particles, __pyx_n_s_traj, __pyx_n_s_traj_view, __pyx_n_s_rts, __pyx_n_s_rts_view, __pyx_n_s_choices, __pyx_n_s_choices_view, __pyx_n_s_particles, __pyx_n_s_particles_view, __pyx_n_s_particles_reduced_sum, __pyx_n_s_particles_reduced_sum_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_sqrt_st_view, __pyx_n_s_n, __pyx_n_s_i, __pyx_n_s_ix, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_t_par, __pyx_n_s_particles_sum, __pyx_n_s_smooth_u, __pyx_n_s_deadline_tmp, __pyx_n_s_num_steps, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_boundary_view, __pyx_n_s_num_draws, __pyx_n_s_gaussian_values, __pyx_n_s_boundary_params_tmp, __pyx_n_s_t_particle, __pyx_n_s_v_dict, __pyx_n_s_z_dict, __pyx_n_s_key);<span class='error_goto'> if (unlikely(!__pyx_tuple__45)) __PYX_ERR(0, 1800, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__45);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__45);
/* … */
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_4cssm_23lca, 0, __pyx_n_s_lca, NULL, __pyx_n_s_cssm, __pyx_d, ((PyObject *)__pyx_codeobj__46));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1800, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (!<span class='pyx_c_api'>__Pyx_CyFunction_InitDefaults</span>(__pyx_t_5, sizeof(__pyx_defaults7), 1)) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L1_error)</span>
  __pyx_codeobj__46 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(18, 0, 0, 61, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__45, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_lca, 1800, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__46)) __PYX_ERR(0, 1800, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1801</span>:         np.ndarray[float, ndim = 2] a, # criterion height</pre>
<pre class="cython line score-0">&#xA0;<span class="">1802</span>:         np.ndarray[float, ndim = 2] z, # initial bias parameters (np.array expect: one column of floats)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1803</span>:         np.ndarray[float, ndim = 2] g, # decay parameter</pre>
<pre class="cython line score-0">&#xA0;<span class="">1804</span>:         np.ndarray[float, ndim = 2] b, # inhibition parameter</pre>
<pre class="cython line score-0">&#xA0;<span class="">1805</span>:         np.ndarray[float, ndim = 2] t,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1806</span>:         np.ndarray[float, ndim = 2] s, # variance (can be one value or np.array of size as v and w)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1807</span>:         np.ndarray[float, ndim = 1] deadline,</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1808</span>:         float delta_t = 0.001, # time-step size in simulator</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(((double)0.001));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1808, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1809</span>:         float max_t = 20, # maximal time</pre>
<pre class='cython code score-5 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)20.0));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1809, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1810</span>:         int n_samples = 2000, # number of samples to produce</pre>
<pre class='cython code score-2 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)0x7D0));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1810, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1811</span>:         int n_trials = 1,</pre>
<pre class='cython code score-2 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)1));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1811, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1812</span>:         boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)</pre>
<pre class='cython code score-6 '>    values[12] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[13] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_True)));
    values[14] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(__pyx_dynamic_args-&gt;__pyx_arg_boundary_params);
</pre><pre class="cython line score-0">&#xA0;<span class="">1813</span>:         boundary_multiplicative = True,</pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1814</span>:         boundary_params = {},</pre>
<pre class='cython code score-12 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1814, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults7, __pyx_t_5)-&gt;__pyx_arg_boundary_params = __pyx_t_4;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_4 = 0;
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsGetter</span>(__pyx_t_5, __pyx_pf_4cssm_60__defaults__);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_lca, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-315" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1815</span>:         random_state = None,</pre>
<pre class='cython code score-315 '>    values[15] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[16] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_full)));
    values[17] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case 18: values[17] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 17);
        CYTHON_FALLTHROUGH;
        case 17: values[16] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 16);
        CYTHON_FALLTHROUGH;
        case 16: values[15] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 15);
        CYTHON_FALLTHROUGH;
        case 15: values[14] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_v)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_a)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("lca", 0, 8, 18, 1); <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_z)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("lca", 0, 8, 18, 2); <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_g)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[3]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("lca", 0, 8, 18, 3); <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_b)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[4]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("lca", 0, 8, 18, 4); <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_t)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[5]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("lca", 0, 8, 18, 5); <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_s)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[6]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("lca", 0, 8, 18, 6); <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (likely((values[7] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_deadline)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[7]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("lca", 0, 8, 18, 7); <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_delta_t);
          if (value) { values[8] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  9:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_max_t);
          if (value) { values[9] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 10:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_samples);
          if (value) { values[10] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 11:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_trials);
          if (value) { values[11] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 12:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_fun);
          if (value) { values[12] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 13:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_multiplicative);
          if (value) { values[13] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 14:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_params);
          if (value) { values[14] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 15:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_random_state);
          if (value) { values[15] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 16:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_return_option);
          if (value) { values[16] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 17:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_smooth);
          if (value) { values[17] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values + 0, kwd_pos_args, "lca") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case 18: values[17] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 17);
        CYTHON_FALLTHROUGH;
        case 17: values[16] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 16);
        CYTHON_FALLTHROUGH;
        case 16: values[15] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 15);
        CYTHON_FALLTHROUGH;
        case 15: values[14] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_v = ((PyArrayObject *)values[0]);
    __pyx_v_a = ((PyArrayObject *)values[1]);
    __pyx_v_z = ((PyArrayObject *)values[2]);
    __pyx_v_g = ((PyArrayObject *)values[3]);
    __pyx_v_b = ((PyArrayObject *)values[4]);
    __pyx_v_t = ((PyArrayObject *)values[5]);
    __pyx_v_s = ((PyArrayObject *)values[6]);
    __pyx_v_deadline = ((PyArrayObject *)values[7]);
    if (values[8]) {
      __pyx_v_delta_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[8]); if (unlikely((__pyx_v_delta_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1808, __pyx_L3_error)</span>
    } else {
      __pyx_v_delta_t = ((float)((double)0.001));
    }
    if (values[9]) {
      __pyx_v_max_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[9]); if (unlikely((__pyx_v_max_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1809, __pyx_L3_error)</span>
    } else {
      __pyx_v_max_t = ((float)((float)20.0));
    }
    if (values[10]) {
      __pyx_v_n_samples = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[10]); if (unlikely((__pyx_v_n_samples == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1810, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_samples = ((int)((int)0x7D0));
    }
    if (values[11]) {
      __pyx_v_n_trials = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[11]); if (unlikely((__pyx_v_n_trials == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1811, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_trials = ((int)((int)1));
    }
    __pyx_v_boundary_fun = values[12];
    __pyx_v_boundary_multiplicative = values[13];
    __pyx_v_boundary_params = values[14];
    __pyx_v_random_state = values[15];
    __pyx_v_return_option = values[16];
    __pyx_v_smooth = values[17];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("lca", 0, 8, 18, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.lca", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) <span class='error_goto'>__PYX_ERR(0, 1800, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) <span class='error_goto'>__PYX_ERR(0, 1801, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) <span class='error_goto'>__PYX_ERR(0, 1802, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_g), __pyx_ptype_5numpy_ndarray, 1, "g", 0))) <span class='error_goto'>__PYX_ERR(0, 1803, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_b), __pyx_ptype_5numpy_ndarray, 1, "b", 0))) <span class='error_goto'>__PYX_ERR(0, 1804, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) <span class='error_goto'>__PYX_ERR(0, 1805, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_s), __pyx_ptype_5numpy_ndarray, 1, "s", 0))) <span class='error_goto'>__PYX_ERR(0, 1806, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_deadline), __pyx_ptype_5numpy_ndarray, 1, "deadline", 0))) <span class='error_goto'>__PYX_ERR(0, 1807, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_4cssm_22lca(__pyx_self, __pyx_v_v, __pyx_v_a, __pyx_v_z, __pyx_v_g, __pyx_v_b, __pyx_v_t, __pyx_v_s, __pyx_v_deadline, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state, __pyx_v_return_option, __pyx_v_smooth, __pyx_v_kwargs);
</pre><pre class="cython line score-0">&#xA0;<span class="">1816</span>:         return_option = 'full',</pre>
<pre class="cython line score-0">&#xA0;<span class="">1817</span>:         smooth = False,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1818</span>:         **kwargs):</pre>
<pre class="cython line score-0">&#xA0;<span class="">1819</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1820</span>:     set_seed(random_state)</pre>
<pre class='cython code score-1 '>  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1820, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1821</span>:     # Param views</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1822</span>:     cdef float[:, :] v_view = v</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(((PyObject *)__pyx_v_v), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1822, __pyx_L1_error)</span>
  __pyx_v_v_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1823</span>:     cdef float[:, :] a_view = a</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(((PyObject *)__pyx_v_a), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1823, __pyx_L1_error)</span>
  __pyx_v_a_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1824</span>:     cdef float[:, :] z_view = z</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(((PyObject *)__pyx_v_z), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1824, __pyx_L1_error)</span>
  __pyx_v_z_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1825</span>:     cdef float[:, :] g_view = g</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(((PyObject *)__pyx_v_g), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1825, __pyx_L1_error)</span>
  __pyx_v_g_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1826</span>:     cdef float[:, :] b_view = b</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(((PyObject *)__pyx_v_b), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1826, __pyx_L1_error)</span>
  __pyx_v_b_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1827</span>:     cdef float[:, :] t_view = t</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(((PyObject *)__pyx_v_t), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1827, __pyx_L1_error)</span>
  __pyx_v_t_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1828</span>:     cdef float[:, :] s_view = s</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(((PyObject *)__pyx_v_s), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1828, __pyx_L1_error)</span>
  __pyx_v_s_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1829</span>:     cdef float[:] deadline_view = deadline</pre>
<pre class='cython code score-2 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_deadline), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 1829, __pyx_L1_error)</span>
  __pyx_v_deadline_view = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1830</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1831</span>:     # Trajectory</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1832</span>:     cdef int n_particles = v.shape[1]</pre>
<pre class='cython code score-5 '>  __pyx_t_4 = __pyx_f_5numpy_7ndarray_5shape_shape(((PyArrayObject *)__pyx_v_v)); if (unlikely(__pyx_t_4 == ((npy_intp *)NULL) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1832, __pyx_L1_error)</span>
  __pyx_v_n_particles = (__pyx_t_4[1]);
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1833</span>:     traj = np.zeros((int(max_t / delta_t) + 1, n_particles), dtype = DTYPE)</pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1833, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1833, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_FromDouble</span>((__pyx_v_max_t / __pyx_v_delta_t));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1833, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_1, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1833, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_particles);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1833, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1833, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 1833, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1833, __pyx_L1_error)</span>;
  __pyx_t_6 = 0;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1833, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 1833, __pyx_L1_error)</span>;
  __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1833, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1833, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1833, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_1, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1833, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_v_traj = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1834</span>:     traj[:, :] = -999</pre>
<pre class='cython code score-5 '>  if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_traj, __pyx_tuple__12, __pyx_int_neg_999) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1834, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1835</span>:     cdef float[:, :] traj_view = traj</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(__pyx_v_traj, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1835, __pyx_L1_error)</span>
  __pyx_v_traj_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1836</span>: </pre>
<pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1837</span>:     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)</pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1837, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1837, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1837, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1837, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1837, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 1837, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1837, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 1837, __pyx_L1_error)</span>;
  __pyx_t_6 = 0;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1837, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 1837, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1837, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1837, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1837, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_1, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1837, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_rts = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1838</span>:     cdef float[:, :, :] rts_view = rts</pre>
<pre class='cython code score-2 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_rts, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1838, __pyx_L1_error)</span>
  __pyx_v_rts_view = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1839</span>: </pre>
<pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1840</span>:     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)</pre>
<pre class='cython code score-46 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1840, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1840, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1840, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1840, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1840, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 1840, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1840, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_7, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 1840, __pyx_L1_error)</span>;
  __pyx_t_6 = 0;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1840, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 1840, __pyx_L1_error)</span>;
  __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1840, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1840, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_intc);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1840, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_9) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1840, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_1, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1840, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_v_choices = __pyx_t_9;
  __pyx_t_9 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1841</span>:     cdef int[:, :, :] choices_view = choices</pre>
<pre class='cython code score-2 '>  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_int</span>(__pyx_v_choices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 1841, __pyx_L1_error)</span>
  __pyx_v_choices_view = __pyx_t_10;
  __pyx_t_10.memview = NULL;
  __pyx_t_10.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1842</span>: </pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1843</span>:     particles = np.zeros(n_particles, dtype = DTYPE)</pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1843, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1843, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_particles);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1843, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1843, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 1843, __pyx_L1_error)</span>;
  __pyx_t_9 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1843, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1843, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1843, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_1, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1843, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_v_particles = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1844</span>:     cdef float[:] particles_view = particles</pre>
<pre class='cython code score-2 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(__pyx_v_particles, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 1844, __pyx_L1_error)</span>
  __pyx_v_particles_view = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1845</span>: </pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1846</span>:     particles_reduced_sum = np.zeros(n_particles, dtype = DTYPE)</pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1846, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1846, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_particles);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1846, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1846, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 1846, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1846, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1846, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1846, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_1, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1846, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_particles_reduced_sum = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1847</span>:     cdef float[:] particles_reduced_sum_view = particles_reduced_sum</pre>
<pre class='cython code score-2 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(__pyx_v_particles_reduced_sum, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 1847, __pyx_L1_error)</span>
  __pyx_v_particles_reduced_sum_view = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1848</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1849</span>:     cdef float delta_t_sqrt = sqrt(delta_t)</pre>
<pre class='cython code score-0 '>  __pyx_v_delta_t_sqrt = sqrt(__pyx_v_delta_t);
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1850</span>:     sqrt_st = s * delta_t_sqrt</pre>
<pre class='cython code score-11 '>  __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_t_sqrt);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1850, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(((PyObject *)__pyx_v_s), __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1850, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_v_sqrt_st = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1851</span>:     cdef float[:, :] sqrt_st_view = sqrt_st</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(__pyx_v_sqrt_st, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1851, __pyx_L1_error)</span>
  __pyx_v_sqrt_st_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1852</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1853</span>:     cdef Py_ssize_t n, i, ix, k</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1854</span>:     cdef Py_ssize_t m = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_m = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1855</span>:     cdef float t_par, particles_sum, smooth_u, deadline_tmp</pre>
<pre class="cython line score-0">&#xA0;<span class="">1856</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1857</span>:     # Boundary storage</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1858</span>:     cdef int num_steps = int((max_t / delta_t) + 2)</pre>
<pre class='cython code score-0 '>  __pyx_v_num_steps = ((int)((__pyx_v_max_t / __pyx_v_delta_t) + 2.0));
</pre><pre class="cython line score-0">&#xA0;<span class="">1859</span>: </pre>
<pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1860</span>:     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)</pre>
<pre class='cython code score-51 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1860, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1860, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_max_t + __pyx_v_delta_t));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1860, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_t);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1860, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_11 = NULL;
  __pyx_t_12 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
    __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
    if (likely(__pyx_t_11)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
      __pyx_t_12 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[4] = {__pyx_t_11, __pyx_int_0, __pyx_t_1, __pyx_t_6};
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+1-__pyx_t_12, 3+__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 1860, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  }
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1860, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1860, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_6 = NULL;
  __pyx_t_12 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
      __pyx_t_12 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_6, __pyx_t_7};
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+1-__pyx_t_12, 1+__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 1860, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  }
  __pyx_v_t_s = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1861</span>:     boundary = np.zeros(t_s.shape, dtype = DTYPE)</pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1861, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1861, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_t_s, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1861, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1861, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 1861, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1861, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1861, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1861, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_7, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1861, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_boundary = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1862</span>:     cdef float[:] boundary_view = boundary</pre>
<pre class='cython code score-2 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(__pyx_v_boundary, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 1862, __pyx_L1_error)</span>
  __pyx_v_boundary_view = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1863</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1864</span>:     cdef int num_draws = num_steps * n_particles</pre>
<pre class='cython code score-0 '>  __pyx_v_num_draws = (__pyx_v_num_steps * __pyx_v_n_particles);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1865</span>:     cdef float[:] gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>  __pyx_t_3 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 1865, __pyx_L1_error)</span>
  __pyx_v_gaussian_values = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1866</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1867</span>:     for k in range(n_trials):</pre>
<pre class='cython code score-0 '>  __pyx_t_12 = __pyx_v_n_trials;
  __pyx_t_13 = __pyx_t_12;
  for (__pyx_t_14 = 0; __pyx_t_14 &lt; __pyx_t_13; __pyx_t_14+=1) {
    __pyx_v_k = __pyx_t_14;
</pre><pre class="cython line score-0">&#xA0;<span class="">1868</span>:         # Precompute boundary evaluations</pre>
<pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1869</span>:         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}</pre>
<pre class='cython code score-27 '>    { /* enter inner scope */
      __pyx_t_6 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1869, __pyx_L7_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_15 = 0;
      if (unlikely(__pyx_v_boundary_params == Py_None)) {
        <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "keys");
        <span class='error_goto'>__PYX_ERR(0, 1869, __pyx_L7_error)</span>
      }
      __pyx_t_7 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&amp;__pyx_t_16), (&amp;__pyx_t_17));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1869, __pyx_L7_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
      __pyx_t_5 = __pyx_t_7;
      __pyx_t_7 = 0;
      while (1) {
        __pyx_t_18 = __Pyx_dict_iter_next(__pyx_t_5, __pyx_t_16, &amp;__pyx_t_15, &amp;__pyx_t_7, NULL, NULL, __pyx_t_17);
        if (unlikely(__pyx_t_18 == 0)) break;
        if (unlikely(__pyx_t_18 == -1)) <span class='error_goto'>__PYX_ERR(0, 1869, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_8genexpr8__pyx_v_key, __pyx_t_7);
        __pyx_t_7 = 0;
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_boundary_params, __pyx_8genexpr8__pyx_v_key);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1869, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_7, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1869, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, (PyObject*)__pyx_8genexpr8__pyx_v_key, (PyObject*)__pyx_t_9))) <span class='error_goto'>__PYX_ERR(0, 1869, __pyx_L7_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr8__pyx_v_key); __pyx_8genexpr8__pyx_v_key = 0;
      goto __pyx_L10_exit_scope;
      __pyx_L7_error:;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr8__pyx_v_key); __pyx_8genexpr8__pyx_v_key = 0;
      goto __pyx_L1_error;
      __pyx_L10_exit_scope:;
    } /* exit inner scope */
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_boundary_params_tmp, ((PyObject*)__pyx_t_6));
    __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1870</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1871</span>:         # Precompute boundary evaluations</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1872</span>:         if boundary_multiplicative:</pre>
<pre class='cython code score-2 '>    __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_boundary_multiplicative); if (unlikely((__pyx_t_19 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1872, __pyx_L1_error)</span>
    if (__pyx_t_19) {
/* … */
      goto __pyx_L11;
    }
</pre><pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1873</span>:             boundary[:] = np.multiply(a_view[k, 0], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)</pre>
<pre class='cython code score-61 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1873, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_multiply);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1873, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_20 = __pyx_v_k;
      __pyx_t_21 = 0;
      __pyx_t_9 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_20 * __pyx_v_a_view.strides[0]) ) + __pyx_t_21 * __pyx_v_a_view.strides[1]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1873, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1873, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_11, __pyx_n_s_t, __pyx_v_t_s) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1873, __pyx_L1_error)</span>
      __pyx_t_1 = __pyx_t_11;
      __pyx_t_11 = 0;
      if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_1, __pyx_v_boundary_params_tmp) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1873, __pyx_L1_error)</span>
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1873, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = NULL;
      __pyx_t_17 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
        __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
        if (likely(__pyx_t_1)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
          __pyx_t_17 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_1, __pyx_t_9, __pyx_t_11};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_7, __pyx_callargs+1-__pyx_t_17, 2+__pyx_t_17);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 1873, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      }
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1873, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1873, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_11 = NULL;
      __pyx_t_17 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
        __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
        if (likely(__pyx_t_11)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
          __pyx_t_17 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_11, __pyx_t_5};
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_7, __pyx_callargs+1-__pyx_t_17, 1+__pyx_t_17);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 1873, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      }
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_boundary, __pyx_t_6, 0, 0, NULL, NULL, &amp;__pyx_slice__5, 0, 0, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1873, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1874</span>:         else:</pre>
<pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1875</span>:             boundary[:] = np.add(a_view[k, 0], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)</pre>
<pre class='cython code score-61 '>    /*else*/ {
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1875, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_add);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1875, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_21 = __pyx_v_k;
      __pyx_t_20 = 0;
      __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_21 * __pyx_v_a_view.strides[0]) ) + __pyx_t_20 * __pyx_v_a_view.strides[1]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1875, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1875, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_t, __pyx_v_t_s) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1875, __pyx_L1_error)</span>
      __pyx_t_9 = __pyx_t_1;
      __pyx_t_1 = 0;
      if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_9, __pyx_v_boundary_params_tmp) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1875, __pyx_L1_error)</span>
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1875, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = NULL;
      __pyx_t_17 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
        __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
        if (likely(__pyx_t_9)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
          __pyx_t_17 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_9, __pyx_t_5, __pyx_t_1};
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_11, __pyx_callargs+1-__pyx_t_17, 2+__pyx_t_17);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 1875, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      }
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1875, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1875, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_1 = NULL;
      __pyx_t_17 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
        __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
        if (likely(__pyx_t_1)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
          __pyx_t_17 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_7};
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_11, __pyx_callargs+1-__pyx_t_17, 1+__pyx_t_17);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 1875, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      }
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_boundary, __pyx_t_6, 0, 0, NULL, NULL, &amp;__pyx_slice__5, 0, 0, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1875, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    }
    __pyx_L11:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1876</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1877</span>:         deadline_tmp = min(max_t, deadline_view[k] - t_view[k, 0])</pre>
<pre class='cython code score-0 '>    __pyx_t_20 = __pyx_v_k;
    __pyx_t_21 = __pyx_v_k;
    __pyx_t_22 = 0;
    __pyx_t_23 = ((*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_20 * __pyx_v_deadline_view.strides[0]) ))) - (*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_21 * __pyx_v_t_view.strides[0]) ) + __pyx_t_22 * __pyx_v_t_view.strides[1]) ))));
    __pyx_t_24 = __pyx_v_max_t;
    __pyx_t_19 = (__pyx_t_23 &lt; __pyx_t_24);
    if (__pyx_t_19) {
      __pyx_t_25 = __pyx_t_23;
    } else {
      __pyx_t_25 = __pyx_t_24;
    }
    __pyx_v_deadline_tmp = __pyx_t_25;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1878</span>:         for n in range(n_samples):</pre>
<pre class='cython code score-0 '>    __pyx_t_17 = __pyx_v_n_samples;
    __pyx_t_18 = __pyx_t_17;
    for (__pyx_t_16 = 0; __pyx_t_16 &lt; __pyx_t_18; __pyx_t_16+=1) {
      __pyx_v_n = __pyx_t_16;
</pre><pre class="cython line score-0">&#xA0;<span class="">1879</span>:             # Reset particle starting points</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1880</span>:             for i in range(n_particles):</pre>
<pre class='cython code score-0 '>      __pyx_t_26 = __pyx_v_n_particles;
      __pyx_t_27 = __pyx_t_26;
      for (__pyx_t_15 = 0; __pyx_t_15 &lt; __pyx_t_27; __pyx_t_15+=1) {
        __pyx_v_i = __pyx_t_15;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1881</span>:                 particles_view[i] = z_view[k, i] * boundary_view[0]</pre>
<pre class='cython code score-0 '>        __pyx_t_22 = __pyx_v_k;
        __pyx_t_21 = __pyx_v_i;
        __pyx_t_20 = 0;
        __pyx_t_28 = __pyx_v_i;
        *((float *) ( /* dim=0 */ (__pyx_v_particles_view.data + __pyx_t_28 * __pyx_v_particles_view.strides[0]) )) = ((*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_z_view.data + __pyx_t_22 * __pyx_v_z_view.strides[0]) ) + __pyx_t_21 * __pyx_v_z_view.strides[1]) ))) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) ))));
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">1882</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1883</span>:             t_particle = 0.0 # reset time</pre>
<pre class='cython code score-0 '>      __pyx_v_t_particle = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1884</span>:             ix = 0 # reset boundary index</pre>
<pre class='cython code score-0 '>      __pyx_v_ix = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1885</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1886</span>:             if n == 0:</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = (__pyx_v_n == 0);
      if (__pyx_t_19) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1887</span>:                 if k == 0:</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = (__pyx_v_k == 0);
        if (__pyx_t_19) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1888</span>:                     for i in range(n_particles):</pre>
<pre class='cython code score-0 '>          __pyx_t_26 = __pyx_v_n_particles;
          __pyx_t_27 = __pyx_t_26;
          for (__pyx_t_15 = 0; __pyx_t_15 &lt; __pyx_t_27; __pyx_t_15+=1) {
            __pyx_v_i = __pyx_t_15;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1889</span>:                         traj_view[0, i] = particles[i]</pre>
<pre class='cython code score-13 '>            __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_particles, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1889, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
            __pyx_t_25 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_6); if (unlikely((__pyx_t_25 == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1889, __pyx_L1_error)</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
            __pyx_t_20 = 0;
            __pyx_t_21 = __pyx_v_i;
            *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_20 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_21 * __pyx_v_traj_view.strides[1]) )) = __pyx_t_25;
          }
</pre><pre class="cython line score-0">&#xA0;<span class="">1890</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1891</span>:             while not check_finished(particles_view, boundary_view[ix], n_particles) and t_particle &lt;= deadline_tmp:</pre>
<pre class='cython code score-5 '>      while (1) {
        __pyx_t_21 = __pyx_v_ix;
        __pyx_t_29 = __pyx_f_4cssm_check_finished(__pyx_v_particles_view, (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_21 * __pyx_v_boundary_view.strides[0]) ))), __pyx_v_n_particles); if (unlikely(__pyx_t_29 == ((int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1891, __pyx_L1_error)</span>
        __pyx_t_30 = (!__pyx_t_29);
        if (__pyx_t_30) {
        } else {
          __pyx_t_19 = __pyx_t_30;
          goto __pyx_L22_bool_binop_done;
        }
        __pyx_t_30 = (__pyx_v_t_particle &lt;= __pyx_v_deadline_tmp);
        __pyx_t_19 = __pyx_t_30;
        __pyx_L22_bool_binop_done:;
        if (!__pyx_t_19) break;
</pre><pre class="cython line score-0">&#xA0;<span class="">1892</span>:                 # calculate current sum over particle positions</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1893</span>:                 particles_sum = csum(particles_view)</pre>
<pre class='cython code score-5 '>        __pyx_t_25 = __pyx_f_4cssm_csum(__pyx_v_particles_view); if (unlikely(__pyx_t_25 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1893, __pyx_L1_error)</span>
        __pyx_v_particles_sum = __pyx_t_25;
</pre><pre class="cython line score-0">&#xA0;<span class="">1894</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1895</span>:                 # update particle positions</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1896</span>:                 for i in range(n_particles):</pre>
<pre class='cython code score-0 '>        __pyx_t_26 = __pyx_v_n_particles;
        __pyx_t_27 = __pyx_t_26;
        for (__pyx_t_15 = 0; __pyx_t_15 &lt; __pyx_t_27; __pyx_t_15+=1) {
          __pyx_v_i = __pyx_t_15;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1897</span>:                     particles_reduced_sum_view[i] = (- 1) * particles_view[i] + particles_sum</pre>
<pre class='cython code score-0 '>          __pyx_t_21 = __pyx_v_i;
          __pyx_t_20 = __pyx_v_i;
          *((float *) ( /* dim=0 */ (__pyx_v_particles_reduced_sum_view.data + __pyx_t_20 * __pyx_v_particles_reduced_sum_view.strides[0]) )) = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_particles_view.data + __pyx_t_21 * __pyx_v_particles_view.strides[0]) )))) + __pyx_v_particles_sum);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1898</span>:                     particles_view[i] += ((v_view[k, i] - (g_view[k, 0] * particles_view[i]) - \</pre>
<pre class='cython code score-0 '>          __pyx_t_21 = __pyx_v_k;
          __pyx_t_20 = __pyx_v_i;
          __pyx_t_22 = __pyx_v_k;
          __pyx_t_28 = 0;
          __pyx_t_31 = __pyx_v_i;
/* … */
          __pyx_t_38 = __pyx_v_i;
          *((float *) ( /* dim=0 */ (__pyx_v_particles_view.data + __pyx_t_38 * __pyx_v_particles_view.strides[0]) )) += (((((*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_v_view.data + __pyx_t_21 * __pyx_v_v_view.strides[0]) ) + __pyx_t_20 * __pyx_v_v_view.strides[1]) ))) - ((*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_g_view.data + __pyx_t_22 * __pyx_v_g_view.strides[0]) ) + __pyx_t_28 * __pyx_v_g_view.strides[1]) ))) * (*((float *) ( /* dim=0 */ (__pyx_v_particles_view.data + __pyx_t_31 * __pyx_v_particles_view.strides[0]) ))))) - ((*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_b_view.data + __pyx_t_32 * __pyx_v_b_view.strides[0]) ) + __pyx_t_33 * __pyx_v_b_view.strides[1]) ))) * (*((float *) ( /* dim=0 */ (__pyx_v_particles_reduced_sum_view.data + __pyx_t_34 * __pyx_v_particles_reduced_sum_view.strides[0]) ))))) * __pyx_v_delta_t) + ((*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_sqrt_st_view.data + __pyx_t_35 * __pyx_v_sqrt_st_view.strides[0]) ) + __pyx_t_36 * __pyx_v_sqrt_st_view.strides[1]) ))) * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_37 * __pyx_v_gaussian_values.strides[0]) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1899</span>:                             (b_view[k, 0] * particles_reduced_sum_view[i])) * delta_t) + (sqrt_st_view[k, i] * gaussian_values[m])</pre>
<pre class='cython code score-0 '>          __pyx_t_32 = __pyx_v_k;
          __pyx_t_33 = 0;
          __pyx_t_34 = __pyx_v_i;
/* … */
          __pyx_t_35 = __pyx_v_k;
          __pyx_t_36 = __pyx_v_i;
/* … */
          __pyx_t_37 = __pyx_v_m;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1900</span>:                     particles_view[i] = fmax(0.0, particles_view[i])</pre>
<pre class='cython code score-0 '>          __pyx_t_37 = __pyx_v_i;
          __pyx_t_36 = __pyx_v_i;
          *((float *) ( /* dim=0 */ (__pyx_v_particles_view.data + __pyx_t_36 * __pyx_v_particles_view.strides[0]) )) = fmax(0.0, (*((float *) ( /* dim=0 */ (__pyx_v_particles_view.data + __pyx_t_37 * __pyx_v_particles_view.strides[0]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1901</span>:                     m += 1</pre>
<pre class='cython code score-0 '>          __pyx_v_m = (__pyx_v_m + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">1902</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1903</span>:                     if m == num_draws:</pre>
<pre class='cython code score-0 '>          __pyx_t_19 = (__pyx_v_m == __pyx_v_num_draws);
          if (__pyx_t_19) {
/* … */
          }
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1904</span>:                         gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>            __pyx_t_3 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 1904, __pyx_L1_error)</span>
            __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
            __pyx_v_gaussian_values = __pyx_t_3;
            __pyx_t_3.memview = NULL;
            __pyx_t_3.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1905</span>:                         m = 0</pre>
<pre class='cython code score-0 '>            __pyx_v_m = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1906</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1907</span>:                 t_particle += delta_t # increment time</pre>
<pre class='cython code score-0 '>        __pyx_v_t_particle = (__pyx_v_t_particle + __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1908</span>:                 ix += 1 # increment boundary index</pre>
<pre class='cython code score-0 '>        __pyx_v_ix = (__pyx_v_ix + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">1909</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1910</span>:                 if n == 0:</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = (__pyx_v_n == 0);
        if (__pyx_t_19) {
/* … */
        }
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1911</span>:                     if k == 0:</pre>
<pre class='cython code score-0 '>          __pyx_t_19 = (__pyx_v_k == 0);
          if (__pyx_t_19) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1912</span>:                         for i in range(n_particles):</pre>
<pre class='cython code score-0 '>            __pyx_t_26 = __pyx_v_n_particles;
            __pyx_t_27 = __pyx_t_26;
            for (__pyx_t_15 = 0; __pyx_t_15 &lt; __pyx_t_27; __pyx_t_15+=1) {
              __pyx_v_i = __pyx_t_15;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1913</span>:                             traj_view[ix, i] = particles[i]</pre>
<pre class='cython code score-13 '>              __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_particles, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1913, __pyx_L1_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
              __pyx_t_25 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_6); if (unlikely((__pyx_t_25 == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1913, __pyx_L1_error)</span>
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
              __pyx_t_37 = __pyx_v_ix;
              __pyx_t_36 = __pyx_v_i;
              *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_37 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_36 * __pyx_v_traj_view.strides[1]) )) = __pyx_t_25;
            }
</pre><pre class="cython line score-0">&#xA0;<span class="">1914</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1915</span>:             if smooth:</pre>
<pre class='cython code score-2 '>      __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_smooth); if (unlikely((__pyx_t_19 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1915, __pyx_L1_error)</span>
      if (__pyx_t_19) {
/* … */
        goto __pyx_L31;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1916</span>:                 if t_particle == 0.0:</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = (__pyx_v_t_particle == 0.0);
        if (__pyx_t_19) {
/* … */
          goto __pyx_L32;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1917</span>:                     smooth_u = random_uniform() * 0.5 * delta_t</pre>
<pre class='cython code score-5 '>          __pyx_t_25 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_25 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1917, __pyx_L1_error)</span>
          __pyx_v_smooth_u = ((__pyx_t_25 * 0.5) * __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1918</span>:                 elif t_particle &lt; deadline_tmp:</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = (__pyx_v_t_particle &lt; __pyx_v_deadline_tmp);
        if (__pyx_t_19) {
/* … */
          goto __pyx_L32;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1919</span>:                     smooth_u = (0.5 - random_uniform()) * delta_t</pre>
<pre class='cython code score-5 '>          __pyx_t_25 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_25 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1919, __pyx_L1_error)</span>
          __pyx_v_smooth_u = ((0.5 - __pyx_t_25) * __pyx_v_delta_t);
</pre><pre class="cython line score-0">&#xA0;<span class="">1920</span>:                 else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1921</span>:                     smooth_u = 0.0</pre>
<pre class='cython code score-0 '>        /*else*/ {
          __pyx_v_smooth_u = 0.0;
        }
        __pyx_L32:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1922</span>:             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1923</span>:                 smooth_u = 0.0</pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_v_smooth_u = 0.0;
      }
      __pyx_L31:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1924</span>: </pre>
<pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1925</span>:             choices_view[n, k, 0] = np.argmax(particles) # store choices for sample n</pre>
<pre class='cython code score-27 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_11, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1925, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_11, __pyx_n_s_argmax);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1925, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      __pyx_t_11 = NULL;
      __pyx_t_26 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
        __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
        if (likely(__pyx_t_11)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
          __pyx_t_26 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_11, __pyx_v_particles};
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_7, __pyx_callargs+1-__pyx_t_26, 1+__pyx_t_26);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 1925, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      }
      __pyx_t_26 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_6); if (unlikely((__pyx_t_26 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1925, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_36 = __pyx_v_n;
      __pyx_t_37 = __pyx_v_k;
      __pyx_t_35 = 0;
      *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_36 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_37 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_35 * __pyx_v_choices_view.strides[2]) )) = __pyx_t_26;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1926</span>:             rts_view[n, k, 0] = t_particle + t_view[k, 0] + smooth_u # t[choices_view[n, 0]] # store reaction time for sample n</pre>
<pre class='cython code score-0 '>      __pyx_t_35 = __pyx_v_k;
      __pyx_t_37 = 0;
      __pyx_t_36 = __pyx_v_n;
      __pyx_t_34 = __pyx_v_k;
      __pyx_t_33 = 0;
      *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_36 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_34 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_33 * __pyx_v_rts_view.strides[2]) )) = ((__pyx_v_t_particle + (*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_35 * __pyx_v_t_view.strides[0]) ) + __pyx_t_37 * __pyx_v_t_view.strides[1]) )))) + __pyx_v_smooth_u);
</pre><pre class="cython line score-0">&#xA0;<span class="">1927</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1928</span>:             if (rts_view[n, k, 0] &gt;= deadline_view[k]) | (deadline_view[k] &lt;= 0):</pre>
<pre class='cython code score-0 '>      __pyx_t_37 = __pyx_v_n;
      __pyx_t_35 = __pyx_v_k;
      __pyx_t_33 = 0;
      __pyx_t_34 = __pyx_v_k;
      __pyx_t_36 = __pyx_v_k;
      __pyx_t_19 = (((*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_37 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_35 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_33 * __pyx_v_rts_view.strides[2]) ))) &gt;= (*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_34 * __pyx_v_deadline_view.strides[0]) )))) | ((*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_36 * __pyx_v_deadline_view.strides[0]) ))) &lt;= 0.0));
      if (__pyx_t_19) {
/* … */
      }
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1929</span>:                 rts_view[n, k, 0] = -999</pre>
<pre class='cython code score-0 '>        __pyx_t_36 = __pyx_v_n;
        __pyx_t_34 = __pyx_v_k;
        __pyx_t_33 = 0;
        *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_36 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_34 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_33 * __pyx_v_rts_view.strides[2]) )) = -999.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1930</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1931</span>:     # Create some dics</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1932</span>:     v_dict = {}</pre>
<pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1932, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_v_v_dict = ((PyObject*)__pyx_t_6);
  __pyx_t_6 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1933</span>:     z_dict = {}</pre>
<pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1933, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_v_z_dict = ((PyObject*)__pyx_t_6);
  __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1934</span>:     #t_dict = {}</pre>
<pre class="cython line score-0">&#xA0;<span class="">1935</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1936</span>:     for i in range(n_particles):</pre>
<pre class='cython code score-0 '>  __pyx_t_12 = __pyx_v_n_particles;
  __pyx_t_13 = __pyx_t_12;
  for (__pyx_t_14 = 0; __pyx_t_14 &lt; __pyx_t_13; __pyx_t_14+=1) {
    __pyx_v_i = __pyx_t_14;
</pre><pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1937</span>:         v_dict['v' + str(i)] = v[:, i]</pre>
<pre class='cython code score-39 '>    __pyx_t_6 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1937, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1937, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__5);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_slice__5)) <span class='error_goto'>__PYX_ERR(0, 1937, __pyx_L1_error)</span>;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 1937, __pyx_L1_error)</span>;
    __pyx_t_6 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_v), __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1937, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1937, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Str</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1937, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_n_u_v, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1937, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    if (unlikely((<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_v_dict, __pyx_t_7, __pyx_t_6) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1937, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1938</span>:         z_dict['z' + str(i)] = z[:, i]</pre>
<pre class='cython code score-39 '>    __pyx_t_6 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1938, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1938, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__5);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_slice__5)) <span class='error_goto'>__PYX_ERR(0, 1938, __pyx_L1_error)</span>;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 1938, __pyx_L1_error)</span>;
    __pyx_t_6 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_z), __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1938, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1938, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Str</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1938, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_n_u_z, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1938, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    if (unlikely((<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_z_dict, __pyx_t_7, __pyx_t_6) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1938, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1939</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1940</span>:     if return_option == 'full':</pre>
<pre class='cython code score-2 '>  __pyx_t_19 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_return_option, __pyx_n_u_full, Py_EQ)); if (unlikely((__pyx_t_19 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1940, __pyx_L1_error)</span>
  if (__pyx_t_19) {
/* … */
  }
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1941</span>:         return {'rts': rts, 'choices': choices, 'metadata': {**v_dict,</pre>
<pre class='cython code score-18 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1941, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1941, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1941, __pyx_L1_error)</span>
    __pyx_t_7 = <span class='py_c_api'>PyDict_Copy</span>(__pyx_v_v_dict);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1941, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1942</span>:                                                             'a': a,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1942, __pyx_L1_error)</span>
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1943</span>:                                                             **z_dict,</pre>
<pre class='cython code score-12 '>    if (unlikely(<span class='py_c_api'>PyDict_Update</span>(__pyx_t_7, __pyx_v_z_dict) &lt; 0)) {
      if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseMappingExpectedError</span>(__pyx_v_z_dict);
      <span class='error_goto'>__PYX_ERR(0, 1943, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1944</span>:                                                             'g': g,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_g, ((PyObject *)__pyx_v_g)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1944, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1945</span>:                                                             'b': b,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_b, ((PyObject *)__pyx_v_b)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1945, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1946</span>:                                                             't': t,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1946, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1947</span>:                                                             'deadline': deadline,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_deadline, ((PyObject *)__pyx_v_deadline)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1947, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1948</span>:                                                             's': s,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_s, ((PyObject *)__pyx_v_s)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1948, __pyx_L1_error)</span>
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1949</span>:                                                             **boundary_params,</pre>
<pre class='cython code score-17 '>    if (unlikely(__pyx_v_boundary_params == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
      <span class='error_goto'>__PYX_ERR(0, 1949, __pyx_L1_error)</span>
    }
    if (unlikely(<span class='py_c_api'>PyDict_Update</span>(__pyx_t_7, __pyx_v_boundary_params) &lt; 0)) {
      if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseMappingExpectedError</span>(__pyx_v_boundary_params);
      <span class='error_goto'>__PYX_ERR(0, 1949, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1950</span>:                                                             'delta_t': delta_t,</pre>
<pre class='cython code score-11 '>    __pyx_t_11 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_t);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1950, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_delta_t, __pyx_t_11) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1950, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1951</span>:                                                             'max_t': max_t,</pre>
<pre class='cython code score-11 '>    __pyx_t_11 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_max_t);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1951, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_max_t, __pyx_t_11) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1951, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1952</span>:                                                             'n_samples': n_samples,</pre>
<pre class='cython code score-8 '>    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1952, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_n_samples, __pyx_t_11) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1952, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1953</span>:                                                             'n_trials': n_trials,</pre>
<pre class='cython code score-13 '>    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1953, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_n_trials, __pyx_t_11) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1953, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_simulator, __pyx_n_u_lca) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1954, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1954</span>:                                                             'simulator' : 'lca',</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1955</span>:                                                             'boundary_fun_type': boundary_fun.__name__,</pre>
<pre class='cython code score-8 '>    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_boundary_fun, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1955, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_boundary_fun_type, __pyx_t_11) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1955, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1956</span>:                                                             'possible_choices': list(np.arange(0, n_particles, 1)),</pre>
<pre class='cython code score-31 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1956, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1956, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_particles);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1956, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_9 = NULL;
    __pyx_t_12 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_9)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
        __pyx_t_12 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[4] = {__pyx_t_9, __pyx_int_0, __pyx_t_1, __pyx_int_1};
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_12, 3+__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_11)) <span class='error_goto'>__PYX_ERR(0, 1956, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PySequence_ListKeepNew</span>(__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1956, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_possible_choices, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1956, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1957</span>:                                                             'trajectory': traj,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_trajectory, __pyx_v_traj) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1957, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1958</span>:                                                             'boundary': boundary}}</pre>
<pre class='cython code score-11 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_boundary, __pyx_v_boundary) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1958, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_metadata, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1941, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_r = __pyx_t_6;
    __pyx_t_6 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1959</span>:     elif return_option == 'minimal':</pre>
<pre class='cython code score-2 '>  __pyx_t_19 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_return_option, __pyx_n_u_minimal, Py_EQ)); if (unlikely((__pyx_t_19 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1959, __pyx_L1_error)</span>
  if (likely(__pyx_t_19)) {
/* … */
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1960</span>:         return {'rts': rts, 'choices': choices, 'metadata': {'simulator': 'lca',</pre>
<pre class='cython code score-20 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1960, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1960, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1960, __pyx_L1_error)</span>
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1960, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_simulator, __pyx_n_u_lca) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1960, __pyx_L1_error)</span>
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1961</span>:                                                              'possible_choices': [-1, 1],</pre>
<pre class='cython code score-17 '>    __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1961, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_5, 0, __pyx_int_neg_1)) <span class='error_goto'>__PYX_ERR(0, 1961, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_5, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 1961, __pyx_L1_error)</span>;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_possible_choices, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1960, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1962</span>:                                                              'boundary_fun_type': boundary_fun.__name__,</pre>
<pre class='cython code score-8 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_boundary_fun, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1962, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_boundary_fun_type, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1960, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1963</span>:                                                              'n_samples': n_samples,</pre>
<pre class='cython code score-8 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1963, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_n_samples, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1960, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1964</span>:                                                              'n_trials': n_trials,</pre>
<pre class='cython code score-14 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1964, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_u_n_trials, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1960, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_metadata, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1960, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_r = __pyx_t_6;
    __pyx_t_6 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1965</span>:                                                              }}</pre>
<pre class="cython line score-0">&#xA0;<span class="">1966</span>:     else:</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1967</span>:         raise ValueError('return_option must be either "full" or "minimal"')</pre>
<pre class='cython code score-5 '>  /*else*/ {
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1967, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_6, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1967, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1968</span>: # -----------------------------------------------------------------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1969</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1970</span>: # Simulate (rt, choice) tuples from: DDM WITH FLEXIBLE BOUNDARIES ------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1971</span>: # @cythonboundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1972</span>: # @cythonwraparound(False)</pre>
<pre class="cython line score-165" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1973</span>: def ddm_flexbound_seq2(np.ndarray[float, ndim = 1] vh,</pre>
<pre class='cython code score-165 '>static PyObject *__pyx_pf_4cssm_62__defaults__(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_r = NULL;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
/* … */
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(12);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1973, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 2, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 3, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 4, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_True));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_True));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 5, ((PyObject *)Py_True))) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 6, Py_None)) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_True));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_True));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 7, ((PyObject *)Py_True))) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults8, __pyx_self)-&gt;__pyx_arg_boundary_params);
  <span class='refnanny'>__Pyx_GIVEREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults8, __pyx_self)-&gt;__pyx_arg_boundary_params);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 8, <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults8, __pyx_self)-&gt;__pyx_arg_boundary_params)) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 9, Py_None)) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject*)__pyx_n_u_full));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject*)__pyx_n_u_full));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 10, ((PyObject*)__pyx_n_u_full))) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_False));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_False));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 11, ((PyObject *)Py_False))) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1973, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 1, Py_None)) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L1_error)</span>;
  __pyx_t_6 = 0;
  __pyx_r = __pyx_t_5;
  __pyx_t_5 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.__defaults__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_4cssm_25ddm_flexbound_seq2(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_4cssm_25ddm_flexbound_seq2 = {"ddm_flexbound_seq2", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_4cssm_25ddm_flexbound_seq2, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_4cssm_25ddm_flexbound_seq2(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyArrayObject *__pyx_v_vh = 0;
  PyArrayObject *__pyx_v_vl1 = 0;
  PyArrayObject *__pyx_v_vl2 = 0;
  PyArrayObject *__pyx_v_a = 0;
  PyArrayObject *__pyx_v_zh = 0;
  PyArrayObject *__pyx_v_zl1 = 0;
  PyArrayObject *__pyx_v_zl2 = 0;
  PyArrayObject *__pyx_v_t = 0;
  PyArrayObject *__pyx_v_deadline = 0;
  float __pyx_v_s;
  float __pyx_v_delta_t;
  float __pyx_v_max_t;
  int __pyx_v_n_samples;
  int __pyx_v_n_trials;
  CYTHON_UNUSED PyObject *__pyx_v_print_info = 0;
  PyObject *__pyx_v_boundary_fun = 0;
  PyObject *__pyx_v_boundary_multiplicative = 0;
  PyObject *__pyx_v_boundary_params = 0;
  PyObject *__pyx_v_random_state = 0;
  PyObject *__pyx_v_return_option = 0;
  PyObject *__pyx_v_smooth = 0;
  CYTHON_UNUSED PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("ddm_flexbound_seq2 (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_vh,&amp;__pyx_n_s_vl1,&amp;__pyx_n_s_vl2,&amp;__pyx_n_s_a,&amp;__pyx_n_s_zh,&amp;__pyx_n_s_zl1,&amp;__pyx_n_s_zl2,&amp;__pyx_n_s_t,&amp;__pyx_n_s_deadline,&amp;__pyx_n_s_s,&amp;__pyx_n_s_delta_t,&amp;__pyx_n_s_max_t,&amp;__pyx_n_s_n_samples,&amp;__pyx_n_s_n_trials,&amp;__pyx_n_s_print_info,&amp;__pyx_n_s_boundary_fun,&amp;__pyx_n_s_boundary_multiplicative,&amp;__pyx_n_s_boundary_params,&amp;__pyx_n_s_random_state,&amp;__pyx_n_s_return_option,&amp;__pyx_n_s_smooth,0};
  PyObject* values[21] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    __pyx_defaults8 *__pyx_dynamic_args = <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults8, __pyx_self);
    values[14] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_True)));
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs);
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4cssm_24ddm_flexbound_seq2(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_vh, PyArrayObject *__pyx_v_vl1, PyArrayObject *__pyx_v_vl2, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_zh, PyArrayObject *__pyx_v_zl1, PyArrayObject *__pyx_v_zl2, PyArrayObject *__pyx_v_t, PyArrayObject *__pyx_v_deadline, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, CYTHON_UNUSED PyObject *__pyx_v_print_info, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state, PyObject *__pyx_v_return_option, PyObject *__pyx_v_smooth, CYTHON_UNUSED PyObject *__pyx_v_kwargs) {
  __Pyx_memviewslice __pyx_v_vh_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_vl1_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_vl2_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_a_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_zh_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_zl1_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_zl2_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_t_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_deadline_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_rts = NULL;
  PyObject *__pyx_v_choices = NULL;
  __Pyx_memviewslice __pyx_v_rts_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_choices_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_traj = NULL;
  __Pyx_memviewslice __pyx_v_traj_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  float __pyx_v_delta_t_sqrt;
  float __pyx_v_sqrt_st;
  int __pyx_v_num_draws;
  PyObject *__pyx_v_t_s = NULL;
  PyObject *__pyx_v_boundary = NULL;
  __Pyx_memviewslice __pyx_v_boundary_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  float __pyx_v_y_h;
  float __pyx_v_t_particle;
  float __pyx_v_t_particle1;
  float __pyx_v_t_particle2;
  float __pyx_v_y_l;
  float __pyx_v_y_l1;
  float __pyx_v_y_l2;
  float __pyx_v_smooth_u;
  float __pyx_v_deadline_tmp;
  Py_ssize_t __pyx_v_n;
  Py_ssize_t __pyx_v_ix;
  Py_ssize_t __pyx_v_ix1;
  Py_ssize_t __pyx_v_ix2;
  Py_ssize_t __pyx_v_k;
  Py_ssize_t __pyx_v_m;
  __Pyx_memviewslice __pyx_v_gaussian_values = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_boundary_params_tmp = NULL;
  PyObject *__pyx_8genexpr9__pyx_v_key = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_a;
  __Pyx_Buffer __pyx_pybuffer_a;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_deadline;
  __Pyx_Buffer __pyx_pybuffer_deadline;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_t;
  __Pyx_Buffer __pyx_pybuffer_t;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_vh;
  __Pyx_Buffer __pyx_pybuffer_vh;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_vl1;
  __Pyx_Buffer __pyx_pybuffer_vl1;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_vl2;
  __Pyx_Buffer __pyx_pybuffer_vl2;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_zh;
  __Pyx_Buffer __pyx_pybuffer_zh;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_zl1;
  __Pyx_Buffer __pyx_pybuffer_zl1;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_zl2;
  __Pyx_Buffer __pyx_pybuffer_zl2;
  PyObject *__pyx_r = NULL;
  __pyx_pybuffer_vh.pybuffer.buf = NULL;
  __pyx_pybuffer_vh.refcount = 0;
  __pyx_pybuffernd_vh.data = NULL;
  __pyx_pybuffernd_vh.rcbuffer = &amp;__pyx_pybuffer_vh;
  __pyx_pybuffer_vl1.pybuffer.buf = NULL;
  __pyx_pybuffer_vl1.refcount = 0;
  __pyx_pybuffernd_vl1.data = NULL;
  __pyx_pybuffernd_vl1.rcbuffer = &amp;__pyx_pybuffer_vl1;
  __pyx_pybuffer_vl2.pybuffer.buf = NULL;
  __pyx_pybuffer_vl2.refcount = 0;
  __pyx_pybuffernd_vl2.data = NULL;
  __pyx_pybuffernd_vl2.rcbuffer = &amp;__pyx_pybuffer_vl2;
  __pyx_pybuffer_a.pybuffer.buf = NULL;
  __pyx_pybuffer_a.refcount = 0;
  __pyx_pybuffernd_a.data = NULL;
  __pyx_pybuffernd_a.rcbuffer = &amp;__pyx_pybuffer_a;
  __pyx_pybuffer_zh.pybuffer.buf = NULL;
  __pyx_pybuffer_zh.refcount = 0;
  __pyx_pybuffernd_zh.data = NULL;
  __pyx_pybuffernd_zh.rcbuffer = &amp;__pyx_pybuffer_zh;
  __pyx_pybuffer_zl1.pybuffer.buf = NULL;
  __pyx_pybuffer_zl1.refcount = 0;
  __pyx_pybuffernd_zl1.data = NULL;
  __pyx_pybuffernd_zl1.rcbuffer = &amp;__pyx_pybuffer_zl1;
  __pyx_pybuffer_zl2.pybuffer.buf = NULL;
  __pyx_pybuffer_zl2.refcount = 0;
  __pyx_pybuffernd_zl2.data = NULL;
  __pyx_pybuffernd_zl2.rcbuffer = &amp;__pyx_pybuffer_zl2;
  __pyx_pybuffer_t.pybuffer.buf = NULL;
  __pyx_pybuffer_t.refcount = 0;
  __pyx_pybuffernd_t.data = NULL;
  __pyx_pybuffernd_t.rcbuffer = &amp;__pyx_pybuffer_t;
  __pyx_pybuffer_deadline.pybuffer.buf = NULL;
  __pyx_pybuffer_deadline.refcount = 0;
  __pyx_pybuffernd_deadline.data = NULL;
  __pyx_pybuffernd_deadline.rcbuffer = &amp;__pyx_pybuffer_deadline;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_vh, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_vh.diminfo[0].strides = __pyx_pybuffernd_vh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_vh.diminfo[0].shape = __pyx_pybuffernd_vh.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vl1.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_vl1, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_vl1.diminfo[0].strides = __pyx_pybuffernd_vl1.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_vl1.diminfo[0].shape = __pyx_pybuffernd_vl1.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vl2.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_vl2, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_vl2.diminfo[0].strides = __pyx_pybuffernd_vl2.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_vl2.diminfo[0].shape = __pyx_pybuffernd_vl2.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_a, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_zh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_zh, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_zh.diminfo[0].strides = __pyx_pybuffernd_zh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_zh.diminfo[0].shape = __pyx_pybuffernd_zh.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_zl1.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_zl1, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_zl1.diminfo[0].strides = __pyx_pybuffernd_zl1.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_zl1.diminfo[0].shape = __pyx_pybuffernd_zl1.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_zl2.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_zl2, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_zl2.diminfo[0].strides = __pyx_pybuffernd_zl2.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_zl2.diminfo[0].shape = __pyx_pybuffernd_zl2.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_t, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_t.diminfo[0].strides = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_t.diminfo[0].shape = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_deadline, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_deadline.diminfo[0].strides = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_deadline.diminfo[0].shape = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.shape[0];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_2, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_7, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_9, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vh.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vl1.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vl2.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zh.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zl1.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zl2.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.ddm_flexbound_seq2", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vl1.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vl2.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zl1.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zl2.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_vh_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_vl1_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_vl2_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_a_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_zh_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_zl1_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_zl2_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_t_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_deadline_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_choices);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_rts_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_choices_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_traj);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_traj_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t_s);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_boundary);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_boundary_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_boundary_params_tmp);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr9__pyx_v_key);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__47 = <span class='py_c_api'>PyTuple_Pack</span>(61, __pyx_n_s_vh, __pyx_n_s_vl1, __pyx_n_s_vl2, __pyx_n_s_a, __pyx_n_s_zh, __pyx_n_s_zl1, __pyx_n_s_zl2, __pyx_n_s_t, __pyx_n_s_deadline, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_print_info, __pyx_n_s_boundary_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_random_state, __pyx_n_s_return_option, __pyx_n_s_smooth, __pyx_n_s_kwargs, __pyx_n_s_vh_view, __pyx_n_s_vl1_view, __pyx_n_s_vl2_view, __pyx_n_s_a_view, __pyx_n_s_zh_view, __pyx_n_s_zl1_view, __pyx_n_s_zl2_view, __pyx_n_s_t_view, __pyx_n_s_deadline_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_traj, __pyx_n_s_traj_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_num_draws, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_boundary_view, __pyx_n_s_y_h, __pyx_n_s_t_particle, __pyx_n_s_t_particle1, __pyx_n_s_t_particle2, __pyx_n_s_y_l, __pyx_n_s_y_l1, __pyx_n_s_y_l2, __pyx_n_s_smooth_u, __pyx_n_s_deadline_tmp, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_ix1, __pyx_n_s_ix2, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_gaussian_values, __pyx_n_s_boundary_params_tmp, __pyx_n_s_key);<span class='error_goto'> if (unlikely(!__pyx_tuple__47)) __PYX_ERR(0, 1973, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__47);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__47);
/* … */
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_4cssm_25ddm_flexbound_seq2, 0, __pyx_n_s_ddm_flexbound_seq2, NULL, __pyx_n_s_cssm, __pyx_d, ((PyObject *)__pyx_codeobj__48));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1973, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (!<span class='pyx_c_api'>__Pyx_CyFunction_InitDefaults</span>(__pyx_t_5, sizeof(__pyx_defaults8), 1)) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L1_error)</span>
  __pyx_codeobj__48 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(21, 0, 0, 61, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__47, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_ddm_flexbound_seq2, 1973, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__48)) __PYX_ERR(0, 1973, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1974</span>:                        np.ndarray[float, ndim = 1] vl1,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1975</span>:                        np.ndarray[float, ndim = 1] vl2,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1976</span>:                        np.ndarray[float, ndim = 1] a,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1977</span>:                        np.ndarray[float, ndim = 1] zh,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1978</span>:                        np.ndarray[float, ndim = 1] zl1,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1979</span>:                        np.ndarray[float, ndim = 1] zl2,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1980</span>:                        np.ndarray[float, ndim = 1] t,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1981</span>:                        np.ndarray[float, ndim = 1] deadline,</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1982</span>:                        float s = 1,</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)1.0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1982, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1983</span>:                        float delta_t = 0.001,</pre>
<pre class='cython code score-5 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(((double)0.001));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1983, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1984</span>:                        float max_t = 20,</pre>
<pre class='cython code score-5 '>  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)20.0));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1984, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1985</span>:                        int n_samples = 20000,</pre>
<pre class='cython code score-2 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)0x4E20));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1985, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1986</span>:                        int n_trials = 1,</pre>
<pre class='cython code score-2 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)1));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1986, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
</pre><pre class="cython line score-0">&#xA0;<span class="">1987</span>:                        print_info = True,</pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1988</span>:                        boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)</pre>
<pre class='cython code score-6 '>    values[15] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[16] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_True)));
    values[17] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(__pyx_dynamic_args-&gt;__pyx_arg_boundary_params);
</pre><pre class="cython line score-0">&#xA0;<span class="">1989</span>:                        boundary_multiplicative = True,</pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1990</span>:                        boundary_params = {},</pre>
<pre class='cython code score-12 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1990, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults8, __pyx_t_5)-&gt;__pyx_arg_boundary_params = __pyx_t_4;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_4 = 0;
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsGetter</span>(__pyx_t_5, __pyx_pf_4cssm_62__defaults__);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_ddm_flexbound_seq2, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-368" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1991</span>:                        random_state = None,</pre>
<pre class='cython code score-368 '>    values[18] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[19] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_full)));
    values[20] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case 21: values[20] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 20);
        CYTHON_FALLTHROUGH;
        case 20: values[19] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 19);
        CYTHON_FALLTHROUGH;
        case 19: values[18] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 18);
        CYTHON_FALLTHROUGH;
        case 18: values[17] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 17);
        CYTHON_FALLTHROUGH;
        case 17: values[16] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 16);
        CYTHON_FALLTHROUGH;
        case 16: values[15] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 15);
        CYTHON_FALLTHROUGH;
        case 15: values[14] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_vh)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_vl1)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_seq2", 0, 9, 21, 1); <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_vl2)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_seq2", 0, 9, 21, 2); <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_a)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[3]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_seq2", 0, 9, 21, 3); <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_zh)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[4]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_seq2", 0, 9, 21, 4); <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_zl1)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[5]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_seq2", 0, 9, 21, 5); <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_zl2)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[6]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_seq2", 0, 9, 21, 6); <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (likely((values[7] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_t)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[7]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_seq2", 0, 9, 21, 7); <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (likely((values[8] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_deadline)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[8]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_seq2", 0, 9, 21, 8); <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  9:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_s);
          if (value) { values[9] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 10:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_delta_t);
          if (value) { values[10] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 11:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_max_t);
          if (value) { values[11] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 12:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_samples);
          if (value) { values[12] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 13:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_trials);
          if (value) { values[13] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 14:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_print_info);
          if (value) { values[14] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 15:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_fun);
          if (value) { values[15] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 16:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_multiplicative);
          if (value) { values[16] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 17:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_params);
          if (value) { values[17] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 18:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_random_state);
          if (value) { values[18] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 19:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_return_option);
          if (value) { values[19] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 20:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_smooth);
          if (value) { values[20] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values + 0, kwd_pos_args, "ddm_flexbound_seq2") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case 21: values[20] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 20);
        CYTHON_FALLTHROUGH;
        case 20: values[19] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 19);
        CYTHON_FALLTHROUGH;
        case 19: values[18] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 18);
        CYTHON_FALLTHROUGH;
        case 18: values[17] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 17);
        CYTHON_FALLTHROUGH;
        case 17: values[16] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 16);
        CYTHON_FALLTHROUGH;
        case 16: values[15] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 15);
        CYTHON_FALLTHROUGH;
        case 15: values[14] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_vh = ((PyArrayObject *)values[0]);
    __pyx_v_vl1 = ((PyArrayObject *)values[1]);
    __pyx_v_vl2 = ((PyArrayObject *)values[2]);
    __pyx_v_a = ((PyArrayObject *)values[3]);
    __pyx_v_zh = ((PyArrayObject *)values[4]);
    __pyx_v_zl1 = ((PyArrayObject *)values[5]);
    __pyx_v_zl2 = ((PyArrayObject *)values[6]);
    __pyx_v_t = ((PyArrayObject *)values[7]);
    __pyx_v_deadline = ((PyArrayObject *)values[8]);
    if (values[9]) {
      __pyx_v_s = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[9]); if (unlikely((__pyx_v_s == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1982, __pyx_L3_error)</span>
    } else {
      __pyx_v_s = ((float)((float)1.0));
    }
    if (values[10]) {
      __pyx_v_delta_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[10]); if (unlikely((__pyx_v_delta_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1983, __pyx_L3_error)</span>
    } else {
      __pyx_v_delta_t = ((float)((double)0.001));
    }
    if (values[11]) {
      __pyx_v_max_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[11]); if (unlikely((__pyx_v_max_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1984, __pyx_L3_error)</span>
    } else {
      __pyx_v_max_t = ((float)((float)20.0));
    }
    if (values[12]) {
      __pyx_v_n_samples = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[12]); if (unlikely((__pyx_v_n_samples == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1985, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_samples = ((int)((int)0x4E20));
    }
    if (values[13]) {
      __pyx_v_n_trials = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[13]); if (unlikely((__pyx_v_n_trials == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1986, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_trials = ((int)((int)1));
    }
    __pyx_v_print_info = values[14];
    __pyx_v_boundary_fun = values[15];
    __pyx_v_boundary_multiplicative = values[16];
    __pyx_v_boundary_params = values[17];
    __pyx_v_random_state = values[18];
    __pyx_v_return_option = values[19];
    __pyx_v_smooth = values[20];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_seq2", 0, 9, 21, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.ddm_flexbound_seq2", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_vh), __pyx_ptype_5numpy_ndarray, 1, "vh", 0))) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_vl1), __pyx_ptype_5numpy_ndarray, 1, "vl1", 0))) <span class='error_goto'>__PYX_ERR(0, 1974, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_vl2), __pyx_ptype_5numpy_ndarray, 1, "vl2", 0))) <span class='error_goto'>__PYX_ERR(0, 1975, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) <span class='error_goto'>__PYX_ERR(0, 1976, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_zh), __pyx_ptype_5numpy_ndarray, 1, "zh", 0))) <span class='error_goto'>__PYX_ERR(0, 1977, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_zl1), __pyx_ptype_5numpy_ndarray, 1, "zl1", 0))) <span class='error_goto'>__PYX_ERR(0, 1978, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_zl2), __pyx_ptype_5numpy_ndarray, 1, "zl2", 0))) <span class='error_goto'>__PYX_ERR(0, 1979, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) <span class='error_goto'>__PYX_ERR(0, 1980, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_deadline), __pyx_ptype_5numpy_ndarray, 1, "deadline", 0))) <span class='error_goto'>__PYX_ERR(0, 1981, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_4cssm_24ddm_flexbound_seq2(__pyx_self, __pyx_v_vh, __pyx_v_vl1, __pyx_v_vl2, __pyx_v_a, __pyx_v_zh, __pyx_v_zl1, __pyx_v_zl2, __pyx_v_t, __pyx_v_deadline, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_print_info, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state, __pyx_v_return_option, __pyx_v_smooth, __pyx_v_kwargs);
</pre><pre class="cython line score-0">&#xA0;<span class="">1992</span>:                        return_option = 'full',</pre>
<pre class="cython line score-0">&#xA0;<span class="">1993</span>:                        smooth = False,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1994</span>:                        **kwargs):</pre>
<pre class="cython line score-0">&#xA0;<span class="">1995</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1996</span>:     set_seed(random_state)</pre>
<pre class='cython code score-1 '>  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1996, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1997</span>:     # Param views</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1998</span>:     cdef float[:] vh_view = vh</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_vh), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1998, __pyx_L1_error)</span>
  __pyx_v_vh_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1999</span>:     cdef float[:] vl1_view = vl1</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_vl1), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1999, __pyx_L1_error)</span>
  __pyx_v_vl1_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2000</span>:     cdef float[:] vl2_view = vl2</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_vl2), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2000, __pyx_L1_error)</span>
  __pyx_v_vl2_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2001</span>:     cdef float[:] a_view = a</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_a), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2001, __pyx_L1_error)</span>
  __pyx_v_a_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2002</span>:     cdef float[:] zh_view = zh</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_zh), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2002, __pyx_L1_error)</span>
  __pyx_v_zh_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2003</span>:     cdef float[:] zl1_view = zl1</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_zl1), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2003, __pyx_L1_error)</span>
  __pyx_v_zl1_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2004</span>:     cdef float[:] zl2_view = zl2</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_zl2), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2004, __pyx_L1_error)</span>
  __pyx_v_zl2_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2005</span>:     cdef float[:] t_view = t</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_t), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2005, __pyx_L1_error)</span>
  __pyx_v_t_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2006</span>:     cdef float[:] deadline_view = deadline</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_deadline), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2006, __pyx_L1_error)</span>
  __pyx_v_deadline_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2007</span>:     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)</pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2007, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2007, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2007, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2007, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2007, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2007, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2007, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 2007, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2007, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 2007, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2007, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2007, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2007, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2007, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_rts = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2008</span>:     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)</pre>
<pre class='cython code score-46 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2008, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2008, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2008, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2008, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2008, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2008, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2008, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 2008, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2008, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 2008, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2008, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2008, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_intc);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2008, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2008, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2008, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_choices = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2009</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2010</span>:     cdef float[:, :, :] rts_view = rts</pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_rts, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 2010, __pyx_L1_error)</span>
  __pyx_v_rts_view = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2011</span>:     cdef int[:, :, :] choices_view = choices</pre>
<pre class='cython code score-2 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_int</span>(__pyx_v_choices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 2011, __pyx_L1_error)</span>
  __pyx_v_choices_view = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">2012</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2013</span>:     # TD: Add Trajectory</pre>
<pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2014</span>:     traj = np.zeros((int(max_t / delta_t) + 1, 3), dtype = DTYPE)</pre>
<pre class='cython code score-42 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2014, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2014, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_FromDouble</span>((__pyx_v_max_t / __pyx_v_delta_t));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2014, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_6, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2014, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2014, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2014, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_int_3)) <span class='error_goto'>__PYX_ERR(0, 2014, __pyx_L1_error)</span>;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2014, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 2014, __pyx_L1_error)</span>;
  __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2014, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2014, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2014, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2014, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_traj = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2015</span>:     traj[:, :] = -999</pre>
<pre class='cython code score-5 '>  if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_traj, __pyx_tuple__12, __pyx_int_neg_999) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2015, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2016</span>:     cdef float[:, :] traj_view = traj</pre>
<pre class='cython code score-2 '>  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(__pyx_v_traj, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 2016, __pyx_L1_error)</span>
  __pyx_v_traj_view = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">2017</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2018</span>:     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion</pre>
<pre class='cython code score-0 '>  __pyx_v_delta_t_sqrt = sqrt(__pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2019</span>:     cdef float sqrt_st = delta_t_sqrt * s # scalar to ensure the correct variance for the gaussian step</pre>
<pre class='cython code score-0 '>  __pyx_v_sqrt_st = (__pyx_v_delta_t_sqrt * __pyx_v_s);
</pre><pre class="cython line score-0">&#xA0;<span class="">2020</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2021</span>:     # Boundary storage for the upper bound</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2022</span>:     cdef int num_draws = int((max_t / delta_t) + 1)</pre>
<pre class='cython code score-0 '>  __pyx_v_num_draws = ((int)((__pyx_v_max_t / __pyx_v_delta_t) + 1.0));
</pre><pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2023</span>:     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)</pre>
<pre class='cython code score-51 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2023, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2023, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_max_t + __pyx_v_delta_t));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2023, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_t);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2023, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_10 = NULL;
  __pyx_t_11 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_10)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_11 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[4] = {__pyx_t_10, __pyx_int_0, __pyx_t_4, __pyx_t_1};
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_11, 3+__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 2023, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2023, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2023, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_1 = NULL;
  __pyx_t_11 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_11 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_6};
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_11, 1+__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 2023, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_v_t_s = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2024</span>:     boundary = np.zeros(t_s.shape, dtype = DTYPE)</pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2024, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2024, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_t_s, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2024, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2024, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 2024, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2024, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2024, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2024, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_6, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2024, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_boundary = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2025</span>:     cdef float[:] boundary_view = boundary</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(__pyx_v_boundary, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2025, __pyx_L1_error)</span>
  __pyx_v_boundary_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">2026</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2027</span>:     cdef float y_h, t_particle, t_particle1, t_particle2, y_l, y_l1, y_l2, smooth_u, deadline_tmp</pre>
<pre class="cython line score-0">&#xA0;<span class="">2028</span>:     cdef Py_ssize_t n, ix, ix1, ix2, k</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2029</span>:     cdef Py_ssize_t m = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_m = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2030</span>:     #cdef Py_ssize_t traj_id</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2031</span>:     cdef float[:] gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2031, __pyx_L1_error)</span>
  __pyx_v_gaussian_values = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">2032</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2033</span>:     for k in range(n_trials):</pre>
<pre class='cython code score-0 '>  __pyx_t_11 = __pyx_v_n_trials;
  __pyx_t_12 = __pyx_t_11;
  for (__pyx_t_13 = 0; __pyx_t_13 &lt; __pyx_t_12; __pyx_t_13+=1) {
    __pyx_v_k = __pyx_t_13;
</pre><pre class="cython line score-0">&#xA0;<span class="">2034</span>:         # Precompute boundary evaluations</pre>
<pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2035</span>:         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}</pre>
<pre class='cython code score-27 '>    { /* enter inner scope */
      __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2035, __pyx_L7_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_14 = 0;
      if (unlikely(__pyx_v_boundary_params == Py_None)) {
        <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "keys");
        <span class='error_goto'>__PYX_ERR(0, 2035, __pyx_L7_error)</span>
      }
      __pyx_t_6 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&amp;__pyx_t_15), (&amp;__pyx_t_16));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2035, __pyx_L7_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
      __pyx_t_5 = __pyx_t_6;
      __pyx_t_6 = 0;
      while (1) {
        __pyx_t_17 = __Pyx_dict_iter_next(__pyx_t_5, __pyx_t_15, &amp;__pyx_t_14, &amp;__pyx_t_6, NULL, NULL, __pyx_t_16);
        if (unlikely(__pyx_t_17 == 0)) break;
        if (unlikely(__pyx_t_17 == -1)) <span class='error_goto'>__PYX_ERR(0, 2035, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_8genexpr9__pyx_v_key, __pyx_t_6);
        __pyx_t_6 = 0;
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_boundary_params, __pyx_8genexpr9__pyx_v_key);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2035, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_6, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2035, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, (PyObject*)__pyx_8genexpr9__pyx_v_key, (PyObject*)__pyx_t_3))) <span class='error_goto'>__PYX_ERR(0, 2035, __pyx_L7_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr9__pyx_v_key); __pyx_8genexpr9__pyx_v_key = 0;
      goto __pyx_L10_exit_scope;
      __pyx_L7_error:;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr9__pyx_v_key); __pyx_8genexpr9__pyx_v_key = 0;
      goto __pyx_L1_error;
      __pyx_L10_exit_scope:;
    } /* exit inner scope */
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_boundary_params_tmp, ((PyObject*)__pyx_t_1));
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2036</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2037</span>:         # Precompute boundary evaluations</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2038</span>:         if boundary_multiplicative:</pre>
<pre class='cython code score-2 '>    __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_boundary_multiplicative); if (unlikely((__pyx_t_18 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2038, __pyx_L1_error)</span>
    if (__pyx_t_18) {
/* … */
      goto __pyx_L11;
    }
</pre><pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2039</span>:             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)</pre>
<pre class='cython code score-61 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2039, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_multiply);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2039, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_19 * __pyx_v_a_view.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2039, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2039, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_t, __pyx_v_t_s) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2039, __pyx_L1_error)</span>
      __pyx_t_4 = __pyx_t_10;
      __pyx_t_10 = 0;
      if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_4, __pyx_v_boundary_params_tmp) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2039, __pyx_L1_error)</span>
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2039, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_4, __pyx_t_3, __pyx_t_10};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_16, 2+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 2039, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      }
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2039, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2039, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_10 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
        __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
        if (likely(__pyx_t_10)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_10, __pyx_t_5};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_16, 1+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2039, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      }
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_boundary, __pyx_t_1, 0, 0, NULL, NULL, &amp;__pyx_slice__5, 0, 0, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2039, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2040</span>:         else:</pre>
<pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2041</span>:             boundary[:] = np.add(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)</pre>
<pre class='cython code score-61 '>    /*else*/ {
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2041, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_add);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2041, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_19 * __pyx_v_a_view.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2041, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2041, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_t, __pyx_v_t_s) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2041, __pyx_L1_error)</span>
      __pyx_t_3 = __pyx_t_4;
      __pyx_t_4 = 0;
      if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_3, __pyx_v_boundary_params_tmp) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2041, __pyx_L1_error)</span>
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2041, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
        __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
        if (likely(__pyx_t_3)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_t_5, __pyx_t_4};
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_16, 2+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 2041, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      }
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2041, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2041, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_4 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_6};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_16, 1+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2041, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      }
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_boundary, __pyx_t_1, 0, 0, NULL, NULL, &amp;__pyx_slice__5, 0, 0, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2041, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    __pyx_L11:;
</pre><pre class="cython line score-0">&#xA0;<span class="">2042</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2043</span>:         deadline_tmp = min(max_t, deadline_view[k] - t_view[k])</pre>
<pre class='cython code score-0 '>    __pyx_t_19 = __pyx_v_k;
    __pyx_t_20 = __pyx_v_k;
    __pyx_t_21 = ((*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_19 * __pyx_v_deadline_view.strides[0]) ))) - (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_20 * __pyx_v_t_view.strides[0]) ))));
    __pyx_t_22 = __pyx_v_max_t;
    __pyx_t_18 = (__pyx_t_21 &lt; __pyx_t_22);
    if (__pyx_t_18) {
      __pyx_t_23 = __pyx_t_21;
    } else {
      __pyx_t_23 = __pyx_t_22;
    }
    __pyx_v_deadline_tmp = __pyx_t_23;
</pre><pre class="cython line score-0">&#xA0;<span class="">2044</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2045</span>:         # Loop over samples</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2046</span>:         for n in range(n_samples):</pre>
<pre class='cython code score-0 '>    __pyx_t_16 = __pyx_v_n_samples;
    __pyx_t_17 = __pyx_t_16;
    for (__pyx_t_15 = 0; __pyx_t_15 &lt; __pyx_t_17; __pyx_t_15+=1) {
      __pyx_v_n = __pyx_t_15;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2047</span>:             t_particle = 0.0 # reset time</pre>
<pre class='cython code score-0 '>      __pyx_v_t_particle = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2048</span>:             ix = 0 # reset boundary index</pre>
<pre class='cython code score-0 '>      __pyx_v_ix = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2049</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2050</span>:             # Random walker 1</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2051</span>:             y_h = (-1) * boundary_view[0] + (zh_view[k] * 2 * (boundary_view[0]))  # reset starting position</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = 0;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_24 = 0;
      __pyx_v_y_h = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_zh_view.data + __pyx_t_19 * __pyx_v_zh_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_24 * __pyx_v_boundary_view.strides[0]) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">2052</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2053</span>:             if n == 0:</pre>
<pre class='cython code score-0 '>      __pyx_t_18 = (__pyx_v_n == 0);
      if (__pyx_t_18) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2054</span>:                 if k == 0:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (__pyx_v_k == 0);
        if (__pyx_t_18) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2055</span>:                     traj_view[0, 0] = y_h</pre>
<pre class='cython code score-0 '>          __pyx_t_24 = 0;
          __pyx_t_19 = 0;
          *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_24 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_19 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y_h;
</pre><pre class="cython line score-0">&#xA0;<span class="">2056</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2057</span>:             while y_h &gt;= (-1) * boundary_view[ix] and y_h &lt;= boundary_view[ix] and t_particle &lt;= deadline_tmp:</pre>
<pre class='cython code score-0 '>      while (1) {
        __pyx_t_19 = __pyx_v_ix;
        __pyx_t_25 = (__pyx_v_y_h &gt;= (-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))));
        if (__pyx_t_25) {
        } else {
          __pyx_t_18 = __pyx_t_25;
          goto __pyx_L18_bool_binop_done;
        }
        __pyx_t_19 = __pyx_v_ix;
        __pyx_t_25 = (__pyx_v_y_h &lt;= (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) ))));
        if (__pyx_t_25) {
        } else {
          __pyx_t_18 = __pyx_t_25;
          goto __pyx_L18_bool_binop_done;
        }
        __pyx_t_25 = (__pyx_v_t_particle &lt;= __pyx_v_deadline_tmp);
        __pyx_t_18 = __pyx_t_25;
        __pyx_L18_bool_binop_done:;
        if (!__pyx_t_18) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2058</span>:                 y_h += (vh_view[k] * delta_t) + (sqrt_st * gaussian_values[m])</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = __pyx_v_k;
        __pyx_t_24 = __pyx_v_m;
        __pyx_v_y_h = (__pyx_v_y_h + (((*((float *) ( /* dim=0 */ (__pyx_v_vh_view.data + __pyx_t_19 * __pyx_v_vh_view.strides[0]) ))) * __pyx_v_delta_t) + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_24 * __pyx_v_gaussian_values.strides[0]) ))))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2059</span>:                 t_particle += delta_t</pre>
<pre class='cython code score-0 '>        __pyx_v_t_particle = (__pyx_v_t_particle + __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2060</span>:                 ix += 1</pre>
<pre class='cython code score-0 '>        __pyx_v_ix = (__pyx_v_ix + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2061</span>:                 m += 1</pre>
<pre class='cython code score-0 '>        __pyx_v_m = (__pyx_v_m + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">2062</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2063</span>:                 if m == num_draws:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (__pyx_v_m == __pyx_v_num_draws);
        if (__pyx_t_18) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2064</span>:                     gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2064, __pyx_L1_error)</span>
          __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
          __pyx_v_gaussian_values = __pyx_t_2;
          __pyx_t_2.memview = NULL;
          __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2065</span>:                     m = 0</pre>
<pre class='cython code score-0 '>          __pyx_v_m = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2066</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2067</span>:                 if n == 0:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (__pyx_v_n == 0);
        if (__pyx_t_18) {
/* … */
        }
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2068</span>:                     if k == 0:</pre>
<pre class='cython code score-0 '>          __pyx_t_18 = (__pyx_v_k == 0);
          if (__pyx_t_18) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2069</span>:                         traj_view[ix, 0] = y_h</pre>
<pre class='cython code score-0 '>            __pyx_t_24 = __pyx_v_ix;
            __pyx_t_19 = 0;
            *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_24 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_19 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y_h;
</pre><pre class="cython line score-0">&#xA0;<span class="">2070</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2071</span>:             # If we are already at maximum t, to generate a choice we just sample from a bernoulli</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2072</span>:             if t_particle &gt;= max_t:</pre>
<pre class='cython code score-0 '>      __pyx_t_18 = (__pyx_v_t_particle &gt;= __pyx_v_max_t);
      if (__pyx_t_18) {
/* … */
        goto __pyx_L24;
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">2073</span>:                 # High dim choice depends on position of particle</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2074</span>:                 if boundary_view[ix] &lt;= 0:</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = __pyx_v_ix;
        __pyx_t_18 = ((*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) ))) &lt;= 0.0);
        if (__pyx_t_18) {
/* … */
          goto __pyx_L25;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2075</span>:                     if random_uniform() &lt;= 0.5:</pre>
<pre class='cython code score-5 '>          __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2075, __pyx_L1_error)</span>
          __pyx_t_18 = (__pyx_t_23 &lt;= 0.5);
          if (__pyx_t_18) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2076</span>:                         choices_view[n, k, 0] += 2</pre>
<pre class='cython code score-0 '>            __pyx_t_19 = __pyx_v_n;
            __pyx_t_24 = __pyx_v_k;
            __pyx_t_20 = 0;
            *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_19 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[2]) )) += 2;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2077</span>:                 elif random_uniform() &lt;= ((y_h + boundary_view[ix]) / (2 * boundary_view[ix])):</pre>
<pre class='cython code score-5 '>        __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2077, __pyx_L1_error)</span>
        __pyx_t_20 = __pyx_v_ix;
        __pyx_t_24 = __pyx_v_ix;
        __pyx_t_18 = (__pyx_t_23 &lt;= ((__pyx_v_y_h + (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))) / (2.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_24 * __pyx_v_boundary_view.strides[0]) ))))));
        if (__pyx_t_18) {
/* … */
        }
        __pyx_L25:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2078</span>:                         choices_view[n, k, 0] += 2</pre>
<pre class='cython code score-0 '>          __pyx_t_24 = __pyx_v_n;
          __pyx_t_20 = __pyx_v_k;
          __pyx_t_19 = 0;
          *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_24 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[2]) )) += 2;
</pre><pre class="cython line score-0">&#xA0;<span class="">2079</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2080</span>:                 # Low dim choice random (didn't even get to process it if rt is at max after first choice)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2081</span>:                 # so we just apply a priori bias</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2082</span>:                 if choices_view[n, k, 0] == 0:</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = __pyx_v_n;
        __pyx_t_20 = __pyx_v_k;
        __pyx_t_24 = 0;
        __pyx_t_18 = ((*((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_19 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[2]) ))) == 0);
        if (__pyx_t_18) {
/* … */
          goto __pyx_L27;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2083</span>:                     if random_uniform() &lt;= zl1_view[k]:</pre>
<pre class='cython code score-5 '>          __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2083, __pyx_L1_error)</span>
          __pyx_t_24 = __pyx_v_k;
          __pyx_t_18 = (__pyx_t_23 &lt;= (*((float *) ( /* dim=0 */ (__pyx_v_zl1_view.data + __pyx_t_24 * __pyx_v_zl1_view.strides[0]) ))));
          if (__pyx_t_18) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2084</span>:                         choices_view[n, k, 0] += 1</pre>
<pre class='cython code score-0 '>            __pyx_t_24 = __pyx_v_n;
            __pyx_t_20 = __pyx_v_k;
            __pyx_t_19 = 0;
            *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_24 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[2]) )) += 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">2085</span>:                 else:</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2086</span>:                     if random_uniform() &lt;= zl2_view[k]:</pre>
<pre class='cython code score-5 '>        /*else*/ {
          __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2086, __pyx_L1_error)</span>
          __pyx_t_19 = __pyx_v_k;
          __pyx_t_18 = (__pyx_t_23 &lt;= (*((float *) ( /* dim=0 */ (__pyx_v_zl2_view.data + __pyx_t_19 * __pyx_v_zl2_view.strides[0]) ))));
          if (__pyx_t_18) {
/* … */
          }
        }
        __pyx_L27:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2087</span>:                         choices_view[n, k, 0] += 1</pre>
<pre class='cython code score-0 '>            __pyx_t_19 = __pyx_v_n;
            __pyx_t_20 = __pyx_v_k;
            __pyx_t_24 = 0;
            *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_19 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[2]) )) += 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2088</span>:                 rts_view[n, k, 0] = t_particle</pre>
<pre class='cython code score-0 '>        __pyx_t_24 = __pyx_v_n;
        __pyx_t_20 = __pyx_v_k;
        __pyx_t_19 = 0;
        *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_24 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_20 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_19 * __pyx_v_rts_view.strides[2]) )) = __pyx_v_t_particle;
</pre><pre class="cython line score-0">&#xA0;<span class="">2089</span>:             else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2090</span>:                 # If boundary is negative (or 0) already, we flip a coin</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2091</span>:                 if boundary_view[ix] &lt;= 0:</pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_t_19 = __pyx_v_ix;
        __pyx_t_18 = ((*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) ))) &lt;= 0.0);
        if (__pyx_t_18) {
/* … */
          goto __pyx_L30;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2092</span>:                     if random_uniform() &lt;= 0.5:</pre>
<pre class='cython code score-5 '>          __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2092, __pyx_L1_error)</span>
          __pyx_t_18 = (__pyx_t_23 &lt;= 0.5);
          if (__pyx_t_18) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2093</span>:                         choices_view[n, k, 0] += 2</pre>
<pre class='cython code score-0 '>            __pyx_t_19 = __pyx_v_n;
            __pyx_t_20 = __pyx_v_k;
            __pyx_t_24 = 0;
            *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_19 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[2]) )) += 2;
</pre><pre class="cython line score-0">&#xA0;<span class="">2094</span>:                 # Otherwise apply rule from above</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2095</span>:                 elif random_uniform() &lt;= ((y_h + boundary_view[ix]) / (2 * boundary_view[ix])):</pre>
<pre class='cython code score-5 '>        __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2095, __pyx_L1_error)</span>
        __pyx_t_24 = __pyx_v_ix;
        __pyx_t_20 = __pyx_v_ix;
        __pyx_t_18 = (__pyx_t_23 &lt;= ((__pyx_v_y_h + (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_24 * __pyx_v_boundary_view.strides[0]) )))) / (2.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) ))))));
        if (__pyx_t_18) {
/* … */
        }
        __pyx_L30:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2096</span>:                     choices_view[n, k, 0] += 2</pre>
<pre class='cython code score-0 '>          __pyx_t_20 = __pyx_v_n;
          __pyx_t_24 = __pyx_v_k;
          __pyx_t_19 = 0;
          *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_20 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[2]) )) += 2;
</pre><pre class="cython line score-0">&#xA0;<span class="">2097</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2098</span>:                 y_l1 = (-1) * boundary_view[ix] + (zl1_view[k] * 2 * (boundary_view[ix]))</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = __pyx_v_ix;
        __pyx_t_24 = __pyx_v_k;
        __pyx_t_20 = __pyx_v_ix;
        __pyx_v_y_l1 = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_zl1_view.data + __pyx_t_24 * __pyx_v_zl1_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2099</span>:                 y_l2 = (-1) * boundary_view[ix] + (zl2_view[k] * 2 * (boundary_view[ix]))</pre>
<pre class='cython code score-0 '>        __pyx_t_20 = __pyx_v_ix;
        __pyx_t_24 = __pyx_v_k;
        __pyx_t_19 = __pyx_v_ix;
        __pyx_v_y_l2 = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_zl2_view.data + __pyx_t_24 * __pyx_v_zl2_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">2100</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2101</span>:                 ix1 = ix</pre>
<pre class='cython code score-0 '>        __pyx_v_ix1 = __pyx_v_ix;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2102</span>:                 t_particle1 = t_particle</pre>
<pre class='cython code score-0 '>        __pyx_v_t_particle1 = __pyx_v_t_particle;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2103</span>:                 ix2 = ix</pre>
<pre class='cython code score-0 '>        __pyx_v_ix2 = __pyx_v_ix;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2104</span>:                 t_particle2 = t_particle</pre>
<pre class='cython code score-0 '>        __pyx_v_t_particle2 = __pyx_v_t_particle;
</pre><pre class="cython line score-0">&#xA0;<span class="">2105</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2106</span>:                 if choices_view[n, k, 0] == 0:</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = __pyx_v_n;
        __pyx_t_24 = __pyx_v_k;
        __pyx_t_20 = 0;
        __pyx_t_18 = ((*((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_19 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[2]) ))) == 0);
        if (__pyx_t_18) {
/* … */
          goto __pyx_L32;
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">2107</span>:                     # ix1 = ix</pre>
<pre class="cython line score-0">&#xA0;<span class="">2108</span>:                     # t_particle1 = t_particle</pre>
<pre class="cython line score-0">&#xA0;<span class="">2109</span>:                     #v_l = vl1_view[k]</pre>
<pre class="cython line score-0">&#xA0;<span class="">2110</span>:                     #z_l = zl1_view[k]</pre>
<pre class="cython line score-0">&#xA0;<span class="">2111</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2112</span>:                     # In case boundary is negative already, we flip a coin with bias determined by w_l_ parameter</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2113</span>:                     if (y_l1 &gt;= boundary_view[ix]) or (y_l1 &lt;= ((-1) * boundary_view[ix])):</pre>
<pre class='cython code score-0 '>          __pyx_t_20 = __pyx_v_ix;
          __pyx_t_25 = (__pyx_v_y_l1 &gt;= (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) ))));
          if (!__pyx_t_25) {
          } else {
            __pyx_t_18 = __pyx_t_25;
            goto __pyx_L34_bool_binop_done;
          }
          __pyx_t_20 = __pyx_v_ix;
          __pyx_t_25 = (__pyx_v_y_l1 &lt;= (-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))));
          __pyx_t_18 = __pyx_t_25;
          __pyx_L34_bool_binop_done:;
          if (__pyx_t_18) {
/* … */
          }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2114</span>:                         if random_uniform() &lt; zl1_view[k]:</pre>
<pre class='cython code score-5 '>            __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2114, __pyx_L1_error)</span>
            __pyx_t_20 = __pyx_v_k;
            __pyx_t_18 = (__pyx_t_23 &lt; (*((float *) ( /* dim=0 */ (__pyx_v_zl1_view.data + __pyx_t_20 * __pyx_v_zl1_view.strides[0]) ))));
            if (__pyx_t_18) {
/* … */
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2115</span>:                             choices_view[n, k, 0] += 1</pre>
<pre class='cython code score-0 '>              __pyx_t_20 = __pyx_v_n;
              __pyx_t_24 = __pyx_v_k;
              __pyx_t_19 = 0;
              *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_20 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[2]) )) += 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">2116</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2117</span>:                     if n == 0:</pre>
<pre class='cython code score-0 '>          __pyx_t_18 = (__pyx_v_n == 0);
          if (__pyx_t_18) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2118</span>:                         if k == 0:</pre>
<pre class='cython code score-0 '>            __pyx_t_18 = (__pyx_v_k == 0);
            if (__pyx_t_18) {
/* … */
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2119</span>:                             traj_view[ix, 1] = y_l1</pre>
<pre class='cython code score-0 '>              __pyx_t_19 = __pyx_v_ix;
              __pyx_t_24 = 1;
              *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_19 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_24 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y_l1;
</pre><pre class="cython line score-0">&#xA0;<span class="">2120</span>:                 else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2121</span>:                     # ix2 = ix</pre>
<pre class="cython line score-0">&#xA0;<span class="">2122</span>:                     # t_particle2 = t_particle</pre>
<pre class="cython line score-0">&#xA0;<span class="">2123</span>:                     # v_l = vl2_view[k]</pre>
<pre class="cython line score-0">&#xA0;<span class="">2124</span>:                     # z_l = zl2_view[k]</pre>
<pre class="cython line score-0">&#xA0;<span class="">2125</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2126</span>:                     # In case boundary is negative already, we flip a coin with bias determined by w_l_ parameter</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2127</span>:                     if (y_l2 &gt;= boundary_view[ix]) or (y_l2 &lt;= ((-1) * boundary_view[ix])):</pre>
<pre class='cython code score-0 '>        /*else*/ {
          __pyx_t_24 = __pyx_v_ix;
          __pyx_t_25 = (__pyx_v_y_l2 &gt;= (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_24 * __pyx_v_boundary_view.strides[0]) ))));
          if (!__pyx_t_25) {
          } else {
            __pyx_t_18 = __pyx_t_25;
            goto __pyx_L40_bool_binop_done;
          }
          __pyx_t_24 = __pyx_v_ix;
          __pyx_t_25 = (__pyx_v_y_l2 &lt;= (-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_24 * __pyx_v_boundary_view.strides[0]) )))));
          __pyx_t_18 = __pyx_t_25;
          __pyx_L40_bool_binop_done:;
          if (__pyx_t_18) {
/* … */
          }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2128</span>:                         if random_uniform() &lt; zl2_view[k]:</pre>
<pre class='cython code score-5 '>            __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2128, __pyx_L1_error)</span>
            __pyx_t_24 = __pyx_v_k;
            __pyx_t_18 = (__pyx_t_23 &lt; (*((float *) ( /* dim=0 */ (__pyx_v_zl2_view.data + __pyx_t_24 * __pyx_v_zl2_view.strides[0]) ))));
            if (__pyx_t_18) {
/* … */
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2129</span>:                             choices_view[n, k, 0] += 1</pre>
<pre class='cython code score-0 '>              __pyx_t_24 = __pyx_v_n;
              __pyx_t_19 = __pyx_v_k;
              __pyx_t_20 = 0;
              *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_24 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[2]) )) += 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">2130</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2131</span>:                     if n == 0:</pre>
<pre class='cython code score-0 '>          __pyx_t_18 = (__pyx_v_n == 0);
          if (__pyx_t_18) {
/* … */
          }
        }
        __pyx_L32:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2132</span>:                         if k == 0:</pre>
<pre class='cython code score-0 '>            __pyx_t_18 = (__pyx_v_k == 0);
            if (__pyx_t_18) {
/* … */
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2133</span>:                             traj_view[ix, 2] = y_l2</pre>
<pre class='cython code score-0 '>              __pyx_t_20 = __pyx_v_ix;
              __pyx_t_19 = 2;
              *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_20 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_19 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y_l2;
</pre><pre class="cython line score-0">&#xA0;<span class="">2134</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2135</span>:                 # Random walker low level (1)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2136</span>:                 if (choices_view[n, k, 0] == 0) | ((n == 0) &amp; (k == 0)):</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = __pyx_v_n;
        __pyx_t_20 = __pyx_v_k;
        __pyx_t_24 = 0;
        __pyx_t_18 = (((*((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_19 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[2]) ))) == 0) | ((__pyx_v_n == 0) &amp; (__pyx_v_k == 0)));
        if (__pyx_t_18) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2137</span>:                     while (y_l1 &gt;= ((-1) * boundary_view[ix1])) and (y_l1 &lt;= boundary_view[ix1]) and (t_particle1 &lt;= deadline_tmp):</pre>
<pre class='cython code score-0 '>          while (1) {
            __pyx_t_24 = __pyx_v_ix1;
            __pyx_t_25 = (__pyx_v_y_l1 &gt;= (-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_24 * __pyx_v_boundary_view.strides[0]) )))));
            if (__pyx_t_25) {
            } else {
              __pyx_t_18 = __pyx_t_25;
              goto __pyx_L48_bool_binop_done;
            }
            __pyx_t_24 = __pyx_v_ix1;
            __pyx_t_25 = (__pyx_v_y_l1 &lt;= (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_24 * __pyx_v_boundary_view.strides[0]) ))));
            if (__pyx_t_25) {
            } else {
              __pyx_t_18 = __pyx_t_25;
              goto __pyx_L48_bool_binop_done;
            }
            __pyx_t_25 = (__pyx_v_t_particle1 &lt;= __pyx_v_deadline_tmp);
            __pyx_t_18 = __pyx_t_25;
            __pyx_L48_bool_binop_done:;
            if (!__pyx_t_18) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2138</span>:                         y_l1 += (vl1_view[k] * delta_t) + (sqrt_st * gaussian_values[m])</pre>
<pre class='cython code score-0 '>            __pyx_t_24 = __pyx_v_k;
            __pyx_t_20 = __pyx_v_m;
            __pyx_v_y_l1 = (__pyx_v_y_l1 + (((*((float *) ( /* dim=0 */ (__pyx_v_vl1_view.data + __pyx_t_24 * __pyx_v_vl1_view.strides[0]) ))) * __pyx_v_delta_t) + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_20 * __pyx_v_gaussian_values.strides[0]) ))))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2139</span>:                         t_particle1 += delta_t</pre>
<pre class='cython code score-0 '>            __pyx_v_t_particle1 = (__pyx_v_t_particle1 + __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2140</span>:                         ix1 += 1</pre>
<pre class='cython code score-0 '>            __pyx_v_ix1 = (__pyx_v_ix1 + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2141</span>:                         m += 1</pre>
<pre class='cython code score-0 '>            __pyx_v_m = (__pyx_v_m + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2142</span>:                         if m == num_draws:</pre>
<pre class='cython code score-0 '>            __pyx_t_18 = (__pyx_v_m == __pyx_v_num_draws);
            if (__pyx_t_18) {
/* … */
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2143</span>:                             gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>              __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2143, __pyx_L1_error)</span>
              __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
              __pyx_v_gaussian_values = __pyx_t_2;
              __pyx_t_2.memview = NULL;
              __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2144</span>:                             m = 0</pre>
<pre class='cython code score-0 '>              __pyx_v_m = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2145</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2146</span>:                         if n == 0:</pre>
<pre class='cython code score-0 '>            __pyx_t_18 = (__pyx_v_n == 0);
            if (__pyx_t_18) {
/* … */
            }
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2147</span>:                             if k == 0:</pre>
<pre class='cython code score-0 '>              __pyx_t_18 = (__pyx_v_k == 0);
              if (__pyx_t_18) {
/* … */
              }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2148</span>:                                 traj_view[ix1, 1] = y_l1</pre>
<pre class='cython code score-0 '>                __pyx_t_20 = __pyx_v_ix1;
                __pyx_t_24 = 1;
                *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_20 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_24 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y_l1;
</pre><pre class="cython line score-0">&#xA0;<span class="">2149</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2150</span>:                 # Random walker low level (2)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2151</span>:                 if (choices_view[n, k, 0] == 2) | ((n == 0) &amp; (k == 0)):</pre>
<pre class='cython code score-0 '>        __pyx_t_24 = __pyx_v_n;
        __pyx_t_20 = __pyx_v_k;
        __pyx_t_19 = 0;
        __pyx_t_18 = (((*((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_24 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[2]) ))) == 2) | ((__pyx_v_n == 0) &amp; (__pyx_v_k == 0)));
        if (__pyx_t_18) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2152</span>:                     while (y_l2 &gt;= ((-1) * boundary_view[ix2])) and (y_l2 &lt;= boundary_view[ix2]) and (t_particle2 &lt;= deadline_tmp):</pre>
<pre class='cython code score-0 '>          while (1) {
            __pyx_t_19 = __pyx_v_ix2;
            __pyx_t_25 = (__pyx_v_y_l2 &gt;= (-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))));
            if (__pyx_t_25) {
            } else {
              __pyx_t_18 = __pyx_t_25;
              goto __pyx_L57_bool_binop_done;
            }
            __pyx_t_19 = __pyx_v_ix2;
            __pyx_t_25 = (__pyx_v_y_l2 &lt;= (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) ))));
            if (__pyx_t_25) {
            } else {
              __pyx_t_18 = __pyx_t_25;
              goto __pyx_L57_bool_binop_done;
            }
            __pyx_t_25 = (__pyx_v_t_particle2 &lt;= __pyx_v_deadline_tmp);
            __pyx_t_18 = __pyx_t_25;
            __pyx_L57_bool_binop_done:;
            if (!__pyx_t_18) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2153</span>:                         y_l2 += (vl2_view[k] * delta_t) + (sqrt_st * gaussian_values[m])</pre>
<pre class='cython code score-0 '>            __pyx_t_19 = __pyx_v_k;
            __pyx_t_20 = __pyx_v_m;
            __pyx_v_y_l2 = (__pyx_v_y_l2 + (((*((float *) ( /* dim=0 */ (__pyx_v_vl2_view.data + __pyx_t_19 * __pyx_v_vl2_view.strides[0]) ))) * __pyx_v_delta_t) + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_20 * __pyx_v_gaussian_values.strides[0]) ))))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2154</span>:                         t_particle2 += delta_t</pre>
<pre class='cython code score-0 '>            __pyx_v_t_particle2 = (__pyx_v_t_particle2 + __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2155</span>:                         ix2 += 1</pre>
<pre class='cython code score-0 '>            __pyx_v_ix2 = (__pyx_v_ix2 + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2156</span>:                         m += 1</pre>
<pre class='cython code score-0 '>            __pyx_v_m = (__pyx_v_m + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2157</span>:                         if m == num_draws:</pre>
<pre class='cython code score-0 '>            __pyx_t_18 = (__pyx_v_m == __pyx_v_num_draws);
            if (__pyx_t_18) {
/* … */
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2158</span>:                             gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>              __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2158, __pyx_L1_error)</span>
              __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
              __pyx_v_gaussian_values = __pyx_t_2;
              __pyx_t_2.memview = NULL;
              __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2159</span>:                             m = 0</pre>
<pre class='cython code score-0 '>              __pyx_v_m = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2160</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2161</span>:                         if n == 0:</pre>
<pre class='cython code score-0 '>            __pyx_t_18 = (__pyx_v_n == 0);
            if (__pyx_t_18) {
/* … */
            }
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2162</span>:                             if k == 0:</pre>
<pre class='cython code score-0 '>              __pyx_t_18 = (__pyx_v_k == 0);
              if (__pyx_t_18) {
/* … */
              }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2163</span>:                                 traj_view[ix2, 2] = y_l2</pre>
<pre class='cython code score-0 '>                __pyx_t_20 = __pyx_v_ix2;
                __pyx_t_19 = 2;
                *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_20 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_19 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y_l2;
</pre><pre class="cython line score-0">&#xA0;<span class="">2164</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2165</span>:                 # Get back to single t_particle</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2166</span>:                 if (choices_view[n, k, 0] == 0):</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = __pyx_v_n;
        __pyx_t_20 = __pyx_v_k;
        __pyx_t_24 = 0;
        __pyx_t_18 = ((*((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_19 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[2]) ))) == 0);
        if (__pyx_t_18) {
/* … */
          goto __pyx_L63;
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2167</span>:                     t_particle = t_particle1</pre>
<pre class='cython code score-0 '>          __pyx_v_t_particle = __pyx_v_t_particle1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2168</span>:                     ix = ix1</pre>
<pre class='cython code score-0 '>          __pyx_v_ix = __pyx_v_ix1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2169</span>:                     y_l = y_l1</pre>
<pre class='cython code score-0 '>          __pyx_v_y_l = __pyx_v_y_l1;
</pre><pre class="cython line score-0">&#xA0;<span class="">2170</span>:                 else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2171</span>:                     t_particle = t_particle2</pre>
<pre class='cython code score-0 '>        /*else*/ {
          __pyx_v_t_particle = __pyx_v_t_particle2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2172</span>:                     ix = ix2</pre>
<pre class='cython code score-0 '>          __pyx_v_ix = __pyx_v_ix2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2173</span>:                     y_l = y_l2</pre>
<pre class='cython code score-0 '>          __pyx_v_y_l = __pyx_v_y_l2;
        }
        __pyx_L63:;
      }
      __pyx_L24:;
</pre><pre class="cython line score-0">&#xA0;<span class="">2174</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2175</span>:             if smooth:</pre>
<pre class='cython code score-2 '>      __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_smooth); if (unlikely((__pyx_t_18 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2175, __pyx_L1_error)</span>
      if (__pyx_t_18) {
/* … */
        goto __pyx_L64;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2176</span>:                 if t_particle == 0.0:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (__pyx_v_t_particle == 0.0);
        if (__pyx_t_18) {
/* … */
          goto __pyx_L65;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2177</span>:                     smooth_u = random_uniform() * 0.5 * delta_t</pre>
<pre class='cython code score-5 '>          __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2177, __pyx_L1_error)</span>
          __pyx_v_smooth_u = ((__pyx_t_23 * 0.5) * __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2178</span>:                 elif t_particle &lt; deadline_tmp:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (__pyx_v_t_particle &lt; __pyx_v_deadline_tmp);
        if (__pyx_t_18) {
/* … */
          goto __pyx_L65;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2179</span>:                     smooth_u = (0.5 - random_uniform()) * delta_t</pre>
<pre class='cython code score-5 '>          __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2179, __pyx_L1_error)</span>
          __pyx_v_smooth_u = ((0.5 - __pyx_t_23) * __pyx_v_delta_t);
</pre><pre class="cython line score-0">&#xA0;<span class="">2180</span>:                 else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2181</span>:                     smooth_u = 0.0</pre>
<pre class='cython code score-0 '>        /*else*/ {
          __pyx_v_smooth_u = 0.0;
        }
        __pyx_L65:;
</pre><pre class="cython line score-0">&#xA0;<span class="">2182</span>:             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2183</span>:                 smooth_u = 0.0</pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_v_smooth_u = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2184</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2185</span>:                 rts_view[n, k, 0] = t_particle + t_view[k] + smooth_u</pre>
<pre class='cython code score-0 '>        __pyx_t_24 = __pyx_v_k;
        __pyx_t_20 = __pyx_v_n;
        __pyx_t_19 = __pyx_v_k;
        __pyx_t_26 = 0;
        *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_20 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_19 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_26 * __pyx_v_rts_view.strides[2]) )) = ((__pyx_v_t_particle + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_24 * __pyx_v_t_view.strides[0]) )))) + __pyx_v_smooth_u);
</pre><pre class="cython line score-0">&#xA0;<span class="">2186</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2187</span>:                 # The probability of making a 'mistake' 1 - (relative y position)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2188</span>:                 # y at upper bound --&gt; choices_view[n, k, 0] add one deterministically</pre>
<pre class="cython line score-0">&#xA0;<span class="">2189</span>:                 # y at lower bound --&gt; choice_view[n, k, 0] stays the same deterministically</pre>
<pre class="cython line score-0">&#xA0;<span class="">2190</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2191</span>:                 # If boundary is negative (or 0) already, we flip a coin</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2192</span>:                 if boundary_view[ix] &lt;= 0:</pre>
<pre class='cython code score-0 '>        __pyx_t_24 = __pyx_v_ix;
        __pyx_t_18 = ((*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_24 * __pyx_v_boundary_view.strides[0]) ))) &lt;= 0.0);
        if (__pyx_t_18) {
/* … */
          goto __pyx_L66;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2193</span>:                     if random_uniform() &lt;= 0.5:</pre>
<pre class='cython code score-5 '>          __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2193, __pyx_L1_error)</span>
          __pyx_t_18 = (__pyx_t_23 &lt;= 0.5);
          if (__pyx_t_18) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2194</span>:                         choices_view[n, k, 0] += 1</pre>
<pre class='cython code score-0 '>            __pyx_t_24 = __pyx_v_n;
            __pyx_t_26 = __pyx_v_k;
            __pyx_t_19 = 0;
            *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_24 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_26 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[2]) )) += 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">2195</span>:                 # Otherwise apply rule from above</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2196</span>:                 elif random_uniform() &lt;= ((y_l + boundary_view[ix]) / (2 * boundary_view[ix])):</pre>
<pre class='cython code score-5 '>        __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2196, __pyx_L1_error)</span>
        __pyx_t_19 = __pyx_v_ix;
        __pyx_t_26 = __pyx_v_ix;
        __pyx_t_18 = (__pyx_t_23 &lt;= ((__pyx_v_y_l + (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))) / (2.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_26 * __pyx_v_boundary_view.strides[0]) ))))));
        if (__pyx_t_18) {
/* … */
        }
        __pyx_L66:;
      }
      __pyx_L64:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2197</span>:                     choices_view[n, k, 0] += 1</pre>
<pre class='cython code score-0 '>          __pyx_t_26 = __pyx_v_n;
          __pyx_t_19 = __pyx_v_k;
          __pyx_t_24 = 0;
          *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_26 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[2]) )) += 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">2198</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2199</span>:             if (rts_view[n, k, 0] &gt;= deadline_view[k]) | (deadline_view[k] &lt;= 0):</pre>
<pre class='cython code score-0 '>      __pyx_t_24 = __pyx_v_n;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_26 = 0;
      __pyx_t_20 = __pyx_v_k;
      __pyx_t_27 = __pyx_v_k;
      __pyx_t_18 = (((*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_24 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_19 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_26 * __pyx_v_rts_view.strides[2]) ))) &gt;= (*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_20 * __pyx_v_deadline_view.strides[0]) )))) | ((*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_27 * __pyx_v_deadline_view.strides[0]) ))) &lt;= 0.0));
      if (__pyx_t_18) {
/* … */
      }
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2200</span>:                     rts_view[n, k, 0] = -999</pre>
<pre class='cython code score-0 '>        __pyx_t_27 = __pyx_v_n;
        __pyx_t_20 = __pyx_v_k;
        __pyx_t_26 = 0;
        *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_27 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_20 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_26 * __pyx_v_rts_view.strides[2]) )) = -999.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2201</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2202</span>:     if return_option == 'full':</pre>
<pre class='cython code score-2 '>  __pyx_t_18 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_return_option, __pyx_n_u_full, Py_EQ)); if (unlikely((__pyx_t_18 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2202, __pyx_L1_error)</span>
  if (__pyx_t_18) {
/* … */
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2203</span>:         return {'rts': rts, 'choices': choices, 'metadata': {'vh': vh,</pre>
<pre class='cython code score-20 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2203, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2203, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2203, __pyx_L1_error)</span>
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(10);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2203, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_vh, ((PyObject *)__pyx_v_vh)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2203, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2204</span>:                                                             'vl1': vl1,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_vl1, ((PyObject *)__pyx_v_vl1)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2203, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2205</span>:                                                             'vl2': vl2,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_vl2, ((PyObject *)__pyx_v_vl2)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2203, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2206</span>:                                                             'a': a,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2203, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2207</span>:                                                             'zh': zh,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_zh, ((PyObject *)__pyx_v_zh)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2203, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2208</span>:                                                             'zl1': zl1,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_zl1, ((PyObject *)__pyx_v_zl1)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2203, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2209</span>:                                                             'zl2': zl2,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_zl2, ((PyObject *)__pyx_v_zl2)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2203, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2210</span>:                                                             't': t,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2203, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2211</span>:                                                             'deadline': deadline,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_deadline, ((PyObject *)__pyx_v_deadline)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2203, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2212</span>:                                                             's': s,</pre>
<pre class='cython code score-11 '>    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_s);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2212, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_s, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2203, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_10 = __pyx_t_6;
    __pyx_t_6 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2213</span>:                                                             **boundary_params,</pre>
<pre class='cython code score-17 '>    if (unlikely(__pyx_v_boundary_params == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
      <span class='error_goto'>__PYX_ERR(0, 2213, __pyx_L1_error)</span>
    }
    if (unlikely(<span class='py_c_api'>PyDict_Update</span>(__pyx_t_10, __pyx_v_boundary_params) &lt; 0)) {
      if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseMappingExpectedError</span>(__pyx_v_boundary_params);
      <span class='error_goto'>__PYX_ERR(0, 2213, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2214</span>:                                                             'delta_t': delta_t,</pre>
<pre class='cython code score-11 '>    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_t);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2214, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_delta_t, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2214, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2215</span>:                                                             'max_t': max_t,</pre>
<pre class='cython code score-11 '>    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_max_t);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2215, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_max_t, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2215, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2216</span>:                                                             'n_samples': n_samples,</pre>
<pre class='cython code score-8 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2216, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_n_samples, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2216, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2217</span>:                                                             'n_trials': n_trials,</pre>
<pre class='cython code score-13 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2217, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_n_trials, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2217, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_simulator, __pyx_n_u_ddm_flexbound) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2218, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">2218</span>:                                                             'simulator': 'ddm_flexbound',</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2219</span>:                                                             'boundary_fun_type': boundary_fun.__name__,</pre>
<pre class='cython code score-8 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_boundary_fun, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2219, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_boundary_fun_type, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2219, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2220</span>:                                                             'trajectory': traj,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_trajectory, __pyx_v_traj) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2220, __pyx_L1_error)</span>
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2221</span>:                                                             'possible_choices': [0, 1, 2, 3],</pre>
<pre class='cython code score-23 '>    __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2221, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 0, __pyx_int_0)) <span class='error_goto'>__PYX_ERR(0, 2221, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 2221, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 2, __pyx_int_2)) <span class='error_goto'>__PYX_ERR(0, 2221, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 3, __pyx_int_3)) <span class='error_goto'>__PYX_ERR(0, 2221, __pyx_L1_error)</span>;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_possible_choices, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2221, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2222</span>:                                                             'boundary': boundary}}</pre>
<pre class='cython code score-11 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_boundary, __pyx_v_boundary) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2222, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_metadata, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2203, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2223</span>:     elif return_option == 'minimal':</pre>
<pre class='cython code score-2 '>  __pyx_t_18 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_return_option, __pyx_n_u_minimal, Py_EQ)); if (unlikely((__pyx_t_18 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2223, __pyx_L1_error)</span>
  if (likely(__pyx_t_18)) {
/* … */
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2224</span>:         return {'rts': rts, 'choices': choices, 'metadata': {'simulator': 'ddm_flexbound',</pre>
<pre class='cython code score-20 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2224, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2224, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2224, __pyx_L1_error)</span>
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2224, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_simulator, __pyx_n_u_ddm_flexbound) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2224, __pyx_L1_error)</span>
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2225</span>:                                                              'possible_choices': [0, 1, 2, 3],</pre>
<pre class='cython code score-23 '>    __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2225, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 0, __pyx_int_0)) <span class='error_goto'>__PYX_ERR(0, 2225, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 2225, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 2, __pyx_int_2)) <span class='error_goto'>__PYX_ERR(0, 2225, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 3, __pyx_int_3)) <span class='error_goto'>__PYX_ERR(0, 2225, __pyx_L1_error)</span>;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_possible_choices, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2224, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2226</span>:                                                              'boundary_fun_type': boundary_fun.__name__,</pre>
<pre class='cython code score-8 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_boundary_fun, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2226, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_boundary_fun_type, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2224, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2227</span>:                                                              'n_samples': n_samples,</pre>
<pre class='cython code score-8 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2227, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_n_samples, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2224, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2228</span>:                                                              'n_trials': n_trials,</pre>
<pre class='cython code score-14 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2228, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_n_trials, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2224, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_metadata, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2224, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2229</span>:                                                              }}</pre>
<pre class="cython line score-0">&#xA0;<span class="">2230</span>:     else:</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2231</span>:         raise ValueError('return_option must be either "full" or "minimal"')</pre>
<pre class='cython code score-5 '>  /*else*/ {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2231, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 2231, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">2232</span>: # -----------------------------------------------------------------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2233</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2234</span>: # Simulate (rt, choice) tuples from: DDM WITH FLEXIBLE BOUNDARIES ------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2235</span>: # @cythonboundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2236</span>: # @cythonwraparound(False)</pre>
<pre class="cython line score-167" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2237</span>: def ddm_flexbound_par2(np.ndarray[float, ndim = 1] vh,</pre>
<pre class='cython code score-167 '>static PyObject *__pyx_pf_4cssm_64__defaults__(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_r = NULL;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
/* … */
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(12);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2237, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 2, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 3, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 4, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_True));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_True));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 5, ((PyObject *)Py_True))) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 6, Py_None)) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_True));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_True));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 7, ((PyObject *)Py_True))) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults9, __pyx_self)-&gt;__pyx_arg_boundary_params);
  <span class='refnanny'>__Pyx_GIVEREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults9, __pyx_self)-&gt;__pyx_arg_boundary_params);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 8, <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults9, __pyx_self)-&gt;__pyx_arg_boundary_params)) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 9, Py_None)) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject*)__pyx_n_u_full));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject*)__pyx_n_u_full));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 10, ((PyObject*)__pyx_n_u_full))) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_False));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_False));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 11, ((PyObject *)Py_False))) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2237, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 1, Py_None)) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L1_error)</span>;
  __pyx_t_6 = 0;
  __pyx_r = __pyx_t_5;
  __pyx_t_5 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.__defaults__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_4cssm_27ddm_flexbound_par2(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_4cssm_27ddm_flexbound_par2 = {"ddm_flexbound_par2", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_4cssm_27ddm_flexbound_par2, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_4cssm_27ddm_flexbound_par2(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyArrayObject *__pyx_v_vh = 0;
  PyArrayObject *__pyx_v_vl1 = 0;
  PyArrayObject *__pyx_v_vl2 = 0;
  PyArrayObject *__pyx_v_a = 0;
  PyArrayObject *__pyx_v_zh = 0;
  PyArrayObject *__pyx_v_zl1 = 0;
  PyArrayObject *__pyx_v_zl2 = 0;
  PyArrayObject *__pyx_v_t = 0;
  PyArrayObject *__pyx_v_deadline = 0;
  float __pyx_v_s;
  float __pyx_v_delta_t;
  float __pyx_v_max_t;
  int __pyx_v_n_samples;
  int __pyx_v_n_trials;
  CYTHON_UNUSED PyObject *__pyx_v_print_info = 0;
  PyObject *__pyx_v_boundary_fun = 0;
  PyObject *__pyx_v_boundary_multiplicative = 0;
  PyObject *__pyx_v_boundary_params = 0;
  PyObject *__pyx_v_random_state = 0;
  PyObject *__pyx_v_return_option = 0;
  PyObject *__pyx_v_smooth = 0;
  CYTHON_UNUSED PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("ddm_flexbound_par2 (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_vh,&amp;__pyx_n_s_vl1,&amp;__pyx_n_s_vl2,&amp;__pyx_n_s_a,&amp;__pyx_n_s_zh,&amp;__pyx_n_s_zl1,&amp;__pyx_n_s_zl2,&amp;__pyx_n_s_t,&amp;__pyx_n_s_deadline,&amp;__pyx_n_s_s,&amp;__pyx_n_s_delta_t,&amp;__pyx_n_s_max_t,&amp;__pyx_n_s_n_samples,&amp;__pyx_n_s_n_trials,&amp;__pyx_n_s_print_info,&amp;__pyx_n_s_boundary_fun,&amp;__pyx_n_s_boundary_multiplicative,&amp;__pyx_n_s_boundary_params,&amp;__pyx_n_s_random_state,&amp;__pyx_n_s_return_option,&amp;__pyx_n_s_smooth,0};
  PyObject* values[21] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    __pyx_defaults9 *__pyx_dynamic_args = <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults9, __pyx_self);
    values[14] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_True)));
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs);
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4cssm_26ddm_flexbound_par2(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_vh, PyArrayObject *__pyx_v_vl1, PyArrayObject *__pyx_v_vl2, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_zh, PyArrayObject *__pyx_v_zl1, PyArrayObject *__pyx_v_zl2, PyArrayObject *__pyx_v_t, PyArrayObject *__pyx_v_deadline, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, CYTHON_UNUSED PyObject *__pyx_v_print_info, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state, PyObject *__pyx_v_return_option, PyObject *__pyx_v_smooth, CYTHON_UNUSED PyObject *__pyx_v_kwargs) {
  __Pyx_memviewslice __pyx_v_vh_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_vl1_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_vl2_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_a_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_zh_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_zl1_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_zl2_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_t_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_deadline_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_traj = NULL;
  __Pyx_memviewslice __pyx_v_traj_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_rts = NULL;
  PyObject *__pyx_v_rts_high = NULL;
  PyObject *__pyx_v_rts_low = NULL;
  PyObject *__pyx_v_choices = NULL;
  __Pyx_memviewslice __pyx_v_rts_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_rts_high_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_rts_low_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_choices_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  float __pyx_v_delta_t_sqrt;
  float __pyx_v_sqrt_st;
  int __pyx_v_num_draws;
  PyObject *__pyx_v_t_s = NULL;
  PyObject *__pyx_v_boundary = NULL;
  __Pyx_memviewslice __pyx_v_boundary_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  float __pyx_v_y_h;
  float __pyx_v_y_l;
  float __pyx_v_y_l1;
  float __pyx_v_y_l2;
  float __pyx_v_t_h;
  float __pyx_v_t_l;
  float __pyx_v_t_l1;
  float __pyx_v_t_l2;
  float __pyx_v_smooth_u;
  float __pyx_v_deadline_tmp;
  Py_ssize_t __pyx_v_n;
  Py_ssize_t __pyx_v_ix;
  Py_ssize_t __pyx_v_ix1;
  Py_ssize_t __pyx_v_ix2;
  Py_ssize_t __pyx_v_k;
  Py_ssize_t __pyx_v_m;
  __Pyx_memviewslice __pyx_v_gaussian_values = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_boundary_params_tmp = NULL;
  PyObject *__pyx_9genexpr10__pyx_v_key = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_a;
  __Pyx_Buffer __pyx_pybuffer_a;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_deadline;
  __Pyx_Buffer __pyx_pybuffer_deadline;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_t;
  __Pyx_Buffer __pyx_pybuffer_t;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_vh;
  __Pyx_Buffer __pyx_pybuffer_vh;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_vl1;
  __Pyx_Buffer __pyx_pybuffer_vl1;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_vl2;
  __Pyx_Buffer __pyx_pybuffer_vl2;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_zh;
  __Pyx_Buffer __pyx_pybuffer_zh;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_zl1;
  __Pyx_Buffer __pyx_pybuffer_zl1;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_zl2;
  __Pyx_Buffer __pyx_pybuffer_zl2;
  PyObject *__pyx_r = NULL;
  __pyx_pybuffer_vh.pybuffer.buf = NULL;
  __pyx_pybuffer_vh.refcount = 0;
  __pyx_pybuffernd_vh.data = NULL;
  __pyx_pybuffernd_vh.rcbuffer = &amp;__pyx_pybuffer_vh;
  __pyx_pybuffer_vl1.pybuffer.buf = NULL;
  __pyx_pybuffer_vl1.refcount = 0;
  __pyx_pybuffernd_vl1.data = NULL;
  __pyx_pybuffernd_vl1.rcbuffer = &amp;__pyx_pybuffer_vl1;
  __pyx_pybuffer_vl2.pybuffer.buf = NULL;
  __pyx_pybuffer_vl2.refcount = 0;
  __pyx_pybuffernd_vl2.data = NULL;
  __pyx_pybuffernd_vl2.rcbuffer = &amp;__pyx_pybuffer_vl2;
  __pyx_pybuffer_a.pybuffer.buf = NULL;
  __pyx_pybuffer_a.refcount = 0;
  __pyx_pybuffernd_a.data = NULL;
  __pyx_pybuffernd_a.rcbuffer = &amp;__pyx_pybuffer_a;
  __pyx_pybuffer_zh.pybuffer.buf = NULL;
  __pyx_pybuffer_zh.refcount = 0;
  __pyx_pybuffernd_zh.data = NULL;
  __pyx_pybuffernd_zh.rcbuffer = &amp;__pyx_pybuffer_zh;
  __pyx_pybuffer_zl1.pybuffer.buf = NULL;
  __pyx_pybuffer_zl1.refcount = 0;
  __pyx_pybuffernd_zl1.data = NULL;
  __pyx_pybuffernd_zl1.rcbuffer = &amp;__pyx_pybuffer_zl1;
  __pyx_pybuffer_zl2.pybuffer.buf = NULL;
  __pyx_pybuffer_zl2.refcount = 0;
  __pyx_pybuffernd_zl2.data = NULL;
  __pyx_pybuffernd_zl2.rcbuffer = &amp;__pyx_pybuffer_zl2;
  __pyx_pybuffer_t.pybuffer.buf = NULL;
  __pyx_pybuffer_t.refcount = 0;
  __pyx_pybuffernd_t.data = NULL;
  __pyx_pybuffernd_t.rcbuffer = &amp;__pyx_pybuffer_t;
  __pyx_pybuffer_deadline.pybuffer.buf = NULL;
  __pyx_pybuffer_deadline.refcount = 0;
  __pyx_pybuffernd_deadline.data = NULL;
  __pyx_pybuffernd_deadline.rcbuffer = &amp;__pyx_pybuffer_deadline;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_vh, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_vh.diminfo[0].strides = __pyx_pybuffernd_vh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_vh.diminfo[0].shape = __pyx_pybuffernd_vh.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vl1.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_vl1, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_vl1.diminfo[0].strides = __pyx_pybuffernd_vl1.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_vl1.diminfo[0].shape = __pyx_pybuffernd_vl1.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vl2.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_vl2, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_vl2.diminfo[0].strides = __pyx_pybuffernd_vl2.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_vl2.diminfo[0].shape = __pyx_pybuffernd_vl2.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_a, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_zh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_zh, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_zh.diminfo[0].strides = __pyx_pybuffernd_zh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_zh.diminfo[0].shape = __pyx_pybuffernd_zh.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_zl1.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_zl1, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_zl1.diminfo[0].strides = __pyx_pybuffernd_zl1.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_zl1.diminfo[0].shape = __pyx_pybuffernd_zl1.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_zl2.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_zl2, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_zl2.diminfo[0].strides = __pyx_pybuffernd_zl2.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_zl2.diminfo[0].shape = __pyx_pybuffernd_zl2.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_t, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_t.diminfo[0].strides = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_t.diminfo[0].shape = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_deadline, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_deadline.diminfo[0].strides = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_deadline.diminfo[0].shape = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.shape[0];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_2, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_9, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vh.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vl1.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vl2.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zh.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zl1.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zl2.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.ddm_flexbound_par2", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vl1.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vl2.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zl1.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zl2.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_vh_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_vl1_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_vl2_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_a_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_zh_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_zl1_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_zl2_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_t_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_deadline_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_traj);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_traj_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rts_high);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rts_low);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_choices);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_rts_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_rts_high_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_rts_low_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_choices_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t_s);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_boundary);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_boundary_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_boundary_params_tmp);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_9genexpr10__pyx_v_key);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__49 = <span class='py_c_api'>PyTuple_Pack</span>(69, __pyx_n_s_vh, __pyx_n_s_vl1, __pyx_n_s_vl2, __pyx_n_s_a, __pyx_n_s_zh, __pyx_n_s_zl1, __pyx_n_s_zl2, __pyx_n_s_t, __pyx_n_s_deadline, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_print_info, __pyx_n_s_boundary_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_random_state, __pyx_n_s_return_option, __pyx_n_s_smooth, __pyx_n_s_kwargs, __pyx_n_s_vh_view, __pyx_n_s_vl1_view, __pyx_n_s_vl2_view, __pyx_n_s_a_view, __pyx_n_s_zh_view, __pyx_n_s_zl1_view, __pyx_n_s_zl2_view, __pyx_n_s_t_view, __pyx_n_s_deadline_view, __pyx_n_s_traj, __pyx_n_s_traj_view, __pyx_n_s_rts, __pyx_n_s_rts_high, __pyx_n_s_rts_low, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_rts_high_view, __pyx_n_s_rts_low_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_num_draws, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_boundary_view, __pyx_n_s_y_h, __pyx_n_s_y_l, __pyx_n_s_y_l1, __pyx_n_s_y_l2, __pyx_n_s_v_l, __pyx_n_s_v_l1, __pyx_n_s_v_l2, __pyx_n_s_t_h, __pyx_n_s_t_l, __pyx_n_s_t_l1, __pyx_n_s_t_l2, __pyx_n_s_smooth_u, __pyx_n_s_deadline_tmp, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_ix1, __pyx_n_s_ix2, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_gaussian_values, __pyx_n_s_boundary_params_tmp, __pyx_n_s_key);<span class='error_goto'> if (unlikely(!__pyx_tuple__49)) __PYX_ERR(0, 2237, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__49);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__49);
/* … */
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_4cssm_27ddm_flexbound_par2, 0, __pyx_n_s_ddm_flexbound_par2, NULL, __pyx_n_s_cssm, __pyx_d, ((PyObject *)__pyx_codeobj__50));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2237, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (!<span class='pyx_c_api'>__Pyx_CyFunction_InitDefaults</span>(__pyx_t_5, sizeof(__pyx_defaults9), 1)) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L1_error)</span>
  __pyx_codeobj__50 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(21, 0, 0, 69, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__49, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_ddm_flexbound_par2, 2237, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__50)) __PYX_ERR(0, 2237, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">2238</span>:                        np.ndarray[float, ndim = 1] vl1,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2239</span>:                        np.ndarray[float, ndim = 1] vl2,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2240</span>:                        np.ndarray[float, ndim = 1] a,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2241</span>:                        np.ndarray[float, ndim = 1] zh,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2242</span>:                        np.ndarray[float, ndim = 1] zl1,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2243</span>:                        np.ndarray[float, ndim = 1] zl2,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2244</span>:                        np.ndarray[float, ndim = 1] t,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2245</span>:                        np.ndarray[float, ndim = 1] deadline,</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2246</span>:                        float s = 1,</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)1.0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2246, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2247</span>:                        float delta_t = 0.001,</pre>
<pre class='cython code score-5 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(((double)0.001));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2247, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2248</span>:                        float max_t = 20,</pre>
<pre class='cython code score-5 '>  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)20.0));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2248, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2249</span>:                        int n_samples = 20000,</pre>
<pre class='cython code score-2 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)0x4E20));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2249, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2250</span>:                        int n_trials = 1,</pre>
<pre class='cython code score-2 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)1));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2250, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
</pre><pre class="cython line score-0">&#xA0;<span class="">2251</span>:                        print_info = True,</pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2252</span>:                        boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)</pre>
<pre class='cython code score-6 '>    values[15] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[16] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_True)));
    values[17] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(__pyx_dynamic_args-&gt;__pyx_arg_boundary_params);
</pre><pre class="cython line score-0">&#xA0;<span class="">2253</span>:                        boundary_multiplicative = True,</pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2254</span>:                        boundary_params = {},</pre>
<pre class='cython code score-12 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2254, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults9, __pyx_t_5)-&gt;__pyx_arg_boundary_params = __pyx_t_4;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_4 = 0;
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsGetter</span>(__pyx_t_5, __pyx_pf_4cssm_64__defaults__);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_ddm_flexbound_par2, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-368" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2255</span>:                        random_state = None,</pre>
<pre class='cython code score-368 '>    values[18] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[19] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_full)));
    values[20] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case 21: values[20] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 20);
        CYTHON_FALLTHROUGH;
        case 20: values[19] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 19);
        CYTHON_FALLTHROUGH;
        case 19: values[18] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 18);
        CYTHON_FALLTHROUGH;
        case 18: values[17] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 17);
        CYTHON_FALLTHROUGH;
        case 17: values[16] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 16);
        CYTHON_FALLTHROUGH;
        case 16: values[15] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 15);
        CYTHON_FALLTHROUGH;
        case 15: values[14] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_vh)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_vl1)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_par2", 0, 9, 21, 1); <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_vl2)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_par2", 0, 9, 21, 2); <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_a)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[3]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_par2", 0, 9, 21, 3); <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_zh)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[4]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_par2", 0, 9, 21, 4); <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_zl1)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[5]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_par2", 0, 9, 21, 5); <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_zl2)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[6]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_par2", 0, 9, 21, 6); <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (likely((values[7] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_t)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[7]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_par2", 0, 9, 21, 7); <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (likely((values[8] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_deadline)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[8]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_par2", 0, 9, 21, 8); <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  9:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_s);
          if (value) { values[9] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 10:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_delta_t);
          if (value) { values[10] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 11:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_max_t);
          if (value) { values[11] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 12:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_samples);
          if (value) { values[12] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 13:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_trials);
          if (value) { values[13] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 14:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_print_info);
          if (value) { values[14] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 15:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_fun);
          if (value) { values[15] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 16:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_multiplicative);
          if (value) { values[16] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 17:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_params);
          if (value) { values[17] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 18:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_random_state);
          if (value) { values[18] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 19:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_return_option);
          if (value) { values[19] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 20:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_smooth);
          if (value) { values[20] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values + 0, kwd_pos_args, "ddm_flexbound_par2") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case 21: values[20] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 20);
        CYTHON_FALLTHROUGH;
        case 20: values[19] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 19);
        CYTHON_FALLTHROUGH;
        case 19: values[18] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 18);
        CYTHON_FALLTHROUGH;
        case 18: values[17] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 17);
        CYTHON_FALLTHROUGH;
        case 17: values[16] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 16);
        CYTHON_FALLTHROUGH;
        case 16: values[15] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 15);
        CYTHON_FALLTHROUGH;
        case 15: values[14] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_vh = ((PyArrayObject *)values[0]);
    __pyx_v_vl1 = ((PyArrayObject *)values[1]);
    __pyx_v_vl2 = ((PyArrayObject *)values[2]);
    __pyx_v_a = ((PyArrayObject *)values[3]);
    __pyx_v_zh = ((PyArrayObject *)values[4]);
    __pyx_v_zl1 = ((PyArrayObject *)values[5]);
    __pyx_v_zl2 = ((PyArrayObject *)values[6]);
    __pyx_v_t = ((PyArrayObject *)values[7]);
    __pyx_v_deadline = ((PyArrayObject *)values[8]);
    if (values[9]) {
      __pyx_v_s = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[9]); if (unlikely((__pyx_v_s == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2246, __pyx_L3_error)</span>
    } else {
      __pyx_v_s = ((float)((float)1.0));
    }
    if (values[10]) {
      __pyx_v_delta_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[10]); if (unlikely((__pyx_v_delta_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2247, __pyx_L3_error)</span>
    } else {
      __pyx_v_delta_t = ((float)((double)0.001));
    }
    if (values[11]) {
      __pyx_v_max_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[11]); if (unlikely((__pyx_v_max_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2248, __pyx_L3_error)</span>
    } else {
      __pyx_v_max_t = ((float)((float)20.0));
    }
    if (values[12]) {
      __pyx_v_n_samples = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[12]); if (unlikely((__pyx_v_n_samples == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2249, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_samples = ((int)((int)0x4E20));
    }
    if (values[13]) {
      __pyx_v_n_trials = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[13]); if (unlikely((__pyx_v_n_trials == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2250, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_trials = ((int)((int)1));
    }
    __pyx_v_print_info = values[14];
    __pyx_v_boundary_fun = values[15];
    __pyx_v_boundary_multiplicative = values[16];
    __pyx_v_boundary_params = values[17];
    __pyx_v_random_state = values[18];
    __pyx_v_return_option = values[19];
    __pyx_v_smooth = values[20];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_par2", 0, 9, 21, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.ddm_flexbound_par2", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_vh), __pyx_ptype_5numpy_ndarray, 1, "vh", 0))) <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_vl1), __pyx_ptype_5numpy_ndarray, 1, "vl1", 0))) <span class='error_goto'>__PYX_ERR(0, 2238, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_vl2), __pyx_ptype_5numpy_ndarray, 1, "vl2", 0))) <span class='error_goto'>__PYX_ERR(0, 2239, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) <span class='error_goto'>__PYX_ERR(0, 2240, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_zh), __pyx_ptype_5numpy_ndarray, 1, "zh", 0))) <span class='error_goto'>__PYX_ERR(0, 2241, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_zl1), __pyx_ptype_5numpy_ndarray, 1, "zl1", 0))) <span class='error_goto'>__PYX_ERR(0, 2242, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_zl2), __pyx_ptype_5numpy_ndarray, 1, "zl2", 0))) <span class='error_goto'>__PYX_ERR(0, 2243, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) <span class='error_goto'>__PYX_ERR(0, 2244, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_deadline), __pyx_ptype_5numpy_ndarray, 1, "deadline", 0))) <span class='error_goto'>__PYX_ERR(0, 2245, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_4cssm_26ddm_flexbound_par2(__pyx_self, __pyx_v_vh, __pyx_v_vl1, __pyx_v_vl2, __pyx_v_a, __pyx_v_zh, __pyx_v_zl1, __pyx_v_zl2, __pyx_v_t, __pyx_v_deadline, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_print_info, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state, __pyx_v_return_option, __pyx_v_smooth, __pyx_v_kwargs);
</pre><pre class="cython line score-0">&#xA0;<span class="">2256</span>:                        return_option = 'full',</pre>
<pre class="cython line score-0">&#xA0;<span class="">2257</span>:                        smooth = False,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2258</span>:                        **kwargs):</pre>
<pre class="cython line score-0">&#xA0;<span class="">2259</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2260</span>:     set_seed(random_state)</pre>
<pre class='cython code score-1 '>  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2260, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2261</span>:     # Param views</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2262</span>:     cdef float[:] vh_view = vh</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_vh), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2262, __pyx_L1_error)</span>
  __pyx_v_vh_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2263</span>:     cdef float[:] vl1_view = vl1</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_vl1), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2263, __pyx_L1_error)</span>
  __pyx_v_vl1_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2264</span>:     cdef float[:] vl2_view = vl2</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_vl2), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2264, __pyx_L1_error)</span>
  __pyx_v_vl2_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2265</span>:     cdef float[:] a_view = a</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_a), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2265, __pyx_L1_error)</span>
  __pyx_v_a_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2266</span>:     cdef float[:] zh_view = zh</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_zh), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2266, __pyx_L1_error)</span>
  __pyx_v_zh_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2267</span>:     cdef float[:] zl1_view = zl1</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_zl1), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2267, __pyx_L1_error)</span>
  __pyx_v_zl1_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2268</span>:     cdef float[:] zl2_view = zl2</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_zl2), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2268, __pyx_L1_error)</span>
  __pyx_v_zl2_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2269</span>:     cdef float[:] t_view = t</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_t), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2269, __pyx_L1_error)</span>
  __pyx_v_t_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2270</span>:     cdef float[:] deadline_view = deadline</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_deadline), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2270, __pyx_L1_error)</span>
  __pyx_v_deadline_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">2271</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2272</span>:     # TD: Add trajectory --&gt; Tricky here because the simulator is optimized to include only two instead of three particles (high dimension choice determines which low dimension choice will matter for ultimate choice)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2273</span>:     # TD: Add Trajectory</pre>
<pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2274</span>:     traj = np.zeros((int(max_t / delta_t) + 1, 3), dtype = DTYPE)</pre>
<pre class='cython code score-42 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2274, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2274, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_FromDouble</span>((__pyx_v_max_t / __pyx_v_delta_t));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2274, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_1, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2274, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2274, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2274, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_3)) <span class='error_goto'>__PYX_ERR(0, 2274, __pyx_L1_error)</span>;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2274, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2274, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2274, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2274, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2274, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2274, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_traj = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2275</span>:     traj[:, :] = -999</pre>
<pre class='cython code score-5 '>  if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_traj, __pyx_tuple__12, __pyx_int_neg_999) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2275, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2276</span>:     cdef float[:, :] traj_view = traj</pre>
<pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(__pyx_v_traj, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 2276, __pyx_L1_error)</span>
  __pyx_v_traj_view = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">2277</span>: </pre>
<pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2278</span>:     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)</pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2278, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2278, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2278, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2278, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2278, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 2278, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2278, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 2278, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2278, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 2278, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2278, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2278, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2278, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2278, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_rts = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2279</span>:     rts_high = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)</pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2279, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2279, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2279, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2279, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2279, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 2279, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2279, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 2279, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2279, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2279, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2279, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2279, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2279, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2279, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_rts_high = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2280</span>:     rts_low = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)</pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2280, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2280, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2280, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2280, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2280, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 2280, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2280, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 2280, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2280, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 2280, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2280, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2280, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2280, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2280, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_rts_low = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2281</span>:     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)</pre>
<pre class='cython code score-46 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2281, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2281, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2281, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2281, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2281, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 2281, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2281, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 2281, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2281, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2281, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2281, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2281, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_intc);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2281, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2281, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2281, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_choices = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2282</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2283</span>:     cdef float[:, :, :] rts_view = rts</pre>
<pre class='cython code score-2 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_rts, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 2283, __pyx_L1_error)</span>
  __pyx_v_rts_view = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2284</span>:     cdef float[:, :, :] rts_high_view = rts_high</pre>
<pre class='cython code score-2 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_rts_high, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 2284, __pyx_L1_error)</span>
  __pyx_v_rts_high_view = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2285</span>:     cdef float[:, :, :] rts_low_view = rts_low</pre>
<pre class='cython code score-2 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_rts_low, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 2285, __pyx_L1_error)</span>
  __pyx_v_rts_low_view = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2286</span>:     cdef int[:, :, :] choices_view = choices</pre>
<pre class='cython code score-2 '>  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_int</span>(__pyx_v_choices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 2286, __pyx_L1_error)</span>
  __pyx_v_choices_view = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">2287</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2288</span>:     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion</pre>
<pre class='cython code score-0 '>  __pyx_v_delta_t_sqrt = sqrt(__pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2289</span>:     cdef float sqrt_st = delta_t_sqrt * s # scalar to ensure the correct variance for the gaussian step</pre>
<pre class='cython code score-0 '>  __pyx_v_sqrt_st = (__pyx_v_delta_t_sqrt * __pyx_v_s);
</pre><pre class="cython line score-0">&#xA0;<span class="">2290</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2291</span>:     # Boundary storage for the upper bound</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2292</span>:     cdef int num_draws = int((max_t / delta_t) + 1)</pre>
<pre class='cython code score-0 '>  __pyx_v_num_draws = ((int)((__pyx_v_max_t / __pyx_v_delta_t) + 1.0));
</pre><pre class="cython line score-0">&#xA0;<span class="">2293</span>: </pre>
<pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2294</span>:     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)</pre>
<pre class='cython code score-51 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2294, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2294, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_max_t + __pyx_v_delta_t));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2294, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_t);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2294, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_10 = NULL;
  __pyx_t_11 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_10)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_11 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[4] = {__pyx_t_10, __pyx_int_0, __pyx_t_4, __pyx_t_5};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_11, 3+__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2294, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2294, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2294, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = NULL;
  __pyx_t_11 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_11 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_1};
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_11, 1+__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 2294, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_v_t_s = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2295</span>:     boundary = np.zeros(t_s.shape, dtype = DTYPE)</pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2295, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2295, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_t_s, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2295, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2295, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 2295, __pyx_L1_error)</span>;
  __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2295, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2295, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2295, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2295, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_v_boundary = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2296</span>:     cdef float[:] boundary_view = boundary</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(__pyx_v_boundary, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2296, __pyx_L1_error)</span>
  __pyx_v_boundary_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">2297</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2298</span>:     cdef float y_h, y_l, y_l1, y_l2, v_l, v_l1, v_l2, t_h, t_l, t_l1, t_l2, smooth_u, deadline_tmp</pre>
<pre class="cython line score-0">&#xA0;<span class="">2299</span>:     cdef Py_ssize_t n, ix, ix1, ix2, k</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2300</span>:     cdef Py_ssize_t m = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_m = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2301</span>:     cdef float[:] gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2301, __pyx_L1_error)</span>
  __pyx_v_gaussian_values = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">2302</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2303</span>:     for k in range(n_trials):</pre>
<pre class='cython code score-0 '>  __pyx_t_11 = __pyx_v_n_trials;
  __pyx_t_12 = __pyx_t_11;
  for (__pyx_t_13 = 0; __pyx_t_13 &lt; __pyx_t_12; __pyx_t_13+=1) {
    __pyx_v_k = __pyx_t_13;
</pre><pre class="cython line score-0">&#xA0;<span class="">2304</span>:         # Precompute boundary evaluations</pre>
<pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2305</span>:         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}</pre>
<pre class='cython code score-27 '>    { /* enter inner scope */
      __pyx_t_5 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2305, __pyx_L7_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_14 = 0;
      if (unlikely(__pyx_v_boundary_params == Py_None)) {
        <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "keys");
        <span class='error_goto'>__PYX_ERR(0, 2305, __pyx_L7_error)</span>
      }
      __pyx_t_1 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&amp;__pyx_t_15), (&amp;__pyx_t_16));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2305, __pyx_L7_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
      __pyx_t_7 = __pyx_t_1;
      __pyx_t_1 = 0;
      while (1) {
        __pyx_t_17 = __Pyx_dict_iter_next(__pyx_t_7, __pyx_t_15, &amp;__pyx_t_14, &amp;__pyx_t_1, NULL, NULL, __pyx_t_16);
        if (unlikely(__pyx_t_17 == 0)) break;
        if (unlikely(__pyx_t_17 == -1)) <span class='error_goto'>__PYX_ERR(0, 2305, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_9genexpr10__pyx_v_key, __pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_boundary_params, __pyx_9genexpr10__pyx_v_key);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2305, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2305, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, (PyObject*)__pyx_9genexpr10__pyx_v_key, (PyObject*)__pyx_t_3))) <span class='error_goto'>__PYX_ERR(0, 2305, __pyx_L7_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_9genexpr10__pyx_v_key); __pyx_9genexpr10__pyx_v_key = 0;
      goto __pyx_L10_exit_scope;
      __pyx_L7_error:;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_9genexpr10__pyx_v_key); __pyx_9genexpr10__pyx_v_key = 0;
      goto __pyx_L1_error;
      __pyx_L10_exit_scope:;
    } /* exit inner scope */
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_boundary_params_tmp, ((PyObject*)__pyx_t_5));
    __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2306</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2307</span>:         # Precompute boundary evaluations</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2308</span>:         if boundary_multiplicative:</pre>
<pre class='cython code score-2 '>    __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_boundary_multiplicative); if (unlikely((__pyx_t_18 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2308, __pyx_L1_error)</span>
    if (__pyx_t_18) {
/* … */
      goto __pyx_L11;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">2309</span>:             # print(a)</pre>
<pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2310</span>:             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)</pre>
<pre class='cython code score-61 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2310, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_multiply);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2310, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_19 * __pyx_v_a_view.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2310, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2310, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_t, __pyx_v_t_s) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2310, __pyx_L1_error)</span>
      __pyx_t_4 = __pyx_t_10;
      __pyx_t_10 = 0;
      if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_4, __pyx_v_boundary_params_tmp) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2310, __pyx_L1_error)</span>
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2310, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_4, __pyx_t_3, __pyx_t_10};
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_16, 2+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 2310, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2310, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2310, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_10 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_10)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_10, __pyx_t_7};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_16, 1+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 2310, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_boundary, __pyx_t_5, 0, 0, NULL, NULL, &amp;__pyx_slice__5, 0, 0, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2310, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2311</span>:         else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2312</span>:             # print(a)</pre>
<pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2313</span>:             boundary[:] = np.add(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)</pre>
<pre class='cython code score-61 '>    /*else*/ {
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2313, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_add);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2313, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_19 * __pyx_v_a_view.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2313, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2313, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_t, __pyx_v_t_s) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2313, __pyx_L1_error)</span>
      __pyx_t_3 = __pyx_t_4;
      __pyx_t_4 = 0;
      if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_3, __pyx_v_boundary_params_tmp) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2313, __pyx_L1_error)</span>
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2313, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
        __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
        if (likely(__pyx_t_3)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_t_7, __pyx_t_4};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_16, 2+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2313, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      }
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2313, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2313, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_4 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_1};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_16, 1+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 2313, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      }
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_boundary, __pyx_t_5, 0, 0, NULL, NULL, &amp;__pyx_slice__5, 0, 0, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2313, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
    __pyx_L11:;
</pre><pre class="cython line score-0">&#xA0;<span class="">2314</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2315</span>:         deadline_tmp = min(max_t, deadline_view[k] - t_view[k])</pre>
<pre class='cython code score-0 '>    __pyx_t_19 = __pyx_v_k;
    __pyx_t_20 = __pyx_v_k;
    __pyx_t_21 = ((*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_19 * __pyx_v_deadline_view.strides[0]) ))) - (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_20 * __pyx_v_t_view.strides[0]) ))));
    __pyx_t_22 = __pyx_v_max_t;
    __pyx_t_18 = (__pyx_t_21 &lt; __pyx_t_22);
    if (__pyx_t_18) {
      __pyx_t_23 = __pyx_t_21;
    } else {
      __pyx_t_23 = __pyx_t_22;
    }
    __pyx_v_deadline_tmp = __pyx_t_23;
</pre><pre class="cython line score-0">&#xA0;<span class="">2316</span>:         # Loop over samples</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2317</span>:         for n in range(n_samples):</pre>
<pre class='cython code score-0 '>    __pyx_t_16 = __pyx_v_n_samples;
    __pyx_t_17 = __pyx_t_16;
    for (__pyx_t_15 = 0; __pyx_t_15 &lt; __pyx_t_17; __pyx_t_15+=1) {
      __pyx_v_n = __pyx_t_15;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2318</span>:             t_h = 0.0 # reset time high dimension</pre>
<pre class='cython code score-0 '>      __pyx_v_t_h = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2319</span>:             t_l1 = 0.0 # reset time low dimension (1)</pre>
<pre class='cython code score-0 '>      __pyx_v_t_l1 = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2320</span>:             t_l2 = 0.0 # reset time low dimension (2)</pre>
<pre class='cython code score-0 '>      __pyx_v_t_l2 = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2321</span>:             t_l = 0.0 # reset time low dimension (1 or 2)</pre>
<pre class='cython code score-0 '>      __pyx_v_t_l = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2322</span>:             ix = 0 # reset boundary index</pre>
<pre class='cython code score-0 '>      __pyx_v_ix = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2323</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2324</span>:             # Initialize walkers</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2325</span>:             y_h = (-1) * boundary_view[0] + (zh_view[k] * 2 * (boundary_view[0]))</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = 0;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_24 = 0;
      __pyx_v_y_h = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_zh_view.data + __pyx_t_19 * __pyx_v_zh_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_24 * __pyx_v_boundary_view.strides[0]) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">2326</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2327</span>:             if n == 0:</pre>
<pre class='cython code score-0 '>      __pyx_t_18 = (__pyx_v_n == 0);
      if (__pyx_t_18) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2328</span>:                 if k == 0:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (__pyx_v_k == 0);
        if (__pyx_t_18) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2329</span>:                     traj_view[0, 0] = y_h</pre>
<pre class='cython code score-0 '>          __pyx_t_24 = 0;
          __pyx_t_19 = 0;
          *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_24 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_19 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y_h;
</pre><pre class="cython line score-0">&#xA0;<span class="">2330</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2331</span>:             # Random walks until y_h hits bound</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2332</span>:             while (y_h &gt;= (-1) * boundary_view[ix]) and (y_h &lt;= boundary_view[ix]) and (t_h &lt;= deadline_tmp):</pre>
<pre class='cython code score-0 '>      while (1) {
        __pyx_t_19 = __pyx_v_ix;
        __pyx_t_25 = (__pyx_v_y_h &gt;= (-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))));
        if (__pyx_t_25) {
        } else {
          __pyx_t_18 = __pyx_t_25;
          goto __pyx_L18_bool_binop_done;
        }
        __pyx_t_19 = __pyx_v_ix;
        __pyx_t_25 = (__pyx_v_y_h &lt;= (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) ))));
        if (__pyx_t_25) {
        } else {
          __pyx_t_18 = __pyx_t_25;
          goto __pyx_L18_bool_binop_done;
        }
        __pyx_t_25 = (__pyx_v_t_h &lt;= __pyx_v_deadline_tmp);
        __pyx_t_18 = __pyx_t_25;
        __pyx_L18_bool_binop_done:;
        if (!__pyx_t_18) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2333</span>:                 y_h += (vh_view[k] * delta_t) + (sqrt_st * gaussian_values[m])</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = __pyx_v_k;
        __pyx_t_24 = __pyx_v_m;
        __pyx_v_y_h = (__pyx_v_y_h + (((*((float *) ( /* dim=0 */ (__pyx_v_vh_view.data + __pyx_t_19 * __pyx_v_vh_view.strides[0]) ))) * __pyx_v_delta_t) + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_24 * __pyx_v_gaussian_values.strides[0]) ))))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2334</span>:                 t_h += delta_t</pre>
<pre class='cython code score-0 '>        __pyx_v_t_h = (__pyx_v_t_h + __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2335</span>:                 ix += 1</pre>
<pre class='cython code score-0 '>        __pyx_v_ix = (__pyx_v_ix + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2336</span>:                 m += 1</pre>
<pre class='cython code score-0 '>        __pyx_v_m = (__pyx_v_m + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2337</span>:                 if m == num_draws:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (__pyx_v_m == __pyx_v_num_draws);
        if (__pyx_t_18) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2338</span>:                     gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2338, __pyx_L1_error)</span>
          __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
          __pyx_v_gaussian_values = __pyx_t_2;
          __pyx_t_2.memview = NULL;
          __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2339</span>:                     m = 0</pre>
<pre class='cython code score-0 '>          __pyx_v_m = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2340</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2341</span>:                 if n == 0:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (__pyx_v_n == 0);
        if (__pyx_t_18) {
/* … */
        }
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2342</span>:                     if k == 0:</pre>
<pre class='cython code score-0 '>          __pyx_t_18 = (__pyx_v_k == 0);
          if (__pyx_t_18) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2343</span>:                         traj_view[ix, 0] = y_h</pre>
<pre class='cython code score-0 '>            __pyx_t_24 = __pyx_v_ix;
            __pyx_t_19 = 0;
            *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_24 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_19 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y_h;
</pre><pre class="cython line score-0">&#xA0;<span class="">2344</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2345</span>:             # The probability of making a 'mistake' 1 - (relative y position)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2346</span>:             # y at upper bound --&gt; choices_view[n, k, 0] add 2 deterministically (correct)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2347</span>:             # y at lower bound --&gt; choice_view[n, k, 0] stay the same deterministically (mistake)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2348</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2349</span>:             # if boundary is negative (or 0) already, we flip a coin</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2350</span>:             if boundary_view[ix] &lt;= 0:</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = __pyx_v_ix;
      __pyx_t_18 = ((*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) ))) &lt;= 0.0);
      if (__pyx_t_18) {
/* … */
        goto __pyx_L24;
      }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2351</span>:                 if random_uniform() &lt;= 0.5:</pre>
<pre class='cython code score-5 '>        __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2351, __pyx_L1_error)</span>
        __pyx_t_18 = (__pyx_t_23 &lt;= 0.5);
        if (__pyx_t_18) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2352</span>:                     choices_view[n, k, 0] += 2</pre>
<pre class='cython code score-0 '>          __pyx_t_19 = __pyx_v_n;
          __pyx_t_24 = __pyx_v_k;
          __pyx_t_20 = 0;
          *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_19 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[2]) )) += 2;
</pre><pre class="cython line score-0">&#xA0;<span class="">2353</span>:             # Otherwise apply rule from above</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2354</span>:             elif random_uniform() &lt;= ((y_h + boundary_view[ix]) / (2 * boundary_view[ix])):</pre>
<pre class='cython code score-5 '>      __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2354, __pyx_L1_error)</span>
      __pyx_t_20 = __pyx_v_ix;
      __pyx_t_24 = __pyx_v_ix;
      __pyx_t_18 = (__pyx_t_23 &lt;= ((__pyx_v_y_h + (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))) / (2.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_24 * __pyx_v_boundary_view.strides[0]) ))))));
      if (__pyx_t_18) {
/* … */
      }
      __pyx_L24:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2355</span>:                 choices_view[n, k, 0] += 2</pre>
<pre class='cython code score-0 '>        __pyx_t_24 = __pyx_v_n;
        __pyx_t_20 = __pyx_v_k;
        __pyx_t_19 = 0;
        *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_24 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[2]) )) += 2;
</pre><pre class="cython line score-0">&#xA0;<span class="">2356</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2357</span>:             # Initialize lower level walkers</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2358</span>:             y_l1 = (-1) * boundary_view[0] + (zl1_view[k] * 2 * (boundary_view[0]))</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = 0;
      __pyx_t_20 = __pyx_v_k;
      __pyx_t_24 = 0;
      __pyx_v_y_l1 = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_zl1_view.data + __pyx_t_20 * __pyx_v_zl1_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_24 * __pyx_v_boundary_view.strides[0]) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2359</span>:             y_l2 = (-1) * boundary_view[0] + (zl2_view[k] * 2 * (boundary_view[0]))</pre>
<pre class='cython code score-0 '>      __pyx_t_24 = 0;
      __pyx_t_20 = __pyx_v_k;
      __pyx_t_19 = 0;
      __pyx_v_y_l2 = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_24 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_zl2_view.data + __pyx_t_20 * __pyx_v_zl2_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">2360</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2361</span>:             # Random walker lower level (1)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2362</span>:             if (choices_view[n, k, 0] == 0) | ((n == 0) &amp; (k == 0)):</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = __pyx_v_n;
      __pyx_t_20 = __pyx_v_k;
      __pyx_t_24 = 0;
      __pyx_t_18 = (((*((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_19 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[2]) ))) == 0) | ((__pyx_v_n == 0) &amp; (__pyx_v_k == 0)));
      if (__pyx_t_18) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2363</span>:                 ix1 = 0</pre>
<pre class='cython code score-0 '>        __pyx_v_ix1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2364</span>:                 while (y_l1 &gt;= (-1) * boundary_view[ix1]) and (y_l1 &lt;= boundary_view[ix1]) and (t_l1 &lt;= deadline_tmp):</pre>
<pre class='cython code score-0 '>        while (1) {
          __pyx_t_24 = __pyx_v_ix1;
          __pyx_t_25 = (__pyx_v_y_l1 &gt;= (-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_24 * __pyx_v_boundary_view.strides[0]) )))));
          if (__pyx_t_25) {
          } else {
            __pyx_t_18 = __pyx_t_25;
            goto __pyx_L29_bool_binop_done;
          }
          __pyx_t_24 = __pyx_v_ix1;
          __pyx_t_25 = (__pyx_v_y_l1 &lt;= (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_24 * __pyx_v_boundary_view.strides[0]) ))));
          if (__pyx_t_25) {
          } else {
            __pyx_t_18 = __pyx_t_25;
            goto __pyx_L29_bool_binop_done;
          }
          __pyx_t_25 = (__pyx_v_t_l1 &lt;= __pyx_v_deadline_tmp);
          __pyx_t_18 = __pyx_t_25;
          __pyx_L29_bool_binop_done:;
          if (!__pyx_t_18) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2365</span>:                     y_l1 += (vl1_view[k] * delta_t) + (sqrt_st * gaussian_values[m])</pre>
<pre class='cython code score-0 '>          __pyx_t_24 = __pyx_v_k;
          __pyx_t_20 = __pyx_v_m;
          __pyx_v_y_l1 = (__pyx_v_y_l1 + (((*((float *) ( /* dim=0 */ (__pyx_v_vl1_view.data + __pyx_t_24 * __pyx_v_vl1_view.strides[0]) ))) * __pyx_v_delta_t) + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_20 * __pyx_v_gaussian_values.strides[0]) ))))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2366</span>:                     t_l1 += delta_t</pre>
<pre class='cython code score-0 '>          __pyx_v_t_l1 = (__pyx_v_t_l1 + __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2367</span>:                     ix1 += 1</pre>
<pre class='cython code score-0 '>          __pyx_v_ix1 = (__pyx_v_ix1 + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2368</span>:                     m += 1</pre>
<pre class='cython code score-0 '>          __pyx_v_m = (__pyx_v_m + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2369</span>:                     if m == num_draws:</pre>
<pre class='cython code score-0 '>          __pyx_t_18 = (__pyx_v_m == __pyx_v_num_draws);
          if (__pyx_t_18) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2370</span>:                         gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>            __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2370, __pyx_L1_error)</span>
            __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
            __pyx_v_gaussian_values = __pyx_t_2;
            __pyx_t_2.memview = NULL;
            __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2371</span>:                         m = 0</pre>
<pre class='cython code score-0 '>            __pyx_v_m = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2372</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2373</span>:                     if n == 0:</pre>
<pre class='cython code score-0 '>          __pyx_t_18 = (__pyx_v_n == 0);
          if (__pyx_t_18) {
/* … */
          }
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2374</span>:                         if k == 0:</pre>
<pre class='cython code score-0 '>            __pyx_t_18 = (__pyx_v_k == 0);
            if (__pyx_t_18) {
/* … */
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2375</span>:                             traj_view[ix1, 1] = y_l1</pre>
<pre class='cython code score-0 '>              __pyx_t_20 = __pyx_v_ix1;
              __pyx_t_24 = 1;
              *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_20 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_24 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y_l1;
</pre><pre class="cython line score-0">&#xA0;<span class="">2376</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2377</span>:             # Random walker lower level (2)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2378</span>:             if (choices_view[n, k, 0] == 2) | ((n == 0) &amp; (k == 0)):</pre>
<pre class='cython code score-0 '>      __pyx_t_24 = __pyx_v_n;
      __pyx_t_20 = __pyx_v_k;
      __pyx_t_19 = 0;
      __pyx_t_18 = (((*((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_24 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[2]) ))) == 2) | ((__pyx_v_n == 0) &amp; (__pyx_v_k == 0)));
      if (__pyx_t_18) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2379</span>:                 ix2 = 0</pre>
<pre class='cython code score-0 '>        __pyx_v_ix2 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2380</span>:                 while (y_l2 &gt;= (-1) * boundary_view[ix2]) and (y_l2 &lt;= boundary_view[ix2]) and (t_l2 &lt;= deadline_tmp):</pre>
<pre class='cython code score-0 '>        while (1) {
          __pyx_t_19 = __pyx_v_ix2;
          __pyx_t_25 = (__pyx_v_y_l2 &gt;= (-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))));
          if (__pyx_t_25) {
          } else {
            __pyx_t_18 = __pyx_t_25;
            goto __pyx_L38_bool_binop_done;
          }
          __pyx_t_19 = __pyx_v_ix2;
          __pyx_t_25 = (__pyx_v_y_l2 &lt;= (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) ))));
          if (__pyx_t_25) {
          } else {
            __pyx_t_18 = __pyx_t_25;
            goto __pyx_L38_bool_binop_done;
          }
          __pyx_t_25 = (__pyx_v_t_l2 &lt;= __pyx_v_deadline_tmp);
          __pyx_t_18 = __pyx_t_25;
          __pyx_L38_bool_binop_done:;
          if (!__pyx_t_18) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2381</span>:                     y_l2 += (vl2_view[k] * delta_t) + (sqrt_st * gaussian_values[m])</pre>
<pre class='cython code score-0 '>          __pyx_t_19 = __pyx_v_k;
          __pyx_t_20 = __pyx_v_m;
          __pyx_v_y_l2 = (__pyx_v_y_l2 + (((*((float *) ( /* dim=0 */ (__pyx_v_vl2_view.data + __pyx_t_19 * __pyx_v_vl2_view.strides[0]) ))) * __pyx_v_delta_t) + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_20 * __pyx_v_gaussian_values.strides[0]) ))))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2382</span>:                     t_l2 += delta_t</pre>
<pre class='cython code score-0 '>          __pyx_v_t_l2 = (__pyx_v_t_l2 + __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2383</span>:                     ix2 += 1</pre>
<pre class='cython code score-0 '>          __pyx_v_ix2 = (__pyx_v_ix2 + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2384</span>:                     m += 1</pre>
<pre class='cython code score-0 '>          __pyx_v_m = (__pyx_v_m + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2385</span>:                     if m == num_draws:</pre>
<pre class='cython code score-0 '>          __pyx_t_18 = (__pyx_v_m == __pyx_v_num_draws);
          if (__pyx_t_18) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2386</span>:                         gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>            __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2386, __pyx_L1_error)</span>
            __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
            __pyx_v_gaussian_values = __pyx_t_2;
            __pyx_t_2.memview = NULL;
            __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2387</span>:                         m = 0</pre>
<pre class='cython code score-0 '>            __pyx_v_m = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2388</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2389</span>:                     if n == 0:</pre>
<pre class='cython code score-0 '>          __pyx_t_18 = (__pyx_v_n == 0);
          if (__pyx_t_18) {
/* … */
          }
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2390</span>:                         if k == 0:</pre>
<pre class='cython code score-0 '>            __pyx_t_18 = (__pyx_v_k == 0);
            if (__pyx_t_18) {
/* … */
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2391</span>:                             traj_view[ix2, 2] = y_l2</pre>
<pre class='cython code score-0 '>              __pyx_t_20 = __pyx_v_ix2;
              __pyx_t_19 = 2;
              *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_20 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_19 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y_l2;
</pre><pre class="cython line score-0">&#xA0;<span class="">2392</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2393</span>:             # Consider only relevant lower-dim walker for final rt</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2394</span>:             if (choices_view[n, k, 0] == 0):</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = __pyx_v_n;
      __pyx_t_20 = __pyx_v_k;
      __pyx_t_24 = 0;
      __pyx_t_18 = ((*((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_19 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[2]) ))) == 0);
      if (__pyx_t_18) {
/* … */
        goto __pyx_L44;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2395</span>:                 t_l = t_l1</pre>
<pre class='cython code score-0 '>        __pyx_v_t_l = __pyx_v_t_l1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2396</span>:                 y_l = y_l1</pre>
<pre class='cython code score-0 '>        __pyx_v_y_l = __pyx_v_y_l1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2397</span>:                 ix = ix1</pre>
<pre class='cython code score-0 '>        __pyx_v_ix = __pyx_v_ix1;
</pre><pre class="cython line score-0">&#xA0;<span class="">2398</span>:             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2399</span>:                 t_l = t_l2</pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_v_t_l = __pyx_v_t_l2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2400</span>:                 y_l = y_l2</pre>
<pre class='cython code score-0 '>        __pyx_v_y_l = __pyx_v_y_l2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2401</span>:                 ix = ix2</pre>
<pre class='cython code score-0 '>        __pyx_v_ix = __pyx_v_ix2;
      }
      __pyx_L44:;
</pre><pre class="cython line score-0">&#xA0;<span class="">2402</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2403</span>:             if smooth:</pre>
<pre class='cython code score-2 '>      __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_smooth); if (unlikely((__pyx_t_18 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2403, __pyx_L1_error)</span>
      if (__pyx_t_18) {
/* … */
        goto __pyx_L45;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2404</span>:                 if t_h == 0.0:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (__pyx_v_t_h == 0.0);
        if (__pyx_t_18) {
/* … */
          goto __pyx_L46;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2405</span>:                     smooth_u = random_uniform() * 0.5 * delta_t</pre>
<pre class='cython code score-5 '>          __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2405, __pyx_L1_error)</span>
          __pyx_v_smooth_u = ((__pyx_t_23 * 0.5) * __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2406</span>:                 elif fmax(t_h, t_l) &lt; deadline_tmp:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (fmax(__pyx_v_t_h, __pyx_v_t_l) &lt; __pyx_v_deadline_tmp);
        if (__pyx_t_18) {
/* … */
          goto __pyx_L46;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2407</span>:                     smooth_u = (0.5 - random_uniform()) * delta_t</pre>
<pre class='cython code score-5 '>          __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2407, __pyx_L1_error)</span>
          __pyx_v_smooth_u = ((0.5 - __pyx_t_23) * __pyx_v_delta_t);
</pre><pre class="cython line score-0">&#xA0;<span class="">2408</span>:                 else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2409</span>:                     smooth_u = 0.0</pre>
<pre class='cython code score-0 '>        /*else*/ {
          __pyx_v_smooth_u = 0.0;
        }
        __pyx_L46:;
</pre><pre class="cython line score-0">&#xA0;<span class="">2410</span>:             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2411</span>:                 smooth_u = 0.0</pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_v_smooth_u = 0.0;
      }
      __pyx_L45:;
</pre><pre class="cython line score-0">&#xA0;<span class="">2412</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2413</span>:             rts_view[n, k, 0] = fmax(t_h, t_l) + t_view[k] + smooth_u</pre>
<pre class='cython code score-0 '>      __pyx_t_24 = __pyx_v_k;
      __pyx_t_20 = __pyx_v_n;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_26 = 0;
      *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_20 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_19 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_26 * __pyx_v_rts_view.strides[2]) )) = ((fmax(__pyx_v_t_h, __pyx_v_t_l) + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_24 * __pyx_v_t_view.strides[0]) )))) + __pyx_v_smooth_u);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2414</span>:             rts_high_view[n, k, 0] = t_h + t_view[k]</pre>
<pre class='cython code score-0 '>      __pyx_t_24 = __pyx_v_k;
      __pyx_t_26 = __pyx_v_n;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_20 = 0;
      *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_high_view.data + __pyx_t_26 * __pyx_v_rts_high_view.strides[0]) ) + __pyx_t_19 * __pyx_v_rts_high_view.strides[1]) ) + __pyx_t_20 * __pyx_v_rts_high_view.strides[2]) )) = (__pyx_v_t_h + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_24 * __pyx_v_t_view.strides[0]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2415</span>:             rts_low_view[n, k, 0] = t_l + t_view[k]</pre>
<pre class='cython code score-0 '>      __pyx_t_24 = __pyx_v_k;
      __pyx_t_20 = __pyx_v_n;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_26 = 0;
      *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_low_view.data + __pyx_t_20 * __pyx_v_rts_low_view.strides[0]) ) + __pyx_t_19 * __pyx_v_rts_low_view.strides[1]) ) + __pyx_t_26 * __pyx_v_rts_low_view.strides[2]) )) = (__pyx_v_t_l + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_24 * __pyx_v_t_view.strides[0]) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">2416</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2417</span>:             # The probability of making a 'mistake' 1 - (relative y position)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2418</span>:             # y at upper bound --&gt; choices_view[n, k, 0] add one deterministically</pre>
<pre class="cython line score-0">&#xA0;<span class="">2419</span>:             # y at lower bound --&gt; choice_view[n, k, 0] stays the same deterministically</pre>
<pre class="cython line score-0">&#xA0;<span class="">2420</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2421</span>:             # If boundary is negative (or 0) already, we flip a coin</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2422</span>:             if boundary_view[ix] &lt;= 0:</pre>
<pre class='cython code score-0 '>      __pyx_t_24 = __pyx_v_ix;
      __pyx_t_18 = ((*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_24 * __pyx_v_boundary_view.strides[0]) ))) &lt;= 0.0);
      if (__pyx_t_18) {
/* … */
        goto __pyx_L47;
      }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2423</span>:                 if random_uniform() &lt;= 0.5:</pre>
<pre class='cython code score-5 '>        __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2423, __pyx_L1_error)</span>
        __pyx_t_18 = (__pyx_t_23 &lt;= 0.5);
        if (__pyx_t_18) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2424</span>:                     choices_view[n, k, 0] += 1</pre>
<pre class='cython code score-0 '>          __pyx_t_24 = __pyx_v_n;
          __pyx_t_26 = __pyx_v_k;
          __pyx_t_19 = 0;
          *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_24 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_26 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[2]) )) += 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">2425</span>:             # Otherwise apply rule from above</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2426</span>:             elif random_uniform() &lt;= ((y_l + boundary_view[ix]) / (2 * boundary_view[ix])):</pre>
<pre class='cython code score-5 '>      __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2426, __pyx_L1_error)</span>
      __pyx_t_19 = __pyx_v_ix;
      __pyx_t_26 = __pyx_v_ix;
      __pyx_t_18 = (__pyx_t_23 &lt;= ((__pyx_v_y_l + (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))) / (2.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_26 * __pyx_v_boundary_view.strides[0]) ))))));
      if (__pyx_t_18) {
/* … */
      }
      __pyx_L47:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2427</span>:                 choices_view[n, k, 0] += 1</pre>
<pre class='cython code score-0 '>        __pyx_t_26 = __pyx_v_n;
        __pyx_t_19 = __pyx_v_k;
        __pyx_t_24 = 0;
        *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_26 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[2]) )) += 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">2428</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2429</span>:             if (rts_view[n, k, 0] &gt;= deadline_view[k]) | (deadline_view[k] &lt;= 0):</pre>
<pre class='cython code score-0 '>      __pyx_t_24 = __pyx_v_n;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_26 = 0;
      __pyx_t_20 = __pyx_v_k;
      __pyx_t_27 = __pyx_v_k;
      __pyx_t_18 = (((*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_24 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_19 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_26 * __pyx_v_rts_view.strides[2]) ))) &gt;= (*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_20 * __pyx_v_deadline_view.strides[0]) )))) | ((*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_27 * __pyx_v_deadline_view.strides[0]) ))) &lt;= 0.0));
      if (__pyx_t_18) {
/* … */
      }
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2430</span>:                 rts_view[n, k, 0] = -999</pre>
<pre class='cython code score-0 '>        __pyx_t_27 = __pyx_v_n;
        __pyx_t_20 = __pyx_v_k;
        __pyx_t_26 = 0;
        *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_27 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_20 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_26 * __pyx_v_rts_view.strides[2]) )) = -999.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2431</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2432</span>:     if return_option == 'full':</pre>
<pre class='cython code score-2 '>  __pyx_t_18 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_return_option, __pyx_n_u_full, Py_EQ)); if (unlikely((__pyx_t_18 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2432, __pyx_L1_error)</span>
  if (__pyx_t_18) {
/* … */
  }
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2433</span>:         return {'rts': rts, 'choices': choices, 'rts_low': rts_low, 'rts_high': rts_high,</pre>
<pre class='cython code score-23 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2433, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2433, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2433, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_rts_low, __pyx_v_rts_low) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2433, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_rts_high, __pyx_v_rts_high) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2433, __pyx_L1_error)</span>
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2434</span>:                 'metadata': {'vh': vh,</pre>
<pre class='cython code score-7 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(10);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2434, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_vh, ((PyObject *)__pyx_v_vh)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2434, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2435</span>:                             'vl1': vl1,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_vl1, ((PyObject *)__pyx_v_vl1)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2434, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2436</span>:                             'vl2': vl2,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_vl2, ((PyObject *)__pyx_v_vl2)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2434, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2437</span>:                             'a': a,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2434, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2438</span>:                             'zh': zh,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_zh, ((PyObject *)__pyx_v_zh)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2434, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2439</span>:                             'zl1': zl1,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_zl1, ((PyObject *)__pyx_v_zl1)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2434, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2440</span>:                             'zl2': zl2,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_zl2, ((PyObject *)__pyx_v_zl2)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2434, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2441</span>:                             't': t,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2434, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2442</span>:                             'deadline': deadline,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_deadline, ((PyObject *)__pyx_v_deadline)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2434, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2443</span>:                             's': s,</pre>
<pre class='cython code score-11 '>    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_s);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2443, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_s, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2434, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_10 = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2444</span>:                             **boundary_params,</pre>
<pre class='cython code score-17 '>    if (unlikely(__pyx_v_boundary_params == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
      <span class='error_goto'>__PYX_ERR(0, 2444, __pyx_L1_error)</span>
    }
    if (unlikely(<span class='py_c_api'>PyDict_Update</span>(__pyx_t_10, __pyx_v_boundary_params) &lt; 0)) {
      if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseMappingExpectedError</span>(__pyx_v_boundary_params);
      <span class='error_goto'>__PYX_ERR(0, 2444, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2445</span>:                             'delta_t': delta_t,</pre>
<pre class='cython code score-11 '>    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_t);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2445, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_delta_t, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2445, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2446</span>:                             'max_t': max_t,</pre>
<pre class='cython code score-11 '>    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_max_t);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2446, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_max_t, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2446, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2447</span>:                             'n_samples': n_samples,</pre>
<pre class='cython code score-8 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2447, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_n_samples, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2447, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2448</span>:                             'n_trials': n_trials,</pre>
<pre class='cython code score-13 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2448, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_n_trials, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2448, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_simulator, __pyx_n_u_ddm_flexbound) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2449, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">2449</span>:                             'simulator': 'ddm_flexbound',</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2450</span>:                             'boundary_fun_type': boundary_fun.__name__,</pre>
<pre class='cython code score-8 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_boundary_fun, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2450, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_boundary_fun_type, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2450, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2451</span>:                             'possible_choices': [0, 1, 2, 3],</pre>
<pre class='cython code score-23 '>    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2451, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_int_0)) <span class='error_goto'>__PYX_ERR(0, 2451, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 2451, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 2, __pyx_int_2)) <span class='error_goto'>__PYX_ERR(0, 2451, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 3, __pyx_int_3)) <span class='error_goto'>__PYX_ERR(0, 2451, __pyx_L1_error)</span>;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_possible_choices, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2451, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2452</span>:                             'trajectory': traj,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_trajectory, __pyx_v_traj) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2452, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2453</span>:                             'boundary': boundary}}</pre>
<pre class='cython code score-11 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_boundary, __pyx_v_boundary) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2453, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_metadata, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2433, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_r = __pyx_t_5;
    __pyx_t_5 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2454</span>:     elif return_option == 'minimal':</pre>
<pre class='cython code score-2 '>  __pyx_t_18 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_return_option, __pyx_n_u_minimal, Py_EQ)); if (unlikely((__pyx_t_18 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2454, __pyx_L1_error)</span>
  if (likely(__pyx_t_18)) {
/* … */
  }
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2455</span>:         return {'rts': rts, 'choices': choices, 'rts_low': rts_low, 'rts_high': rts_high,</pre>
<pre class='cython code score-23 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2455, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2455, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2455, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_rts_low, __pyx_v_rts_low) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2455, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_rts_high, __pyx_v_rts_high) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2455, __pyx_L1_error)</span>
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2456</span>:                 'metadata': {'simulator': 'ddm_flexbound',</pre>
<pre class='cython code score-7 '>    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2456, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_simulator, __pyx_n_u_ddm_flexbound) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2456, __pyx_L1_error)</span>
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2457</span>:                              'possible_choices': [0, 1, 2, 3],</pre>
<pre class='cython code score-23 '>    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2457, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_int_0)) <span class='error_goto'>__PYX_ERR(0, 2457, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 2457, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 2, __pyx_int_2)) <span class='error_goto'>__PYX_ERR(0, 2457, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 3, __pyx_int_3)) <span class='error_goto'>__PYX_ERR(0, 2457, __pyx_L1_error)</span>;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_possible_choices, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2456, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2458</span>:                              'boundary_fun_type': boundary_fun.__name__,</pre>
<pre class='cython code score-8 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_boundary_fun, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2458, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_boundary_fun_type, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2456, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2459</span>:                              'n_samples': n_samples,</pre>
<pre class='cython code score-8 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2459, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_n_samples, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2456, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2460</span>:                              'n_trials': n_trials,</pre>
<pre class='cython code score-14 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2460, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_n_trials, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2456, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_metadata, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2455, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_r = __pyx_t_5;
    __pyx_t_5 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2461</span>:                              }}</pre>
<pre class="cython line score-0">&#xA0;<span class="">2462</span>:     else:</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2463</span>:         raise ValueError('return_option must be either "full" or "minimal"')</pre>
<pre class='cython code score-5 '>  /*else*/ {
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2463, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_5, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='error_goto'>__PYX_ERR(0, 2463, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">2464</span>: # -----------------------------------------------------------------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2465</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2466</span>: # Simulate (rt, choice) tuples from: DDM WITH FLEXIBLE BOUNDARIES ------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2467</span>: # @cythonboundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2468</span>: # @cythonwraparound(False)</pre>
<pre class="cython line score-187" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2469</span>: def ddm_flexbound_mic2_ornstein(np.ndarray[float, ndim = 1] vh,</pre>
<pre class='cython code score-187 '>static PyObject *__pyx_pf_4cssm_66__defaults__(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_r = NULL;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
/* … */
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(12);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2469, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 2, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 3, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 4, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_True));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_True));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 5, ((PyObject *)Py_True))) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 6, Py_None)) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_True));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_True));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 7, ((PyObject *)Py_True))) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults10, __pyx_self)-&gt;__pyx_arg_boundary_params);
  <span class='refnanny'>__Pyx_GIVEREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults10, __pyx_self)-&gt;__pyx_arg_boundary_params);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 8, <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults10, __pyx_self)-&gt;__pyx_arg_boundary_params)) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 9, Py_None)) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject*)__pyx_n_u_full));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject*)__pyx_n_u_full));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 10, ((PyObject*)__pyx_n_u_full))) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_False));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_False));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 11, ((PyObject *)Py_False))) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2469, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 1, Py_None)) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L1_error)</span>;
  __pyx_t_6 = 0;
  __pyx_r = __pyx_t_5;
  __pyx_t_5 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.__defaults__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_4cssm_29ddm_flexbound_mic2_ornstein(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_4cssm_29ddm_flexbound_mic2_ornstein = {"ddm_flexbound_mic2_ornstein", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_4cssm_29ddm_flexbound_mic2_ornstein, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_4cssm_29ddm_flexbound_mic2_ornstein(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyArrayObject *__pyx_v_vh = 0;
  PyArrayObject *__pyx_v_vl1 = 0;
  PyArrayObject *__pyx_v_vl2 = 0;
  PyArrayObject *__pyx_v_a = 0;
  PyArrayObject *__pyx_v_zh = 0;
  PyArrayObject *__pyx_v_zl1 = 0;
  PyArrayObject *__pyx_v_zl2 = 0;
  PyArrayObject *__pyx_v_d = 0;
  PyArrayObject *__pyx_v_g = 0;
  PyArrayObject *__pyx_v_t = 0;
  PyArrayObject *__pyx_v_deadline = 0;
  PyArrayObject *__pyx_v_s_pre_high_level_choice = 0;
  float __pyx_v_s;
  float __pyx_v_delta_t;
  float __pyx_v_max_t;
  int __pyx_v_n_samples;
  int __pyx_v_n_trials;
  CYTHON_UNUSED PyObject *__pyx_v_print_info = 0;
  PyObject *__pyx_v_boundary_fun = 0;
  PyObject *__pyx_v_boundary_multiplicative = 0;
  PyObject *__pyx_v_boundary_params = 0;
  PyObject *__pyx_v_random_state = 0;
  PyObject *__pyx_v_return_option = 0;
  PyObject *__pyx_v_smooth = 0;
  CYTHON_UNUSED PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("ddm_flexbound_mic2_ornstein (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_vh,&amp;__pyx_n_s_vl1,&amp;__pyx_n_s_vl2,&amp;__pyx_n_s_a,&amp;__pyx_n_s_zh,&amp;__pyx_n_s_zl1,&amp;__pyx_n_s_zl2,&amp;__pyx_n_s_d,&amp;__pyx_n_s_g,&amp;__pyx_n_s_t,&amp;__pyx_n_s_deadline,&amp;__pyx_n_s_s_pre_high_level_choice,&amp;__pyx_n_s_s,&amp;__pyx_n_s_delta_t,&amp;__pyx_n_s_max_t,&amp;__pyx_n_s_n_samples,&amp;__pyx_n_s_n_trials,&amp;__pyx_n_s_print_info,&amp;__pyx_n_s_boundary_fun,&amp;__pyx_n_s_boundary_multiplicative,&amp;__pyx_n_s_boundary_params,&amp;__pyx_n_s_random_state,&amp;__pyx_n_s_return_option,&amp;__pyx_n_s_smooth,0};
  PyObject* values[24] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    __pyx_defaults10 *__pyx_dynamic_args = <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults10, __pyx_self);
    values[17] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_True)));
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs);
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4cssm_28ddm_flexbound_mic2_ornstein(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_vh, PyArrayObject *__pyx_v_vl1, PyArrayObject *__pyx_v_vl2, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_zh, PyArrayObject *__pyx_v_zl1, PyArrayObject *__pyx_v_zl2, PyArrayObject *__pyx_v_d, PyArrayObject *__pyx_v_g, PyArrayObject *__pyx_v_t, PyArrayObject *__pyx_v_deadline, PyArrayObject *__pyx_v_s_pre_high_level_choice, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, CYTHON_UNUSED PyObject *__pyx_v_print_info, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state, PyObject *__pyx_v_return_option, PyObject *__pyx_v_smooth, CYTHON_UNUSED PyObject *__pyx_v_kwargs) {
  __Pyx_memviewslice __pyx_v_vh_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_vl1_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_vl2_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_a_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_zh_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_zl1_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_zl2_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_d_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_g_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_t_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_s_pre_high_level_choice_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_deadline_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_rts = NULL;
  PyObject *__pyx_v_choices = NULL;
  PyObject *__pyx_v_rts_low = NULL;
  PyObject *__pyx_v_rts_high = NULL;
  __Pyx_memviewslice __pyx_v_rts_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_rts_high_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_rts_low_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_choices_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_traj = NULL;
  __Pyx_memviewslice __pyx_v_traj_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  float __pyx_v_delta_t_sqrt;
  float __pyx_v_sqrt_st;
  int __pyx_v_num_draws;
  PyObject *__pyx_v_t_s = NULL;
  PyObject *__pyx_v_boundary = NULL;
  __Pyx_memviewslice __pyx_v_boundary_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_bias_trace_l1 = NULL;
  PyObject *__pyx_v_bias_trace_l2 = NULL;
  __Pyx_memviewslice __pyx_v_bias_trace_l1_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_bias_trace_l2_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  float __pyx_v_y_h;
  float __pyx_v_y_l;
  float __pyx_v_y_l1;
  float __pyx_v_y_l2;
  float __pyx_v_t_h;
  float __pyx_v_t_l;
  float __pyx_v_t_l1;
  float __pyx_v_t_l2;
  CYTHON_UNUSED float __pyx_v_smooth_u;
  float __pyx_v_deadline_tmp;
  Py_ssize_t __pyx_v_n;
  Py_ssize_t __pyx_v_ix;
  Py_ssize_t __pyx_v_ix1;
  Py_ssize_t __pyx_v_ix2;
  Py_ssize_t __pyx_v_ix_l;
  Py_ssize_t __pyx_v_ix1_tmp;
  Py_ssize_t __pyx_v_ix2_tmp;
  Py_ssize_t __pyx_v_k;
  Py_ssize_t __pyx_v_m;
  __Pyx_memviewslice __pyx_v_gaussian_values = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_boundary_params_tmp = NULL;
  PyObject *__pyx_9genexpr11__pyx_v_key = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_a;
  __Pyx_Buffer __pyx_pybuffer_a;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_d;
  __Pyx_Buffer __pyx_pybuffer_d;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_deadline;
  __Pyx_Buffer __pyx_pybuffer_deadline;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_g;
  __Pyx_Buffer __pyx_pybuffer_g;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_s_pre_high_level_choice;
  __Pyx_Buffer __pyx_pybuffer_s_pre_high_level_choice;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_t;
  __Pyx_Buffer __pyx_pybuffer_t;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_vh;
  __Pyx_Buffer __pyx_pybuffer_vh;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_vl1;
  __Pyx_Buffer __pyx_pybuffer_vl1;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_vl2;
  __Pyx_Buffer __pyx_pybuffer_vl2;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_zh;
  __Pyx_Buffer __pyx_pybuffer_zh;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_zl1;
  __Pyx_Buffer __pyx_pybuffer_zl1;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_zl2;
  __Pyx_Buffer __pyx_pybuffer_zl2;
  PyObject *__pyx_r = NULL;
  __pyx_pybuffer_vh.pybuffer.buf = NULL;
  __pyx_pybuffer_vh.refcount = 0;
  __pyx_pybuffernd_vh.data = NULL;
  __pyx_pybuffernd_vh.rcbuffer = &amp;__pyx_pybuffer_vh;
  __pyx_pybuffer_vl1.pybuffer.buf = NULL;
  __pyx_pybuffer_vl1.refcount = 0;
  __pyx_pybuffernd_vl1.data = NULL;
  __pyx_pybuffernd_vl1.rcbuffer = &amp;__pyx_pybuffer_vl1;
  __pyx_pybuffer_vl2.pybuffer.buf = NULL;
  __pyx_pybuffer_vl2.refcount = 0;
  __pyx_pybuffernd_vl2.data = NULL;
  __pyx_pybuffernd_vl2.rcbuffer = &amp;__pyx_pybuffer_vl2;
  __pyx_pybuffer_a.pybuffer.buf = NULL;
  __pyx_pybuffer_a.refcount = 0;
  __pyx_pybuffernd_a.data = NULL;
  __pyx_pybuffernd_a.rcbuffer = &amp;__pyx_pybuffer_a;
  __pyx_pybuffer_zh.pybuffer.buf = NULL;
  __pyx_pybuffer_zh.refcount = 0;
  __pyx_pybuffernd_zh.data = NULL;
  __pyx_pybuffernd_zh.rcbuffer = &amp;__pyx_pybuffer_zh;
  __pyx_pybuffer_zl1.pybuffer.buf = NULL;
  __pyx_pybuffer_zl1.refcount = 0;
  __pyx_pybuffernd_zl1.data = NULL;
  __pyx_pybuffernd_zl1.rcbuffer = &amp;__pyx_pybuffer_zl1;
  __pyx_pybuffer_zl2.pybuffer.buf = NULL;
  __pyx_pybuffer_zl2.refcount = 0;
  __pyx_pybuffernd_zl2.data = NULL;
  __pyx_pybuffernd_zl2.rcbuffer = &amp;__pyx_pybuffer_zl2;
  __pyx_pybuffer_d.pybuffer.buf = NULL;
  __pyx_pybuffer_d.refcount = 0;
  __pyx_pybuffernd_d.data = NULL;
  __pyx_pybuffernd_d.rcbuffer = &amp;__pyx_pybuffer_d;
  __pyx_pybuffer_g.pybuffer.buf = NULL;
  __pyx_pybuffer_g.refcount = 0;
  __pyx_pybuffernd_g.data = NULL;
  __pyx_pybuffernd_g.rcbuffer = &amp;__pyx_pybuffer_g;
  __pyx_pybuffer_t.pybuffer.buf = NULL;
  __pyx_pybuffer_t.refcount = 0;
  __pyx_pybuffernd_t.data = NULL;
  __pyx_pybuffernd_t.rcbuffer = &amp;__pyx_pybuffer_t;
  __pyx_pybuffer_deadline.pybuffer.buf = NULL;
  __pyx_pybuffer_deadline.refcount = 0;
  __pyx_pybuffernd_deadline.data = NULL;
  __pyx_pybuffernd_deadline.rcbuffer = &amp;__pyx_pybuffer_deadline;
  __pyx_pybuffer_s_pre_high_level_choice.pybuffer.buf = NULL;
  __pyx_pybuffer_s_pre_high_level_choice.refcount = 0;
  __pyx_pybuffernd_s_pre_high_level_choice.data = NULL;
  __pyx_pybuffernd_s_pre_high_level_choice.rcbuffer = &amp;__pyx_pybuffer_s_pre_high_level_choice;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_vh, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_vh.diminfo[0].strides = __pyx_pybuffernd_vh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_vh.diminfo[0].shape = __pyx_pybuffernd_vh.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vl1.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_vl1, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_vl1.diminfo[0].strides = __pyx_pybuffernd_vl1.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_vl1.diminfo[0].shape = __pyx_pybuffernd_vl1.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vl2.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_vl2, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_vl2.diminfo[0].strides = __pyx_pybuffernd_vl2.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_vl2.diminfo[0].shape = __pyx_pybuffernd_vl2.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_a, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_zh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_zh, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_zh.diminfo[0].strides = __pyx_pybuffernd_zh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_zh.diminfo[0].shape = __pyx_pybuffernd_zh.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_zl1.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_zl1, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_zl1.diminfo[0].strides = __pyx_pybuffernd_zl1.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_zl1.diminfo[0].shape = __pyx_pybuffernd_zl1.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_zl2.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_zl2, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_zl2.diminfo[0].strides = __pyx_pybuffernd_zl2.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_zl2.diminfo[0].shape = __pyx_pybuffernd_zl2.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_d.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_d, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_d.diminfo[0].strides = __pyx_pybuffernd_d.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_d.diminfo[0].shape = __pyx_pybuffernd_d.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_g.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_g, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_g.diminfo[0].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_g.diminfo[0].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_t, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_t.diminfo[0].strides = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_t.diminfo[0].shape = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_deadline, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_deadline.diminfo[0].strides = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_deadline.diminfo[0].shape = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_s_pre_high_level_choice.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_s_pre_high_level_choice, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_s_pre_high_level_choice.diminfo[0].strides = __pyx_pybuffernd_s_pre_high_level_choice.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_s_pre_high_level_choice.diminfo[0].shape = __pyx_pybuffernd_s_pre_high_level_choice.rcbuffer-&gt;pybuffer.shape[0];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_2, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_7, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_9, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_d.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_g.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_s_pre_high_level_choice.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vh.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vl1.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vl2.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zh.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zl1.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zl2.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.ddm_flexbound_mic2_ornstein", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_d.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_g.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_s_pre_high_level_choice.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vl1.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vl2.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zl1.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zl2.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_vh_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_vl1_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_vl2_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_a_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_zh_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_zl1_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_zl2_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_d_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_g_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_t_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_s_pre_high_level_choice_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_deadline_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_choices);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rts_low);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rts_high);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_rts_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_rts_high_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_rts_low_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_choices_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_traj);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_traj_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t_s);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_boundary);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_boundary_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_bias_trace_l1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_bias_trace_l2);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_bias_trace_l1_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_bias_trace_l2_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_boundary_params_tmp);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_9genexpr11__pyx_v_key);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__51 = <span class='py_c_api'>PyTuple_Pack</span>(83, __pyx_n_s_vh, __pyx_n_s_vl1, __pyx_n_s_vl2, __pyx_n_s_a, __pyx_n_s_zh, __pyx_n_s_zl1, __pyx_n_s_zl2, __pyx_n_s_d, __pyx_n_s_g, __pyx_n_s_t, __pyx_n_s_deadline, __pyx_n_s_s_pre_high_level_choice, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_print_info, __pyx_n_s_boundary_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_random_state, __pyx_n_s_return_option, __pyx_n_s_smooth, __pyx_n_s_kwargs, __pyx_n_s_vh_view, __pyx_n_s_vl1_view, __pyx_n_s_vl2_view, __pyx_n_s_a_view, __pyx_n_s_zh_view, __pyx_n_s_zl1_view, __pyx_n_s_zl2_view, __pyx_n_s_d_view, __pyx_n_s_g_view, __pyx_n_s_t_view, __pyx_n_s_s_pre_high_level_choice_view, __pyx_n_s_deadline_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_low, __pyx_n_s_rts_high, __pyx_n_s_rts_view, __pyx_n_s_rts_high_view, __pyx_n_s_rts_low_view, __pyx_n_s_choices_view, __pyx_n_s_traj, __pyx_n_s_traj_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_num_draws, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_boundary_view, __pyx_n_s_bias_trace_l1, __pyx_n_s_bias_trace_l2, __pyx_n_s_bias_trace_l1_view, __pyx_n_s_bias_trace_l2_view, __pyx_n_s_y_h, __pyx_n_s_y_l, __pyx_n_s_y_l1, __pyx_n_s_y_l2, __pyx_n_s_v_l, __pyx_n_s_v_l1, __pyx_n_s_v_l2, __pyx_n_s_t_h, __pyx_n_s_t_l, __pyx_n_s_t_l1, __pyx_n_s_t_l2, __pyx_n_s_smooth_u, __pyx_n_s_deadline_tmp, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_ix1, __pyx_n_s_ix2, __pyx_n_s_ix_l, __pyx_n_s_ix_tmp, __pyx_n_s_ix1_tmp, __pyx_n_s_ix2_tmp, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_gaussian_values, __pyx_n_s_boundary_params_tmp, __pyx_n_s_key);<span class='error_goto'> if (unlikely(!__pyx_tuple__51)) __PYX_ERR(0, 2469, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__51);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__51);
/* … */
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_4cssm_29ddm_flexbound_mic2_ornstein, 0, __pyx_n_s_ddm_flexbound_mic2_ornstein, NULL, __pyx_n_s_cssm, __pyx_d, ((PyObject *)__pyx_codeobj__52));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2469, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (!<span class='pyx_c_api'>__Pyx_CyFunction_InitDefaults</span>(__pyx_t_5, sizeof(__pyx_defaults10), 1)) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L1_error)</span>
  __pyx_codeobj__52 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(24, 0, 0, 83, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__51, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_ddm_flexbound_mic2_ornstein, 2469, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__52)) __PYX_ERR(0, 2469, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">2470</span>:                                 np.ndarray[float, ndim = 1] vl1,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2471</span>:                                 np.ndarray[float, ndim = 1] vl2,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2472</span>:                                 np.ndarray[float, ndim = 1] a,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2473</span>:                                 np.ndarray[float, ndim = 1] zh,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2474</span>:                                 np.ndarray[float, ndim = 1] zl1,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2475</span>:                                 np.ndarray[float, ndim = 1] zl2,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2476</span>:                                 np.ndarray[float, ndim = 1] d, # damper (1 --&gt; no drift on low level until high level done, 0 --&gt; full drift on low level)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2477</span>:                                 np.ndarray[float, ndim = 1] g, # inhibition parameter for the low dim choice procress while high dim is running</pre>
<pre class="cython line score-0">&#xA0;<span class="">2478</span>:                                 np.ndarray[float, ndim = 1] t,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2479</span>:                                 np.ndarray[float, ndim = 1] deadline,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2480</span>:                                 np.ndarray[float, ndim = 1] s_pre_high_level_choice,</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2481</span>:                                 float s = 1.0,</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(((double)1.0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2481, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2482</span>:                                 float delta_t = 0.001,</pre>
<pre class='cython code score-5 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(((double)0.001));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2482, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2483</span>:                                 float max_t = 20,</pre>
<pre class='cython code score-5 '>  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)20.0));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2483, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2484</span>:                                 int n_samples = 20000,</pre>
<pre class='cython code score-2 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)0x4E20));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2484, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2485</span>:                                 int n_trials = 1,</pre>
<pre class='cython code score-2 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)1));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2485, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
</pre><pre class="cython line score-0">&#xA0;<span class="">2486</span>:                                 print_info = True,</pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2487</span>:                                 boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)</pre>
<pre class='cython code score-6 '>    values[18] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[19] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_True)));
    values[20] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(__pyx_dynamic_args-&gt;__pyx_arg_boundary_params);
</pre><pre class="cython line score-0">&#xA0;<span class="">2488</span>:                                 boundary_multiplicative = True,</pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2489</span>:                                 boundary_params = {},</pre>
<pre class='cython code score-12 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2489, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults10, __pyx_t_5)-&gt;__pyx_arg_boundary_params = __pyx_t_4;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_4 = 0;
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsGetter</span>(__pyx_t_5, __pyx_pf_4cssm_66__defaults__);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_ddm_flexbound_mic2_ornstein, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-419" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2490</span>:                                 random_state = None,</pre>
<pre class='cython code score-419 '>    values[21] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[22] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_full)));
    values[23] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case 24: values[23] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 23);
        CYTHON_FALLTHROUGH;
        case 23: values[22] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 22);
        CYTHON_FALLTHROUGH;
        case 22: values[21] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 21);
        CYTHON_FALLTHROUGH;
        case 21: values[20] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 20);
        CYTHON_FALLTHROUGH;
        case 20: values[19] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 19);
        CYTHON_FALLTHROUGH;
        case 19: values[18] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 18);
        CYTHON_FALLTHROUGH;
        case 18: values[17] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 17);
        CYTHON_FALLTHROUGH;
        case 17: values[16] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 16);
        CYTHON_FALLTHROUGH;
        case 16: values[15] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 15);
        CYTHON_FALLTHROUGH;
        case 15: values[14] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_vh)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_vl1)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_ornstein", 0, 12, 24, 1); <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_vl2)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_ornstein", 0, 12, 24, 2); <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_a)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[3]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_ornstein", 0, 12, 24, 3); <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_zh)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[4]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_ornstein", 0, 12, 24, 4); <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_zl1)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[5]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_ornstein", 0, 12, 24, 5); <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_zl2)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[6]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_ornstein", 0, 12, 24, 6); <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (likely((values[7] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_d)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[7]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_ornstein", 0, 12, 24, 7); <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (likely((values[8] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_g)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[8]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_ornstein", 0, 12, 24, 8); <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  9:
        if (likely((values[9] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_t)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[9]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_ornstein", 0, 12, 24, 9); <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 10:
        if (likely((values[10] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_deadline)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[10]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_ornstein", 0, 12, 24, 10); <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 11:
        if (likely((values[11] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_s_pre_high_level_choice)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[11]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_ornstein", 0, 12, 24, 11); <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 12:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_s);
          if (value) { values[12] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 13:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_delta_t);
          if (value) { values[13] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 14:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_max_t);
          if (value) { values[14] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 15:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_samples);
          if (value) { values[15] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 16:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_trials);
          if (value) { values[16] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 17:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_print_info);
          if (value) { values[17] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 18:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_fun);
          if (value) { values[18] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 19:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_multiplicative);
          if (value) { values[19] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 20:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_params);
          if (value) { values[20] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 21:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_random_state);
          if (value) { values[21] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 22:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_return_option);
          if (value) { values[22] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 23:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_smooth);
          if (value) { values[23] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values + 0, kwd_pos_args, "ddm_flexbound_mic2_ornstein") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case 24: values[23] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 23);
        CYTHON_FALLTHROUGH;
        case 23: values[22] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 22);
        CYTHON_FALLTHROUGH;
        case 22: values[21] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 21);
        CYTHON_FALLTHROUGH;
        case 21: values[20] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 20);
        CYTHON_FALLTHROUGH;
        case 20: values[19] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 19);
        CYTHON_FALLTHROUGH;
        case 19: values[18] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 18);
        CYTHON_FALLTHROUGH;
        case 18: values[17] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 17);
        CYTHON_FALLTHROUGH;
        case 17: values[16] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 16);
        CYTHON_FALLTHROUGH;
        case 16: values[15] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 15);
        CYTHON_FALLTHROUGH;
        case 15: values[14] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_vh = ((PyArrayObject *)values[0]);
    __pyx_v_vl1 = ((PyArrayObject *)values[1]);
    __pyx_v_vl2 = ((PyArrayObject *)values[2]);
    __pyx_v_a = ((PyArrayObject *)values[3]);
    __pyx_v_zh = ((PyArrayObject *)values[4]);
    __pyx_v_zl1 = ((PyArrayObject *)values[5]);
    __pyx_v_zl2 = ((PyArrayObject *)values[6]);
    __pyx_v_d = ((PyArrayObject *)values[7]);
    __pyx_v_g = ((PyArrayObject *)values[8]);
    __pyx_v_t = ((PyArrayObject *)values[9]);
    __pyx_v_deadline = ((PyArrayObject *)values[10]);
    __pyx_v_s_pre_high_level_choice = ((PyArrayObject *)values[11]);
    if (values[12]) {
      __pyx_v_s = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[12]); if (unlikely((__pyx_v_s == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2481, __pyx_L3_error)</span>
    } else {
      __pyx_v_s = ((float)((double)1.0));
    }
    if (values[13]) {
      __pyx_v_delta_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[13]); if (unlikely((__pyx_v_delta_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2482, __pyx_L3_error)</span>
    } else {
      __pyx_v_delta_t = ((float)((double)0.001));
    }
    if (values[14]) {
      __pyx_v_max_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[14]); if (unlikely((__pyx_v_max_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2483, __pyx_L3_error)</span>
    } else {
      __pyx_v_max_t = ((float)((float)20.0));
    }
    if (values[15]) {
      __pyx_v_n_samples = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[15]); if (unlikely((__pyx_v_n_samples == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2484, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_samples = ((int)((int)0x4E20));
    }
    if (values[16]) {
      __pyx_v_n_trials = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[16]); if (unlikely((__pyx_v_n_trials == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2485, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_trials = ((int)((int)1));
    }
    __pyx_v_print_info = values[17];
    __pyx_v_boundary_fun = values[18];
    __pyx_v_boundary_multiplicative = values[19];
    __pyx_v_boundary_params = values[20];
    __pyx_v_random_state = values[21];
    __pyx_v_return_option = values[22];
    __pyx_v_smooth = values[23];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_ornstein", 0, 12, 24, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.ddm_flexbound_mic2_ornstein", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_vh), __pyx_ptype_5numpy_ndarray, 1, "vh", 0))) <span class='error_goto'>__PYX_ERR(0, 2469, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_vl1), __pyx_ptype_5numpy_ndarray, 1, "vl1", 0))) <span class='error_goto'>__PYX_ERR(0, 2470, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_vl2), __pyx_ptype_5numpy_ndarray, 1, "vl2", 0))) <span class='error_goto'>__PYX_ERR(0, 2471, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) <span class='error_goto'>__PYX_ERR(0, 2472, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_zh), __pyx_ptype_5numpy_ndarray, 1, "zh", 0))) <span class='error_goto'>__PYX_ERR(0, 2473, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_zl1), __pyx_ptype_5numpy_ndarray, 1, "zl1", 0))) <span class='error_goto'>__PYX_ERR(0, 2474, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_zl2), __pyx_ptype_5numpy_ndarray, 1, "zl2", 0))) <span class='error_goto'>__PYX_ERR(0, 2475, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_d), __pyx_ptype_5numpy_ndarray, 1, "d", 0))) <span class='error_goto'>__PYX_ERR(0, 2476, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_g), __pyx_ptype_5numpy_ndarray, 1, "g", 0))) <span class='error_goto'>__PYX_ERR(0, 2477, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) <span class='error_goto'>__PYX_ERR(0, 2478, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_deadline), __pyx_ptype_5numpy_ndarray, 1, "deadline", 0))) <span class='error_goto'>__PYX_ERR(0, 2479, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_s_pre_high_level_choice), __pyx_ptype_5numpy_ndarray, 1, "s_pre_high_level_choice", 0))) <span class='error_goto'>__PYX_ERR(0, 2480, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_4cssm_28ddm_flexbound_mic2_ornstein(__pyx_self, __pyx_v_vh, __pyx_v_vl1, __pyx_v_vl2, __pyx_v_a, __pyx_v_zh, __pyx_v_zl1, __pyx_v_zl2, __pyx_v_d, __pyx_v_g, __pyx_v_t, __pyx_v_deadline, __pyx_v_s_pre_high_level_choice, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_print_info, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state, __pyx_v_return_option, __pyx_v_smooth, __pyx_v_kwargs);
</pre><pre class="cython line score-0">&#xA0;<span class="">2491</span>:                                 return_option = 'full',</pre>
<pre class="cython line score-0">&#xA0;<span class="">2492</span>:                                 smooth = False,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2493</span>:                                 **kwargs):</pre>
<pre class="cython line score-0">&#xA0;<span class="">2494</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2495</span>:     set_seed(random_state)</pre>
<pre class='cython code score-1 '>  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2495, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2496</span>:     # Param views</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2497</span>:     cdef float[:] vh_view = vh</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_vh), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2497, __pyx_L1_error)</span>
  __pyx_v_vh_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2498</span>:     cdef float[:] vl1_view = vl1</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_vl1), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2498, __pyx_L1_error)</span>
  __pyx_v_vl1_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2499</span>:     cdef float[:] vl2_view = vl2</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_vl2), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2499, __pyx_L1_error)</span>
  __pyx_v_vl2_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2500</span>:     cdef float[:] a_view = a</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_a), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2500, __pyx_L1_error)</span>
  __pyx_v_a_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2501</span>:     cdef float[:] zh_view = zh</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_zh), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2501, __pyx_L1_error)</span>
  __pyx_v_zh_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2502</span>:     cdef float[:] zl1_view = zl1</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_zl1), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2502, __pyx_L1_error)</span>
  __pyx_v_zl1_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2503</span>:     cdef float[:] zl2_view = zl2</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_zl2), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2503, __pyx_L1_error)</span>
  __pyx_v_zl2_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2504</span>:     cdef float[:] d_view = d</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_d), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2504, __pyx_L1_error)</span>
  __pyx_v_d_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2505</span>:     cdef float[:] g_view = g</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_g), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2505, __pyx_L1_error)</span>
  __pyx_v_g_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2506</span>:     cdef float[:] t_view = t</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_t), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2506, __pyx_L1_error)</span>
  __pyx_v_t_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2507</span>:     cdef float[:] s_pre_high_level_choice_view = s_pre_high_level_choice</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_s_pre_high_level_choice), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2507, __pyx_L1_error)</span>
  __pyx_v_s_pre_high_level_choice_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2508</span>:     cdef float[:] deadline_view = deadline</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_deadline), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2508, __pyx_L1_error)</span>
  __pyx_v_deadline_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">2509</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2510</span>:     # TD: Add trajectory --&gt; same issue as with par2 model above... might need to make a separate simulator for trajectories</pre>
<pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2511</span>:     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)</pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2511, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2511, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2511, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2511, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2511, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2511, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2511, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 2511, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2511, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 2511, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2511, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2511, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2511, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2511, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_rts = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2512</span>:     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)</pre>
<pre class='cython code score-46 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2512, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2512, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2512, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2512, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2512, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2512, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2512, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 2512, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2512, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 2512, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2512, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2512, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_intc);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2512, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2512, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2512, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_choices = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2513</span>:     rts_low = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)</pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2513, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2513, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2513, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2513, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2513, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 2513, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2513, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 2513, __pyx_L1_error)</span>;
  __pyx_t_6 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2513, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 2513, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2513, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2513, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2513, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2513, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_rts_low = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2514</span>:     rts_high = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)</pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2514, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2514, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2514, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2514, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2514, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 2514, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2514, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 2514, __pyx_L1_error)</span>;
  __pyx_t_6 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2514, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 2514, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2514, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2514, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2514, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2514, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_rts_high = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2515</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2516</span>:     cdef float[:, :, :] rts_view = rts</pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_rts, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 2516, __pyx_L1_error)</span>
  __pyx_v_rts_view = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2517</span>:     cdef float[:, :, :] rts_high_view = rts_high</pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_rts_high, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 2517, __pyx_L1_error)</span>
  __pyx_v_rts_high_view = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2518</span>:     cdef float[:, :, :] rts_low_view = rts_low</pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_rts_low, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 2518, __pyx_L1_error)</span>
  __pyx_v_rts_low_view = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2519</span>:     cdef int[:, :, :] choices_view = choices</pre>
<pre class='cython code score-2 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_int</span>(__pyx_v_choices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 2519, __pyx_L1_error)</span>
  __pyx_v_choices_view = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">2520</span>: </pre>
<pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2521</span>:     traj = np.zeros((int(max_t / delta_t) + 1, 3), dtype = DTYPE)</pre>
<pre class='cython code score-42 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2521, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2521, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_FromDouble</span>((__pyx_v_max_t / __pyx_v_delta_t));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2521, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_6, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2521, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2521, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2521, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_int_3)) <span class='error_goto'>__PYX_ERR(0, 2521, __pyx_L1_error)</span>;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2521, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 2521, __pyx_L1_error)</span>;
  __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2521, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2521, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2521, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2521, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_traj = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2522</span>:     traj[:, :] = -999</pre>
<pre class='cython code score-5 '>  if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_traj, __pyx_tuple__12, __pyx_int_neg_999) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2522, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2523</span>:     cdef float[:, :] traj_view = traj</pre>
<pre class='cython code score-2 '>  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(__pyx_v_traj, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 2523, __pyx_L1_error)</span>
  __pyx_v_traj_view = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">2524</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2525</span>:     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion</pre>
<pre class='cython code score-0 '>  __pyx_v_delta_t_sqrt = sqrt(__pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2526</span>:     cdef float sqrt_st = delta_t_sqrt * s # scalar to ensure the correct variance for the gaussian step</pre>
<pre class='cython code score-0 '>  __pyx_v_sqrt_st = (__pyx_v_delta_t_sqrt * __pyx_v_s);
</pre><pre class="cython line score-0">&#xA0;<span class="">2527</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2528</span>:     # Boundary storage for the upper bound</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2529</span>:     cdef int num_draws = int((max_t / delta_t) + 1)</pre>
<pre class='cython code score-0 '>  __pyx_v_num_draws = ((int)((__pyx_v_max_t / __pyx_v_delta_t) + 1.0));
</pre><pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2530</span>:     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)</pre>
<pre class='cython code score-51 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2530, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2530, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_max_t + __pyx_v_delta_t));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2530, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_t);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2530, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_10 = NULL;
  __pyx_t_11 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_10)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_11 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[4] = {__pyx_t_10, __pyx_int_0, __pyx_t_4, __pyx_t_1};
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_11, 3+__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 2530, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2530, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2530, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_1 = NULL;
  __pyx_t_11 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_11 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_6};
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_11, 1+__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 2530, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_v_t_s = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2531</span>:     boundary = np.zeros(t_s.shape, dtype = DTYPE)</pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2531, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2531, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_t_s, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2531, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2531, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 2531, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2531, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2531, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2531, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_6, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2531, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_boundary = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2532</span>:     cdef float[:] boundary_view = boundary</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(__pyx_v_boundary, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2532, __pyx_L1_error)</span>
  __pyx_v_boundary_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">2533</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2534</span>:     # Y particle trace</pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2535</span>:     bias_trace_l1 = np.zeros(num_draws, dtype = DTYPE)</pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2535, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2535, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2535, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2535, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2535, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2535, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2535, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2535, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_6, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2535, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_bias_trace_l1 = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2536</span>:     bias_trace_l2 = np.zeros(num_draws, dtype = DTYPE)</pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2536, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2536, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2536, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2536, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 2536, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2536, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2536, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2536, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_6, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2536, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_bias_trace_l2 = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2537</span>:     cdef float[:] bias_trace_l1_view = bias_trace_l1</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(__pyx_v_bias_trace_l1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2537, __pyx_L1_error)</span>
  __pyx_v_bias_trace_l1_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2538</span>:     cdef float[:] bias_trace_l2_view = bias_trace_l2</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(__pyx_v_bias_trace_l2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2538, __pyx_L1_error)</span>
  __pyx_v_bias_trace_l2_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">2539</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2540</span>:     cdef float y_h, y_l, y_l1, y_l2</pre>
<pre class="cython line score-0">&#xA0;<span class="">2541</span>:     cdef float v_l, v_l1, v_l2,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2542</span>:     cdef float t_h, t_l, t_l1, t_l2, smooth_u, deadline_tmp</pre>
<pre class="cython line score-0">&#xA0;<span class="">2543</span>:     cdef Py_ssize_t n, ix, ix1, ix2, ix_l, ix_tmp, ix1_tmp, ix2_tmp, k</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2544</span>:     cdef Py_ssize_t m = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_m = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2545</span>:     cdef float[:] gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2545, __pyx_L1_error)</span>
  __pyx_v_gaussian_values = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">2546</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2547</span>:     for k in range(n_trials):</pre>
<pre class='cython code score-0 '>  __pyx_t_11 = __pyx_v_n_trials;
  __pyx_t_12 = __pyx_t_11;
  for (__pyx_t_13 = 0; __pyx_t_13 &lt; __pyx_t_12; __pyx_t_13+=1) {
    __pyx_v_k = __pyx_t_13;
</pre><pre class="cython line score-0">&#xA0;<span class="">2548</span>:         # Precompute boundary evaluations</pre>
<pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2549</span>:         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}</pre>
<pre class='cython code score-27 '>    { /* enter inner scope */
      __pyx_t_5 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2549, __pyx_L7_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_14 = 0;
      if (unlikely(__pyx_v_boundary_params == Py_None)) {
        <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "keys");
        <span class='error_goto'>__PYX_ERR(0, 2549, __pyx_L7_error)</span>
      }
      __pyx_t_6 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&amp;__pyx_t_15), (&amp;__pyx_t_16));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2549, __pyx_L7_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
      __pyx_t_3 = __pyx_t_6;
      __pyx_t_6 = 0;
      while (1) {
        __pyx_t_17 = __Pyx_dict_iter_next(__pyx_t_3, __pyx_t_15, &amp;__pyx_t_14, &amp;__pyx_t_6, NULL, NULL, __pyx_t_16);
        if (unlikely(__pyx_t_17 == 0)) break;
        if (unlikely(__pyx_t_17 == -1)) <span class='error_goto'>__PYX_ERR(0, 2549, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_9genexpr11__pyx_v_key, __pyx_t_6);
        __pyx_t_6 = 0;
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_boundary_params, __pyx_9genexpr11__pyx_v_key);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2549, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_6, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2549, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, (PyObject*)__pyx_9genexpr11__pyx_v_key, (PyObject*)__pyx_t_1))) <span class='error_goto'>__PYX_ERR(0, 2549, __pyx_L7_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_9genexpr11__pyx_v_key); __pyx_9genexpr11__pyx_v_key = 0;
      goto __pyx_L10_exit_scope;
      __pyx_L7_error:;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_9genexpr11__pyx_v_key); __pyx_9genexpr11__pyx_v_key = 0;
      goto __pyx_L1_error;
      __pyx_L10_exit_scope:;
    } /* exit inner scope */
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_boundary_params_tmp, ((PyObject*)__pyx_t_5));
    __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2550</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2551</span>:         # Precompute boundary evaluations</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2552</span>:         if boundary_multiplicative:</pre>
<pre class='cython code score-2 '>    __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_boundary_multiplicative); if (unlikely((__pyx_t_18 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2552, __pyx_L1_error)</span>
    if (__pyx_t_18) {
/* … */
      goto __pyx_L11;
    }
</pre><pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2553</span>:             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)</pre>
<pre class='cython code score-61 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2553, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_multiply);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2553, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_19 * __pyx_v_a_view.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2553, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2553, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_t, __pyx_v_t_s) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2553, __pyx_L1_error)</span>
      __pyx_t_4 = __pyx_t_10;
      __pyx_t_10 = 0;
      if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_4, __pyx_v_boundary_params_tmp) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2553, __pyx_L1_error)</span>
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2553, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_4, __pyx_t_1, __pyx_t_10};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_16, 2+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 2553, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      }
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2553, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2553, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_10 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
        __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
        if (likely(__pyx_t_10)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_10, __pyx_t_3};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_16, 1+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 2553, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      }
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_boundary, __pyx_t_5, 0, 0, NULL, NULL, &amp;__pyx_slice__5, 0, 0, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2553, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2554</span>:         else:</pre>
<pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2555</span>:             boundary[:] = np.add(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)</pre>
<pre class='cython code score-61 '>    /*else*/ {
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2555, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_add);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2555, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_19 * __pyx_v_a_view.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2555, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2555, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_t, __pyx_v_t_s) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2555, __pyx_L1_error)</span>
      __pyx_t_1 = __pyx_t_4;
      __pyx_t_4 = 0;
      if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_1, __pyx_v_boundary_params_tmp) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2555, __pyx_L1_error)</span>
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2555, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
        __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
        if (likely(__pyx_t_1)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_1, __pyx_t_3, __pyx_t_4};
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_16, 2+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 2555, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      }
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2555, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2555, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_4 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_6};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_16, 1+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 2555, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      }
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_boundary, __pyx_t_5, 0, 0, NULL, NULL, &amp;__pyx_slice__5, 0, 0, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2555, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
    __pyx_L11:;
</pre><pre class="cython line score-0">&#xA0;<span class="">2556</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2557</span>:         deadline_tmp = min(max_t, deadline_view[k] - t_view[k])</pre>
<pre class='cython code score-0 '>    __pyx_t_19 = __pyx_v_k;
    __pyx_t_20 = __pyx_v_k;
    __pyx_t_21 = ((*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_19 * __pyx_v_deadline_view.strides[0]) ))) - (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_20 * __pyx_v_t_view.strides[0]) ))));
    __pyx_t_22 = __pyx_v_max_t;
    __pyx_t_18 = (__pyx_t_21 &lt; __pyx_t_22);
    if (__pyx_t_18) {
      __pyx_t_23 = __pyx_t_21;
    } else {
      __pyx_t_23 = __pyx_t_22;
    }
    __pyx_v_deadline_tmp = __pyx_t_23;
</pre><pre class="cython line score-0">&#xA0;<span class="">2558</span>:         # Loop over samples</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2559</span>:         for n in range(n_samples):</pre>
<pre class='cython code score-0 '>    __pyx_t_16 = __pyx_v_n_samples;
    __pyx_t_17 = __pyx_t_16;
    for (__pyx_t_15 = 0; __pyx_t_15 &lt; __pyx_t_17; __pyx_t_15+=1) {
      __pyx_v_n = __pyx_t_15;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2560</span>:             choices_view[n, k, 0] = 0 # reset choice</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = __pyx_v_n;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_24 = 0;
      *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_20 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[2]) )) = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2561</span>:             t_h = 0 # reset time high dimension</pre>
<pre class='cython code score-0 '>      __pyx_v_t_h = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2562</span>:             t_l = 0 # reset time low dimension</pre>
<pre class='cython code score-0 '>      __pyx_v_t_l = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2563</span>:             t_l1 = 0 # reset time low dimension (1)</pre>
<pre class='cython code score-0 '>      __pyx_v_t_l1 = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2564</span>:             t_l2 = 0 # reset time low dimension (2)</pre>
<pre class='cython code score-0 '>      __pyx_v_t_l2 = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2565</span>:             ix = 0 # reset boundary index</pre>
<pre class='cython code score-0 '>      __pyx_v_ix = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2566</span>:             ix1 = 0 # reset boundary index (1)</pre>
<pre class='cython code score-0 '>      __pyx_v_ix1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2567</span>:             ix2 = 0 # reset boundary index (2)</pre>
<pre class='cython code score-0 '>      __pyx_v_ix2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2568</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2569</span>:             # Initialize walkers</pre>
<pre class="cython line score-0">&#xA0;<span class="">2570</span>:             # Particle</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2571</span>:             y_h = (-1) * boundary_view[0] + (zh_view[k] * 2 * (boundary_view[0]))</pre>
<pre class='cython code score-0 '>      __pyx_t_24 = 0;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_20 = 0;
      __pyx_v_y_h = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_24 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_zh_view.data + __pyx_t_19 * __pyx_v_zh_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">2572</span>:             # Relative particle position (used as resource allocator for low dim choice)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2573</span>:             bias_trace_l2_view[0] = ((y_h + boundary_view[0]) / (2 * boundary_view[0]))</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = 0;
      __pyx_t_19 = 0;
      __pyx_t_24 = 0;
      *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l2_view.data + __pyx_t_24 * __pyx_v_bias_trace_l2_view.strides[0]) )) = ((__pyx_v_y_h + (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))) / (2.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2574</span>:             bias_trace_l1_view[0] = 1.0 - bias_trace_l2_view[0]</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = 0;
      __pyx_t_20 = 0;
      *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l1_view.data + __pyx_t_20 * __pyx_v_bias_trace_l1_view.strides[0]) )) = (1.0 - (*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l2_view.data + __pyx_t_19 * __pyx_v_bias_trace_l2_view.strides[0]) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">2575</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2576</span>:             if n == 0:</pre>
<pre class='cython code score-0 '>      __pyx_t_18 = (__pyx_v_n == 0);
      if (__pyx_t_18) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2577</span>:                 if k == 0:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (__pyx_v_k == 0);
        if (__pyx_t_18) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2578</span>:                     traj_view[0, 0] = y_h</pre>
<pre class='cython code score-0 '>          __pyx_t_19 = 0;
          __pyx_t_20 = 0;
          *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_19 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_20 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y_h;
</pre><pre class="cython line score-0">&#xA0;<span class="">2579</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2580</span>:             # Random walks until y_h hits bound</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2581</span>:             while (y_h &gt;= ((-1) * boundary_view[ix])) and ((y_h &lt;= boundary_view[ix])) and (t_h &lt;= deadline_tmp):</pre>
<pre class='cython code score-0 '>      while (1) {
        __pyx_t_20 = __pyx_v_ix;
        __pyx_t_25 = (__pyx_v_y_h &gt;= (-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))));
        if (__pyx_t_25) {
        } else {
          __pyx_t_18 = __pyx_t_25;
          goto __pyx_L18_bool_binop_done;
        }
        __pyx_t_20 = __pyx_v_ix;
        __pyx_t_25 = (__pyx_v_y_h &lt;= (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) ))));
        if (__pyx_t_25) {
        } else {
          __pyx_t_18 = __pyx_t_25;
          goto __pyx_L18_bool_binop_done;
        }
        __pyx_t_25 = (__pyx_v_t_h &lt;= __pyx_v_deadline_tmp);
        __pyx_t_18 = __pyx_t_25;
        __pyx_L18_bool_binop_done:;
        if (!__pyx_t_18) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2582</span>:                 y_h += (vh_view[k] * delta_t) + (sqrt_st * gaussian_values[m])</pre>
<pre class='cython code score-0 '>        __pyx_t_20 = __pyx_v_k;
        __pyx_t_19 = __pyx_v_m;
        __pyx_v_y_h = (__pyx_v_y_h + (((*((float *) ( /* dim=0 */ (__pyx_v_vh_view.data + __pyx_t_20 * __pyx_v_vh_view.strides[0]) ))) * __pyx_v_delta_t) + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_19 * __pyx_v_gaussian_values.strides[0]) ))))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2583</span>:                 bias_trace_l2_view[ix] = ((y_h + boundary_view[ix]) / (2 * boundary_view[ix]))</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = __pyx_v_ix;
        __pyx_t_20 = __pyx_v_ix;
        __pyx_t_24 = __pyx_v_ix;
        *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l2_view.data + __pyx_t_24 * __pyx_v_bias_trace_l2_view.strides[0]) )) = ((__pyx_v_y_h + (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))) / (2.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2584</span>:                 bias_trace_l1_view[ix] = 1.0 - bias_trace_l2_view[ix]</pre>
<pre class='cython code score-0 '>        __pyx_t_20 = __pyx_v_ix;
        __pyx_t_19 = __pyx_v_ix;
        *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l1_view.data + __pyx_t_19 * __pyx_v_bias_trace_l1_view.strides[0]) )) = (1.0 - (*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l2_view.data + __pyx_t_20 * __pyx_v_bias_trace_l2_view.strides[0]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2585</span>:                 t_h += delta_t</pre>
<pre class='cython code score-0 '>        __pyx_v_t_h = (__pyx_v_t_h + __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2586</span>:                 ix += 1</pre>
<pre class='cython code score-0 '>        __pyx_v_ix = (__pyx_v_ix + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2587</span>:                 m += 1</pre>
<pre class='cython code score-0 '>        __pyx_v_m = (__pyx_v_m + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2588</span>:                 if m == num_draws:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (__pyx_v_m == __pyx_v_num_draws);
        if (__pyx_t_18) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2589</span>:                     gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2589, __pyx_L1_error)</span>
          __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
          __pyx_v_gaussian_values = __pyx_t_2;
          __pyx_t_2.memview = NULL;
          __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2590</span>:                     m = 0</pre>
<pre class='cython code score-0 '>          __pyx_v_m = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2591</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2592</span>:                 if n == 0:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (__pyx_v_n == 0);
        if (__pyx_t_18) {
/* … */
        }
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2593</span>:                     if k == 0:</pre>
<pre class='cython code score-0 '>          __pyx_t_18 = (__pyx_v_k == 0);
          if (__pyx_t_18) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2594</span>:                         traj_view[ix, 0] = y_h</pre>
<pre class='cython code score-0 '>            __pyx_t_20 = __pyx_v_ix;
            __pyx_t_19 = 0;
            *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_20 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_19 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y_h;
</pre><pre class="cython line score-0">&#xA0;<span class="">2595</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2596</span>:             # The probability of making a 'mistake' 1 - (relative y position)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2597</span>:             # y at upper bound --&gt; choices_view[n, k, 0] add 2 deterministically</pre>
<pre class="cython line score-0">&#xA0;<span class="">2598</span>:             # y at lower bound --&gt; choice_view[n, k, 0] stay the same deterministically</pre>
<pre class="cython line score-0">&#xA0;<span class="">2599</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2600</span>:             # If boundary is negative (or 0) already, we flip a coin</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2601</span>:             if boundary_view[ix] &lt;= 0:</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = __pyx_v_ix;
      __pyx_t_18 = ((*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) ))) &lt;= 0.0);
      if (__pyx_t_18) {
/* … */
        goto __pyx_L24;
      }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2602</span>:                 if random_uniform() &lt;= 0.5:</pre>
<pre class='cython code score-5 '>        __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2602, __pyx_L1_error)</span>
        __pyx_t_18 = (__pyx_t_23 &lt;= 0.5);
        if (__pyx_t_18) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2603</span>:                     choices_view[n, k, 0] += 2</pre>
<pre class='cython code score-0 '>          __pyx_t_19 = __pyx_v_n;
          __pyx_t_20 = __pyx_v_k;
          __pyx_t_24 = 0;
          *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_19 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[2]) )) += 2;
</pre><pre class="cython line score-0">&#xA0;<span class="">2604</span>:             # Otherwise, apply rule from above</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2605</span>:             elif random_uniform() &lt;= ((y_h + boundary_view[ix]) / (2 * boundary_view[ix])):</pre>
<pre class='cython code score-5 '>      __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2605, __pyx_L1_error)</span>
      __pyx_t_24 = __pyx_v_ix;
      __pyx_t_20 = __pyx_v_ix;
      __pyx_t_18 = (__pyx_t_23 &lt;= ((__pyx_v_y_h + (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_24 * __pyx_v_boundary_view.strides[0]) )))) / (2.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) ))))));
      if (__pyx_t_18) {
/* … */
      }
      __pyx_L24:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2606</span>:                 choices_view[n, k, 0] += 2</pre>
<pre class='cython code score-0 '>        __pyx_t_20 = __pyx_v_n;
        __pyx_t_24 = __pyx_v_k;
        __pyx_t_19 = 0;
        *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_20 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[2]) )) += 2;
</pre><pre class="cython line score-0">&#xA0;<span class="">2607</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2608</span>:             y_l2 = (- 1) * boundary_view[0] + (zl2_view[k] * 2 * (boundary_view[0]))</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = 0;
      __pyx_t_24 = __pyx_v_k;
      __pyx_t_20 = 0;
      __pyx_v_y_l2 = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_zl2_view.data + __pyx_t_24 * __pyx_v_zl2_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2609</span>:             y_l1 = (- 1) * boundary_view[0] + (zl1_view[k] * 2 * (boundary_view[0]))</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = 0;
      __pyx_t_24 = __pyx_v_k;
      __pyx_t_19 = 0;
      __pyx_v_y_l1 = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_zl1_view.data + __pyx_t_24 * __pyx_v_zl1_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">2610</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2611</span>:             if choices_view[n, k, 0] == 0:</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = __pyx_v_n;
      __pyx_t_24 = __pyx_v_k;
      __pyx_t_20 = 0;
      __pyx_t_18 = ((*((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_19 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[2]) ))) == 0);
      if (__pyx_t_18) {
/* … */
        goto __pyx_L26;
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">2612</span>:                  # Fill bias tracea until max_rt reached</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2613</span>:                 ix1_tmp = ix + 1</pre>
<pre class='cython code score-0 '>        __pyx_v_ix1_tmp = (__pyx_v_ix + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2614</span>:                 while ix1_tmp &lt; num_draws:</pre>
<pre class='cython code score-0 '>        while (1) {
          __pyx_t_18 = (__pyx_v_ix1_tmp &lt; __pyx_v_num_draws);
          if (!__pyx_t_18) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2615</span>:                     bias_trace_l2_view[ix1_tmp] = 0.0</pre>
<pre class='cython code score-0 '>          __pyx_t_20 = __pyx_v_ix1_tmp;
          *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l2_view.data + __pyx_t_20 * __pyx_v_bias_trace_l2_view.strides[0]) )) = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2616</span>:                     bias_trace_l1_view[ix1_tmp] = 1.0</pre>
<pre class='cython code score-0 '>          __pyx_t_20 = __pyx_v_ix1_tmp;
          *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l1_view.data + __pyx_t_20 * __pyx_v_bias_trace_l1_view.strides[0]) )) = 1.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2617</span>:                     ix1_tmp += 1</pre>
<pre class='cython code score-0 '>          __pyx_v_ix1_tmp = (__pyx_v_ix1_tmp + 1);
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">2618</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2619</span>:             else: # Store intermediate choice</pre>
<pre class="cython line score-0">&#xA0;<span class="">2620</span>:                 # Fill bias tracea until max_rt reached</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2621</span>:                 ix2_tmp = ix + 1</pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_v_ix2_tmp = (__pyx_v_ix + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2622</span>:                 while ix2_tmp &lt; num_draws:</pre>
<pre class='cython code score-0 '>        while (1) {
          __pyx_t_18 = (__pyx_v_ix2_tmp &lt; __pyx_v_num_draws);
          if (!__pyx_t_18) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2623</span>:                     bias_trace_l2_view[ix2_tmp] = 1.0</pre>
<pre class='cython code score-0 '>          __pyx_t_20 = __pyx_v_ix2_tmp;
          *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l2_view.data + __pyx_t_20 * __pyx_v_bias_trace_l2_view.strides[0]) )) = 1.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2624</span>:                     bias_trace_l1_view[ix2_tmp] = 0.0</pre>
<pre class='cython code score-0 '>          __pyx_t_20 = __pyx_v_ix2_tmp;
          *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l1_view.data + __pyx_t_20 * __pyx_v_bias_trace_l1_view.strides[0]) )) = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2625</span>:                     ix2_tmp += 1</pre>
<pre class='cython code score-0 '>          __pyx_v_ix2_tmp = (__pyx_v_ix2_tmp + 1);
        }
      }
      __pyx_L26:;
</pre><pre class="cython line score-0">&#xA0;<span class="">2626</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2627</span>:             # lower level random walker (1)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2628</span>:             if (choices_view[n, k, 0] == 0) | ((n == 0) &amp; (k == 0)):</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = __pyx_v_n;
      __pyx_t_24 = __pyx_v_k;
      __pyx_t_19 = 0;
      __pyx_t_18 = (((*((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_20 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[2]) ))) == 0) | ((__pyx_v_n == 0) &amp; (__pyx_v_k == 0)));
      if (__pyx_t_18) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2629</span>:                 while (y_l1 &gt;= ((-1) * boundary_view[ix1])) and (y_l1 &lt;= boundary_view[ix1]) and (t_l1 &lt;= deadline_tmp):</pre>
<pre class='cython code score-0 '>        while (1) {
          __pyx_t_19 = __pyx_v_ix1;
          __pyx_t_25 = (__pyx_v_y_l1 &gt;= (-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))));
          if (__pyx_t_25) {
          } else {
            __pyx_t_18 = __pyx_t_25;
            goto __pyx_L34_bool_binop_done;
          }
          __pyx_t_19 = __pyx_v_ix1;
          __pyx_t_25 = (__pyx_v_y_l1 &lt;= (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) ))));
          if (__pyx_t_25) {
          } else {
            __pyx_t_18 = __pyx_t_25;
            goto __pyx_L34_bool_binop_done;
          }
          __pyx_t_25 = (__pyx_v_t_l1 &lt;= __pyx_v_deadline_tmp);
          __pyx_t_18 = __pyx_t_25;
          __pyx_L34_bool_binop_done:;
          if (!__pyx_t_18) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2630</span>:                     if (bias_trace_l1_view[ix1] &lt; 1) and (bias_trace_l1_view[ix1] &gt; 0):</pre>
<pre class='cython code score-0 '>          __pyx_t_19 = __pyx_v_ix1;
          __pyx_t_25 = ((*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l1_view.data + __pyx_t_19 * __pyx_v_bias_trace_l1_view.strides[0]) ))) &lt; 1.0);
          if (__pyx_t_25) {
          } else {
            __pyx_t_18 = __pyx_t_25;
            goto __pyx_L38_bool_binop_done;
          }
          __pyx_t_19 = __pyx_v_ix1;
          __pyx_t_25 = ((*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l1_view.data + __pyx_t_19 * __pyx_v_bias_trace_l1_view.strides[0]) ))) &gt; 0.0);
          __pyx_t_18 = __pyx_t_25;
          __pyx_L38_bool_binop_done:;
          if (__pyx_t_18) {
/* … */
            goto __pyx_L37;
          }
</pre><pre class="cython line score-0">&#xA0;<span class="">2631</span>:                         # main propagation if bias_trace is between 0 and 1 (high level choice is not yet made)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2632</span>:                         y_l1 += (((vl1_view[k] * bias_trace_l1_view[ix1] * (1 - d_view[k])) - (g_view[k] * y_l1)) * delta_t)</pre>
<pre class='cython code score-0 '>            __pyx_t_19 = __pyx_v_k;
            __pyx_t_24 = __pyx_v_ix1;
            __pyx_t_20 = __pyx_v_k;
            __pyx_t_26 = __pyx_v_k;
            __pyx_v_y_l1 = (__pyx_v_y_l1 + (((((*((float *) ( /* dim=0 */ (__pyx_v_vl1_view.data + __pyx_t_19 * __pyx_v_vl1_view.strides[0]) ))) * (*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l1_view.data + __pyx_t_24 * __pyx_v_bias_trace_l1_view.strides[0]) )))) * (1.0 - (*((float *) ( /* dim=0 */ (__pyx_v_d_view.data + __pyx_t_20 * __pyx_v_d_view.strides[0]) ))))) - ((*((float *) ( /* dim=0 */ (__pyx_v_g_view.data + __pyx_t_26 * __pyx_v_g_view.strides[0]) ))) * __pyx_v_y_l1)) * __pyx_v_delta_t));
</pre><pre class="cython line score-0">&#xA0;<span class="">2633</span>:                         # add gaussian displacement</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2634</span>:                         y_l1 += (sqrt_st * gaussian_values[m]) * s_pre_high_level_choice_view[k]</pre>
<pre class='cython code score-0 '>            __pyx_t_26 = __pyx_v_m;
            __pyx_t_20 = __pyx_v_k;
            __pyx_v_y_l1 = (__pyx_v_y_l1 + ((__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_26 * __pyx_v_gaussian_values.strides[0]) )))) * (*((float *) ( /* dim=0 */ (__pyx_v_s_pre_high_level_choice_view.data + __pyx_t_20 * __pyx_v_s_pre_high_level_choice_view.strides[0]) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">2635</span>:                     else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2636</span>:                         # main propagation if bias_trace is not between 0 and 1 (high level choice is already made)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2637</span>:                         y_l1 += (vl1_view[k] * delta_t)</pre>
<pre class='cython code score-0 '>          /*else*/ {
            __pyx_t_20 = __pyx_v_k;
            __pyx_v_y_l1 = (__pyx_v_y_l1 + ((*((float *) ( /* dim=0 */ (__pyx_v_vl1_view.data + __pyx_t_20 * __pyx_v_vl1_view.strides[0]) ))) * __pyx_v_delta_t));
</pre><pre class="cython line score-0">&#xA0;<span class="">2638</span>:                         # add gaussian displacement</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2639</span>:                         y_l1 += (sqrt_st * gaussian_values[m])</pre>
<pre class='cython code score-0 '>            __pyx_t_20 = __pyx_v_m;
            __pyx_v_y_l1 = (__pyx_v_y_l1 + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_20 * __pyx_v_gaussian_values.strides[0]) )))));
          }
          __pyx_L37:;
</pre><pre class="cython line score-0">&#xA0;<span class="">2640</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2641</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2642</span>:                     # propagate time and indices</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2643</span>:                     t_l1 += delta_t</pre>
<pre class='cython code score-0 '>          __pyx_v_t_l1 = (__pyx_v_t_l1 + __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2644</span>:                     ix1 += 1</pre>
<pre class='cython code score-0 '>          __pyx_v_ix1 = (__pyx_v_ix1 + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2645</span>:                     m += 1</pre>
<pre class='cython code score-0 '>          __pyx_v_m = (__pyx_v_m + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2646</span>:                     if m == num_draws:</pre>
<pre class='cython code score-0 '>          __pyx_t_18 = (__pyx_v_m == __pyx_v_num_draws);
          if (__pyx_t_18) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2647</span>:                         gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>            __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2647, __pyx_L1_error)</span>
            __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
            __pyx_v_gaussian_values = __pyx_t_2;
            __pyx_t_2.memview = NULL;
            __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2648</span>:                         m = 0</pre>
<pre class='cython code score-0 '>            __pyx_v_m = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2649</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2650</span>:                     if n == 0:</pre>
<pre class='cython code score-0 '>          __pyx_t_18 = (__pyx_v_n == 0);
          if (__pyx_t_18) {
/* … */
          }
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2651</span>:                         if k == 0:</pre>
<pre class='cython code score-0 '>            __pyx_t_18 = (__pyx_v_k == 0);
            if (__pyx_t_18) {
/* … */
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2652</span>:                             traj_view[ix1, 1] = y_l1</pre>
<pre class='cython code score-0 '>              __pyx_t_20 = __pyx_v_ix1;
              __pyx_t_26 = 1;
              *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_20 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_26 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y_l1;
</pre><pre class="cython line score-0">&#xA0;<span class="">2653</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2654</span>:             # lower level random walker (2)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2655</span>:             if (choices_view[n, k, 0] == 2) | ((n == 0) &amp; (k == 0)):</pre>
<pre class='cython code score-0 '>      __pyx_t_26 = __pyx_v_n;
      __pyx_t_20 = __pyx_v_k;
      __pyx_t_24 = 0;
      __pyx_t_18 = (((*((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_26 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[2]) ))) == 2) | ((__pyx_v_n == 0) &amp; (__pyx_v_k == 0)));
      if (__pyx_t_18) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2656</span>:                 while (y_l2 &gt;= ((-1) * boundary_view[ix2])) and (y_l2 &lt;= boundary_view[ix2]) and (t_l2 &lt;= deadline_tmp):</pre>
<pre class='cython code score-0 '>        while (1) {
          __pyx_t_24 = __pyx_v_ix2;
          __pyx_t_25 = (__pyx_v_y_l2 &gt;= (-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_24 * __pyx_v_boundary_view.strides[0]) )))));
          if (__pyx_t_25) {
          } else {
            __pyx_t_18 = __pyx_t_25;
            goto __pyx_L46_bool_binop_done;
          }
          __pyx_t_24 = __pyx_v_ix2;
          __pyx_t_25 = (__pyx_v_y_l2 &lt;= (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_24 * __pyx_v_boundary_view.strides[0]) ))));
          if (__pyx_t_25) {
          } else {
            __pyx_t_18 = __pyx_t_25;
            goto __pyx_L46_bool_binop_done;
          }
          __pyx_t_25 = (__pyx_v_t_l2 &lt;= __pyx_v_deadline_tmp);
          __pyx_t_18 = __pyx_t_25;
          __pyx_L46_bool_binop_done:;
          if (!__pyx_t_18) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2657</span>:                     if (bias_trace_l2_view[ix2] &lt; 1) and (bias_trace_l2_view[ix2] &gt; 0):</pre>
<pre class='cython code score-0 '>          __pyx_t_24 = __pyx_v_ix2;
          __pyx_t_25 = ((*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l2_view.data + __pyx_t_24 * __pyx_v_bias_trace_l2_view.strides[0]) ))) &lt; 1.0);
          if (__pyx_t_25) {
          } else {
            __pyx_t_18 = __pyx_t_25;
            goto __pyx_L50_bool_binop_done;
          }
          __pyx_t_24 = __pyx_v_ix2;
          __pyx_t_25 = ((*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l2_view.data + __pyx_t_24 * __pyx_v_bias_trace_l2_view.strides[0]) ))) &gt; 0.0);
          __pyx_t_18 = __pyx_t_25;
          __pyx_L50_bool_binop_done:;
          if (__pyx_t_18) {
/* … */
            goto __pyx_L49;
          }
</pre><pre class="cython line score-0">&#xA0;<span class="">2658</span>:                         # main propagation if bias_trace is between 0 and 1 (high level choice is not yet made)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2659</span>:                         y_l2 += (((vl2_view[k] * bias_trace_l2_view[ix2] * (1 - d_view[k])) - (g_view[k] * y_l2)) * delta_t)</pre>
<pre class='cython code score-0 '>            __pyx_t_24 = __pyx_v_k;
            __pyx_t_20 = __pyx_v_ix2;
            __pyx_t_26 = __pyx_v_k;
            __pyx_t_19 = __pyx_v_k;
            __pyx_v_y_l2 = (__pyx_v_y_l2 + (((((*((float *) ( /* dim=0 */ (__pyx_v_vl2_view.data + __pyx_t_24 * __pyx_v_vl2_view.strides[0]) ))) * (*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l2_view.data + __pyx_t_20 * __pyx_v_bias_trace_l2_view.strides[0]) )))) * (1.0 - (*((float *) ( /* dim=0 */ (__pyx_v_d_view.data + __pyx_t_26 * __pyx_v_d_view.strides[0]) ))))) - ((*((float *) ( /* dim=0 */ (__pyx_v_g_view.data + __pyx_t_19 * __pyx_v_g_view.strides[0]) ))) * __pyx_v_y_l2)) * __pyx_v_delta_t));
</pre><pre class="cython line score-0">&#xA0;<span class="">2660</span>:                         # add gaussian displacement</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2661</span>:                         y_l2 += (sqrt_st * gaussian_values[m]) * s_pre_high_level_choice_view[k]</pre>
<pre class='cython code score-0 '>            __pyx_t_19 = __pyx_v_m;
            __pyx_t_26 = __pyx_v_k;
            __pyx_v_y_l2 = (__pyx_v_y_l2 + ((__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_19 * __pyx_v_gaussian_values.strides[0]) )))) * (*((float *) ( /* dim=0 */ (__pyx_v_s_pre_high_level_choice_view.data + __pyx_t_26 * __pyx_v_s_pre_high_level_choice_view.strides[0]) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">2662</span>:                     else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2663</span>:                         # main propagation if bias_trace is not between 0 and 1 (high level choice is already made)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2664</span>:                         y_l2 += (vl2_view[k] * delta_t)</pre>
<pre class='cython code score-0 '>          /*else*/ {
            __pyx_t_26 = __pyx_v_k;
            __pyx_v_y_l2 = (__pyx_v_y_l2 + ((*((float *) ( /* dim=0 */ (__pyx_v_vl2_view.data + __pyx_t_26 * __pyx_v_vl2_view.strides[0]) ))) * __pyx_v_delta_t));
</pre><pre class="cython line score-0">&#xA0;<span class="">2665</span>:                         # add gaussian displacement</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2666</span>:                         y_l2 += (sqrt_st * gaussian_values[m])</pre>
<pre class='cython code score-0 '>            __pyx_t_26 = __pyx_v_m;
            __pyx_v_y_l2 = (__pyx_v_y_l2 + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_26 * __pyx_v_gaussian_values.strides[0]) )))));
          }
          __pyx_L49:;
</pre><pre class="cython line score-0">&#xA0;<span class="">2667</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2668</span>:                     # propagate time and indices</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2669</span>:                     t_l2 += delta_t</pre>
<pre class='cython code score-0 '>          __pyx_v_t_l2 = (__pyx_v_t_l2 + __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2670</span>:                     ix2 += 1</pre>
<pre class='cython code score-0 '>          __pyx_v_ix2 = (__pyx_v_ix2 + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2671</span>:                     m += 1</pre>
<pre class='cython code score-0 '>          __pyx_v_m = (__pyx_v_m + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2672</span>:                     if m == num_draws:</pre>
<pre class='cython code score-0 '>          __pyx_t_18 = (__pyx_v_m == __pyx_v_num_draws);
          if (__pyx_t_18) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2673</span>:                         gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>            __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2673, __pyx_L1_error)</span>
            __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
            __pyx_v_gaussian_values = __pyx_t_2;
            __pyx_t_2.memview = NULL;
            __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2674</span>:                         m = 0</pre>
<pre class='cython code score-0 '>            __pyx_v_m = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2675</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2676</span>:                     if n == 0:</pre>
<pre class='cython code score-0 '>          __pyx_t_18 = (__pyx_v_n == 0);
          if (__pyx_t_18) {
/* … */
          }
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2677</span>:                         if k == 0:</pre>
<pre class='cython code score-0 '>            __pyx_t_18 = (__pyx_v_k == 0);
            if (__pyx_t_18) {
/* … */
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2678</span>:                             traj_view[ix2, 2] = y_l2</pre>
<pre class='cython code score-0 '>              __pyx_t_26 = __pyx_v_ix2;
              __pyx_t_19 = 2;
              *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_26 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_19 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y_l2;
</pre><pre class="cython line score-0">&#xA0;<span class="">2679</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2680</span>:             # Get back to single y_l and t_l</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2681</span>:             if (choices_view[n, k, 0] == 0):</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = __pyx_v_n;
      __pyx_t_26 = __pyx_v_k;
      __pyx_t_20 = 0;
      __pyx_t_18 = ((*((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_19 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_26 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[2]) ))) == 0);
      if (__pyx_t_18) {
/* … */
        goto __pyx_L55;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2682</span>:                 t_l = t_l1</pre>
<pre class='cython code score-0 '>        __pyx_v_t_l = __pyx_v_t_l1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2683</span>:                 y_l = y_l1</pre>
<pre class='cython code score-0 '>        __pyx_v_y_l = __pyx_v_y_l1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2684</span>:                 ix_l = ix1</pre>
<pre class='cython code score-0 '>        __pyx_v_ix_l = __pyx_v_ix1;
</pre><pre class="cython line score-0">&#xA0;<span class="">2685</span>:             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2686</span>:                 t_l = t_l2</pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_v_t_l = __pyx_v_t_l2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2687</span>:                 y_l = y_l2</pre>
<pre class='cython code score-0 '>        __pyx_v_y_l = __pyx_v_y_l2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2688</span>:                 ix_l = ix2</pre>
<pre class='cython code score-0 '>        __pyx_v_ix_l = __pyx_v_ix2;
      }
      __pyx_L55:;
</pre><pre class="cython line score-0">&#xA0;<span class="">2689</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2690</span>:             if smooth:</pre>
<pre class='cython code score-2 '>      __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_smooth); if (unlikely((__pyx_t_18 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2690, __pyx_L1_error)</span>
      if (__pyx_t_18) {
/* … */
        goto __pyx_L56;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2691</span>:                 if t_h == 0.0:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (__pyx_v_t_h == 0.0);
        if (__pyx_t_18) {
/* … */
          goto __pyx_L57;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2692</span>:                     smooth_u = random_uniform() * 0.5 * delta_t</pre>
<pre class='cython code score-5 '>          __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2692, __pyx_L1_error)</span>
          __pyx_v_smooth_u = ((__pyx_t_23 * 0.5) * __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2693</span>:                 elif fmax(t_h, t_l) &lt; deadline_tmp:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (fmax(__pyx_v_t_h, __pyx_v_t_l) &lt; __pyx_v_deadline_tmp);
        if (__pyx_t_18) {
/* … */
          goto __pyx_L57;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2694</span>:                     smooth_u = (0.5 - random_uniform()) * delta_t</pre>
<pre class='cython code score-5 '>          __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2694, __pyx_L1_error)</span>
          __pyx_v_smooth_u = ((0.5 - __pyx_t_23) * __pyx_v_delta_t);
</pre><pre class="cython line score-0">&#xA0;<span class="">2695</span>:                 else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2696</span>:                     smooth_u = 0.0</pre>
<pre class='cython code score-0 '>        /*else*/ {
          __pyx_v_smooth_u = 0.0;
        }
        __pyx_L57:;
</pre><pre class="cython line score-0">&#xA0;<span class="">2697</span>:             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2698</span>:                 smooth_u = 0.0</pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_v_smooth_u = 0.0;
      }
      __pyx_L56:;
</pre><pre class="cython line score-0">&#xA0;<span class="">2699</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2700</span>:             rts_view[n, k, 0] = fmax(t_h, t_l) + t_view[k]</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = __pyx_v_k;
      __pyx_t_26 = __pyx_v_n;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_24 = 0;
      *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_26 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_19 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_24 * __pyx_v_rts_view.strides[2]) )) = (fmax(__pyx_v_t_h, __pyx_v_t_l) + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_20 * __pyx_v_t_view.strides[0]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2701</span>:             rts_high_view[n, k, 0] = t_h + t_view[k]</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = __pyx_v_k;
      __pyx_t_24 = __pyx_v_n;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_26 = 0;
      *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_high_view.data + __pyx_t_24 * __pyx_v_rts_high_view.strides[0]) ) + __pyx_t_19 * __pyx_v_rts_high_view.strides[1]) ) + __pyx_t_26 * __pyx_v_rts_high_view.strides[2]) )) = (__pyx_v_t_h + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_20 * __pyx_v_t_view.strides[0]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2702</span>:             rts_low_view[n, k, 0] = t_l + t_view[k]</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = __pyx_v_k;
      __pyx_t_26 = __pyx_v_n;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_24 = 0;
      *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_low_view.data + __pyx_t_26 * __pyx_v_rts_low_view.strides[0]) ) + __pyx_t_19 * __pyx_v_rts_low_view.strides[1]) ) + __pyx_t_24 * __pyx_v_rts_low_view.strides[2]) )) = (__pyx_v_t_l + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_20 * __pyx_v_t_view.strides[0]) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">2703</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2704</span>:             # The probability of making a 'mistake' 1 - (relative y position)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2705</span>:             # y at upper bound --&gt; choices_view[n, k, 0] add one deterministically</pre>
<pre class="cython line score-0">&#xA0;<span class="">2706</span>:             # y at lower bound --&gt; choice_view[n, k, 0] stays the same deterministically</pre>
<pre class="cython line score-0">&#xA0;<span class="">2707</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2708</span>:             # If boundary is negative (or 0) already, we flip a coin</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2709</span>:             if boundary_view[ix] &lt;= 0:</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = __pyx_v_ix;
      __pyx_t_18 = ((*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) ))) &lt;= 0.0);
      if (__pyx_t_18) {
/* … */
        goto __pyx_L58;
      }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2710</span>:                 if random_uniform() &lt;= 0.5:</pre>
<pre class='cython code score-5 '>        __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2710, __pyx_L1_error)</span>
        __pyx_t_18 = (__pyx_t_23 &lt;= 0.5);
        if (__pyx_t_18) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2711</span>:                     choices_view[n, k, 0] += 1</pre>
<pre class='cython code score-0 '>          __pyx_t_20 = __pyx_v_n;
          __pyx_t_24 = __pyx_v_k;
          __pyx_t_19 = 0;
          *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_20 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[2]) )) += 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">2712</span>:             # Otherwise apply rule from above</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2713</span>:             elif random_uniform() &lt;= ((y_l + boundary_view[ix_l]) / (2 * boundary_view[ix_l])):</pre>
<pre class='cython code score-5 '>      __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2713, __pyx_L1_error)</span>
      __pyx_t_19 = __pyx_v_ix_l;
      __pyx_t_24 = __pyx_v_ix_l;
      __pyx_t_18 = (__pyx_t_23 &lt;= ((__pyx_v_y_l + (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))) / (2.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_24 * __pyx_v_boundary_view.strides[0]) ))))));
      if (__pyx_t_18) {
/* … */
      }
      __pyx_L58:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2714</span>:                 choices_view[n, k, 0] += 1</pre>
<pre class='cython code score-0 '>        __pyx_t_24 = __pyx_v_n;
        __pyx_t_19 = __pyx_v_k;
        __pyx_t_20 = 0;
        *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_24 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[2]) )) += 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">2715</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2716</span>:             if (rts_view[n, k, 0] &gt;= deadline_view[k]) | (deadline_view[k] &lt;= 0):</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = __pyx_v_n;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_24 = 0;
      __pyx_t_26 = __pyx_v_k;
      __pyx_t_27 = __pyx_v_k;
      __pyx_t_18 = (((*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_20 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_19 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_24 * __pyx_v_rts_view.strides[2]) ))) &gt;= (*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_26 * __pyx_v_deadline_view.strides[0]) )))) | ((*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_27 * __pyx_v_deadline_view.strides[0]) ))) &lt;= 0.0));
      if (__pyx_t_18) {
/* … */
      }
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2717</span>:                 rts_view[n, k, 0] = -999</pre>
<pre class='cython code score-0 '>        __pyx_t_27 = __pyx_v_n;
        __pyx_t_26 = __pyx_v_k;
        __pyx_t_24 = 0;
        *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_27 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_26 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_24 * __pyx_v_rts_view.strides[2]) )) = -999.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2718</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2719</span>:     if return_option == 'full':</pre>
<pre class='cython code score-2 '>  __pyx_t_18 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_return_option, __pyx_n_u_full, Py_EQ)); if (unlikely((__pyx_t_18 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2719, __pyx_L1_error)</span>
  if (__pyx_t_18) {
/* … */
  }
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2720</span>:         return {'rts': rts, 'choices': choices, 'rts_high': rts_high, 'rts_low': rts_low,</pre>
<pre class='cython code score-23 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2720, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2720, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2720, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_rts_high, __pyx_v_rts_high) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2720, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_rts_low, __pyx_v_rts_low) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2720, __pyx_L1_error)</span>
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2721</span>:                 'metadata': {'vh': vh,</pre>
<pre class='cython code score-7 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(12);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2721, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_vh, ((PyObject *)__pyx_v_vh)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2721, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2722</span>:                             'vl1': vl1,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_vl1, ((PyObject *)__pyx_v_vl1)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2721, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2723</span>:                             'vl2': vl2,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_vl2, ((PyObject *)__pyx_v_vl2)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2721, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2724</span>:                             'a': a,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2721, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2725</span>:                             'zh': zh,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_zh, ((PyObject *)__pyx_v_zh)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2721, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2726</span>:                             'zl1': zl1,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_zl1, ((PyObject *)__pyx_v_zl1)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2721, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2727</span>:                             'zl2': zl2,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_zl2, ((PyObject *)__pyx_v_zl2)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2721, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2728</span>:                             'd': d,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_d, ((PyObject *)__pyx_v_d)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2721, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2729</span>:                             't': t,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2721, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2730</span>:                             'deadline': deadline,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_deadline, ((PyObject *)__pyx_v_deadline)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2721, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2731</span>:                             's_pre_high_level_choice': s_pre_high_level_choice,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_s_pre_high_level_choice, ((PyObject *)__pyx_v_s_pre_high_level_choice)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2721, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2732</span>:                             's': s,</pre>
<pre class='cython code score-11 '>    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_s);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2732, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_s, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2721, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_10 = __pyx_t_6;
    __pyx_t_6 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2733</span>:                             **boundary_params,</pre>
<pre class='cython code score-17 '>    if (unlikely(__pyx_v_boundary_params == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
      <span class='error_goto'>__PYX_ERR(0, 2733, __pyx_L1_error)</span>
    }
    if (unlikely(<span class='py_c_api'>PyDict_Update</span>(__pyx_t_10, __pyx_v_boundary_params) &lt; 0)) {
      if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseMappingExpectedError</span>(__pyx_v_boundary_params);
      <span class='error_goto'>__PYX_ERR(0, 2733, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2734</span>:                             'delta_t': delta_t,</pre>
<pre class='cython code score-11 '>    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_t);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2734, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_delta_t, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2734, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2735</span>:                             'max_t': max_t,</pre>
<pre class='cython code score-11 '>    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_max_t);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2735, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_max_t, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2735, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2736</span>:                             'n_samples': n_samples,</pre>
<pre class='cython code score-8 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2736, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_n_samples, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2736, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2737</span>:                             'n_trials': n_trials,</pre>
<pre class='cython code score-13 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2737, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_n_trials, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2737, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_simulator, __pyx_n_u_ddm_flexbound_mic2_adj) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2738, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">2738</span>:                             'simulator': 'ddm_flexbound_mic2_adj',</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2739</span>:                             'boundary_fun_type': boundary_fun.__name__,</pre>
<pre class='cython code score-8 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_boundary_fun, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2739, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_boundary_fun_type, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2739, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2740</span>:                             'possible_choices': [0, 1, 2, 3],</pre>
<pre class='cython code score-23 '>    __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2740, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 0, __pyx_int_0)) <span class='error_goto'>__PYX_ERR(0, 2740, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 2740, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 2, __pyx_int_2)) <span class='error_goto'>__PYX_ERR(0, 2740, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 3, __pyx_int_3)) <span class='error_goto'>__PYX_ERR(0, 2740, __pyx_L1_error)</span>;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_possible_choices, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2740, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2741</span>:                             'trajectory': traj,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_trajectory, __pyx_v_traj) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2741, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2742</span>:                             'boundary': boundary}}</pre>
<pre class='cython code score-11 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_boundary, __pyx_v_boundary) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2742, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_metadata, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2720, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_r = __pyx_t_5;
    __pyx_t_5 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2743</span>:     elif return_option == 'minimal':</pre>
<pre class='cython code score-2 '>  __pyx_t_18 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_return_option, __pyx_n_u_minimal, Py_EQ)); if (unlikely((__pyx_t_18 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2743, __pyx_L1_error)</span>
  if (likely(__pyx_t_18)) {
/* … */
  }
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2744</span>:         return {'rts': rts, 'choices': choices, 'rts_high': rts_high, 'rts_low': rts_low,</pre>
<pre class='cython code score-23 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2744, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2744, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2744, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_rts_high, __pyx_v_rts_high) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2744, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_rts_low, __pyx_v_rts_low) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2744, __pyx_L1_error)</span>
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2745</span>:                 'metadata': {'simulator': 'ddm_flexbound_mic2_adj',</pre>
<pre class='cython code score-7 '>    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2745, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_simulator, __pyx_n_u_ddm_flexbound_mic2_adj) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2745, __pyx_L1_error)</span>
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2746</span>:                              'possible_choices': [0, 1, 2, 3],</pre>
<pre class='cython code score-23 '>    __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2746, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 0, __pyx_int_0)) <span class='error_goto'>__PYX_ERR(0, 2746, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 2746, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 2, __pyx_int_2)) <span class='error_goto'>__PYX_ERR(0, 2746, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 3, __pyx_int_3)) <span class='error_goto'>__PYX_ERR(0, 2746, __pyx_L1_error)</span>;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_possible_choices, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2745, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2747</span>:                              'boundary_fun_type': boundary_fun.__name__,</pre>
<pre class='cython code score-8 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_boundary_fun, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2747, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_boundary_fun_type, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2745, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2748</span>:                              'n_samples': n_samples,</pre>
<pre class='cython code score-8 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2748, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_n_samples, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2745, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2749</span>:                              'n_trials': n_trials,</pre>
<pre class='cython code score-14 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2749, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_n_trials, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2745, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_metadata, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2744, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_r = __pyx_t_5;
    __pyx_t_5 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2750</span>:                              }}</pre>
<pre class="cython line score-0">&#xA0;<span class="">2751</span>:     else:</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2752</span>:         raise ValueError('return_option must be either "full" or "minimal"')</pre>
<pre class='cython code score-5 '>  /*else*/ {
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2752, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_5, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='error_goto'>__PYX_ERR(0, 2752, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">2753</span>: # ----------------------------------------------------------------------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2754</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2755</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2756</span>: # Simulate (rt, choice) tuples from: DDM WITH FLEXIBLE BOUNDARIES ------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2757</span>: # @cythonboundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2758</span>: # @cythonwraparound(False)</pre>
<pre class="cython line score-175" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2759</span>: def ddm_flexbound_mic2_multinoise(np.ndarray[float, ndim = 1] vh,</pre>
<pre class='cython code score-175 '>static PyObject *__pyx_pf_4cssm_68__defaults__(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_r = NULL;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
/* … */
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(12);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2759, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 2, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 3, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 4, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_True));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_True));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 5, ((PyObject *)Py_True))) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 6, Py_None)) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_True));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_True));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 7, ((PyObject *)Py_True))) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults11, __pyx_self)-&gt;__pyx_arg_boundary_params);
  <span class='refnanny'>__Pyx_GIVEREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults11, __pyx_self)-&gt;__pyx_arg_boundary_params);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 8, <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults11, __pyx_self)-&gt;__pyx_arg_boundary_params)) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 9, Py_None)) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject*)__pyx_n_u_full));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject*)__pyx_n_u_full));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 10, ((PyObject*)__pyx_n_u_full))) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_False));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_False));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 11, ((PyObject *)Py_False))) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2759, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 1, Py_None)) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L1_error)</span>;
  __pyx_t_6 = 0;
  __pyx_r = __pyx_t_5;
  __pyx_t_5 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.__defaults__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_4cssm_31ddm_flexbound_mic2_multinoise(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_4cssm_31ddm_flexbound_mic2_multinoise = {"ddm_flexbound_mic2_multinoise", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_4cssm_31ddm_flexbound_mic2_multinoise, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_4cssm_31ddm_flexbound_mic2_multinoise(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyArrayObject *__pyx_v_vh = 0;
  PyArrayObject *__pyx_v_vl1 = 0;
  PyArrayObject *__pyx_v_vl2 = 0;
  PyArrayObject *__pyx_v_a = 0;
  PyArrayObject *__pyx_v_zh = 0;
  PyArrayObject *__pyx_v_zl1 = 0;
  PyArrayObject *__pyx_v_zl2 = 0;
  PyArrayObject *__pyx_v_d = 0;
  PyArrayObject *__pyx_v_t = 0;
  PyArrayObject *__pyx_v_deadline = 0;
  float __pyx_v_s;
  float __pyx_v_delta_t;
  float __pyx_v_max_t;
  int __pyx_v_n_samples;
  int __pyx_v_n_trials;
  CYTHON_UNUSED PyObject *__pyx_v_print_info = 0;
  PyObject *__pyx_v_boundary_fun = 0;
  PyObject *__pyx_v_boundary_multiplicative = 0;
  PyObject *__pyx_v_boundary_params = 0;
  PyObject *__pyx_v_random_state = 0;
  PyObject *__pyx_v_return_option = 0;
  PyObject *__pyx_v_smooth = 0;
  CYTHON_UNUSED PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("ddm_flexbound_mic2_multinoise (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_vh,&amp;__pyx_n_s_vl1,&amp;__pyx_n_s_vl2,&amp;__pyx_n_s_a,&amp;__pyx_n_s_zh,&amp;__pyx_n_s_zl1,&amp;__pyx_n_s_zl2,&amp;__pyx_n_s_d,&amp;__pyx_n_s_t,&amp;__pyx_n_s_deadline,&amp;__pyx_n_s_s,&amp;__pyx_n_s_delta_t,&amp;__pyx_n_s_max_t,&amp;__pyx_n_s_n_samples,&amp;__pyx_n_s_n_trials,&amp;__pyx_n_s_print_info,&amp;__pyx_n_s_boundary_fun,&amp;__pyx_n_s_boundary_multiplicative,&amp;__pyx_n_s_boundary_params,&amp;__pyx_n_s_random_state,&amp;__pyx_n_s_return_option,&amp;__pyx_n_s_smooth,0};
  PyObject* values[22] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    __pyx_defaults11 *__pyx_dynamic_args = <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults11, __pyx_self);
    values[15] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_True)));
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs);
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4cssm_30ddm_flexbound_mic2_multinoise(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_vh, PyArrayObject *__pyx_v_vl1, PyArrayObject *__pyx_v_vl2, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_zh, PyArrayObject *__pyx_v_zl1, PyArrayObject *__pyx_v_zl2, PyArrayObject *__pyx_v_d, PyArrayObject *__pyx_v_t, PyArrayObject *__pyx_v_deadline, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, CYTHON_UNUSED PyObject *__pyx_v_print_info, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state, PyObject *__pyx_v_return_option, PyObject *__pyx_v_smooth, CYTHON_UNUSED PyObject *__pyx_v_kwargs) {
  __Pyx_memviewslice __pyx_v_vh_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_vl1_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_vl2_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_a_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_zh_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_zl1_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_zl2_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_d_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_t_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_deadline_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_rts = NULL;
  PyObject *__pyx_v_choices = NULL;
  PyObject *__pyx_v_rts_low = NULL;
  PyObject *__pyx_v_rts_high = NULL;
  __Pyx_memviewslice __pyx_v_rts_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_rts_high_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_rts_low_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_choices_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_traj = NULL;
  __Pyx_memviewslice __pyx_v_traj_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  float __pyx_v_delta_t_sqrt;
  float __pyx_v_sqrt_st;
  int __pyx_v_num_draws;
  PyObject *__pyx_v_t_s = NULL;
  PyObject *__pyx_v_boundary = NULL;
  __Pyx_memviewslice __pyx_v_boundary_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_bias_trace_l1 = NULL;
  PyObject *__pyx_v_bias_trace_l2 = NULL;
  __Pyx_memviewslice __pyx_v_bias_trace_l1_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_bias_trace_l2_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  float __pyx_v_y_h;
  float __pyx_v_y_l;
  float __pyx_v_y_l1;
  float __pyx_v_y_l2;
  float __pyx_v_t_h;
  float __pyx_v_t_l;
  float __pyx_v_t_l1;
  float __pyx_v_t_l2;
  CYTHON_UNUSED float __pyx_v_smooth_u;
  float __pyx_v_deadline_tmp;
  Py_ssize_t __pyx_v_n;
  Py_ssize_t __pyx_v_ix;
  Py_ssize_t __pyx_v_ix1;
  Py_ssize_t __pyx_v_ix2;
  CYTHON_UNUSED Py_ssize_t __pyx_v_ix_l;
  Py_ssize_t __pyx_v_ix1_tmp;
  Py_ssize_t __pyx_v_ix2_tmp;
  Py_ssize_t __pyx_v_k;
  Py_ssize_t __pyx_v_m;
  __Pyx_memviewslice __pyx_v_gaussian_values = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_boundary_params_tmp = NULL;
  PyObject *__pyx_9genexpr12__pyx_v_key = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_a;
  __Pyx_Buffer __pyx_pybuffer_a;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_d;
  __Pyx_Buffer __pyx_pybuffer_d;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_deadline;
  __Pyx_Buffer __pyx_pybuffer_deadline;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_t;
  __Pyx_Buffer __pyx_pybuffer_t;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_vh;
  __Pyx_Buffer __pyx_pybuffer_vh;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_vl1;
  __Pyx_Buffer __pyx_pybuffer_vl1;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_vl2;
  __Pyx_Buffer __pyx_pybuffer_vl2;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_zh;
  __Pyx_Buffer __pyx_pybuffer_zh;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_zl1;
  __Pyx_Buffer __pyx_pybuffer_zl1;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_zl2;
  __Pyx_Buffer __pyx_pybuffer_zl2;
  PyObject *__pyx_r = NULL;
  __pyx_pybuffer_vh.pybuffer.buf = NULL;
  __pyx_pybuffer_vh.refcount = 0;
  __pyx_pybuffernd_vh.data = NULL;
  __pyx_pybuffernd_vh.rcbuffer = &amp;__pyx_pybuffer_vh;
  __pyx_pybuffer_vl1.pybuffer.buf = NULL;
  __pyx_pybuffer_vl1.refcount = 0;
  __pyx_pybuffernd_vl1.data = NULL;
  __pyx_pybuffernd_vl1.rcbuffer = &amp;__pyx_pybuffer_vl1;
  __pyx_pybuffer_vl2.pybuffer.buf = NULL;
  __pyx_pybuffer_vl2.refcount = 0;
  __pyx_pybuffernd_vl2.data = NULL;
  __pyx_pybuffernd_vl2.rcbuffer = &amp;__pyx_pybuffer_vl2;
  __pyx_pybuffer_a.pybuffer.buf = NULL;
  __pyx_pybuffer_a.refcount = 0;
  __pyx_pybuffernd_a.data = NULL;
  __pyx_pybuffernd_a.rcbuffer = &amp;__pyx_pybuffer_a;
  __pyx_pybuffer_zh.pybuffer.buf = NULL;
  __pyx_pybuffer_zh.refcount = 0;
  __pyx_pybuffernd_zh.data = NULL;
  __pyx_pybuffernd_zh.rcbuffer = &amp;__pyx_pybuffer_zh;
  __pyx_pybuffer_zl1.pybuffer.buf = NULL;
  __pyx_pybuffer_zl1.refcount = 0;
  __pyx_pybuffernd_zl1.data = NULL;
  __pyx_pybuffernd_zl1.rcbuffer = &amp;__pyx_pybuffer_zl1;
  __pyx_pybuffer_zl2.pybuffer.buf = NULL;
  __pyx_pybuffer_zl2.refcount = 0;
  __pyx_pybuffernd_zl2.data = NULL;
  __pyx_pybuffernd_zl2.rcbuffer = &amp;__pyx_pybuffer_zl2;
  __pyx_pybuffer_d.pybuffer.buf = NULL;
  __pyx_pybuffer_d.refcount = 0;
  __pyx_pybuffernd_d.data = NULL;
  __pyx_pybuffernd_d.rcbuffer = &amp;__pyx_pybuffer_d;
  __pyx_pybuffer_t.pybuffer.buf = NULL;
  __pyx_pybuffer_t.refcount = 0;
  __pyx_pybuffernd_t.data = NULL;
  __pyx_pybuffernd_t.rcbuffer = &amp;__pyx_pybuffer_t;
  __pyx_pybuffer_deadline.pybuffer.buf = NULL;
  __pyx_pybuffer_deadline.refcount = 0;
  __pyx_pybuffernd_deadline.data = NULL;
  __pyx_pybuffernd_deadline.rcbuffer = &amp;__pyx_pybuffer_deadline;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_vh, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_vh.diminfo[0].strides = __pyx_pybuffernd_vh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_vh.diminfo[0].shape = __pyx_pybuffernd_vh.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vl1.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_vl1, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_vl1.diminfo[0].strides = __pyx_pybuffernd_vl1.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_vl1.diminfo[0].shape = __pyx_pybuffernd_vl1.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vl2.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_vl2, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_vl2.diminfo[0].strides = __pyx_pybuffernd_vl2.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_vl2.diminfo[0].shape = __pyx_pybuffernd_vl2.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_a, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_zh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_zh, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_zh.diminfo[0].strides = __pyx_pybuffernd_zh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_zh.diminfo[0].shape = __pyx_pybuffernd_zh.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_zl1.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_zl1, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_zl1.diminfo[0].strides = __pyx_pybuffernd_zl1.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_zl1.diminfo[0].shape = __pyx_pybuffernd_zl1.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_zl2.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_zl2, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_zl2.diminfo[0].strides = __pyx_pybuffernd_zl2.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_zl2.diminfo[0].shape = __pyx_pybuffernd_zl2.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_d.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_d, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_d.diminfo[0].strides = __pyx_pybuffernd_d.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_d.diminfo[0].shape = __pyx_pybuffernd_d.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_t, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_t.diminfo[0].strides = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_t.diminfo[0].shape = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_deadline, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_deadline.diminfo[0].strides = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_deadline.diminfo[0].shape = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.shape[0];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_2, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_7, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_9, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_d.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vh.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vl1.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vl2.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zh.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zl1.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zl2.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.ddm_flexbound_mic2_multinoise", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_d.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vl1.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vl2.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zl1.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zl2.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_vh_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_vl1_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_vl2_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_a_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_zh_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_zl1_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_zl2_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_d_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_t_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_deadline_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_choices);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rts_low);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rts_high);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_rts_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_rts_high_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_rts_low_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_choices_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_traj);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_traj_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t_s);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_boundary);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_boundary_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_bias_trace_l1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_bias_trace_l2);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_bias_trace_l1_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_bias_trace_l2_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_boundary_params_tmp);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_9genexpr12__pyx_v_key);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__53 = <span class='py_c_api'>PyTuple_Pack</span>(79, __pyx_n_s_vh, __pyx_n_s_vl1, __pyx_n_s_vl2, __pyx_n_s_a, __pyx_n_s_zh, __pyx_n_s_zl1, __pyx_n_s_zl2, __pyx_n_s_d, __pyx_n_s_t, __pyx_n_s_deadline, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_print_info, __pyx_n_s_boundary_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_random_state, __pyx_n_s_return_option, __pyx_n_s_smooth, __pyx_n_s_kwargs, __pyx_n_s_vh_view, __pyx_n_s_vl1_view, __pyx_n_s_vl2_view, __pyx_n_s_a_view, __pyx_n_s_zh_view, __pyx_n_s_zl1_view, __pyx_n_s_zl2_view, __pyx_n_s_d_view, __pyx_n_s_t_view, __pyx_n_s_deadline_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_low, __pyx_n_s_rts_high, __pyx_n_s_rts_view, __pyx_n_s_rts_high_view, __pyx_n_s_rts_low_view, __pyx_n_s_choices_view, __pyx_n_s_traj, __pyx_n_s_traj_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_num_draws, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_boundary_view, __pyx_n_s_bias_trace_l1, __pyx_n_s_bias_trace_l2, __pyx_n_s_bias_trace_l1_view, __pyx_n_s_bias_trace_l2_view, __pyx_n_s_y_h, __pyx_n_s_y_l, __pyx_n_s_y_l1, __pyx_n_s_y_l2, __pyx_n_s_v_l, __pyx_n_s_v_l1, __pyx_n_s_v_l2, __pyx_n_s_t_h, __pyx_n_s_t_l, __pyx_n_s_t_l1, __pyx_n_s_t_l2, __pyx_n_s_smooth_u, __pyx_n_s_deadline_tmp, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_ix1, __pyx_n_s_ix2, __pyx_n_s_ix_l, __pyx_n_s_ix_tmp, __pyx_n_s_ix1_tmp, __pyx_n_s_ix2_tmp, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_gaussian_values, __pyx_n_s_boundary_params_tmp, __pyx_n_s_key);<span class='error_goto'> if (unlikely(!__pyx_tuple__53)) __PYX_ERR(0, 2759, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__53);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__53);
/* … */
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_4cssm_31ddm_flexbound_mic2_multinoise, 0, __pyx_n_s_ddm_flexbound_mic2_multinoise, NULL, __pyx_n_s_cssm, __pyx_d, ((PyObject *)__pyx_codeobj__54));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2759, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (!<span class='pyx_c_api'>__Pyx_CyFunction_InitDefaults</span>(__pyx_t_5, sizeof(__pyx_defaults11), 1)) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L1_error)</span>
  __pyx_codeobj__54 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(22, 0, 0, 79, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__53, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_ddm_flexbound_mic2_multinoise, 2759, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__54)) __PYX_ERR(0, 2759, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">2760</span>:                                   np.ndarray[float, ndim = 1] vl1,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2761</span>:                                   np.ndarray[float, ndim = 1] vl2,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2762</span>:                                   np.ndarray[float, ndim = 1] a,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2763</span>:                                   np.ndarray[float, ndim = 1] zh,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2764</span>:                                   np.ndarray[float, ndim = 1] zl1,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2765</span>:                                   np.ndarray[float, ndim = 1] zl2,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2766</span>:                                   np.ndarray[float, ndim = 1] d, # damper (1 --&gt; no drift on low level until high level done, 0 --&gt; full drift on low level)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2767</span>:                                   np.ndarray[float, ndim = 1] t,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2768</span>:                                   np.ndarray[float, ndim = 1] deadline,</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2769</span>:                                   float s = 1.0,</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(((double)1.0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2769, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2770</span>:                                   float delta_t = 0.001,</pre>
<pre class='cython code score-5 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(((double)0.001));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2770, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2771</span>:                                   float max_t = 20,</pre>
<pre class='cython code score-5 '>  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)20.0));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2771, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2772</span>:                                   int n_samples = 20000,</pre>
<pre class='cython code score-2 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)0x4E20));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2772, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2773</span>:                                   int n_trials = 1,</pre>
<pre class='cython code score-2 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)1));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2773, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
</pre><pre class="cython line score-0">&#xA0;<span class="">2774</span>:                                   print_info = True,</pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2775</span>:                                   boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)</pre>
<pre class='cython code score-6 '>    values[16] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[17] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_True)));
    values[18] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(__pyx_dynamic_args-&gt;__pyx_arg_boundary_params);
</pre><pre class="cython line score-0">&#xA0;<span class="">2776</span>:                                   boundary_multiplicative = True,</pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2777</span>:                                   boundary_params = {},</pre>
<pre class='cython code score-12 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2777, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults11, __pyx_t_5)-&gt;__pyx_arg_boundary_params = __pyx_t_4;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_4 = 0;
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsGetter</span>(__pyx_t_5, __pyx_pf_4cssm_68__defaults__);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_ddm_flexbound_mic2_multinoise, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-385" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2778</span>:                                   random_state = None,</pre>
<pre class='cython code score-385 '>    values[19] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[20] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_full)));
    values[21] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case 22: values[21] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 21);
        CYTHON_FALLTHROUGH;
        case 21: values[20] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 20);
        CYTHON_FALLTHROUGH;
        case 20: values[19] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 19);
        CYTHON_FALLTHROUGH;
        case 19: values[18] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 18);
        CYTHON_FALLTHROUGH;
        case 18: values[17] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 17);
        CYTHON_FALLTHROUGH;
        case 17: values[16] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 16);
        CYTHON_FALLTHROUGH;
        case 16: values[15] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 15);
        CYTHON_FALLTHROUGH;
        case 15: values[14] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_vh)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_vl1)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_multinoise", 0, 10, 22, 1); <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_vl2)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_multinoise", 0, 10, 22, 2); <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_a)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[3]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_multinoise", 0, 10, 22, 3); <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_zh)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[4]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_multinoise", 0, 10, 22, 4); <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_zl1)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[5]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_multinoise", 0, 10, 22, 5); <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_zl2)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[6]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_multinoise", 0, 10, 22, 6); <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (likely((values[7] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_d)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[7]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_multinoise", 0, 10, 22, 7); <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (likely((values[8] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_t)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[8]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_multinoise", 0, 10, 22, 8); <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  9:
        if (likely((values[9] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_deadline)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[9]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_multinoise", 0, 10, 22, 9); <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 10:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_s);
          if (value) { values[10] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 11:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_delta_t);
          if (value) { values[11] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 12:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_max_t);
          if (value) { values[12] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 13:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_samples);
          if (value) { values[13] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 14:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_trials);
          if (value) { values[14] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 15:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_print_info);
          if (value) { values[15] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 16:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_fun);
          if (value) { values[16] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 17:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_multiplicative);
          if (value) { values[17] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 18:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_params);
          if (value) { values[18] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 19:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_random_state);
          if (value) { values[19] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 20:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_return_option);
          if (value) { values[20] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 21:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_smooth);
          if (value) { values[21] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values + 0, kwd_pos_args, "ddm_flexbound_mic2_multinoise") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case 22: values[21] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 21);
        CYTHON_FALLTHROUGH;
        case 21: values[20] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 20);
        CYTHON_FALLTHROUGH;
        case 20: values[19] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 19);
        CYTHON_FALLTHROUGH;
        case 19: values[18] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 18);
        CYTHON_FALLTHROUGH;
        case 18: values[17] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 17);
        CYTHON_FALLTHROUGH;
        case 17: values[16] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 16);
        CYTHON_FALLTHROUGH;
        case 16: values[15] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 15);
        CYTHON_FALLTHROUGH;
        case 15: values[14] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_vh = ((PyArrayObject *)values[0]);
    __pyx_v_vl1 = ((PyArrayObject *)values[1]);
    __pyx_v_vl2 = ((PyArrayObject *)values[2]);
    __pyx_v_a = ((PyArrayObject *)values[3]);
    __pyx_v_zh = ((PyArrayObject *)values[4]);
    __pyx_v_zl1 = ((PyArrayObject *)values[5]);
    __pyx_v_zl2 = ((PyArrayObject *)values[6]);
    __pyx_v_d = ((PyArrayObject *)values[7]);
    __pyx_v_t = ((PyArrayObject *)values[8]);
    __pyx_v_deadline = ((PyArrayObject *)values[9]);
    if (values[10]) {
      __pyx_v_s = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[10]); if (unlikely((__pyx_v_s == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2769, __pyx_L3_error)</span>
    } else {
      __pyx_v_s = ((float)((double)1.0));
    }
    if (values[11]) {
      __pyx_v_delta_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[11]); if (unlikely((__pyx_v_delta_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2770, __pyx_L3_error)</span>
    } else {
      __pyx_v_delta_t = ((float)((double)0.001));
    }
    if (values[12]) {
      __pyx_v_max_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[12]); if (unlikely((__pyx_v_max_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2771, __pyx_L3_error)</span>
    } else {
      __pyx_v_max_t = ((float)((float)20.0));
    }
    if (values[13]) {
      __pyx_v_n_samples = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[13]); if (unlikely((__pyx_v_n_samples == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2772, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_samples = ((int)((int)0x4E20));
    }
    if (values[14]) {
      __pyx_v_n_trials = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[14]); if (unlikely((__pyx_v_n_trials == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2773, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_trials = ((int)((int)1));
    }
    __pyx_v_print_info = values[15];
    __pyx_v_boundary_fun = values[16];
    __pyx_v_boundary_multiplicative = values[17];
    __pyx_v_boundary_params = values[18];
    __pyx_v_random_state = values[19];
    __pyx_v_return_option = values[20];
    __pyx_v_smooth = values[21];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_multinoise", 0, 10, 22, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.ddm_flexbound_mic2_multinoise", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_vh), __pyx_ptype_5numpy_ndarray, 1, "vh", 0))) <span class='error_goto'>__PYX_ERR(0, 2759, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_vl1), __pyx_ptype_5numpy_ndarray, 1, "vl1", 0))) <span class='error_goto'>__PYX_ERR(0, 2760, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_vl2), __pyx_ptype_5numpy_ndarray, 1, "vl2", 0))) <span class='error_goto'>__PYX_ERR(0, 2761, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) <span class='error_goto'>__PYX_ERR(0, 2762, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_zh), __pyx_ptype_5numpy_ndarray, 1, "zh", 0))) <span class='error_goto'>__PYX_ERR(0, 2763, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_zl1), __pyx_ptype_5numpy_ndarray, 1, "zl1", 0))) <span class='error_goto'>__PYX_ERR(0, 2764, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_zl2), __pyx_ptype_5numpy_ndarray, 1, "zl2", 0))) <span class='error_goto'>__PYX_ERR(0, 2765, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_d), __pyx_ptype_5numpy_ndarray, 1, "d", 0))) <span class='error_goto'>__PYX_ERR(0, 2766, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) <span class='error_goto'>__PYX_ERR(0, 2767, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_deadline), __pyx_ptype_5numpy_ndarray, 1, "deadline", 0))) <span class='error_goto'>__PYX_ERR(0, 2768, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_4cssm_30ddm_flexbound_mic2_multinoise(__pyx_self, __pyx_v_vh, __pyx_v_vl1, __pyx_v_vl2, __pyx_v_a, __pyx_v_zh, __pyx_v_zl1, __pyx_v_zl2, __pyx_v_d, __pyx_v_t, __pyx_v_deadline, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_print_info, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state, __pyx_v_return_option, __pyx_v_smooth, __pyx_v_kwargs);
</pre><pre class="cython line score-0">&#xA0;<span class="">2779</span>:                                   return_option = 'full',</pre>
<pre class="cython line score-0">&#xA0;<span class="">2780</span>:                                   smooth = False,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2781</span>:                                   **kwargs):</pre>
<pre class="cython line score-0">&#xA0;<span class="">2782</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2783</span>:     set_seed(random_state)</pre>
<pre class='cython code score-1 '>  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2783, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2784</span>:     # Param views</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2785</span>:     cdef float[:] vh_view = vh</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_vh), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2785, __pyx_L1_error)</span>
  __pyx_v_vh_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2786</span>:     cdef float[:] vl1_view = vl1</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_vl1), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2786, __pyx_L1_error)</span>
  __pyx_v_vl1_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2787</span>:     cdef float[:] vl2_view = vl2</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_vl2), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2787, __pyx_L1_error)</span>
  __pyx_v_vl2_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2788</span>:     cdef float[:] a_view = a</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_a), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2788, __pyx_L1_error)</span>
  __pyx_v_a_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2789</span>:     cdef float[:] zh_view = zh</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_zh), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2789, __pyx_L1_error)</span>
  __pyx_v_zh_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2790</span>:     cdef float[:] zl1_view = zl1</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_zl1), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2790, __pyx_L1_error)</span>
  __pyx_v_zl1_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2791</span>:     cdef float[:] zl2_view = zl2</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_zl2), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2791, __pyx_L1_error)</span>
  __pyx_v_zl2_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2792</span>:     cdef float[:] d_view = d</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_d), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2792, __pyx_L1_error)</span>
  __pyx_v_d_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2793</span>:     cdef float[:] t_view = t</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_t), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2793, __pyx_L1_error)</span>
  __pyx_v_t_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2794</span>:     cdef float[:] deadline_view = deadline</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_deadline), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2794, __pyx_L1_error)</span>
  __pyx_v_deadline_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">2795</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2796</span>:     # TD: Add trajectory --&gt; same issue as with par2 model above... might need to make a separate simulator for trajectories</pre>
<pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2797</span>:     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)</pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2797, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2797, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2797, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2797, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2797, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2797, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2797, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 2797, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2797, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 2797, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2797, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2797, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2797, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2797, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_rts = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2798</span>:     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)</pre>
<pre class='cython code score-46 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2798, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2798, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2798, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2798, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2798, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2798, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2798, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 2798, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2798, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 2798, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2798, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2798, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_intc);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2798, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2798, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2798, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_choices = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2799</span>:     rts_low = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)</pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2799, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2799, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2799, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2799, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2799, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 2799, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2799, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 2799, __pyx_L1_error)</span>;
  __pyx_t_6 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2799, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 2799, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2799, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2799, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2799, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2799, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_rts_low = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2800</span>:     rts_high = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)</pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2800, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2800, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2800, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2800, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2800, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 2800, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2800, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 2800, __pyx_L1_error)</span>;
  __pyx_t_6 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2800, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 2800, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2800, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2800, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2800, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2800, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_rts_high = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2801</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2802</span>:     cdef float[:, :, :] rts_view = rts</pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_rts, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 2802, __pyx_L1_error)</span>
  __pyx_v_rts_view = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2803</span>:     cdef float[:, :, :] rts_high_view = rts_high</pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_rts_high, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 2803, __pyx_L1_error)</span>
  __pyx_v_rts_high_view = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2804</span>:     cdef float[:, :, :] rts_low_view = rts_low</pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_rts_low, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 2804, __pyx_L1_error)</span>
  __pyx_v_rts_low_view = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2805</span>:     cdef int[:, :, :] choices_view = choices</pre>
<pre class='cython code score-2 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_int</span>(__pyx_v_choices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 2805, __pyx_L1_error)</span>
  __pyx_v_choices_view = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">2806</span>: </pre>
<pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2807</span>:     traj = np.zeros((int(max_t / delta_t) + 1, 3), dtype = DTYPE)</pre>
<pre class='cython code score-42 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2807, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2807, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_FromDouble</span>((__pyx_v_max_t / __pyx_v_delta_t));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2807, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_6, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2807, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2807, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2807, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_int_3)) <span class='error_goto'>__PYX_ERR(0, 2807, __pyx_L1_error)</span>;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2807, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 2807, __pyx_L1_error)</span>;
  __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2807, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2807, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2807, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2807, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_traj = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2808</span>:     traj[:, :] = -999</pre>
<pre class='cython code score-5 '>  if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_traj, __pyx_tuple__12, __pyx_int_neg_999) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2808, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2809</span>:     cdef float[:, :] traj_view = traj</pre>
<pre class='cython code score-2 '>  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(__pyx_v_traj, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 2809, __pyx_L1_error)</span>
  __pyx_v_traj_view = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">2810</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2811</span>:     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion</pre>
<pre class='cython code score-0 '>  __pyx_v_delta_t_sqrt = sqrt(__pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2812</span>:     cdef float sqrt_st = delta_t_sqrt * s # scalar to ensure the correct variance for the gaussian step</pre>
<pre class='cython code score-0 '>  __pyx_v_sqrt_st = (__pyx_v_delta_t_sqrt * __pyx_v_s);
</pre><pre class="cython line score-0">&#xA0;<span class="">2813</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2814</span>:     # Boundary storage for the upper bound</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2815</span>:     cdef int num_draws = int((max_t / delta_t) + 1)</pre>
<pre class='cython code score-0 '>  __pyx_v_num_draws = ((int)((__pyx_v_max_t / __pyx_v_delta_t) + 1.0));
</pre><pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2816</span>:     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)</pre>
<pre class='cython code score-51 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2816, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2816, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_max_t + __pyx_v_delta_t));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2816, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_t);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2816, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_10 = NULL;
  __pyx_t_11 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_10)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_11 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[4] = {__pyx_t_10, __pyx_int_0, __pyx_t_4, __pyx_t_1};
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_11, 3+__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 2816, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2816, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2816, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_1 = NULL;
  __pyx_t_11 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_11 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_6};
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_11, 1+__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 2816, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_v_t_s = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2817</span>:     boundary = np.zeros(t_s.shape, dtype = DTYPE)</pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2817, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2817, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_t_s, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2817, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2817, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 2817, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2817, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2817, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2817, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_6, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2817, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_boundary = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2818</span>:     cdef float[:] boundary_view = boundary</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(__pyx_v_boundary, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2818, __pyx_L1_error)</span>
  __pyx_v_boundary_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">2819</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2820</span>:     # Y particle trace</pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2821</span>:     bias_trace_l1 = np.zeros(num_draws, dtype = DTYPE)</pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2821, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2821, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2821, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2821, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2821, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2821, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2821, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2821, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_6, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2821, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_bias_trace_l1 = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2822</span>:     bias_trace_l2 = np.zeros(num_draws, dtype = DTYPE)</pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2822, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2822, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2822, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2822, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 2822, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2822, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2822, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2822, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_6, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2822, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_bias_trace_l2 = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2823</span>:     cdef float[:] bias_trace_l1_view = bias_trace_l1</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(__pyx_v_bias_trace_l1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2823, __pyx_L1_error)</span>
  __pyx_v_bias_trace_l1_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2824</span>:     cdef float[:] bias_trace_l2_view = bias_trace_l2</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(__pyx_v_bias_trace_l2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2824, __pyx_L1_error)</span>
  __pyx_v_bias_trace_l2_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">2825</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2826</span>:     cdef float y_h, y_l, y_l1, y_l2</pre>
<pre class="cython line score-0">&#xA0;<span class="">2827</span>:     cdef float v_l, v_l1, v_l2</pre>
<pre class="cython line score-0">&#xA0;<span class="">2828</span>:     cdef float t_h, t_l, t_l1, t_l2, smooth_u, deadline_tmp</pre>
<pre class="cython line score-0">&#xA0;<span class="">2829</span>:     cdef Py_ssize_t n, ix, ix1, ix2, ix_l, ix_tmp, ix1_tmp, ix2_tmp, k</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2830</span>:     cdef Py_ssize_t m = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_m = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2831</span>:     cdef float[:] gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2831, __pyx_L1_error)</span>
  __pyx_v_gaussian_values = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">2832</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2833</span>:     for k in range(n_trials):</pre>
<pre class='cython code score-0 '>  __pyx_t_11 = __pyx_v_n_trials;
  __pyx_t_12 = __pyx_t_11;
  for (__pyx_t_13 = 0; __pyx_t_13 &lt; __pyx_t_12; __pyx_t_13+=1) {
    __pyx_v_k = __pyx_t_13;
</pre><pre class="cython line score-0">&#xA0;<span class="">2834</span>:         # Precompute boundary evaluations</pre>
<pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2835</span>:         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}</pre>
<pre class='cython code score-27 '>    { /* enter inner scope */
      __pyx_t_5 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2835, __pyx_L7_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_14 = 0;
      if (unlikely(__pyx_v_boundary_params == Py_None)) {
        <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "keys");
        <span class='error_goto'>__PYX_ERR(0, 2835, __pyx_L7_error)</span>
      }
      __pyx_t_6 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&amp;__pyx_t_15), (&amp;__pyx_t_16));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2835, __pyx_L7_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
      __pyx_t_3 = __pyx_t_6;
      __pyx_t_6 = 0;
      while (1) {
        __pyx_t_17 = __Pyx_dict_iter_next(__pyx_t_3, __pyx_t_15, &amp;__pyx_t_14, &amp;__pyx_t_6, NULL, NULL, __pyx_t_16);
        if (unlikely(__pyx_t_17 == 0)) break;
        if (unlikely(__pyx_t_17 == -1)) <span class='error_goto'>__PYX_ERR(0, 2835, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_9genexpr12__pyx_v_key, __pyx_t_6);
        __pyx_t_6 = 0;
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_boundary_params, __pyx_9genexpr12__pyx_v_key);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2835, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_6, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2835, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, (PyObject*)__pyx_9genexpr12__pyx_v_key, (PyObject*)__pyx_t_1))) <span class='error_goto'>__PYX_ERR(0, 2835, __pyx_L7_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_9genexpr12__pyx_v_key); __pyx_9genexpr12__pyx_v_key = 0;
      goto __pyx_L10_exit_scope;
      __pyx_L7_error:;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_9genexpr12__pyx_v_key); __pyx_9genexpr12__pyx_v_key = 0;
      goto __pyx_L1_error;
      __pyx_L10_exit_scope:;
    } /* exit inner scope */
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_boundary_params_tmp, ((PyObject*)__pyx_t_5));
    __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2836</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2837</span>:         # Precompute boundary evaluations</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2838</span>:         if boundary_multiplicative:</pre>
<pre class='cython code score-2 '>    __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_boundary_multiplicative); if (unlikely((__pyx_t_18 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2838, __pyx_L1_error)</span>
    if (__pyx_t_18) {
/* … */
      goto __pyx_L11;
    }
</pre><pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2839</span>:             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)</pre>
<pre class='cython code score-61 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2839, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_multiply);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2839, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_19 * __pyx_v_a_view.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2839, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2839, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_t, __pyx_v_t_s) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2839, __pyx_L1_error)</span>
      __pyx_t_4 = __pyx_t_10;
      __pyx_t_10 = 0;
      if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_4, __pyx_v_boundary_params_tmp) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2839, __pyx_L1_error)</span>
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2839, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_4, __pyx_t_1, __pyx_t_10};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_16, 2+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 2839, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      }
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2839, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2839, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_10 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
        __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
        if (likely(__pyx_t_10)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_10, __pyx_t_3};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_16, 1+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 2839, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      }
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_boundary, __pyx_t_5, 0, 0, NULL, NULL, &amp;__pyx_slice__5, 0, 0, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2839, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2840</span>:         else:</pre>
<pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2841</span>:             boundary[:] = np.add(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)</pre>
<pre class='cython code score-61 '>    /*else*/ {
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2841, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_add);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2841, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_19 * __pyx_v_a_view.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2841, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2841, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_t, __pyx_v_t_s) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2841, __pyx_L1_error)</span>
      __pyx_t_1 = __pyx_t_4;
      __pyx_t_4 = 0;
      if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_1, __pyx_v_boundary_params_tmp) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2841, __pyx_L1_error)</span>
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2841, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
        __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
        if (likely(__pyx_t_1)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_1, __pyx_t_3, __pyx_t_4};
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_16, 2+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 2841, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      }
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2841, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2841, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_4 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_6};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_16, 1+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 2841, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      }
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_boundary, __pyx_t_5, 0, 0, NULL, NULL, &amp;__pyx_slice__5, 0, 0, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2841, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
    __pyx_L11:;
</pre><pre class="cython line score-0">&#xA0;<span class="">2842</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2843</span>:         deadline_tmp = min(max_t, deadline_view[k] - t_view[k])</pre>
<pre class='cython code score-0 '>    __pyx_t_19 = __pyx_v_k;
    __pyx_t_20 = __pyx_v_k;
    __pyx_t_21 = ((*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_19 * __pyx_v_deadline_view.strides[0]) ))) - (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_20 * __pyx_v_t_view.strides[0]) ))));
    __pyx_t_22 = __pyx_v_max_t;
    __pyx_t_18 = (__pyx_t_21 &lt; __pyx_t_22);
    if (__pyx_t_18) {
      __pyx_t_23 = __pyx_t_21;
    } else {
      __pyx_t_23 = __pyx_t_22;
    }
    __pyx_v_deadline_tmp = __pyx_t_23;
</pre><pre class="cython line score-0">&#xA0;<span class="">2844</span>:         # Loop over samples</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2845</span>:         for n in range(n_samples):</pre>
<pre class='cython code score-0 '>    __pyx_t_16 = __pyx_v_n_samples;
    __pyx_t_17 = __pyx_t_16;
    for (__pyx_t_15 = 0; __pyx_t_15 &lt; __pyx_t_17; __pyx_t_15+=1) {
      __pyx_v_n = __pyx_t_15;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2846</span>:             choices_view[n, k, 0] = 0 # reset choice</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = __pyx_v_n;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_24 = 0;
      *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_20 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[2]) )) = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2847</span>:             t_h = 0 # reset time high dimension</pre>
<pre class='cython code score-0 '>      __pyx_v_t_h = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2848</span>:             t_l = 0 # reset time low dimension</pre>
<pre class='cython code score-0 '>      __pyx_v_t_l = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2849</span>:             t_l1 = 0 # reset time low dimension (1)</pre>
<pre class='cython code score-0 '>      __pyx_v_t_l1 = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2850</span>:             t_l2 = 0 # reset time low dimension (2)</pre>
<pre class='cython code score-0 '>      __pyx_v_t_l2 = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2851</span>:             ix = 0 # reset boundary index</pre>
<pre class='cython code score-0 '>      __pyx_v_ix = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2852</span>:             ix1 = 0 # reset boundary index (1)</pre>
<pre class='cython code score-0 '>      __pyx_v_ix1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2853</span>:             ix2 = 0 # reset boundary index (2)</pre>
<pre class='cython code score-0 '>      __pyx_v_ix2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2854</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2855</span>:             # Initialize walkers</pre>
<pre class="cython line score-0">&#xA0;<span class="">2856</span>:             # Particle</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2857</span>:             y_h = (-1) * boundary_view[0] + (zh_view[k] * 2 * (boundary_view[0]))</pre>
<pre class='cython code score-0 '>      __pyx_t_24 = 0;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_20 = 0;
      __pyx_v_y_h = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_24 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_zh_view.data + __pyx_t_19 * __pyx_v_zh_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">2858</span>:             # Relative particle position (used as resource allocator for low dim choice)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2859</span>:             bias_trace_l2_view[0] = ((y_h + boundary_view[0]) / (2 * boundary_view[0]))</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = 0;
      __pyx_t_19 = 0;
      __pyx_t_24 = 0;
      *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l2_view.data + __pyx_t_24 * __pyx_v_bias_trace_l2_view.strides[0]) )) = ((__pyx_v_y_h + (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))) / (2.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2860</span>:             bias_trace_l1_view[0] = 1.0 - bias_trace_l2_view[0]</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = 0;
      __pyx_t_20 = 0;
      *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l1_view.data + __pyx_t_20 * __pyx_v_bias_trace_l1_view.strides[0]) )) = (1.0 - (*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l2_view.data + __pyx_t_19 * __pyx_v_bias_trace_l2_view.strides[0]) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">2861</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2862</span>:             if n == 0:</pre>
<pre class='cython code score-0 '>      __pyx_t_18 = (__pyx_v_n == 0);
      if (__pyx_t_18) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2863</span>:                 if k == 0:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (__pyx_v_k == 0);
        if (__pyx_t_18) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2864</span>:                     traj_view[0, 0] = y_h</pre>
<pre class='cython code score-0 '>          __pyx_t_19 = 0;
          __pyx_t_20 = 0;
          *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_19 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_20 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y_h;
</pre><pre class="cython line score-0">&#xA0;<span class="">2865</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2866</span>:             # Random walks until y_h hits bound</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2867</span>:             while (y_h &gt;= ((-1) * boundary_view[ix])) and ((y_h &lt;= boundary_view[ix])) and (t_h &lt;= deadline_tmp):</pre>
<pre class='cython code score-0 '>      while (1) {
        __pyx_t_20 = __pyx_v_ix;
        __pyx_t_25 = (__pyx_v_y_h &gt;= (-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))));
        if (__pyx_t_25) {
        } else {
          __pyx_t_18 = __pyx_t_25;
          goto __pyx_L18_bool_binop_done;
        }
        __pyx_t_20 = __pyx_v_ix;
        __pyx_t_25 = (__pyx_v_y_h &lt;= (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) ))));
        if (__pyx_t_25) {
        } else {
          __pyx_t_18 = __pyx_t_25;
          goto __pyx_L18_bool_binop_done;
        }
        __pyx_t_25 = (__pyx_v_t_h &lt;= __pyx_v_deadline_tmp);
        __pyx_t_18 = __pyx_t_25;
        __pyx_L18_bool_binop_done:;
        if (!__pyx_t_18) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2868</span>:                 y_h += (vh_view[k] * delta_t) + (sqrt_st * gaussian_values[m])</pre>
<pre class='cython code score-0 '>        __pyx_t_20 = __pyx_v_k;
        __pyx_t_19 = __pyx_v_m;
        __pyx_v_y_h = (__pyx_v_y_h + (((*((float *) ( /* dim=0 */ (__pyx_v_vh_view.data + __pyx_t_20 * __pyx_v_vh_view.strides[0]) ))) * __pyx_v_delta_t) + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_19 * __pyx_v_gaussian_values.strides[0]) ))))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2869</span>:                 bias_trace_l2_view[ix] = ((y_h + boundary_view[ix]) / (2 * boundary_view[ix]))</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = __pyx_v_ix;
        __pyx_t_20 = __pyx_v_ix;
        __pyx_t_24 = __pyx_v_ix;
        *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l2_view.data + __pyx_t_24 * __pyx_v_bias_trace_l2_view.strides[0]) )) = ((__pyx_v_y_h + (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))) / (2.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2870</span>:                 bias_trace_l1_view[ix] = 1.0 - bias_trace_l2_view[ix]</pre>
<pre class='cython code score-0 '>        __pyx_t_20 = __pyx_v_ix;
        __pyx_t_19 = __pyx_v_ix;
        *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l1_view.data + __pyx_t_19 * __pyx_v_bias_trace_l1_view.strides[0]) )) = (1.0 - (*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l2_view.data + __pyx_t_20 * __pyx_v_bias_trace_l2_view.strides[0]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2871</span>:                 t_h += delta_t</pre>
<pre class='cython code score-0 '>        __pyx_v_t_h = (__pyx_v_t_h + __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2872</span>:                 ix += 1</pre>
<pre class='cython code score-0 '>        __pyx_v_ix = (__pyx_v_ix + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2873</span>:                 m += 1</pre>
<pre class='cython code score-0 '>        __pyx_v_m = (__pyx_v_m + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2874</span>:                 if m == num_draws:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (__pyx_v_m == __pyx_v_num_draws);
        if (__pyx_t_18) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2875</span>:                     gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2875, __pyx_L1_error)</span>
          __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
          __pyx_v_gaussian_values = __pyx_t_2;
          __pyx_t_2.memview = NULL;
          __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2876</span>:                     m = 0</pre>
<pre class='cython code score-0 '>          __pyx_v_m = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2877</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2878</span>:                 if n == 0:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (__pyx_v_n == 0);
        if (__pyx_t_18) {
/* … */
        }
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2879</span>:                     if k == 0:</pre>
<pre class='cython code score-0 '>          __pyx_t_18 = (__pyx_v_k == 0);
          if (__pyx_t_18) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2880</span>:                         traj_view[ix, 0] = y_h</pre>
<pre class='cython code score-0 '>            __pyx_t_20 = __pyx_v_ix;
            __pyx_t_19 = 0;
            *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_20 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_19 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y_h;
</pre><pre class="cython line score-0">&#xA0;<span class="">2881</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2882</span>:             # The probability of making a 'mistake' 1 - (relative y position)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2883</span>:             # y at upper bound --&gt; choices_view[n, k, 0] add 2 deterministically</pre>
<pre class="cython line score-0">&#xA0;<span class="">2884</span>:             # y at lower bound --&gt; choice_view[n, k, 0] stay the same deterministically</pre>
<pre class="cython line score-0">&#xA0;<span class="">2885</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2886</span>:             # If boundary is negative (or 0) already, we flip a coin</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2887</span>:             if boundary_view[ix] &lt;= 0:</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = __pyx_v_ix;
      __pyx_t_18 = ((*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) ))) &lt;= 0.0);
      if (__pyx_t_18) {
/* … */
        goto __pyx_L24;
      }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2888</span>:                 if random_uniform() &lt;= 0.5:</pre>
<pre class='cython code score-5 '>        __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2888, __pyx_L1_error)</span>
        __pyx_t_18 = (__pyx_t_23 &lt;= 0.5);
        if (__pyx_t_18) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2889</span>:                     choices_view[n, k, 0] += 2</pre>
<pre class='cython code score-0 '>          __pyx_t_19 = __pyx_v_n;
          __pyx_t_20 = __pyx_v_k;
          __pyx_t_24 = 0;
          *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_19 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[2]) )) += 2;
</pre><pre class="cython line score-0">&#xA0;<span class="">2890</span>:             # Otherwise, apply rule from above</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2891</span>:             elif random_uniform() &lt;= ((y_h + boundary_view[ix]) / (2 * boundary_view[ix])):</pre>
<pre class='cython code score-5 '>      __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2891, __pyx_L1_error)</span>
      __pyx_t_24 = __pyx_v_ix;
      __pyx_t_20 = __pyx_v_ix;
      __pyx_t_18 = (__pyx_t_23 &lt;= ((__pyx_v_y_h + (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_24 * __pyx_v_boundary_view.strides[0]) )))) / (2.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) ))))));
      if (__pyx_t_18) {
/* … */
      }
      __pyx_L24:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2892</span>:                 choices_view[n, k, 0] += 2</pre>
<pre class='cython code score-0 '>        __pyx_t_20 = __pyx_v_n;
        __pyx_t_24 = __pyx_v_k;
        __pyx_t_19 = 0;
        *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_20 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[2]) )) += 2;
</pre><pre class="cython line score-0">&#xA0;<span class="">2893</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2894</span>:             y_l2 = (- 1) * boundary_view[0] + (zl2_view[k] * 2 * (boundary_view[0]))</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = 0;
      __pyx_t_24 = __pyx_v_k;
      __pyx_t_20 = 0;
      __pyx_v_y_l2 = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_zl2_view.data + __pyx_t_24 * __pyx_v_zl2_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2895</span>:             y_l1 = (- 1) * boundary_view[0] + (zl1_view[k] * 2 * (boundary_view[0]))</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = 0;
      __pyx_t_24 = __pyx_v_k;
      __pyx_t_19 = 0;
      __pyx_v_y_l1 = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_zl1_view.data + __pyx_t_24 * __pyx_v_zl1_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">2896</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2897</span>:             if choices_view[n, k, 0] == 0:</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = __pyx_v_n;
      __pyx_t_24 = __pyx_v_k;
      __pyx_t_20 = 0;
      __pyx_t_18 = ((*((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_19 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[2]) ))) == 0);
      if (__pyx_t_18) {
/* … */
        goto __pyx_L26;
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">2898</span>:                  # Fill bias tracea until max_rt reached</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2899</span>:                 ix1_tmp = ix + 1</pre>
<pre class='cython code score-0 '>        __pyx_v_ix1_tmp = (__pyx_v_ix + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2900</span>:                 while ix1_tmp &lt; num_draws:</pre>
<pre class='cython code score-0 '>        while (1) {
          __pyx_t_18 = (__pyx_v_ix1_tmp &lt; __pyx_v_num_draws);
          if (!__pyx_t_18) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2901</span>:                     bias_trace_l2_view[ix1_tmp] = 0.0</pre>
<pre class='cython code score-0 '>          __pyx_t_20 = __pyx_v_ix1_tmp;
          *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l2_view.data + __pyx_t_20 * __pyx_v_bias_trace_l2_view.strides[0]) )) = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2902</span>:                     bias_trace_l1_view[ix1_tmp] = 1.0</pre>
<pre class='cython code score-0 '>          __pyx_t_20 = __pyx_v_ix1_tmp;
          *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l1_view.data + __pyx_t_20 * __pyx_v_bias_trace_l1_view.strides[0]) )) = 1.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2903</span>:                     ix1_tmp += 1</pre>
<pre class='cython code score-0 '>          __pyx_v_ix1_tmp = (__pyx_v_ix1_tmp + 1);
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">2904</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2905</span>:             else: # Store intermediate choice</pre>
<pre class="cython line score-0">&#xA0;<span class="">2906</span>:                 # Fill bias tracea until max_rt reached</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2907</span>:                 ix2_tmp = ix + 1</pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_v_ix2_tmp = (__pyx_v_ix + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2908</span>:                 while ix2_tmp &lt; num_draws:</pre>
<pre class='cython code score-0 '>        while (1) {
          __pyx_t_18 = (__pyx_v_ix2_tmp &lt; __pyx_v_num_draws);
          if (!__pyx_t_18) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2909</span>:                     bias_trace_l2_view[ix2_tmp] = 1.0</pre>
<pre class='cython code score-0 '>          __pyx_t_20 = __pyx_v_ix2_tmp;
          *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l2_view.data + __pyx_t_20 * __pyx_v_bias_trace_l2_view.strides[0]) )) = 1.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2910</span>:                     bias_trace_l1_view[ix2_tmp] = 0.0</pre>
<pre class='cython code score-0 '>          __pyx_t_20 = __pyx_v_ix2_tmp;
          *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l1_view.data + __pyx_t_20 * __pyx_v_bias_trace_l1_view.strides[0]) )) = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2911</span>:                     ix2_tmp += 1</pre>
<pre class='cython code score-0 '>          __pyx_v_ix2_tmp = (__pyx_v_ix2_tmp + 1);
        }
      }
      __pyx_L26:;
</pre><pre class="cython line score-0">&#xA0;<span class="">2912</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2913</span>:             # lower level random walker (1)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2914</span>:             if (choices_view[n, k, 0] == 0) | ((n == 0) &amp; (k == 0)):</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = __pyx_v_n;
      __pyx_t_24 = __pyx_v_k;
      __pyx_t_19 = 0;
      __pyx_t_18 = (((*((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_20 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[2]) ))) == 0) | ((__pyx_v_n == 0) &amp; (__pyx_v_k == 0)));
      if (__pyx_t_18) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2915</span>:                 while (y_l1 &gt;= ((-1) * boundary_view[ix1])) and (y_l1 &lt;= boundary_view[ix1]) and (t_l1 &lt;= deadline_tmp):</pre>
<pre class='cython code score-0 '>        while (1) {
          __pyx_t_19 = __pyx_v_ix1;
          __pyx_t_25 = (__pyx_v_y_l1 &gt;= (-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))));
          if (__pyx_t_25) {
          } else {
            __pyx_t_18 = __pyx_t_25;
            goto __pyx_L34_bool_binop_done;
          }
          __pyx_t_19 = __pyx_v_ix1;
          __pyx_t_25 = (__pyx_v_y_l1 &lt;= (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) ))));
          if (__pyx_t_25) {
          } else {
            __pyx_t_18 = __pyx_t_25;
            goto __pyx_L34_bool_binop_done;
          }
          __pyx_t_25 = (__pyx_v_t_l1 &lt;= __pyx_v_deadline_tmp);
          __pyx_t_18 = __pyx_t_25;
          __pyx_L34_bool_binop_done:;
          if (!__pyx_t_18) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2916</span>:                     if (bias_trace_l1_view[ix1] &lt; 1) and (bias_trace_l1_view[ix1] &gt; 0):</pre>
<pre class='cython code score-0 '>          __pyx_t_19 = __pyx_v_ix1;
          __pyx_t_25 = ((*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l1_view.data + __pyx_t_19 * __pyx_v_bias_trace_l1_view.strides[0]) ))) &lt; 1.0);
          if (__pyx_t_25) {
          } else {
            __pyx_t_18 = __pyx_t_25;
            goto __pyx_L38_bool_binop_done;
          }
          __pyx_t_19 = __pyx_v_ix1;
          __pyx_t_25 = ((*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l1_view.data + __pyx_t_19 * __pyx_v_bias_trace_l1_view.strides[0]) ))) &gt; 0.0);
          __pyx_t_18 = __pyx_t_25;
          __pyx_L38_bool_binop_done:;
          if (__pyx_t_18) {
/* … */
            goto __pyx_L37;
          }
</pre><pre class="cython line score-0">&#xA0;<span class="">2917</span>:                         # main propagation if bias_trace is between 0 and 1 (high level choice is not yet made)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2918</span>:                         y_l1 += (((vl1_view[k] * bias_trace_l1_view[ix1] * (1 - d_view[k]))) * delta_t)</pre>
<pre class='cython code score-0 '>            __pyx_t_19 = __pyx_v_k;
            __pyx_t_24 = __pyx_v_ix1;
            __pyx_t_20 = __pyx_v_k;
            __pyx_v_y_l1 = (__pyx_v_y_l1 + ((((*((float *) ( /* dim=0 */ (__pyx_v_vl1_view.data + __pyx_t_19 * __pyx_v_vl1_view.strides[0]) ))) * (*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l1_view.data + __pyx_t_24 * __pyx_v_bias_trace_l1_view.strides[0]) )))) * (1.0 - (*((float *) ( /* dim=0 */ (__pyx_v_d_view.data + __pyx_t_20 * __pyx_v_d_view.strides[0]) ))))) * __pyx_v_delta_t));
</pre><pre class="cython line score-0">&#xA0;<span class="">2919</span>:                         # add gaussian displacement</pre>
<pre class="cython line score-0">&#xA0;<span class="">2920</span>:                         # we multiply by bias_trace_view to make low level variance depend on high level trace</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2921</span>:                         y_l1 += (sqrt_st * gaussian_values[m]) * bias_trace_l1_view[ix1]</pre>
<pre class='cython code score-0 '>            __pyx_t_20 = __pyx_v_m;
            __pyx_t_24 = __pyx_v_ix1;
            __pyx_v_y_l1 = (__pyx_v_y_l1 + ((__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_20 * __pyx_v_gaussian_values.strides[0]) )))) * (*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l1_view.data + __pyx_t_24 * __pyx_v_bias_trace_l1_view.strides[0]) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">2922</span>:                     else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2923</span>:                         # main propagation if bias_trace is not between 0 and 1 (high level choice is already made)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2924</span>:                         y_l1 += (vl1_view[k] * delta_t)</pre>
<pre class='cython code score-0 '>          /*else*/ {
            __pyx_t_24 = __pyx_v_k;
            __pyx_v_y_l1 = (__pyx_v_y_l1 + ((*((float *) ( /* dim=0 */ (__pyx_v_vl1_view.data + __pyx_t_24 * __pyx_v_vl1_view.strides[0]) ))) * __pyx_v_delta_t));
</pre><pre class="cython line score-0">&#xA0;<span class="">2925</span>:                         # add gaussian displacement</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2926</span>:                         y_l1 += (sqrt_st * gaussian_values[m])</pre>
<pre class='cython code score-0 '>            __pyx_t_24 = __pyx_v_m;
            __pyx_v_y_l1 = (__pyx_v_y_l1 + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_24 * __pyx_v_gaussian_values.strides[0]) )))));
          }
          __pyx_L37:;
</pre><pre class="cython line score-0">&#xA0;<span class="">2927</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2928</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2929</span>:                     # propagate time and indices</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2930</span>:                     t_l1 += delta_t</pre>
<pre class='cython code score-0 '>          __pyx_v_t_l1 = (__pyx_v_t_l1 + __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2931</span>:                     ix1 += 1</pre>
<pre class='cython code score-0 '>          __pyx_v_ix1 = (__pyx_v_ix1 + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2932</span>:                     m += 1</pre>
<pre class='cython code score-0 '>          __pyx_v_m = (__pyx_v_m + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2933</span>:                     if m == num_draws:</pre>
<pre class='cython code score-0 '>          __pyx_t_18 = (__pyx_v_m == __pyx_v_num_draws);
          if (__pyx_t_18) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2934</span>:                         gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>            __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2934, __pyx_L1_error)</span>
            __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
            __pyx_v_gaussian_values = __pyx_t_2;
            __pyx_t_2.memview = NULL;
            __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2935</span>:                         m = 0</pre>
<pre class='cython code score-0 '>            __pyx_v_m = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2936</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2937</span>:                     if n == 0:</pre>
<pre class='cython code score-0 '>          __pyx_t_18 = (__pyx_v_n == 0);
          if (__pyx_t_18) {
/* … */
          }
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2938</span>:                         if k == 0:</pre>
<pre class='cython code score-0 '>            __pyx_t_18 = (__pyx_v_k == 0);
            if (__pyx_t_18) {
/* … */
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2939</span>:                             traj_view[ix1, 1] = y_l1</pre>
<pre class='cython code score-0 '>              __pyx_t_24 = __pyx_v_ix1;
              __pyx_t_20 = 1;
              *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_24 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_20 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y_l1;
</pre><pre class="cython line score-0">&#xA0;<span class="">2940</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2941</span>:             # lower level random walker (2)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2942</span>:             if (choices_view[n, k, 0] == 2) | ((n == 0) &amp; (k == 0)):</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = __pyx_v_n;
      __pyx_t_24 = __pyx_v_k;
      __pyx_t_19 = 0;
      __pyx_t_18 = (((*((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_20 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[2]) ))) == 2) | ((__pyx_v_n == 0) &amp; (__pyx_v_k == 0)));
      if (__pyx_t_18) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2943</span>:                 while (y_l2 &gt;= ((-1) * boundary_view[ix2])) and (y_l2 &lt;= boundary_view[ix2]) and (t_l2 &lt;= deadline_tmp):</pre>
<pre class='cython code score-0 '>        while (1) {
          __pyx_t_19 = __pyx_v_ix2;
          __pyx_t_25 = (__pyx_v_y_l2 &gt;= (-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))));
          if (__pyx_t_25) {
          } else {
            __pyx_t_18 = __pyx_t_25;
            goto __pyx_L46_bool_binop_done;
          }
          __pyx_t_19 = __pyx_v_ix2;
          __pyx_t_25 = (__pyx_v_y_l2 &lt;= (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) ))));
          if (__pyx_t_25) {
          } else {
            __pyx_t_18 = __pyx_t_25;
            goto __pyx_L46_bool_binop_done;
          }
          __pyx_t_25 = (__pyx_v_t_l2 &lt;= __pyx_v_deadline_tmp);
          __pyx_t_18 = __pyx_t_25;
          __pyx_L46_bool_binop_done:;
          if (!__pyx_t_18) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2944</span>:                     if (bias_trace_l2_view[ix2] &lt; 1) and (bias_trace_l2_view[ix2] &gt; 0):</pre>
<pre class='cython code score-0 '>          __pyx_t_19 = __pyx_v_ix2;
          __pyx_t_25 = ((*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l2_view.data + __pyx_t_19 * __pyx_v_bias_trace_l2_view.strides[0]) ))) &lt; 1.0);
          if (__pyx_t_25) {
          } else {
            __pyx_t_18 = __pyx_t_25;
            goto __pyx_L50_bool_binop_done;
          }
          __pyx_t_19 = __pyx_v_ix2;
          __pyx_t_25 = ((*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l2_view.data + __pyx_t_19 * __pyx_v_bias_trace_l2_view.strides[0]) ))) &gt; 0.0);
          __pyx_t_18 = __pyx_t_25;
          __pyx_L50_bool_binop_done:;
          if (__pyx_t_18) {
/* … */
            goto __pyx_L49;
          }
</pre><pre class="cython line score-0">&#xA0;<span class="">2945</span>:                         # main propagation if bias_trace is between 0 and 1 (high level choice is not yet made)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2946</span>:                         y_l2 += (((vl2_view[k] * bias_trace_l2_view[ix2] * (1 - d_view[k]))) * delta_t)</pre>
<pre class='cython code score-0 '>            __pyx_t_19 = __pyx_v_k;
            __pyx_t_24 = __pyx_v_ix2;
            __pyx_t_20 = __pyx_v_k;
            __pyx_v_y_l2 = (__pyx_v_y_l2 + ((((*((float *) ( /* dim=0 */ (__pyx_v_vl2_view.data + __pyx_t_19 * __pyx_v_vl2_view.strides[0]) ))) * (*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l2_view.data + __pyx_t_24 * __pyx_v_bias_trace_l2_view.strides[0]) )))) * (1.0 - (*((float *) ( /* dim=0 */ (__pyx_v_d_view.data + __pyx_t_20 * __pyx_v_d_view.strides[0]) ))))) * __pyx_v_delta_t));
</pre><pre class="cython line score-0">&#xA0;<span class="">2947</span>:                         # add gaussian displacement</pre>
<pre class="cython line score-0">&#xA0;<span class="">2948</span>:                         # we multiply by bias_trace_view to make low level variance depend on high level trace</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2949</span>:                         y_l2 += (sqrt_st * gaussian_values[m]) * bias_trace_l2_view[ix2]</pre>
<pre class='cython code score-0 '>            __pyx_t_20 = __pyx_v_m;
            __pyx_t_24 = __pyx_v_ix2;
            __pyx_v_y_l2 = (__pyx_v_y_l2 + ((__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_20 * __pyx_v_gaussian_values.strides[0]) )))) * (*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l2_view.data + __pyx_t_24 * __pyx_v_bias_trace_l2_view.strides[0]) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">2950</span>:                     else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2951</span>:                         # main propagation if bias_trace is not between 0 and 1 (high level choice is already made)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2952</span>:                         y_l2 += (vl2_view[k] * delta_t)</pre>
<pre class='cython code score-0 '>          /*else*/ {
            __pyx_t_24 = __pyx_v_k;
            __pyx_v_y_l2 = (__pyx_v_y_l2 + ((*((float *) ( /* dim=0 */ (__pyx_v_vl2_view.data + __pyx_t_24 * __pyx_v_vl2_view.strides[0]) ))) * __pyx_v_delta_t));
</pre><pre class="cython line score-0">&#xA0;<span class="">2953</span>:                         # add gaussian displacement</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2954</span>:                         y_l2 += (sqrt_st * gaussian_values[m])</pre>
<pre class='cython code score-0 '>            __pyx_t_24 = __pyx_v_m;
            __pyx_v_y_l2 = (__pyx_v_y_l2 + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_24 * __pyx_v_gaussian_values.strides[0]) )))));
          }
          __pyx_L49:;
</pre><pre class="cython line score-0">&#xA0;<span class="">2955</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2956</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2957</span>:                     # propagate time and indices</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2958</span>:                     t_l2 += delta_t</pre>
<pre class='cython code score-0 '>          __pyx_v_t_l2 = (__pyx_v_t_l2 + __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2959</span>:                     ix2 += 1</pre>
<pre class='cython code score-0 '>          __pyx_v_ix2 = (__pyx_v_ix2 + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2960</span>:                     m += 1</pre>
<pre class='cython code score-0 '>          __pyx_v_m = (__pyx_v_m + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2961</span>:                     if m == num_draws:</pre>
<pre class='cython code score-0 '>          __pyx_t_18 = (__pyx_v_m == __pyx_v_num_draws);
          if (__pyx_t_18) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2962</span>:                         gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>            __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 2962, __pyx_L1_error)</span>
            __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
            __pyx_v_gaussian_values = __pyx_t_2;
            __pyx_t_2.memview = NULL;
            __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2963</span>:                         m = 0</pre>
<pre class='cython code score-0 '>            __pyx_v_m = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2964</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2965</span>:                     if n == 0:</pre>
<pre class='cython code score-0 '>          __pyx_t_18 = (__pyx_v_n == 0);
          if (__pyx_t_18) {
/* … */
          }
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2966</span>:                         if k == 0:</pre>
<pre class='cython code score-0 '>            __pyx_t_18 = (__pyx_v_k == 0);
            if (__pyx_t_18) {
/* … */
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2967</span>:                             traj_view[ix2, 2] = y_l2</pre>
<pre class='cython code score-0 '>              __pyx_t_24 = __pyx_v_ix2;
              __pyx_t_20 = 2;
              *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_24 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_20 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y_l2;
</pre><pre class="cython line score-0">&#xA0;<span class="">2968</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2969</span>:             # Get back to single y_l and t_l</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2970</span>:             if (choices_view[n, k, 0] == 0):</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = __pyx_v_n;
      __pyx_t_24 = __pyx_v_k;
      __pyx_t_19 = 0;
      __pyx_t_18 = ((*((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_20 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[2]) ))) == 0);
      if (__pyx_t_18) {
/* … */
        goto __pyx_L55;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2971</span>:                 t_l = t_l1</pre>
<pre class='cython code score-0 '>        __pyx_v_t_l = __pyx_v_t_l1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2972</span>:                 y_l = y_l1</pre>
<pre class='cython code score-0 '>        __pyx_v_y_l = __pyx_v_y_l1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2973</span>:                 ix_l = ix1</pre>
<pre class='cython code score-0 '>        __pyx_v_ix_l = __pyx_v_ix1;
</pre><pre class="cython line score-0">&#xA0;<span class="">2974</span>:             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2975</span>:                 t_l = t_l2</pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_v_t_l = __pyx_v_t_l2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2976</span>:                 y_l = y_l2</pre>
<pre class='cython code score-0 '>        __pyx_v_y_l = __pyx_v_y_l2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2977</span>:                 ix_l = ix2</pre>
<pre class='cython code score-0 '>        __pyx_v_ix_l = __pyx_v_ix2;
      }
      __pyx_L55:;
</pre><pre class="cython line score-0">&#xA0;<span class="">2978</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2979</span>:             if smooth:</pre>
<pre class='cython code score-2 '>      __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_smooth); if (unlikely((__pyx_t_18 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2979, __pyx_L1_error)</span>
      if (__pyx_t_18) {
/* … */
        goto __pyx_L56;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2980</span>:                 if t_h == 0.0:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (__pyx_v_t_h == 0.0);
        if (__pyx_t_18) {
/* … */
          goto __pyx_L57;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2981</span>:                     smooth_u = random_uniform() * 0.5 * delta_t</pre>
<pre class='cython code score-5 '>          __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2981, __pyx_L1_error)</span>
          __pyx_v_smooth_u = ((__pyx_t_23 * 0.5) * __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2982</span>:                 elif fmax(t_h, t_l) &lt; deadline_tmp:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (fmax(__pyx_v_t_h, __pyx_v_t_l) &lt; __pyx_v_deadline_tmp);
        if (__pyx_t_18) {
/* … */
          goto __pyx_L57;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2983</span>:                     smooth_u = (0.5 - random_uniform()) * delta_t</pre>
<pre class='cython code score-5 '>          __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2983, __pyx_L1_error)</span>
          __pyx_v_smooth_u = ((0.5 - __pyx_t_23) * __pyx_v_delta_t);
</pre><pre class="cython line score-0">&#xA0;<span class="">2984</span>:                 else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2985</span>:                     smooth_u = 0.0</pre>
<pre class='cython code score-0 '>        /*else*/ {
          __pyx_v_smooth_u = 0.0;
        }
        __pyx_L57:;
</pre><pre class="cython line score-0">&#xA0;<span class="">2986</span>:             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2987</span>:                 smooth_u = 0.0</pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_v_smooth_u = 0.0;
      }
      __pyx_L56:;
</pre><pre class="cython line score-0">&#xA0;<span class="">2988</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2989</span>:             rts_view[n, k, 0] = fmax(t_h, t_l) + t_view[k]</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = __pyx_v_k;
      __pyx_t_24 = __pyx_v_n;
      __pyx_t_20 = __pyx_v_k;
      __pyx_t_26 = 0;
      *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_24 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_20 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_26 * __pyx_v_rts_view.strides[2]) )) = (fmax(__pyx_v_t_h, __pyx_v_t_l) + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_19 * __pyx_v_t_view.strides[0]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2990</span>:             rts_high_view[n, k, 0] = t_h + t_view[k]</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = __pyx_v_k;
      __pyx_t_26 = __pyx_v_n;
      __pyx_t_20 = __pyx_v_k;
      __pyx_t_24 = 0;
      *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_high_view.data + __pyx_t_26 * __pyx_v_rts_high_view.strides[0]) ) + __pyx_t_20 * __pyx_v_rts_high_view.strides[1]) ) + __pyx_t_24 * __pyx_v_rts_high_view.strides[2]) )) = (__pyx_v_t_h + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_19 * __pyx_v_t_view.strides[0]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2991</span>:             rts_low_view[n, k, 0] = t_l + t_view[k]</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = __pyx_v_k;
      __pyx_t_24 = __pyx_v_n;
      __pyx_t_20 = __pyx_v_k;
      __pyx_t_26 = 0;
      *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_low_view.data + __pyx_t_24 * __pyx_v_rts_low_view.strides[0]) ) + __pyx_t_20 * __pyx_v_rts_low_view.strides[1]) ) + __pyx_t_26 * __pyx_v_rts_low_view.strides[2]) )) = (__pyx_v_t_l + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_19 * __pyx_v_t_view.strides[0]) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">2992</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2993</span>:             # The probability of making a 'mistake' 1 - (relative y position)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2994</span>:             # y at upper bound --&gt; choices_view[n, k, 0] add one deterministically</pre>
<pre class="cython line score-0">&#xA0;<span class="">2995</span>:             # y at lower bound --&gt; choice_view[n, k, 0] stays the same deterministically</pre>
<pre class="cython line score-0">&#xA0;<span class="">2996</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2997</span>:             # If boundary is negative (or 0) already, we flip a coin</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2998</span>:             if boundary_view[ix] &lt;= 0:</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = __pyx_v_ix;
      __pyx_t_18 = ((*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) ))) &lt;= 0.0);
      if (__pyx_t_18) {
/* … */
        goto __pyx_L58;
      }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2999</span>:                 if random_uniform() &lt;= 0.5:</pre>
<pre class='cython code score-5 '>        __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2999, __pyx_L1_error)</span>
        __pyx_t_18 = (__pyx_t_23 &lt;= 0.5);
        if (__pyx_t_18) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3000</span>:                     choices_view[n, k, 0] += 1</pre>
<pre class='cython code score-0 '>          __pyx_t_19 = __pyx_v_n;
          __pyx_t_26 = __pyx_v_k;
          __pyx_t_20 = 0;
          *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_19 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_26 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[2]) )) += 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">3001</span>:             # Otherwise apply rule from above</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3002</span>:             elif random_uniform() &lt;= ((y_l + boundary_view[ix]) / (2 * boundary_view[ix])):</pre>
<pre class='cython code score-5 '>      __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3002, __pyx_L1_error)</span>
      __pyx_t_20 = __pyx_v_ix;
      __pyx_t_26 = __pyx_v_ix;
      __pyx_t_18 = (__pyx_t_23 &lt;= ((__pyx_v_y_l + (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))) / (2.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_26 * __pyx_v_boundary_view.strides[0]) ))))));
      if (__pyx_t_18) {
/* … */
      }
      __pyx_L58:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3003</span>:                 choices_view[n, k, 0] += 1</pre>
<pre class='cython code score-0 '>        __pyx_t_26 = __pyx_v_n;
        __pyx_t_20 = __pyx_v_k;
        __pyx_t_19 = 0;
        *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_26 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[2]) )) += 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">3004</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3005</span>:             if (rts_view[n, k, 0] &gt;= deadline_view[k]) | (deadline_view[k] &lt;= 0):</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = __pyx_v_n;
      __pyx_t_20 = __pyx_v_k;
      __pyx_t_26 = 0;
      __pyx_t_24 = __pyx_v_k;
      __pyx_t_27 = __pyx_v_k;
      __pyx_t_18 = (((*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_19 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_20 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_26 * __pyx_v_rts_view.strides[2]) ))) &gt;= (*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_24 * __pyx_v_deadline_view.strides[0]) )))) | ((*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_27 * __pyx_v_deadline_view.strides[0]) ))) &lt;= 0.0));
      if (__pyx_t_18) {
/* … */
      }
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3006</span>:                 rts_view[n, k, 0] = -999</pre>
<pre class='cython code score-0 '>        __pyx_t_27 = __pyx_v_n;
        __pyx_t_24 = __pyx_v_k;
        __pyx_t_26 = 0;
        *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_27 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_24 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_26 * __pyx_v_rts_view.strides[2]) )) = -999.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3007</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3008</span>:     if return_option == 'full':</pre>
<pre class='cython code score-2 '>  __pyx_t_18 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_return_option, __pyx_n_u_full, Py_EQ)); if (unlikely((__pyx_t_18 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3008, __pyx_L1_error)</span>
  if (__pyx_t_18) {
/* … */
  }
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3009</span>:         return {'rts': rts, 'choices': choices, 'rts_high': rts_high, 'rts_low': rts_low,</pre>
<pre class='cython code score-23 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3009, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3009, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3009, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_rts_high, __pyx_v_rts_high) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3009, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_rts_low, __pyx_v_rts_low) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3009, __pyx_L1_error)</span>
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3010</span>:                 'metadata': {'vh': vh,</pre>
<pre class='cython code score-7 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(11);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3010, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_vh, ((PyObject *)__pyx_v_vh)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3010, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3011</span>:                             'vl1': vl1,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_vl1, ((PyObject *)__pyx_v_vl1)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3010, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3012</span>:                             'vl2': vl2,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_vl2, ((PyObject *)__pyx_v_vl2)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3010, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3013</span>:                             'a': a,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3010, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3014</span>:                             'zh': zh,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_zh, ((PyObject *)__pyx_v_zh)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3010, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3015</span>:                             'zl1': zl1,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_zl1, ((PyObject *)__pyx_v_zl1)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3010, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3016</span>:                             'zl2': zl2,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_zl2, ((PyObject *)__pyx_v_zl2)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3010, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3017</span>:                             'd': d,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_d, ((PyObject *)__pyx_v_d)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3010, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3018</span>:                             't': t,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3010, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3019</span>:                             'deadline': deadline,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_deadline, ((PyObject *)__pyx_v_deadline)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3010, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3020</span>:                             's': s,</pre>
<pre class='cython code score-11 '>    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_s);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3020, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_s, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3010, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_10 = __pyx_t_6;
    __pyx_t_6 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3021</span>:                             **boundary_params,</pre>
<pre class='cython code score-17 '>    if (unlikely(__pyx_v_boundary_params == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
      <span class='error_goto'>__PYX_ERR(0, 3021, __pyx_L1_error)</span>
    }
    if (unlikely(<span class='py_c_api'>PyDict_Update</span>(__pyx_t_10, __pyx_v_boundary_params) &lt; 0)) {
      if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseMappingExpectedError</span>(__pyx_v_boundary_params);
      <span class='error_goto'>__PYX_ERR(0, 3021, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3022</span>:                             'delta_t': delta_t,</pre>
<pre class='cython code score-11 '>    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_t);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3022, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_delta_t, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3022, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3023</span>:                             'max_t': max_t,</pre>
<pre class='cython code score-11 '>    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_max_t);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3023, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_max_t, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3023, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3024</span>:                             'n_samples': n_samples,</pre>
<pre class='cython code score-8 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3024, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_n_samples, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3024, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3025</span>:                             'n_trials': n_trials,</pre>
<pre class='cython code score-13 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3025, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_n_trials, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3025, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_simulator, __pyx_n_u_ddm_flexbound_mic2_adj) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3026, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">3026</span>:                             'simulator': 'ddm_flexbound_mic2_adj',</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3027</span>:                             'boundary_fun_type': boundary_fun.__name__,</pre>
<pre class='cython code score-8 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_boundary_fun, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3027, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_boundary_fun_type, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3027, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3028</span>:                             'possible_choices': [0, 1, 2, 3],</pre>
<pre class='cython code score-23 '>    __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3028, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 0, __pyx_int_0)) <span class='error_goto'>__PYX_ERR(0, 3028, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 3028, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 2, __pyx_int_2)) <span class='error_goto'>__PYX_ERR(0, 3028, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 3, __pyx_int_3)) <span class='error_goto'>__PYX_ERR(0, 3028, __pyx_L1_error)</span>;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_possible_choices, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3028, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3029</span>:                             'trajectory': traj,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_trajectory, __pyx_v_traj) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3029, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3030</span>:                             'boundary': boundary}}</pre>
<pre class='cython code score-11 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_boundary, __pyx_v_boundary) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3030, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_metadata, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3009, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_r = __pyx_t_5;
    __pyx_t_5 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3031</span>:     elif return_option == 'minimal':</pre>
<pre class='cython code score-2 '>  __pyx_t_18 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_return_option, __pyx_n_u_minimal, Py_EQ)); if (unlikely((__pyx_t_18 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3031, __pyx_L1_error)</span>
  if (likely(__pyx_t_18)) {
/* … */
  }
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3032</span>:         return {'rts': rts, 'choices': choices, 'rts_high': rts_high, 'rts_low': rts_low,</pre>
<pre class='cython code score-23 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3032, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3032, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3032, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_rts_high, __pyx_v_rts_high) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3032, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_rts_low, __pyx_v_rts_low) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3032, __pyx_L1_error)</span>
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3033</span>:                 'metadata': {'simulator': 'ddm_flexbound_mic2_adj',</pre>
<pre class='cython code score-7 '>    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3033, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_simulator, __pyx_n_u_ddm_flexbound_mic2_adj) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3033, __pyx_L1_error)</span>
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3034</span>:                              'possible_choices': [0, 1, 2, 3],</pre>
<pre class='cython code score-23 '>    __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3034, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 0, __pyx_int_0)) <span class='error_goto'>__PYX_ERR(0, 3034, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 3034, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 2, __pyx_int_2)) <span class='error_goto'>__PYX_ERR(0, 3034, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 3, __pyx_int_3)) <span class='error_goto'>__PYX_ERR(0, 3034, __pyx_L1_error)</span>;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_possible_choices, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3033, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3035</span>:                              'boundary_fun_type': boundary_fun.__name__,</pre>
<pre class='cython code score-8 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_boundary_fun, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3035, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_boundary_fun_type, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3033, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3036</span>:                              'n_samples': n_samples,</pre>
<pre class='cython code score-8 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3036, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_n_samples, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3033, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3037</span>:                              'n_trials': n_trials,</pre>
<pre class='cython code score-14 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3037, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_n_trials, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3033, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_metadata, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3032, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_r = __pyx_t_5;
    __pyx_t_5 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3038</span>:                              }}</pre>
<pre class="cython line score-0">&#xA0;<span class="">3039</span>:     else:</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3040</span>:         raise ValueError('return_option must be either "full" or "minimal"')</pre>
<pre class='cython code score-5 '>  /*else*/ {
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3040, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_5, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='error_goto'>__PYX_ERR(0, 3040, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">3041</span>: # ----------------------------------------------------------------------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">3042</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3043</span>: # Simulate (rt, choice) tuples from: DDM WITH FLEXIBLE BOUNDARIES ------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">3044</span>: # @cythonboundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3045</span>: # @cythonwraparound(False)</pre>
<pre class="cython line score-181" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3046</span>: def ddm_flexbound_mic2_ornstein_multinoise(np.ndarray[float, ndim = 1] vh,</pre>
<pre class='cython code score-181 '>static PyObject *__pyx_pf_4cssm_70__defaults__(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_r = NULL;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
/* … */
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(12);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3046, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 2, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 3, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 4, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_True));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_True));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 5, ((PyObject *)Py_True))) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 6, Py_None)) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_True));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_True));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 7, ((PyObject *)Py_True))) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults12, __pyx_self)-&gt;__pyx_arg_boundary_params);
  <span class='refnanny'>__Pyx_GIVEREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults12, __pyx_self)-&gt;__pyx_arg_boundary_params);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 8, <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults12, __pyx_self)-&gt;__pyx_arg_boundary_params)) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 9, Py_None)) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject*)__pyx_n_u_full));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject*)__pyx_n_u_full));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 10, ((PyObject*)__pyx_n_u_full))) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_False));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_False));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 11, ((PyObject *)Py_False))) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3046, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 1, Py_None)) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>;
  __pyx_t_6 = 0;
  __pyx_r = __pyx_t_5;
  __pyx_t_5 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.__defaults__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_4cssm_33ddm_flexbound_mic2_ornstein_multinoise(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_4cssm_33ddm_flexbound_mic2_ornstein_multinoise = {"ddm_flexbound_mic2_ornstein_multinoise", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_4cssm_33ddm_flexbound_mic2_ornstein_multinoise, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_4cssm_33ddm_flexbound_mic2_ornstein_multinoise(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyArrayObject *__pyx_v_vh = 0;
  PyArrayObject *__pyx_v_vl1 = 0;
  PyArrayObject *__pyx_v_vl2 = 0;
  PyArrayObject *__pyx_v_a = 0;
  PyArrayObject *__pyx_v_zh = 0;
  PyArrayObject *__pyx_v_zl1 = 0;
  PyArrayObject *__pyx_v_zl2 = 0;
  PyArrayObject *__pyx_v_d = 0;
  PyArrayObject *__pyx_v_g = 0;
  PyArrayObject *__pyx_v_t = 0;
  PyArrayObject *__pyx_v_deadline = 0;
  float __pyx_v_s;
  float __pyx_v_delta_t;
  float __pyx_v_max_t;
  int __pyx_v_n_samples;
  int __pyx_v_n_trials;
  CYTHON_UNUSED PyObject *__pyx_v_print_info = 0;
  PyObject *__pyx_v_boundary_fun = 0;
  PyObject *__pyx_v_boundary_multiplicative = 0;
  PyObject *__pyx_v_boundary_params = 0;
  PyObject *__pyx_v_random_state = 0;
  PyObject *__pyx_v_return_option = 0;
  PyObject *__pyx_v_smooth = 0;
  CYTHON_UNUSED PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("ddm_flexbound_mic2_ornstein_multinoise (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_vh,&amp;__pyx_n_s_vl1,&amp;__pyx_n_s_vl2,&amp;__pyx_n_s_a,&amp;__pyx_n_s_zh,&amp;__pyx_n_s_zl1,&amp;__pyx_n_s_zl2,&amp;__pyx_n_s_d,&amp;__pyx_n_s_g,&amp;__pyx_n_s_t,&amp;__pyx_n_s_deadline,&amp;__pyx_n_s_s,&amp;__pyx_n_s_delta_t,&amp;__pyx_n_s_max_t,&amp;__pyx_n_s_n_samples,&amp;__pyx_n_s_n_trials,&amp;__pyx_n_s_print_info,&amp;__pyx_n_s_boundary_fun,&amp;__pyx_n_s_boundary_multiplicative,&amp;__pyx_n_s_boundary_params,&amp;__pyx_n_s_random_state,&amp;__pyx_n_s_return_option,&amp;__pyx_n_s_smooth,0};
  PyObject* values[23] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    __pyx_defaults12 *__pyx_dynamic_args = <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults12, __pyx_self);
    values[16] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_True)));
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs);
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4cssm_32ddm_flexbound_mic2_ornstein_multinoise(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_vh, PyArrayObject *__pyx_v_vl1, PyArrayObject *__pyx_v_vl2, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_zh, PyArrayObject *__pyx_v_zl1, PyArrayObject *__pyx_v_zl2, PyArrayObject *__pyx_v_d, PyArrayObject *__pyx_v_g, PyArrayObject *__pyx_v_t, PyArrayObject *__pyx_v_deadline, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, CYTHON_UNUSED PyObject *__pyx_v_print_info, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state, PyObject *__pyx_v_return_option, PyObject *__pyx_v_smooth, CYTHON_UNUSED PyObject *__pyx_v_kwargs) {
  __Pyx_memviewslice __pyx_v_vh_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_vl1_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_vl2_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_a_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_zh_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_zl1_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_zl2_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_d_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_g_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_t_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_deadline_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_rts = NULL;
  PyObject *__pyx_v_choices = NULL;
  PyObject *__pyx_v_rts_low = NULL;
  PyObject *__pyx_v_rts_high = NULL;
  __Pyx_memviewslice __pyx_v_rts_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_rts_high_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_rts_low_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_choices_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_traj = NULL;
  __Pyx_memviewslice __pyx_v_traj_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  float __pyx_v_delta_t_sqrt;
  float __pyx_v_sqrt_st;
  int __pyx_v_num_draws;
  PyObject *__pyx_v_t_s = NULL;
  PyObject *__pyx_v_boundary = NULL;
  __Pyx_memviewslice __pyx_v_boundary_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_bias_trace_l1 = NULL;
  PyObject *__pyx_v_bias_trace_l2 = NULL;
  __Pyx_memviewslice __pyx_v_bias_trace_l1_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_bias_trace_l2_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  float __pyx_v_y_h;
  float __pyx_v_y_l;
  float __pyx_v_y_l1;
  float __pyx_v_y_l2;
  float __pyx_v_t_h;
  float __pyx_v_t_l;
  float __pyx_v_t_l1;
  float __pyx_v_t_l2;
  CYTHON_UNUSED float __pyx_v_smooth_u;
  float __pyx_v_deadline_tmp;
  Py_ssize_t __pyx_v_n;
  Py_ssize_t __pyx_v_ix;
  Py_ssize_t __pyx_v_ix1;
  Py_ssize_t __pyx_v_ix2;
  CYTHON_UNUSED Py_ssize_t __pyx_v_ix_l;
  Py_ssize_t __pyx_v_ix1_tmp;
  Py_ssize_t __pyx_v_ix2_tmp;
  Py_ssize_t __pyx_v_k;
  Py_ssize_t __pyx_v_m;
  __Pyx_memviewslice __pyx_v_gaussian_values = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_boundary_params_tmp = NULL;
  PyObject *__pyx_9genexpr13__pyx_v_key = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_a;
  __Pyx_Buffer __pyx_pybuffer_a;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_d;
  __Pyx_Buffer __pyx_pybuffer_d;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_deadline;
  __Pyx_Buffer __pyx_pybuffer_deadline;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_g;
  __Pyx_Buffer __pyx_pybuffer_g;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_t;
  __Pyx_Buffer __pyx_pybuffer_t;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_vh;
  __Pyx_Buffer __pyx_pybuffer_vh;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_vl1;
  __Pyx_Buffer __pyx_pybuffer_vl1;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_vl2;
  __Pyx_Buffer __pyx_pybuffer_vl2;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_zh;
  __Pyx_Buffer __pyx_pybuffer_zh;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_zl1;
  __Pyx_Buffer __pyx_pybuffer_zl1;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_zl2;
  __Pyx_Buffer __pyx_pybuffer_zl2;
  PyObject *__pyx_r = NULL;
  __pyx_pybuffer_vh.pybuffer.buf = NULL;
  __pyx_pybuffer_vh.refcount = 0;
  __pyx_pybuffernd_vh.data = NULL;
  __pyx_pybuffernd_vh.rcbuffer = &amp;__pyx_pybuffer_vh;
  __pyx_pybuffer_vl1.pybuffer.buf = NULL;
  __pyx_pybuffer_vl1.refcount = 0;
  __pyx_pybuffernd_vl1.data = NULL;
  __pyx_pybuffernd_vl1.rcbuffer = &amp;__pyx_pybuffer_vl1;
  __pyx_pybuffer_vl2.pybuffer.buf = NULL;
  __pyx_pybuffer_vl2.refcount = 0;
  __pyx_pybuffernd_vl2.data = NULL;
  __pyx_pybuffernd_vl2.rcbuffer = &amp;__pyx_pybuffer_vl2;
  __pyx_pybuffer_a.pybuffer.buf = NULL;
  __pyx_pybuffer_a.refcount = 0;
  __pyx_pybuffernd_a.data = NULL;
  __pyx_pybuffernd_a.rcbuffer = &amp;__pyx_pybuffer_a;
  __pyx_pybuffer_zh.pybuffer.buf = NULL;
  __pyx_pybuffer_zh.refcount = 0;
  __pyx_pybuffernd_zh.data = NULL;
  __pyx_pybuffernd_zh.rcbuffer = &amp;__pyx_pybuffer_zh;
  __pyx_pybuffer_zl1.pybuffer.buf = NULL;
  __pyx_pybuffer_zl1.refcount = 0;
  __pyx_pybuffernd_zl1.data = NULL;
  __pyx_pybuffernd_zl1.rcbuffer = &amp;__pyx_pybuffer_zl1;
  __pyx_pybuffer_zl2.pybuffer.buf = NULL;
  __pyx_pybuffer_zl2.refcount = 0;
  __pyx_pybuffernd_zl2.data = NULL;
  __pyx_pybuffernd_zl2.rcbuffer = &amp;__pyx_pybuffer_zl2;
  __pyx_pybuffer_d.pybuffer.buf = NULL;
  __pyx_pybuffer_d.refcount = 0;
  __pyx_pybuffernd_d.data = NULL;
  __pyx_pybuffernd_d.rcbuffer = &amp;__pyx_pybuffer_d;
  __pyx_pybuffer_g.pybuffer.buf = NULL;
  __pyx_pybuffer_g.refcount = 0;
  __pyx_pybuffernd_g.data = NULL;
  __pyx_pybuffernd_g.rcbuffer = &amp;__pyx_pybuffer_g;
  __pyx_pybuffer_t.pybuffer.buf = NULL;
  __pyx_pybuffer_t.refcount = 0;
  __pyx_pybuffernd_t.data = NULL;
  __pyx_pybuffernd_t.rcbuffer = &amp;__pyx_pybuffer_t;
  __pyx_pybuffer_deadline.pybuffer.buf = NULL;
  __pyx_pybuffer_deadline.refcount = 0;
  __pyx_pybuffernd_deadline.data = NULL;
  __pyx_pybuffernd_deadline.rcbuffer = &amp;__pyx_pybuffer_deadline;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_vh, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_vh.diminfo[0].strides = __pyx_pybuffernd_vh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_vh.diminfo[0].shape = __pyx_pybuffernd_vh.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vl1.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_vl1, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_vl1.diminfo[0].strides = __pyx_pybuffernd_vl1.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_vl1.diminfo[0].shape = __pyx_pybuffernd_vl1.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vl2.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_vl2, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_vl2.diminfo[0].strides = __pyx_pybuffernd_vl2.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_vl2.diminfo[0].shape = __pyx_pybuffernd_vl2.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_a, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_zh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_zh, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_zh.diminfo[0].strides = __pyx_pybuffernd_zh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_zh.diminfo[0].shape = __pyx_pybuffernd_zh.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_zl1.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_zl1, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_zl1.diminfo[0].strides = __pyx_pybuffernd_zl1.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_zl1.diminfo[0].shape = __pyx_pybuffernd_zl1.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_zl2.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_zl2, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_zl2.diminfo[0].strides = __pyx_pybuffernd_zl2.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_zl2.diminfo[0].shape = __pyx_pybuffernd_zl2.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_d.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_d, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_d.diminfo[0].strides = __pyx_pybuffernd_d.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_d.diminfo[0].shape = __pyx_pybuffernd_d.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_g.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_g, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_g.diminfo[0].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_g.diminfo[0].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_t, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_t.diminfo[0].strides = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_t.diminfo[0].shape = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_deadline, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_deadline.diminfo[0].strides = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_deadline.diminfo[0].shape = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.shape[0];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_2, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_7, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_9, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_d.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_g.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vh.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vl1.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vl2.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zh.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zl1.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zl2.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.ddm_flexbound_mic2_ornstein_multinoise", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_d.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_g.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vl1.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vl2.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zl1.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zl2.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_vh_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_vl1_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_vl2_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_a_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_zh_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_zl1_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_zl2_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_d_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_g_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_t_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_deadline_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_choices);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rts_low);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rts_high);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_rts_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_rts_high_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_rts_low_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_choices_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_traj);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_traj_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t_s);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_boundary);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_boundary_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_bias_trace_l1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_bias_trace_l2);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_bias_trace_l1_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_bias_trace_l2_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_boundary_params_tmp);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_9genexpr13__pyx_v_key);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__55 = <span class='py_c_api'>PyTuple_Pack</span>(81, __pyx_n_s_vh, __pyx_n_s_vl1, __pyx_n_s_vl2, __pyx_n_s_a, __pyx_n_s_zh, __pyx_n_s_zl1, __pyx_n_s_zl2, __pyx_n_s_d, __pyx_n_s_g, __pyx_n_s_t, __pyx_n_s_deadline, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_print_info, __pyx_n_s_boundary_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_random_state, __pyx_n_s_return_option, __pyx_n_s_smooth, __pyx_n_s_kwargs, __pyx_n_s_vh_view, __pyx_n_s_vl1_view, __pyx_n_s_vl2_view, __pyx_n_s_a_view, __pyx_n_s_zh_view, __pyx_n_s_zl1_view, __pyx_n_s_zl2_view, __pyx_n_s_d_view, __pyx_n_s_g_view, __pyx_n_s_t_view, __pyx_n_s_deadline_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_low, __pyx_n_s_rts_high, __pyx_n_s_rts_view, __pyx_n_s_rts_high_view, __pyx_n_s_rts_low_view, __pyx_n_s_choices_view, __pyx_n_s_traj, __pyx_n_s_traj_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_num_draws, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_boundary_view, __pyx_n_s_bias_trace_l1, __pyx_n_s_bias_trace_l2, __pyx_n_s_bias_trace_l1_view, __pyx_n_s_bias_trace_l2_view, __pyx_n_s_y_h, __pyx_n_s_y_l, __pyx_n_s_y_l1, __pyx_n_s_y_l2, __pyx_n_s_v_l, __pyx_n_s_v_l1, __pyx_n_s_v_l2, __pyx_n_s_t_h, __pyx_n_s_t_l, __pyx_n_s_t_l1, __pyx_n_s_t_l2, __pyx_n_s_smooth_u, __pyx_n_s_deadline_tmp, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_ix1, __pyx_n_s_ix2, __pyx_n_s_ix_l, __pyx_n_s_ix_tmp, __pyx_n_s_ix1_tmp, __pyx_n_s_ix2_tmp, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_gaussian_values, __pyx_n_s_boundary_params_tmp, __pyx_n_s_key);<span class='error_goto'> if (unlikely(!__pyx_tuple__55)) __PYX_ERR(0, 3046, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__55);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__55);
/* … */
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_4cssm_33ddm_flexbound_mic2_ornstein_multinoise, 0, __pyx_n_s_ddm_flexbound_mic2_ornstein_mult, NULL, __pyx_n_s_cssm, __pyx_d, ((PyObject *)__pyx_codeobj__56));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3046, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (!<span class='pyx_c_api'>__Pyx_CyFunction_InitDefaults</span>(__pyx_t_5, sizeof(__pyx_defaults12), 1)) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>
  __pyx_codeobj__56 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(23, 0, 0, 81, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__55, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_ddm_flexbound_mic2_ornstein_mult, 3046, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__56)) __PYX_ERR(0, 3046, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">3047</span>:                                            np.ndarray[float, ndim = 1] vl1,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3048</span>:                                            np.ndarray[float, ndim = 1] vl2,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3049</span>:                                            np.ndarray[float, ndim = 1] a,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3050</span>:                                            np.ndarray[float, ndim = 1] zh,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3051</span>:                                            np.ndarray[float, ndim = 1] zl1,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3052</span>:                                            np.ndarray[float, ndim = 1] zl2,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3053</span>:                                            np.ndarray[float, ndim = 1] d, # damper (1 --&gt; no drift on low level until high level done, 0 --&gt; full drift on low level)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3054</span>:                                            np.ndarray[float, ndim = 1] g, # inhibition parameter for the low dim choice procress while high dim is running</pre>
<pre class="cython line score-0">&#xA0;<span class="">3055</span>:                                            np.ndarray[float, ndim = 1] t,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3056</span>:                                            np.ndarray[float, ndim = 1] deadline,</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3057</span>:                                            float s = 1.0,</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(((double)1.0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3057, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3058</span>:                                            float delta_t = 0.001,</pre>
<pre class='cython code score-5 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(((double)0.001));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3058, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3059</span>:                                            float max_t = 20,</pre>
<pre class='cython code score-5 '>  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)20.0));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3059, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3060</span>:                                            int n_samples = 20000,</pre>
<pre class='cython code score-2 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)0x4E20));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3060, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3061</span>:                                            int n_trials = 1,</pre>
<pre class='cython code score-2 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)1));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3061, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
</pre><pre class="cython line score-0">&#xA0;<span class="">3062</span>:                                            print_info = True,</pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3063</span>:                                            boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)</pre>
<pre class='cython code score-6 '>    values[17] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[18] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_True)));
    values[19] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(__pyx_dynamic_args-&gt;__pyx_arg_boundary_params);
</pre><pre class="cython line score-0">&#xA0;<span class="">3064</span>:                                            boundary_multiplicative = True,</pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3065</span>:                                            boundary_params = {},</pre>
<pre class='cython code score-12 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3065, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults12, __pyx_t_5)-&gt;__pyx_arg_boundary_params = __pyx_t_4;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_4 = 0;
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsGetter</span>(__pyx_t_5, __pyx_pf_4cssm_70__defaults__);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_ddm_flexbound_mic2_ornstein_mult, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-402" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3066</span>:                                            random_state = None,</pre>
<pre class='cython code score-402 '>    values[20] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[21] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_full)));
    values[22] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case 23: values[22] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 22);
        CYTHON_FALLTHROUGH;
        case 22: values[21] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 21);
        CYTHON_FALLTHROUGH;
        case 21: values[20] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 20);
        CYTHON_FALLTHROUGH;
        case 20: values[19] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 19);
        CYTHON_FALLTHROUGH;
        case 19: values[18] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 18);
        CYTHON_FALLTHROUGH;
        case 18: values[17] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 17);
        CYTHON_FALLTHROUGH;
        case 17: values[16] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 16);
        CYTHON_FALLTHROUGH;
        case 16: values[15] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 15);
        CYTHON_FALLTHROUGH;
        case 15: values[14] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_vh)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_vl1)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_ornstein_multinoise", 0, 11, 23, 1); <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_vl2)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_ornstein_multinoise", 0, 11, 23, 2); <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_a)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[3]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_ornstein_multinoise", 0, 11, 23, 3); <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_zh)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[4]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_ornstein_multinoise", 0, 11, 23, 4); <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_zl1)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[5]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_ornstein_multinoise", 0, 11, 23, 5); <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_zl2)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[6]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_ornstein_multinoise", 0, 11, 23, 6); <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (likely((values[7] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_d)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[7]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_ornstein_multinoise", 0, 11, 23, 7); <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (likely((values[8] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_g)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[8]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_ornstein_multinoise", 0, 11, 23, 8); <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  9:
        if (likely((values[9] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_t)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[9]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_ornstein_multinoise", 0, 11, 23, 9); <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 10:
        if (likely((values[10] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_deadline)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[10]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_ornstein_multinoise", 0, 11, 23, 10); <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 11:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_s);
          if (value) { values[11] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 12:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_delta_t);
          if (value) { values[12] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 13:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_max_t);
          if (value) { values[13] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 14:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_samples);
          if (value) { values[14] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 15:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_trials);
          if (value) { values[15] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 16:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_print_info);
          if (value) { values[16] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 17:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_fun);
          if (value) { values[17] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 18:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_multiplicative);
          if (value) { values[18] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 19:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_params);
          if (value) { values[19] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 20:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_random_state);
          if (value) { values[20] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 21:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_return_option);
          if (value) { values[21] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 22:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_smooth);
          if (value) { values[22] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values + 0, kwd_pos_args, "ddm_flexbound_mic2_ornstein_multinoise") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case 23: values[22] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 22);
        CYTHON_FALLTHROUGH;
        case 22: values[21] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 21);
        CYTHON_FALLTHROUGH;
        case 21: values[20] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 20);
        CYTHON_FALLTHROUGH;
        case 20: values[19] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 19);
        CYTHON_FALLTHROUGH;
        case 19: values[18] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 18);
        CYTHON_FALLTHROUGH;
        case 18: values[17] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 17);
        CYTHON_FALLTHROUGH;
        case 17: values[16] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 16);
        CYTHON_FALLTHROUGH;
        case 16: values[15] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 15);
        CYTHON_FALLTHROUGH;
        case 15: values[14] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_vh = ((PyArrayObject *)values[0]);
    __pyx_v_vl1 = ((PyArrayObject *)values[1]);
    __pyx_v_vl2 = ((PyArrayObject *)values[2]);
    __pyx_v_a = ((PyArrayObject *)values[3]);
    __pyx_v_zh = ((PyArrayObject *)values[4]);
    __pyx_v_zl1 = ((PyArrayObject *)values[5]);
    __pyx_v_zl2 = ((PyArrayObject *)values[6]);
    __pyx_v_d = ((PyArrayObject *)values[7]);
    __pyx_v_g = ((PyArrayObject *)values[8]);
    __pyx_v_t = ((PyArrayObject *)values[9]);
    __pyx_v_deadline = ((PyArrayObject *)values[10]);
    if (values[11]) {
      __pyx_v_s = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[11]); if (unlikely((__pyx_v_s == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3057, __pyx_L3_error)</span>
    } else {
      __pyx_v_s = ((float)((double)1.0));
    }
    if (values[12]) {
      __pyx_v_delta_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[12]); if (unlikely((__pyx_v_delta_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3058, __pyx_L3_error)</span>
    } else {
      __pyx_v_delta_t = ((float)((double)0.001));
    }
    if (values[13]) {
      __pyx_v_max_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[13]); if (unlikely((__pyx_v_max_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3059, __pyx_L3_error)</span>
    } else {
      __pyx_v_max_t = ((float)((float)20.0));
    }
    if (values[14]) {
      __pyx_v_n_samples = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[14]); if (unlikely((__pyx_v_n_samples == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3060, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_samples = ((int)((int)0x4E20));
    }
    if (values[15]) {
      __pyx_v_n_trials = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[15]); if (unlikely((__pyx_v_n_trials == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3061, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_trials = ((int)((int)1));
    }
    __pyx_v_print_info = values[16];
    __pyx_v_boundary_fun = values[17];
    __pyx_v_boundary_multiplicative = values[18];
    __pyx_v_boundary_params = values[19];
    __pyx_v_random_state = values[20];
    __pyx_v_return_option = values[21];
    __pyx_v_smooth = values[22];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_ornstein_multinoise", 0, 11, 23, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.ddm_flexbound_mic2_ornstein_multinoise", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_vh), __pyx_ptype_5numpy_ndarray, 1, "vh", 0))) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_vl1), __pyx_ptype_5numpy_ndarray, 1, "vl1", 0))) <span class='error_goto'>__PYX_ERR(0, 3047, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_vl2), __pyx_ptype_5numpy_ndarray, 1, "vl2", 0))) <span class='error_goto'>__PYX_ERR(0, 3048, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) <span class='error_goto'>__PYX_ERR(0, 3049, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_zh), __pyx_ptype_5numpy_ndarray, 1, "zh", 0))) <span class='error_goto'>__PYX_ERR(0, 3050, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_zl1), __pyx_ptype_5numpy_ndarray, 1, "zl1", 0))) <span class='error_goto'>__PYX_ERR(0, 3051, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_zl2), __pyx_ptype_5numpy_ndarray, 1, "zl2", 0))) <span class='error_goto'>__PYX_ERR(0, 3052, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_d), __pyx_ptype_5numpy_ndarray, 1, "d", 0))) <span class='error_goto'>__PYX_ERR(0, 3053, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_g), __pyx_ptype_5numpy_ndarray, 1, "g", 0))) <span class='error_goto'>__PYX_ERR(0, 3054, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) <span class='error_goto'>__PYX_ERR(0, 3055, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_deadline), __pyx_ptype_5numpy_ndarray, 1, "deadline", 0))) <span class='error_goto'>__PYX_ERR(0, 3056, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_4cssm_32ddm_flexbound_mic2_ornstein_multinoise(__pyx_self, __pyx_v_vh, __pyx_v_vl1, __pyx_v_vl2, __pyx_v_a, __pyx_v_zh, __pyx_v_zl1, __pyx_v_zl2, __pyx_v_d, __pyx_v_g, __pyx_v_t, __pyx_v_deadline, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_print_info, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state, __pyx_v_return_option, __pyx_v_smooth, __pyx_v_kwargs);
</pre><pre class="cython line score-0">&#xA0;<span class="">3067</span>:                                            return_option = 'full',</pre>
<pre class="cython line score-0">&#xA0;<span class="">3068</span>:                                            smooth = False,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3069</span>:                                            **kwargs):</pre>
<pre class="cython line score-0">&#xA0;<span class="">3070</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3071</span>:     set_seed(random_state)</pre>
<pre class='cython code score-1 '>  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3071, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3072</span>:     # Param views</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3073</span>:     cdef float[:] vh_view = vh</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_vh), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 3073, __pyx_L1_error)</span>
  __pyx_v_vh_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3074</span>:     cdef float[:] vl1_view = vl1</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_vl1), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 3074, __pyx_L1_error)</span>
  __pyx_v_vl1_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3075</span>:     cdef float[:] vl2_view = vl2</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_vl2), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 3075, __pyx_L1_error)</span>
  __pyx_v_vl2_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3076</span>:     cdef float[:] a_view = a</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_a), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 3076, __pyx_L1_error)</span>
  __pyx_v_a_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3077</span>:     cdef float[:] zh_view = zh</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_zh), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 3077, __pyx_L1_error)</span>
  __pyx_v_zh_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3078</span>:     cdef float[:] zl1_view = zl1</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_zl1), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 3078, __pyx_L1_error)</span>
  __pyx_v_zl1_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3079</span>:     cdef float[:] zl2_view = zl2</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_zl2), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 3079, __pyx_L1_error)</span>
  __pyx_v_zl2_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3080</span>:     cdef float[:] d_view = d</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_d), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 3080, __pyx_L1_error)</span>
  __pyx_v_d_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3081</span>:     cdef float[:] g_view = g</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_g), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 3081, __pyx_L1_error)</span>
  __pyx_v_g_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3082</span>:     cdef float[:] t_view = t</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_t), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 3082, __pyx_L1_error)</span>
  __pyx_v_t_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3083</span>:     cdef float[:] deadline_view = deadline</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_deadline), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 3083, __pyx_L1_error)</span>
  __pyx_v_deadline_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">3084</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3085</span>:     # TD: Add trajectory --&gt; same issue as with par2 model above... might need to make a separate simulator for trajectories</pre>
<pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3086</span>:     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)</pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3086, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3086, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3086, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3086, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3086, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3086, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 3086, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 3086, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3086, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3086, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3086, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3086, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3086, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3086, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_rts = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3087</span>:     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)</pre>
<pre class='cython code score-46 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3087, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3087, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3087, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3087, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3087, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3087, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 3087, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 3087, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3087, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 3087, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3087, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3087, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_intc);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3087, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3087, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3087, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_choices = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3088</span>:     rts_low = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)</pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3088, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3088, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3088, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3088, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3088, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 3088, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 3088, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 3088, __pyx_L1_error)</span>;
  __pyx_t_6 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3088, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3088, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3088, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3088, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3088, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3088, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_rts_low = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3089</span>:     rts_high = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)</pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3089, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3089, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3089, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3089, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3089, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 3089, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 3089, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 3089, __pyx_L1_error)</span>;
  __pyx_t_6 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3089, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 3089, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3089, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3089, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3089, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3089, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_rts_high = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3090</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3091</span>:     cdef float[:, :, :] rts_view = rts</pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_rts, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 3091, __pyx_L1_error)</span>
  __pyx_v_rts_view = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3092</span>:     cdef float[:, :, :] rts_high_view = rts_high</pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_rts_high, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 3092, __pyx_L1_error)</span>
  __pyx_v_rts_high_view = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3093</span>:     cdef float[:, :, :] rts_low_view = rts_low</pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_rts_low, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 3093, __pyx_L1_error)</span>
  __pyx_v_rts_low_view = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3094</span>:     cdef int[:, :, :] choices_view = choices</pre>
<pre class='cython code score-2 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_int</span>(__pyx_v_choices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 3094, __pyx_L1_error)</span>
  __pyx_v_choices_view = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">3095</span>: </pre>
<pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3096</span>:     traj = np.zeros((int(max_t / delta_t) + 1, 3), dtype = DTYPE)</pre>
<pre class='cython code score-42 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3096, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3096, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_FromDouble</span>((__pyx_v_max_t / __pyx_v_delta_t));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3096, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_6, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3096, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3096, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 3096, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_int_3)) <span class='error_goto'>__PYX_ERR(0, 3096, __pyx_L1_error)</span>;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3096, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 3096, __pyx_L1_error)</span>;
  __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3096, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3096, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3096, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3096, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_traj = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3097</span>:     traj[:, :] = -999</pre>
<pre class='cython code score-5 '>  if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_traj, __pyx_tuple__12, __pyx_int_neg_999) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3097, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3098</span>:     cdef float[:, :] traj_view = traj</pre>
<pre class='cython code score-2 '>  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(__pyx_v_traj, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 3098, __pyx_L1_error)</span>
  __pyx_v_traj_view = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">3099</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3100</span>:     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion</pre>
<pre class='cython code score-0 '>  __pyx_v_delta_t_sqrt = sqrt(__pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3101</span>:     cdef float sqrt_st = delta_t_sqrt * s # scalar to ensure the correct variance for the gaussian step</pre>
<pre class='cython code score-0 '>  __pyx_v_sqrt_st = (__pyx_v_delta_t_sqrt * __pyx_v_s);
</pre><pre class="cython line score-0">&#xA0;<span class="">3102</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3103</span>:     # Boundary storage for the upper bound</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3104</span>:     cdef int num_draws = int((max_t / delta_t) + 1)</pre>
<pre class='cython code score-0 '>  __pyx_v_num_draws = ((int)((__pyx_v_max_t / __pyx_v_delta_t) + 1.0));
</pre><pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3105</span>:     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)</pre>
<pre class='cython code score-51 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3105, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3105, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_max_t + __pyx_v_delta_t));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3105, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_t);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3105, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_10 = NULL;
  __pyx_t_11 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_10)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_11 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[4] = {__pyx_t_10, __pyx_int_0, __pyx_t_4, __pyx_t_1};
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_11, 3+__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 3105, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3105, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3105, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_1 = NULL;
  __pyx_t_11 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_11 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_6};
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_11, 1+__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3105, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_v_t_s = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3106</span>:     boundary = np.zeros(t_s.shape, dtype = DTYPE)</pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3106, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3106, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_t_s, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3106, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3106, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3106, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3106, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3106, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3106, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_6, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3106, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_boundary = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3107</span>:     cdef float[:] boundary_view = boundary</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(__pyx_v_boundary, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 3107, __pyx_L1_error)</span>
  __pyx_v_boundary_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">3108</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3109</span>:     # Y particle trace</pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3110</span>:     bias_trace_l1 = np.zeros(num_draws, dtype = DTYPE)</pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3110, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3110, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3110, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3110, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3110, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3110, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3110, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3110, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_6, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3110, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_bias_trace_l1 = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3111</span>:     bias_trace_l2 = np.zeros(num_draws, dtype = DTYPE)</pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3111, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3111, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3111, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3111, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 3111, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3111, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3111, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3111, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_6, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3111, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_bias_trace_l2 = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3112</span>:     cdef float[:] bias_trace_l1_view = bias_trace_l1</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(__pyx_v_bias_trace_l1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 3112, __pyx_L1_error)</span>
  __pyx_v_bias_trace_l1_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3113</span>:     cdef float[:] bias_trace_l2_view = bias_trace_l2</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(__pyx_v_bias_trace_l2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 3113, __pyx_L1_error)</span>
  __pyx_v_bias_trace_l2_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">3114</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3115</span>:     cdef float y_h, y_l, y_l1, y_l2</pre>
<pre class="cython line score-0">&#xA0;<span class="">3116</span>:     cdef float v_l, v_l1, v_l2,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3117</span>:     cdef float t_h, t_l, t_l1, t_l2, smooth_u, deadline_tmp</pre>
<pre class="cython line score-0">&#xA0;<span class="">3118</span>:     cdef Py_ssize_t n, ix, ix1, ix2, ix_l, ix_tmp, ix1_tmp, ix2_tmp, k</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3119</span>:     cdef Py_ssize_t m = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_m = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3120</span>:     cdef float[:] gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 3120, __pyx_L1_error)</span>
  __pyx_v_gaussian_values = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">3121</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3122</span>:     for k in range(n_trials):</pre>
<pre class='cython code score-0 '>  __pyx_t_11 = __pyx_v_n_trials;
  __pyx_t_12 = __pyx_t_11;
  for (__pyx_t_13 = 0; __pyx_t_13 &lt; __pyx_t_12; __pyx_t_13+=1) {
    __pyx_v_k = __pyx_t_13;
</pre><pre class="cython line score-0">&#xA0;<span class="">3123</span>:         # Precompute boundary evaluations</pre>
<pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3124</span>:         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}</pre>
<pre class='cython code score-27 '>    { /* enter inner scope */
      __pyx_t_5 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3124, __pyx_L7_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_14 = 0;
      if (unlikely(__pyx_v_boundary_params == Py_None)) {
        <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "keys");
        <span class='error_goto'>__PYX_ERR(0, 3124, __pyx_L7_error)</span>
      }
      __pyx_t_6 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&amp;__pyx_t_15), (&amp;__pyx_t_16));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3124, __pyx_L7_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
      __pyx_t_3 = __pyx_t_6;
      __pyx_t_6 = 0;
      while (1) {
        __pyx_t_17 = __Pyx_dict_iter_next(__pyx_t_3, __pyx_t_15, &amp;__pyx_t_14, &amp;__pyx_t_6, NULL, NULL, __pyx_t_16);
        if (unlikely(__pyx_t_17 == 0)) break;
        if (unlikely(__pyx_t_17 == -1)) <span class='error_goto'>__PYX_ERR(0, 3124, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_9genexpr13__pyx_v_key, __pyx_t_6);
        __pyx_t_6 = 0;
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_boundary_params, __pyx_9genexpr13__pyx_v_key);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3124, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_6, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3124, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, (PyObject*)__pyx_9genexpr13__pyx_v_key, (PyObject*)__pyx_t_1))) <span class='error_goto'>__PYX_ERR(0, 3124, __pyx_L7_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_9genexpr13__pyx_v_key); __pyx_9genexpr13__pyx_v_key = 0;
      goto __pyx_L10_exit_scope;
      __pyx_L7_error:;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_9genexpr13__pyx_v_key); __pyx_9genexpr13__pyx_v_key = 0;
      goto __pyx_L1_error;
      __pyx_L10_exit_scope:;
    } /* exit inner scope */
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_boundary_params_tmp, ((PyObject*)__pyx_t_5));
    __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3125</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3126</span>:         # Precompute boundary evaluations</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3127</span>:         if boundary_multiplicative:</pre>
<pre class='cython code score-2 '>    __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_boundary_multiplicative); if (unlikely((__pyx_t_18 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3127, __pyx_L1_error)</span>
    if (__pyx_t_18) {
/* … */
      goto __pyx_L11;
    }
</pre><pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3128</span>:             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)</pre>
<pre class='cython code score-61 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3128, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_multiply);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3128, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_19 * __pyx_v_a_view.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3128, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3128, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_t, __pyx_v_t_s) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3128, __pyx_L1_error)</span>
      __pyx_t_4 = __pyx_t_10;
      __pyx_t_10 = 0;
      if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_4, __pyx_v_boundary_params_tmp) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3128, __pyx_L1_error)</span>
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3128, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_4, __pyx_t_1, __pyx_t_10};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_16, 2+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 3128, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      }
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3128, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3128, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_10 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
        __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
        if (likely(__pyx_t_10)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_10, __pyx_t_3};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_16, 1+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3128, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      }
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_boundary, __pyx_t_5, 0, 0, NULL, NULL, &amp;__pyx_slice__5, 0, 0, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3128, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3129</span>:         else:</pre>
<pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3130</span>:             boundary[:] = np.add(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)</pre>
<pre class='cython code score-61 '>    /*else*/ {
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3130, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_add);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3130, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_19 * __pyx_v_a_view.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3130, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3130, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_t, __pyx_v_t_s) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3130, __pyx_L1_error)</span>
      __pyx_t_1 = __pyx_t_4;
      __pyx_t_4 = 0;
      if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_1, __pyx_v_boundary_params_tmp) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3130, __pyx_L1_error)</span>
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3130, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
        __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
        if (likely(__pyx_t_1)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_1, __pyx_t_3, __pyx_t_4};
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_16, 2+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 3130, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      }
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3130, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3130, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_4 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_6};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_16, 1+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3130, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      }
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_boundary, __pyx_t_5, 0, 0, NULL, NULL, &amp;__pyx_slice__5, 0, 0, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3130, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
    __pyx_L11:;
</pre><pre class="cython line score-0">&#xA0;<span class="">3131</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3132</span>:         deadline_tmp = min(max_t, deadline_view[k] - t_view[k])</pre>
<pre class='cython code score-0 '>    __pyx_t_19 = __pyx_v_k;
    __pyx_t_20 = __pyx_v_k;
    __pyx_t_21 = ((*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_19 * __pyx_v_deadline_view.strides[0]) ))) - (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_20 * __pyx_v_t_view.strides[0]) ))));
    __pyx_t_22 = __pyx_v_max_t;
    __pyx_t_18 = (__pyx_t_21 &lt; __pyx_t_22);
    if (__pyx_t_18) {
      __pyx_t_23 = __pyx_t_21;
    } else {
      __pyx_t_23 = __pyx_t_22;
    }
    __pyx_v_deadline_tmp = __pyx_t_23;
</pre><pre class="cython line score-0">&#xA0;<span class="">3133</span>:         # Loop over samples</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3134</span>:         for n in range(n_samples):</pre>
<pre class='cython code score-0 '>    __pyx_t_16 = __pyx_v_n_samples;
    __pyx_t_17 = __pyx_t_16;
    for (__pyx_t_15 = 0; __pyx_t_15 &lt; __pyx_t_17; __pyx_t_15+=1) {
      __pyx_v_n = __pyx_t_15;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3135</span>:             choices_view[n, k, 0] = 0 # reset choice</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = __pyx_v_n;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_24 = 0;
      *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_20 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[2]) )) = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3136</span>:             t_h = 0 # reset time high dimension</pre>
<pre class='cython code score-0 '>      __pyx_v_t_h = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3137</span>:             t_l = 0 # reset time low dimension</pre>
<pre class='cython code score-0 '>      __pyx_v_t_l = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3138</span>:             t_l1 = 0 # reset time low dimension (1)</pre>
<pre class='cython code score-0 '>      __pyx_v_t_l1 = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3139</span>:             t_l2 = 0 # reset time low dimension (2)</pre>
<pre class='cython code score-0 '>      __pyx_v_t_l2 = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3140</span>:             ix = 0 # reset boundary index</pre>
<pre class='cython code score-0 '>      __pyx_v_ix = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3141</span>:             ix1 = 0 # reset boundary index (1)</pre>
<pre class='cython code score-0 '>      __pyx_v_ix1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3142</span>:             ix2 = 0 # reset boundary index (2)</pre>
<pre class='cython code score-0 '>      __pyx_v_ix2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3143</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3144</span>:             # Initialize walkers</pre>
<pre class="cython line score-0">&#xA0;<span class="">3145</span>:             # Particle</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3146</span>:             y_h = (-1) * boundary_view[0] + (zh_view[k] * 2 * (boundary_view[0]))</pre>
<pre class='cython code score-0 '>      __pyx_t_24 = 0;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_20 = 0;
      __pyx_v_y_h = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_24 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_zh_view.data + __pyx_t_19 * __pyx_v_zh_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">3147</span>:             # Relative particle position (used as resource allocator for low dim choice)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3148</span>:             bias_trace_l2_view[0] = ((y_h + boundary_view[0]) / (2 * boundary_view[0]))</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = 0;
      __pyx_t_19 = 0;
      __pyx_t_24 = 0;
      *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l2_view.data + __pyx_t_24 * __pyx_v_bias_trace_l2_view.strides[0]) )) = ((__pyx_v_y_h + (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))) / (2.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3149</span>:             bias_trace_l1_view[0] = 1.0 - bias_trace_l2_view[0]</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = 0;
      __pyx_t_20 = 0;
      *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l1_view.data + __pyx_t_20 * __pyx_v_bias_trace_l1_view.strides[0]) )) = (1.0 - (*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l2_view.data + __pyx_t_19 * __pyx_v_bias_trace_l2_view.strides[0]) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">3150</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3151</span>:             if n == 0:</pre>
<pre class='cython code score-0 '>      __pyx_t_18 = (__pyx_v_n == 0);
      if (__pyx_t_18) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3152</span>:                 if k == 0:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (__pyx_v_k == 0);
        if (__pyx_t_18) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3153</span>:                     traj_view[0, 0] = y_h</pre>
<pre class='cython code score-0 '>          __pyx_t_19 = 0;
          __pyx_t_20 = 0;
          *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_19 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_20 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y_h;
</pre><pre class="cython line score-0">&#xA0;<span class="">3154</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3155</span>:             # Random walks until y_h hits bound</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3156</span>:             while (y_h &gt;= ((-1) * boundary_view[ix])) and ((y_h &lt;= boundary_view[ix])) and (t_h &lt;= deadline_tmp):</pre>
<pre class='cython code score-0 '>      while (1) {
        __pyx_t_20 = __pyx_v_ix;
        __pyx_t_25 = (__pyx_v_y_h &gt;= (-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))));
        if (__pyx_t_25) {
        } else {
          __pyx_t_18 = __pyx_t_25;
          goto __pyx_L18_bool_binop_done;
        }
        __pyx_t_20 = __pyx_v_ix;
        __pyx_t_25 = (__pyx_v_y_h &lt;= (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) ))));
        if (__pyx_t_25) {
        } else {
          __pyx_t_18 = __pyx_t_25;
          goto __pyx_L18_bool_binop_done;
        }
        __pyx_t_25 = (__pyx_v_t_h &lt;= __pyx_v_deadline_tmp);
        __pyx_t_18 = __pyx_t_25;
        __pyx_L18_bool_binop_done:;
        if (!__pyx_t_18) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3157</span>:                 y_h += (vh_view[k] * delta_t) + (sqrt_st * gaussian_values[m])</pre>
<pre class='cython code score-0 '>        __pyx_t_20 = __pyx_v_k;
        __pyx_t_19 = __pyx_v_m;
        __pyx_v_y_h = (__pyx_v_y_h + (((*((float *) ( /* dim=0 */ (__pyx_v_vh_view.data + __pyx_t_20 * __pyx_v_vh_view.strides[0]) ))) * __pyx_v_delta_t) + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_19 * __pyx_v_gaussian_values.strides[0]) ))))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3158</span>:                 bias_trace_l2_view[ix] = ((y_h + boundary_view[ix]) / (2 * boundary_view[ix]))</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = __pyx_v_ix;
        __pyx_t_20 = __pyx_v_ix;
        __pyx_t_24 = __pyx_v_ix;
        *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l2_view.data + __pyx_t_24 * __pyx_v_bias_trace_l2_view.strides[0]) )) = ((__pyx_v_y_h + (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))) / (2.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3159</span>:                 bias_trace_l1_view[ix] = 1.0 - bias_trace_l2_view[ix]</pre>
<pre class='cython code score-0 '>        __pyx_t_20 = __pyx_v_ix;
        __pyx_t_19 = __pyx_v_ix;
        *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l1_view.data + __pyx_t_19 * __pyx_v_bias_trace_l1_view.strides[0]) )) = (1.0 - (*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l2_view.data + __pyx_t_20 * __pyx_v_bias_trace_l2_view.strides[0]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3160</span>:                 t_h += delta_t</pre>
<pre class='cython code score-0 '>        __pyx_v_t_h = (__pyx_v_t_h + __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3161</span>:                 ix += 1</pre>
<pre class='cython code score-0 '>        __pyx_v_ix = (__pyx_v_ix + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3162</span>:                 m += 1</pre>
<pre class='cython code score-0 '>        __pyx_v_m = (__pyx_v_m + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3163</span>:                 if m == num_draws:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (__pyx_v_m == __pyx_v_num_draws);
        if (__pyx_t_18) {
/* … */
        }
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3164</span>:                     gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 3164, __pyx_L1_error)</span>
          __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
          __pyx_v_gaussian_values = __pyx_t_2;
          __pyx_t_2.memview = NULL;
          __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3165</span>:                     m = 0</pre>
<pre class='cython code score-0 '>          __pyx_v_m = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3166</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3167</span>:             # The probability of making a 'mistake' 1 - (relative y position)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3168</span>:             # y at upper bound --&gt; choices_view[n, k, 0] add 2 deterministically</pre>
<pre class="cython line score-0">&#xA0;<span class="">3169</span>:             # y at lower bound --&gt; choice_view[n, k, 0] stay the same deterministically</pre>
<pre class="cython line score-0">&#xA0;<span class="">3170</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3171</span>:             # If boundary is negative (or 0) already, we flip a coin</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3172</span>:             if boundary_view[ix] &lt;= 0:</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = __pyx_v_ix;
      __pyx_t_18 = ((*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) ))) &lt;= 0.0);
      if (__pyx_t_18) {
/* … */
        goto __pyx_L22;
      }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3173</span>:                 if random_uniform() &lt;= 0.5:</pre>
<pre class='cython code score-5 '>        __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3173, __pyx_L1_error)</span>
        __pyx_t_18 = (__pyx_t_23 &lt;= 0.5);
        if (__pyx_t_18) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3174</span>:                     choices_view[n, k, 0] += 2</pre>
<pre class='cython code score-0 '>          __pyx_t_20 = __pyx_v_n;
          __pyx_t_19 = __pyx_v_k;
          __pyx_t_24 = 0;
          *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_20 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[2]) )) += 2;
</pre><pre class="cython line score-0">&#xA0;<span class="">3175</span>:             # Otherwise, apply rule from above</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3176</span>:             elif random_uniform() &lt;= ((y_h + boundary_view[ix]) / (2 * boundary_view[ix])):</pre>
<pre class='cython code score-5 '>      __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3176, __pyx_L1_error)</span>
      __pyx_t_24 = __pyx_v_ix;
      __pyx_t_19 = __pyx_v_ix;
      __pyx_t_18 = (__pyx_t_23 &lt;= ((__pyx_v_y_h + (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_24 * __pyx_v_boundary_view.strides[0]) )))) / (2.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) ))))));
      if (__pyx_t_18) {
/* … */
      }
      __pyx_L22:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3177</span>:                 choices_view[n, k, 0] += 2</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = __pyx_v_n;
        __pyx_t_24 = __pyx_v_k;
        __pyx_t_20 = 0;
        *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_19 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[2]) )) += 2;
</pre><pre class="cython line score-0">&#xA0;<span class="">3178</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3179</span>:             y_l2 = (- 1) * boundary_view[0] + (zl2_view[k] * 2 * (boundary_view[0]))</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = 0;
      __pyx_t_24 = __pyx_v_k;
      __pyx_t_19 = 0;
      __pyx_v_y_l2 = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_zl2_view.data + __pyx_t_24 * __pyx_v_zl2_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3180</span>:             y_l1 = (- 1) * boundary_view[0] + (zl1_view[k] * 2 * (boundary_view[0]))</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = 0;
      __pyx_t_24 = __pyx_v_k;
      __pyx_t_20 = 0;
      __pyx_v_y_l1 = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_zl1_view.data + __pyx_t_24 * __pyx_v_zl1_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">3181</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3182</span>:             if choices_view[n, k, 0] == 0:</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = __pyx_v_n;
      __pyx_t_24 = __pyx_v_k;
      __pyx_t_19 = 0;
      __pyx_t_18 = ((*((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_20 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[2]) ))) == 0);
      if (__pyx_t_18) {
/* … */
        goto __pyx_L24;
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">3183</span>:                  # Fill bias tracea until max_rt reached</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3184</span>:                 ix1_tmp = ix + 1</pre>
<pre class='cython code score-0 '>        __pyx_v_ix1_tmp = (__pyx_v_ix + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3185</span>:                 while ix1_tmp &lt; num_draws:</pre>
<pre class='cython code score-0 '>        while (1) {
          __pyx_t_18 = (__pyx_v_ix1_tmp &lt; __pyx_v_num_draws);
          if (!__pyx_t_18) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3186</span>:                     bias_trace_l2_view[ix1_tmp] = 0.0</pre>
<pre class='cython code score-0 '>          __pyx_t_19 = __pyx_v_ix1_tmp;
          *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l2_view.data + __pyx_t_19 * __pyx_v_bias_trace_l2_view.strides[0]) )) = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3187</span>:                     bias_trace_l1_view[ix1_tmp] = 1.0</pre>
<pre class='cython code score-0 '>          __pyx_t_19 = __pyx_v_ix1_tmp;
          *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l1_view.data + __pyx_t_19 * __pyx_v_bias_trace_l1_view.strides[0]) )) = 1.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3188</span>:                     ix1_tmp += 1</pre>
<pre class='cython code score-0 '>          __pyx_v_ix1_tmp = (__pyx_v_ix1_tmp + 1);
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">3189</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3190</span>:             else: # Store intermediate choice</pre>
<pre class="cython line score-0">&#xA0;<span class="">3191</span>:                 # Fill bias tracea until max_rt reached</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3192</span>:                 ix2_tmp = ix + 1</pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_v_ix2_tmp = (__pyx_v_ix + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3193</span>:                 while ix2_tmp &lt; num_draws:</pre>
<pre class='cython code score-0 '>        while (1) {
          __pyx_t_18 = (__pyx_v_ix2_tmp &lt; __pyx_v_num_draws);
          if (!__pyx_t_18) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3194</span>:                     bias_trace_l2_view[ix2_tmp] = 1.0</pre>
<pre class='cython code score-0 '>          __pyx_t_19 = __pyx_v_ix2_tmp;
          *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l2_view.data + __pyx_t_19 * __pyx_v_bias_trace_l2_view.strides[0]) )) = 1.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3195</span>:                     bias_trace_l1_view[ix2_tmp] = 0.0</pre>
<pre class='cython code score-0 '>          __pyx_t_19 = __pyx_v_ix2_tmp;
          *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l1_view.data + __pyx_t_19 * __pyx_v_bias_trace_l1_view.strides[0]) )) = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3196</span>:                     ix2_tmp += 1</pre>
<pre class='cython code score-0 '>          __pyx_v_ix2_tmp = (__pyx_v_ix2_tmp + 1);
        }
      }
      __pyx_L24:;
</pre><pre class="cython line score-0">&#xA0;<span class="">3197</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3198</span>:             # lower level random walker (1)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3199</span>:             if (choices_view[n, k, 0] == 0) | ((n == 0) &amp; (k == 0)):</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = __pyx_v_n;
      __pyx_t_24 = __pyx_v_k;
      __pyx_t_20 = 0;
      __pyx_t_18 = (((*((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_19 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[2]) ))) == 0) | ((__pyx_v_n == 0) &amp; (__pyx_v_k == 0)));
      if (__pyx_t_18) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3200</span>:                 while (y_l1 &gt;= ((-1) * boundary_view[ix1])) and (y_l1 &lt;= boundary_view[ix1]) and (t_l1 &lt;= deadline_tmp):</pre>
<pre class='cython code score-0 '>        while (1) {
          __pyx_t_20 = __pyx_v_ix1;
          __pyx_t_25 = (__pyx_v_y_l1 &gt;= (-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))));
          if (__pyx_t_25) {
          } else {
            __pyx_t_18 = __pyx_t_25;
            goto __pyx_L32_bool_binop_done;
          }
          __pyx_t_20 = __pyx_v_ix1;
          __pyx_t_25 = (__pyx_v_y_l1 &lt;= (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) ))));
          if (__pyx_t_25) {
          } else {
            __pyx_t_18 = __pyx_t_25;
            goto __pyx_L32_bool_binop_done;
          }
          __pyx_t_25 = (__pyx_v_t_l1 &lt;= __pyx_v_deadline_tmp);
          __pyx_t_18 = __pyx_t_25;
          __pyx_L32_bool_binop_done:;
          if (!__pyx_t_18) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3201</span>:                     if (bias_trace_l1_view[ix1] &lt; 1) and (bias_trace_l1_view[ix1] &gt; 0):</pre>
<pre class='cython code score-0 '>          __pyx_t_20 = __pyx_v_ix1;
          __pyx_t_25 = ((*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l1_view.data + __pyx_t_20 * __pyx_v_bias_trace_l1_view.strides[0]) ))) &lt; 1.0);
          if (__pyx_t_25) {
          } else {
            __pyx_t_18 = __pyx_t_25;
            goto __pyx_L36_bool_binop_done;
          }
          __pyx_t_20 = __pyx_v_ix1;
          __pyx_t_25 = ((*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l1_view.data + __pyx_t_20 * __pyx_v_bias_trace_l1_view.strides[0]) ))) &gt; 0.0);
          __pyx_t_18 = __pyx_t_25;
          __pyx_L36_bool_binop_done:;
          if (__pyx_t_18) {
/* … */
            goto __pyx_L35;
          }
</pre><pre class="cython line score-0">&#xA0;<span class="">3202</span>:                         # main propagation if bias_trace is between 0 and 1 (high level choice is not yet made)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3203</span>:                         y_l1 += (((vl1_view[k] * bias_trace_l1_view[ix1] * (1 - d_view[k])) - (g_view[k] * y_l1)) * delta_t)</pre>
<pre class='cython code score-0 '>            __pyx_t_20 = __pyx_v_k;
            __pyx_t_24 = __pyx_v_ix1;
            __pyx_t_19 = __pyx_v_k;
            __pyx_t_26 = __pyx_v_k;
            __pyx_v_y_l1 = (__pyx_v_y_l1 + (((((*((float *) ( /* dim=0 */ (__pyx_v_vl1_view.data + __pyx_t_20 * __pyx_v_vl1_view.strides[0]) ))) * (*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l1_view.data + __pyx_t_24 * __pyx_v_bias_trace_l1_view.strides[0]) )))) * (1.0 - (*((float *) ( /* dim=0 */ (__pyx_v_d_view.data + __pyx_t_19 * __pyx_v_d_view.strides[0]) ))))) - ((*((float *) ( /* dim=0 */ (__pyx_v_g_view.data + __pyx_t_26 * __pyx_v_g_view.strides[0]) ))) * __pyx_v_y_l1)) * __pyx_v_delta_t));
</pre><pre class="cython line score-0">&#xA0;<span class="">3204</span>:                         # add gaussian displacement</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3205</span>:                         y_l1 += (sqrt_st * gaussian_values[m]) * bias_trace_l1_view[ix1]</pre>
<pre class='cython code score-0 '>            __pyx_t_26 = __pyx_v_m;
            __pyx_t_19 = __pyx_v_ix1;
            __pyx_v_y_l1 = (__pyx_v_y_l1 + ((__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_26 * __pyx_v_gaussian_values.strides[0]) )))) * (*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l1_view.data + __pyx_t_19 * __pyx_v_bias_trace_l1_view.strides[0]) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">3206</span>:                     else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">3207</span>:                         # main propagation if bias_trace is not between 0 and 1 (high level choice is already made)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3208</span>:                         y_l1 += (vl1_view[k] * delta_t)</pre>
<pre class='cython code score-0 '>          /*else*/ {
            __pyx_t_19 = __pyx_v_k;
            __pyx_v_y_l1 = (__pyx_v_y_l1 + ((*((float *) ( /* dim=0 */ (__pyx_v_vl1_view.data + __pyx_t_19 * __pyx_v_vl1_view.strides[0]) ))) * __pyx_v_delta_t));
</pre><pre class="cython line score-0">&#xA0;<span class="">3209</span>:                         # add gaussian displacement</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3210</span>:                         y_l1 += (sqrt_st * gaussian_values[m])</pre>
<pre class='cython code score-0 '>            __pyx_t_19 = __pyx_v_m;
            __pyx_v_y_l1 = (__pyx_v_y_l1 + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_19 * __pyx_v_gaussian_values.strides[0]) )))));
          }
          __pyx_L35:;
</pre><pre class="cython line score-0">&#xA0;<span class="">3211</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3212</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3213</span>:                     # propagate time and indices</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3214</span>:                     t_l1 += delta_t</pre>
<pre class='cython code score-0 '>          __pyx_v_t_l1 = (__pyx_v_t_l1 + __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3215</span>:                     ix1 += 1</pre>
<pre class='cython code score-0 '>          __pyx_v_ix1 = (__pyx_v_ix1 + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3216</span>:                     m += 1</pre>
<pre class='cython code score-0 '>          __pyx_v_m = (__pyx_v_m + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3217</span>:                     if m == num_draws:</pre>
<pre class='cython code score-0 '>          __pyx_t_18 = (__pyx_v_m == __pyx_v_num_draws);
          if (__pyx_t_18) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3218</span>:                         gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>            __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 3218, __pyx_L1_error)</span>
            __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
            __pyx_v_gaussian_values = __pyx_t_2;
            __pyx_t_2.memview = NULL;
            __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3219</span>:                         m = 0</pre>
<pre class='cython code score-0 '>            __pyx_v_m = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3220</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3221</span>:                     if n == 0:</pre>
<pre class='cython code score-0 '>          __pyx_t_18 = (__pyx_v_n == 0);
          if (__pyx_t_18) {
/* … */
          }
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3222</span>:                         if k == 0:</pre>
<pre class='cython code score-0 '>            __pyx_t_18 = (__pyx_v_k == 0);
            if (__pyx_t_18) {
/* … */
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3223</span>:                             traj_view[ix1, 1] = y_l1</pre>
<pre class='cython code score-0 '>              __pyx_t_19 = __pyx_v_ix1;
              __pyx_t_26 = 1;
              *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_19 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_26 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y_l1;
</pre><pre class="cython line score-0">&#xA0;<span class="">3224</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3225</span>:             # lower level random walker (2)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3226</span>:             if (choices_view[n, k, 0] == 2) | ((n == 0) &amp; (k == 0)):</pre>
<pre class='cython code score-0 '>      __pyx_t_26 = __pyx_v_n;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_24 = 0;
      __pyx_t_18 = (((*((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_26 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[2]) ))) == 2) | ((__pyx_v_n == 0) &amp; (__pyx_v_k == 0)));
      if (__pyx_t_18) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3227</span>:                 while (y_l2 &gt;= ((-1) * boundary_view[ix2])) and (y_l2 &lt;= boundary_view[ix2]) and (t_l2 &lt;= deadline_tmp):</pre>
<pre class='cython code score-0 '>        while (1) {
          __pyx_t_24 = __pyx_v_ix2;
          __pyx_t_25 = (__pyx_v_y_l2 &gt;= (-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_24 * __pyx_v_boundary_view.strides[0]) )))));
          if (__pyx_t_25) {
          } else {
            __pyx_t_18 = __pyx_t_25;
            goto __pyx_L44_bool_binop_done;
          }
          __pyx_t_24 = __pyx_v_ix2;
          __pyx_t_25 = (__pyx_v_y_l2 &lt;= (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_24 * __pyx_v_boundary_view.strides[0]) ))));
          if (__pyx_t_25) {
          } else {
            __pyx_t_18 = __pyx_t_25;
            goto __pyx_L44_bool_binop_done;
          }
          __pyx_t_25 = (__pyx_v_t_l2 &lt;= __pyx_v_deadline_tmp);
          __pyx_t_18 = __pyx_t_25;
          __pyx_L44_bool_binop_done:;
          if (!__pyx_t_18) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3228</span>:                     if (bias_trace_l2_view[ix2] &lt; 1) and (bias_trace_l2_view[ix2] &gt; 0):</pre>
<pre class='cython code score-0 '>          __pyx_t_24 = __pyx_v_ix2;
          __pyx_t_25 = ((*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l2_view.data + __pyx_t_24 * __pyx_v_bias_trace_l2_view.strides[0]) ))) &lt; 1.0);
          if (__pyx_t_25) {
          } else {
            __pyx_t_18 = __pyx_t_25;
            goto __pyx_L48_bool_binop_done;
          }
          __pyx_t_24 = __pyx_v_ix2;
          __pyx_t_25 = ((*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l2_view.data + __pyx_t_24 * __pyx_v_bias_trace_l2_view.strides[0]) ))) &gt; 0.0);
          __pyx_t_18 = __pyx_t_25;
          __pyx_L48_bool_binop_done:;
          if (__pyx_t_18) {
/* … */
            goto __pyx_L47;
          }
</pre><pre class="cython line score-0">&#xA0;<span class="">3229</span>:                         # main propagation if bias_trace is between 0 and 1 (high level choice is not yet made)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3230</span>:                         y_l2 += (((vl2_view[k] * bias_trace_l2_view[ix2] * (1 - d_view[k])) - (g_view[k] * y_l2)) * delta_t)</pre>
<pre class='cython code score-0 '>            __pyx_t_24 = __pyx_v_k;
            __pyx_t_19 = __pyx_v_ix2;
            __pyx_t_26 = __pyx_v_k;
            __pyx_t_20 = __pyx_v_k;
            __pyx_v_y_l2 = (__pyx_v_y_l2 + (((((*((float *) ( /* dim=0 */ (__pyx_v_vl2_view.data + __pyx_t_24 * __pyx_v_vl2_view.strides[0]) ))) * (*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l2_view.data + __pyx_t_19 * __pyx_v_bias_trace_l2_view.strides[0]) )))) * (1.0 - (*((float *) ( /* dim=0 */ (__pyx_v_d_view.data + __pyx_t_26 * __pyx_v_d_view.strides[0]) ))))) - ((*((float *) ( /* dim=0 */ (__pyx_v_g_view.data + __pyx_t_20 * __pyx_v_g_view.strides[0]) ))) * __pyx_v_y_l2)) * __pyx_v_delta_t));
</pre><pre class="cython line score-0">&#xA0;<span class="">3231</span>:                         # add gaussian displacement</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3232</span>:                         y_l2 += (sqrt_st * gaussian_values[m]) * bias_trace_l2_view[ix2]</pre>
<pre class='cython code score-0 '>            __pyx_t_20 = __pyx_v_m;
            __pyx_t_26 = __pyx_v_ix2;
            __pyx_v_y_l2 = (__pyx_v_y_l2 + ((__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_20 * __pyx_v_gaussian_values.strides[0]) )))) * (*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l2_view.data + __pyx_t_26 * __pyx_v_bias_trace_l2_view.strides[0]) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">3233</span>:                     else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">3234</span>:                         # main propagation if bias_trace is not between 0 and 1 (high level choice is already made)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3235</span>:                         y_l2 += (vl2_view[k] * delta_t)</pre>
<pre class='cython code score-0 '>          /*else*/ {
            __pyx_t_26 = __pyx_v_k;
            __pyx_v_y_l2 = (__pyx_v_y_l2 + ((*((float *) ( /* dim=0 */ (__pyx_v_vl2_view.data + __pyx_t_26 * __pyx_v_vl2_view.strides[0]) ))) * __pyx_v_delta_t));
</pre><pre class="cython line score-0">&#xA0;<span class="">3236</span>:                         # add gaussian displacement</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3237</span>:                         y_l2 += (sqrt_st * gaussian_values[m])</pre>
<pre class='cython code score-0 '>            __pyx_t_26 = __pyx_v_m;
            __pyx_v_y_l2 = (__pyx_v_y_l2 + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_26 * __pyx_v_gaussian_values.strides[0]) )))));
          }
          __pyx_L47:;
</pre><pre class="cython line score-0">&#xA0;<span class="">3238</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3239</span>:                     # propagate time and indices</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3240</span>:                     t_l2 += delta_t</pre>
<pre class='cython code score-0 '>          __pyx_v_t_l2 = (__pyx_v_t_l2 + __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3241</span>:                     ix2 += 1</pre>
<pre class='cython code score-0 '>          __pyx_v_ix2 = (__pyx_v_ix2 + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3242</span>:                     m += 1</pre>
<pre class='cython code score-0 '>          __pyx_v_m = (__pyx_v_m + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3243</span>:                     if m == num_draws:</pre>
<pre class='cython code score-0 '>          __pyx_t_18 = (__pyx_v_m == __pyx_v_num_draws);
          if (__pyx_t_18) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3244</span>:                         gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>            __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 3244, __pyx_L1_error)</span>
            __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
            __pyx_v_gaussian_values = __pyx_t_2;
            __pyx_t_2.memview = NULL;
            __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3245</span>:                         m = 0</pre>
<pre class='cython code score-0 '>            __pyx_v_m = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3246</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3247</span>:                     if n == 0:</pre>
<pre class='cython code score-0 '>          __pyx_t_18 = (__pyx_v_n == 0);
          if (__pyx_t_18) {
/* … */
          }
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3248</span>:                         if k == 0:</pre>
<pre class='cython code score-0 '>            __pyx_t_18 = (__pyx_v_k == 0);
            if (__pyx_t_18) {
/* … */
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3249</span>:                             traj_view[ix2, 2] = y_l2</pre>
<pre class='cython code score-0 '>              __pyx_t_26 = __pyx_v_ix2;
              __pyx_t_20 = 2;
              *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_26 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_20 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y_l2;
</pre><pre class="cython line score-0">&#xA0;<span class="">3250</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3251</span>:             # Get back to single y_l and t_l</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3252</span>:             if (choices_view[n, k, 0] == 0):</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = __pyx_v_n;
      __pyx_t_26 = __pyx_v_k;
      __pyx_t_19 = 0;
      __pyx_t_18 = ((*((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_20 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_26 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[2]) ))) == 0);
      if (__pyx_t_18) {
/* … */
        goto __pyx_L53;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3253</span>:                 t_l = t_l1</pre>
<pre class='cython code score-0 '>        __pyx_v_t_l = __pyx_v_t_l1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3254</span>:                 y_l = y_l1</pre>
<pre class='cython code score-0 '>        __pyx_v_y_l = __pyx_v_y_l1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3255</span>:                 ix_l = ix1</pre>
<pre class='cython code score-0 '>        __pyx_v_ix_l = __pyx_v_ix1;
</pre><pre class="cython line score-0">&#xA0;<span class="">3256</span>:             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3257</span>:                 t_l = t_l2</pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_v_t_l = __pyx_v_t_l2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3258</span>:                 y_l = y_l2</pre>
<pre class='cython code score-0 '>        __pyx_v_y_l = __pyx_v_y_l2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3259</span>:                 ix_l = ix2</pre>
<pre class='cython code score-0 '>        __pyx_v_ix_l = __pyx_v_ix2;
      }
      __pyx_L53:;
</pre><pre class="cython line score-0">&#xA0;<span class="">3260</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3261</span>:             if smooth:</pre>
<pre class='cython code score-2 '>      __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_smooth); if (unlikely((__pyx_t_18 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3261, __pyx_L1_error)</span>
      if (__pyx_t_18) {
/* … */
        goto __pyx_L54;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3262</span>:                 if t_h == 0.0:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (__pyx_v_t_h == 0.0);
        if (__pyx_t_18) {
/* … */
          goto __pyx_L55;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3263</span>:                     smooth_u = random_uniform() * 0.5 * delta_t</pre>
<pre class='cython code score-5 '>          __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3263, __pyx_L1_error)</span>
          __pyx_v_smooth_u = ((__pyx_t_23 * 0.5) * __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3264</span>:                 elif fmax(t_h, t_l) &lt; deadline_tmp:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (fmax(__pyx_v_t_h, __pyx_v_t_l) &lt; __pyx_v_deadline_tmp);
        if (__pyx_t_18) {
/* … */
          goto __pyx_L55;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3265</span>:                     smooth_u = (0.5 - random_uniform()) * delta_t</pre>
<pre class='cython code score-5 '>          __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3265, __pyx_L1_error)</span>
          __pyx_v_smooth_u = ((0.5 - __pyx_t_23) * __pyx_v_delta_t);
</pre><pre class="cython line score-0">&#xA0;<span class="">3266</span>:                 else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3267</span>:                     smooth_u = 0.0</pre>
<pre class='cython code score-0 '>        /*else*/ {
          __pyx_v_smooth_u = 0.0;
        }
        __pyx_L55:;
</pre><pre class="cython line score-0">&#xA0;<span class="">3268</span>:             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3269</span>:                 smooth_u = 0.0</pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_v_smooth_u = 0.0;
      }
      __pyx_L54:;
</pre><pre class="cython line score-0">&#xA0;<span class="">3270</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3271</span>:             rts_view[n, k, 0] = fmax(t_h, t_l) + t_view[k]</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = __pyx_v_k;
      __pyx_t_26 = __pyx_v_n;
      __pyx_t_20 = __pyx_v_k;
      __pyx_t_24 = 0;
      *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_26 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_20 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_24 * __pyx_v_rts_view.strides[2]) )) = (fmax(__pyx_v_t_h, __pyx_v_t_l) + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_19 * __pyx_v_t_view.strides[0]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3272</span>:             rts_high_view[n, k, 0] = t_h + t_view[k]</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = __pyx_v_k;
      __pyx_t_24 = __pyx_v_n;
      __pyx_t_20 = __pyx_v_k;
      __pyx_t_26 = 0;
      *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_high_view.data + __pyx_t_24 * __pyx_v_rts_high_view.strides[0]) ) + __pyx_t_20 * __pyx_v_rts_high_view.strides[1]) ) + __pyx_t_26 * __pyx_v_rts_high_view.strides[2]) )) = (__pyx_v_t_h + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_19 * __pyx_v_t_view.strides[0]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3273</span>:             rts_low_view[n, k, 0] = t_l + t_view[k]</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = __pyx_v_k;
      __pyx_t_26 = __pyx_v_n;
      __pyx_t_20 = __pyx_v_k;
      __pyx_t_24 = 0;
      *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_low_view.data + __pyx_t_26 * __pyx_v_rts_low_view.strides[0]) ) + __pyx_t_20 * __pyx_v_rts_low_view.strides[1]) ) + __pyx_t_24 * __pyx_v_rts_low_view.strides[2]) )) = (__pyx_v_t_l + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_19 * __pyx_v_t_view.strides[0]) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">3274</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3275</span>:             # The probability of making a 'mistake' 1 - (relative y position)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3276</span>:             # y at upper bound --&gt; choices_view[n, k, 0] add one deterministically</pre>
<pre class="cython line score-0">&#xA0;<span class="">3277</span>:             # y at lower bound --&gt; choice_view[n, k, 0] stays the same deterministically</pre>
<pre class="cython line score-0">&#xA0;<span class="">3278</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3279</span>:             # If boundary is negative (or 0) already, we flip a coin</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3280</span>:             if boundary_view[ix] &lt;= 0:</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = __pyx_v_ix;
      __pyx_t_18 = ((*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) ))) &lt;= 0.0);
      if (__pyx_t_18) {
/* … */
        goto __pyx_L56;
      }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3281</span>:                 if random_uniform() &lt;= 0.5:</pre>
<pre class='cython code score-5 '>        __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3281, __pyx_L1_error)</span>
        __pyx_t_18 = (__pyx_t_23 &lt;= 0.5);
        if (__pyx_t_18) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3282</span>:                     choices_view[n, k, 0] += 1</pre>
<pre class='cython code score-0 '>          __pyx_t_19 = __pyx_v_n;
          __pyx_t_24 = __pyx_v_k;
          __pyx_t_20 = 0;
          *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_19 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[2]) )) += 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">3283</span>:             # Otherwise apply rule from above</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3284</span>:             elif random_uniform() &lt;= ((y_l + boundary_view[ix]) / (2 * boundary_view[ix])):</pre>
<pre class='cython code score-5 '>      __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3284, __pyx_L1_error)</span>
      __pyx_t_20 = __pyx_v_ix;
      __pyx_t_24 = __pyx_v_ix;
      __pyx_t_18 = (__pyx_t_23 &lt;= ((__pyx_v_y_l + (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))) / (2.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_24 * __pyx_v_boundary_view.strides[0]) ))))));
      if (__pyx_t_18) {
/* … */
      }
      __pyx_L56:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3285</span>:                 choices_view[n, k, 0] += 1</pre>
<pre class='cython code score-0 '>        __pyx_t_24 = __pyx_v_n;
        __pyx_t_20 = __pyx_v_k;
        __pyx_t_19 = 0;
        *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_24 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[2]) )) += 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">3286</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3287</span>:             if (rts_view[n, k, 0] &gt;= deadline_view[k]) | (deadline_view[k] &lt;= 0):</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = __pyx_v_n;
      __pyx_t_20 = __pyx_v_k;
      __pyx_t_24 = 0;
      __pyx_t_26 = __pyx_v_k;
      __pyx_t_27 = __pyx_v_k;
      __pyx_t_18 = (((*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_19 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_20 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_24 * __pyx_v_rts_view.strides[2]) ))) &gt;= (*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_26 * __pyx_v_deadline_view.strides[0]) )))) | ((*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_27 * __pyx_v_deadline_view.strides[0]) ))) &lt;= 0.0));
      if (__pyx_t_18) {
/* … */
      }
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3288</span>:                 rts_view[n, k, 0] = -999</pre>
<pre class='cython code score-0 '>        __pyx_t_27 = __pyx_v_n;
        __pyx_t_26 = __pyx_v_k;
        __pyx_t_24 = 0;
        *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_27 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_26 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_24 * __pyx_v_rts_view.strides[2]) )) = -999.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3289</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3290</span>:     if return_option == 'full':</pre>
<pre class='cython code score-2 '>  __pyx_t_18 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_return_option, __pyx_n_u_full, Py_EQ)); if (unlikely((__pyx_t_18 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3290, __pyx_L1_error)</span>
  if (__pyx_t_18) {
/* … */
  }
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3291</span>:         return {'rts': rts, 'choices': choices, 'rts_high': rts_high, 'rts_low': rts_low,</pre>
<pre class='cython code score-23 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3291, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3291, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3291, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_rts_high, __pyx_v_rts_high) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3291, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_rts_low, __pyx_v_rts_low) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3291, __pyx_L1_error)</span>
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3292</span>:                 'metadata': {'vh': vh,</pre>
<pre class='cython code score-7 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(11);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3292, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_vh, ((PyObject *)__pyx_v_vh)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3292, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3293</span>:                             'vl1': vl1,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_vl1, ((PyObject *)__pyx_v_vl1)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3292, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3294</span>:                             'vl2': vl2,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_vl2, ((PyObject *)__pyx_v_vl2)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3292, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3295</span>:                             'a': a,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3292, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3296</span>:                             'zh': zh,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_zh, ((PyObject *)__pyx_v_zh)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3292, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3297</span>:                             'zl1': zl1,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_zl1, ((PyObject *)__pyx_v_zl1)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3292, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3298</span>:                             'zl2': zl2,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_zl2, ((PyObject *)__pyx_v_zl2)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3292, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3299</span>:                             'd': d,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_d, ((PyObject *)__pyx_v_d)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3292, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3300</span>:                             't': t,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3292, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3301</span>:                             'deadline': deadline,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_deadline, ((PyObject *)__pyx_v_deadline)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3292, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3302</span>:                             's': s,</pre>
<pre class='cython code score-11 '>    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_s);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3302, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_s, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3292, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_10 = __pyx_t_6;
    __pyx_t_6 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3303</span>:                             **boundary_params,</pre>
<pre class='cython code score-17 '>    if (unlikely(__pyx_v_boundary_params == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
      <span class='error_goto'>__PYX_ERR(0, 3303, __pyx_L1_error)</span>
    }
    if (unlikely(<span class='py_c_api'>PyDict_Update</span>(__pyx_t_10, __pyx_v_boundary_params) &lt; 0)) {
      if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseMappingExpectedError</span>(__pyx_v_boundary_params);
      <span class='error_goto'>__PYX_ERR(0, 3303, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3304</span>:                             'delta_t': delta_t,</pre>
<pre class='cython code score-11 '>    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_t);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3304, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_delta_t, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3304, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3305</span>:                             'max_t': max_t,</pre>
<pre class='cython code score-11 '>    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_max_t);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3305, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_max_t, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3305, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3306</span>:                             'n_samples': n_samples,</pre>
<pre class='cython code score-8 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3306, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_n_samples, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3306, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3307</span>:                             'n_trials': n_trials,</pre>
<pre class='cython code score-13 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3307, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_n_trials, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3307, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_simulator, __pyx_n_u_ddm_flexbound_mic2_adj) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3308, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">3308</span>:                             'simulator': 'ddm_flexbound_mic2_adj',</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3309</span>:                             'boundary_fun_type': boundary_fun.__name__,</pre>
<pre class='cython code score-8 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_boundary_fun, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3309, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_boundary_fun_type, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3309, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3310</span>:                             'possible_choices': [0, 1, 2, 3],</pre>
<pre class='cython code score-23 '>    __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3310, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 0, __pyx_int_0)) <span class='error_goto'>__PYX_ERR(0, 3310, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 3310, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 2, __pyx_int_2)) <span class='error_goto'>__PYX_ERR(0, 3310, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 3, __pyx_int_3)) <span class='error_goto'>__PYX_ERR(0, 3310, __pyx_L1_error)</span>;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_possible_choices, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3310, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3311</span>:                             'trajectory': traj,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_trajectory, __pyx_v_traj) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3311, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3312</span>:                             'boundary': boundary}}</pre>
<pre class='cython code score-11 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_boundary, __pyx_v_boundary) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3312, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_metadata, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3291, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_r = __pyx_t_5;
    __pyx_t_5 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3313</span>:     elif return_option == 'minimal':</pre>
<pre class='cython code score-2 '>  __pyx_t_18 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_return_option, __pyx_n_u_minimal, Py_EQ)); if (unlikely((__pyx_t_18 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3313, __pyx_L1_error)</span>
  if (likely(__pyx_t_18)) {
/* … */
  }
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3314</span>:         return {'rts': rts, 'choices': choices, 'rts_high': rts_high, 'rts_low': rts_low,</pre>
<pre class='cython code score-23 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3314, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3314, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3314, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_rts_high, __pyx_v_rts_high) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3314, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_rts_low, __pyx_v_rts_low) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3314, __pyx_L1_error)</span>
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3315</span>:                 'metadata': {'simulator': 'ddm_flexbound_mic2_adj',</pre>
<pre class='cython code score-7 '>    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3315, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_simulator, __pyx_n_u_ddm_flexbound_mic2_adj) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3315, __pyx_L1_error)</span>
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3316</span>:                              'possible_choices': [0, 1, 2, 3],</pre>
<pre class='cython code score-23 '>    __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3316, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 0, __pyx_int_0)) <span class='error_goto'>__PYX_ERR(0, 3316, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 3316, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 2, __pyx_int_2)) <span class='error_goto'>__PYX_ERR(0, 3316, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 3, __pyx_int_3)) <span class='error_goto'>__PYX_ERR(0, 3316, __pyx_L1_error)</span>;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_possible_choices, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3315, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3317</span>:                              'boundary_fun_type': boundary_fun.__name__,</pre>
<pre class='cython code score-8 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_boundary_fun, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3317, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_boundary_fun_type, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3315, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3318</span>:                              'n_samples': n_samples,</pre>
<pre class='cython code score-8 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3318, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_n_samples, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3315, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3319</span>:                              'n_trials': n_trials,</pre>
<pre class='cython code score-14 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3319, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_n_trials, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3315, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_metadata, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3314, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_r = __pyx_t_5;
    __pyx_t_5 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3320</span>:                              }}</pre>
<pre class="cython line score-0">&#xA0;<span class="">3321</span>:     else:</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3322</span>:         raise ValueError('return_option must be either "full" or "minimal"')</pre>
<pre class='cython code score-5 '>  /*else*/ {
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3322, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_5, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='error_goto'>__PYX_ERR(0, 3322, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">3323</span>: # ----------------------------------------------------------------------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">3324</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3325</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3326</span>: # Simulate (rt, choice) tuples from: Vanilla LBA Model without ndt -----------------------------</pre>
<pre class="cython line score-300" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3327</span>: def lba_vanilla(np.ndarray[float, ndim = 2] v,</pre>
<pre class='cython code score-300 '>/* Python wrapper */
static PyObject *__pyx_pw_4cssm_35lba_vanilla(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_4cssm_35lba_vanilla = {"lba_vanilla", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_4cssm_35lba_vanilla, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_4cssm_35lba_vanilla(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyArrayObject *__pyx_v_v = 0;
  PyArrayObject *__pyx_v_a = 0;
  PyArrayObject *__pyx_v_z = 0;
  PyArrayObject *__pyx_v_deadline = 0;
  float __pyx_v_sd;
  float __pyx_v_ndt;
  int __pyx_v_nact;
  int __pyx_v_n_samples;
  int __pyx_v_n_trials;
  float __pyx_v_max_t;
  CYTHON_UNUSED PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lba_vanilla (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_v,&amp;__pyx_n_s_a,&amp;__pyx_n_s_z,&amp;__pyx_n_s_deadline,&amp;__pyx_n_s_sd,&amp;__pyx_n_s_ndt,&amp;__pyx_n_s_nact,&amp;__pyx_n_s_n_samples,&amp;__pyx_n_s_n_trials,&amp;__pyx_n_s_max_t,0};
  PyObject* values[10] = {0,0,0,0,0,0,0,0,0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_v)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3327, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_a)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3327, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("lba_vanilla", 0, 5, 10, 1); <span class='error_goto'>__PYX_ERR(0, 3327, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_z)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3327, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("lba_vanilla", 0, 5, 10, 2); <span class='error_goto'>__PYX_ERR(0, 3327, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_deadline)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[3]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3327, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("lba_vanilla", 0, 5, 10, 3); <span class='error_goto'>__PYX_ERR(0, 3327, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_sd)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[4]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3327, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("lba_vanilla", 0, 5, 10, 4); <span class='error_goto'>__PYX_ERR(0, 3327, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_ndt);
          if (value) { values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3327, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_nact);
          if (value) { values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3327, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_samples);
          if (value) { values[7] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3327, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_trials);
          if (value) { values[8] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3327, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  9:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_max_t);
          if (value) { values[9] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3327, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values + 0, kwd_pos_args, "lba_vanilla") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 3327, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_v = ((PyArrayObject *)values[0]);
    __pyx_v_a = ((PyArrayObject *)values[1]);
    __pyx_v_z = ((PyArrayObject *)values[2]);
    __pyx_v_deadline = ((PyArrayObject *)values[3]);
    __pyx_v_sd = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[4]); if (unlikely((__pyx_v_sd == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3331, __pyx_L3_error)</span>
    if (values[5]) {
      __pyx_v_ndt = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[5]); if (unlikely((__pyx_v_ndt == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3332, __pyx_L3_error)</span>
    } else {
      __pyx_v_ndt = ((float)((float)0.0));
    }
    if (values[6]) {
      __pyx_v_nact = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[6]); if (unlikely((__pyx_v_nact == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3333, __pyx_L3_error)</span>
    } else {
      __pyx_v_nact = ((int)((int)3));
    }
    if (values[7]) {
      __pyx_v_n_samples = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[7]); if (unlikely((__pyx_v_n_samples == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3334, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_samples = ((int)((int)0x7D0));
    }
    if (values[8]) {
      __pyx_v_n_trials = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[8]); if (unlikely((__pyx_v_n_trials == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3335, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_trials = ((int)((int)1));
    }
    if (values[9]) {
      __pyx_v_max_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[9]); if (unlikely((__pyx_v_max_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3336, __pyx_L3_error)</span>
    } else {
      __pyx_v_max_t = ((float)((float)20.0));
    }
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("lba_vanilla", 0, 5, 10, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 3327, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.lba_vanilla", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) <span class='error_goto'>__PYX_ERR(0, 3327, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) <span class='error_goto'>__PYX_ERR(0, 3328, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) <span class='error_goto'>__PYX_ERR(0, 3329, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_deadline), __pyx_ptype_5numpy_ndarray, 1, "deadline", 0))) <span class='error_goto'>__PYX_ERR(0, 3330, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_4cssm_34lba_vanilla(__pyx_self, __pyx_v_v, __pyx_v_a, __pyx_v_z, __pyx_v_deadline, __pyx_v_sd, __pyx_v_ndt, __pyx_v_nact, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_max_t, __pyx_v_kwargs);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs);
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4cssm_34lba_vanilla(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_deadline, float __pyx_v_sd, float __pyx_v_ndt, int __pyx_v_nact, int __pyx_v_n_samples, int __pyx_v_n_trials, float __pyx_v_max_t, CYTHON_UNUSED PyObject *__pyx_v_kwargs) {
  __Pyx_memviewslice __pyx_v_v_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_a_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_z_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_deadline_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_rts = NULL;
  __Pyx_memviewslice __pyx_v_rts_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_choices = NULL;
  __Pyx_memviewslice __pyx_v_choices_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  Py_ssize_t __pyx_v_n;
  Py_ssize_t __pyx_v_k;
  Py_ssize_t __pyx_v_i;
  PyObject *__pyx_v_zs = NULL;
  PyObject *__pyx_v_vs = NULL;
  PyObject *__pyx_v_x_t = NULL;
  PyObject *__pyx_v_v_dict = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_a;
  __Pyx_Buffer __pyx_pybuffer_a;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_deadline;
  __Pyx_Buffer __pyx_pybuffer_deadline;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_v;
  __Pyx_Buffer __pyx_pybuffer_v;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_z;
  __Pyx_Buffer __pyx_pybuffer_z;
  PyObject *__pyx_r = NULL;
  __pyx_pybuffer_v.pybuffer.buf = NULL;
  __pyx_pybuffer_v.refcount = 0;
  __pyx_pybuffernd_v.data = NULL;
  __pyx_pybuffernd_v.rcbuffer = &amp;__pyx_pybuffer_v;
  __pyx_pybuffer_a.pybuffer.buf = NULL;
  __pyx_pybuffer_a.refcount = 0;
  __pyx_pybuffernd_a.data = NULL;
  __pyx_pybuffernd_a.rcbuffer = &amp;__pyx_pybuffer_a;
  __pyx_pybuffer_z.pybuffer.buf = NULL;
  __pyx_pybuffer_z.refcount = 0;
  __pyx_pybuffernd_z.data = NULL;
  __pyx_pybuffernd_z.rcbuffer = &amp;__pyx_pybuffer_z;
  __pyx_pybuffer_deadline.pybuffer.buf = NULL;
  __pyx_pybuffer_deadline.refcount = 0;
  __pyx_pybuffernd_deadline.data = NULL;
  __pyx_pybuffernd_deadline.rcbuffer = &amp;__pyx_pybuffer_deadline;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_v, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3327, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_v.diminfo[0].strides = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_v.diminfo[0].shape = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_v.diminfo[1].strides = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_v.diminfo[1].shape = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_a, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3327, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_a.diminfo[1].strides = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_a.diminfo[1].shape = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_z, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3327, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_z.diminfo[0].strides = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_z.diminfo[0].shape = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_z.diminfo[1].strides = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_z.diminfo[1].shape = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_deadline, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3327, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_deadline.diminfo[0].strides = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_deadline.diminfo[0].shape = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.shape[0];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_1, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_2, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_7, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_9, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.lba_vanilla", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_v_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_a_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_z_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_deadline_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rts);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_rts_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_choices);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_choices_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_zs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x_t);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_v_dict);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__57 = <span class='py_c_api'>PyTuple_Pack</span>(26, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_deadline, __pyx_n_s_sd, __pyx_n_s_ndt, __pyx_n_s_nact, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_max_t, __pyx_n_s_kwargs, __pyx_n_s_v_view, __pyx_n_s_a_view, __pyx_n_s_z_view, __pyx_n_s_deadline_view, __pyx_n_s_rts, __pyx_n_s_rts_view, __pyx_n_s_choices, __pyx_n_s_choices_view, __pyx_n_s_n, __pyx_n_s_k, __pyx_n_s_i, __pyx_n_s_zs, __pyx_n_s_vs, __pyx_n_s_x_t, __pyx_n_s_v_dict);<span class='error_goto'> if (unlikely(!__pyx_tuple__57)) __PYX_ERR(0, 3327, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__57);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__57);
/* … */
  __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 3327, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3327, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 3327, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_7, 2, __pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 3327, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_7, 3, __pyx_t_10)) <span class='error_goto'>__PYX_ERR(0, 3327, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_7, 4, __pyx_t_11)) <span class='error_goto'>__PYX_ERR(0, 3327, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_t_4 = 0;
  __pyx_t_9 = 0;
  __pyx_t_10 = 0;
  __pyx_t_11 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_4cssm_35lba_vanilla, 0, __pyx_n_s_lba_vanilla, NULL, __pyx_n_s_cssm, __pyx_d, ((PyObject *)__pyx_codeobj__58));<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 3327, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_11, __pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_lba_vanilla, __pyx_t_11) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3327, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_codeobj__58 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(10, 0, 0, 26, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__57, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_lba_vanilla, 3327, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__58)) __PYX_ERR(0, 3327, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">3328</span>:         np.ndarray[float, ndim = 2] a,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3329</span>:         np.ndarray[float, ndim = 2] z,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3330</span>:         np.ndarray[float, ndim = 1] deadline,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3331</span>:         float sd, # std dev of Normal from where we sample vs</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3332</span>:         float ndt = 0, # ndt is supposed to be 0 by default because of parameter identifiability issues</pre>
<pre class='cython code score-5 '>  __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)0.0));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3332, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3333</span>:         int nact = 3,</pre>
<pre class='cython code score-2 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)3));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3333, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3334</span>:         int n_samples = 2000,</pre>
<pre class='cython code score-2 '>  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)0x7D0));<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3334, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3335</span>:         int n_trials = 1,</pre>
<pre class='cython code score-2 '>  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)1));<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3335, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3336</span>:         float max_t = 20,</pre>
<pre class='cython code score-5 '>  __pyx_t_11 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)20.0));<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 3336, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
</pre><pre class="cython line score-0">&#xA0;<span class="">3337</span>:         **kwargs</pre>
<pre class="cython line score-0">&#xA0;<span class="">3338</span>:         ):</pre>
<pre class="cython line score-0">&#xA0;<span class="">3339</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3340</span>:     # v_t = np.random.normal(v, sd)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3341</span>:     # print(len(z), nact, np.array([z]*nact).transpose().shape)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3342</span>:     # z_t = np.random.uniform(np.zeros((len(z), nact)), np.array([z]*nact).transpose(), (len(z), nact))</pre>
<pre class="cython line score-0">&#xA0;<span class="">3343</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3344</span>:     # Param views</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3345</span>:     cdef float[:, :] v_view = v</pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(((PyObject *)__pyx_v_v), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 3345, __pyx_L1_error)</span>
  __pyx_v_v_view = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3346</span>:     cdef float[:, :] a_view = a</pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(((PyObject *)__pyx_v_a), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 3346, __pyx_L1_error)</span>
  __pyx_v_a_view = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3347</span>:     cdef float[:, :] z_view = z</pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(((PyObject *)__pyx_v_z), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 3347, __pyx_L1_error)</span>
  __pyx_v_z_view = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">3348</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3349</span>:     cdef float[:] deadline_view = deadline</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_deadline), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 3349, __pyx_L1_error)</span>
  __pyx_v_deadline_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">3350</span>: </pre>
<pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3351</span>:     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)</pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3351, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3351, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3351, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3351, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3351, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 3351, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3351, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 3351, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3351, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 3351, __pyx_L1_error)</span>;
  __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3351, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3351, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3351, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_5, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3351, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_rts = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3352</span>:     cdef float[:, :, :] rts_view = rts</pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_rts, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 3352, __pyx_L1_error)</span>
  __pyx_v_rts_view = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">3353</span>: </pre>
<pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3354</span>:     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)</pre>
<pre class='cython code score-46 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3354, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3354, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3354, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3354, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3354, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 3354, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3354, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 3354, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3354, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 3354, __pyx_L1_error)</span>;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3354, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3354, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_intc);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3354, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3354, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_5, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3354, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_choices = __pyx_t_8;
  __pyx_t_8 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3355</span>:     cdef int[:, :, :] choices_view = choices</pre>
<pre class='cython code score-2 '>  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_int</span>(__pyx_v_choices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 3355, __pyx_L1_error)</span>
  __pyx_v_choices_view = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">3356</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3357</span>:     cdef Py_ssize_t n, k, i</pre>
<pre class="cython line score-0">&#xA0;<span class="">3358</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3359</span>:     for k in range(n_trials):</pre>
<pre class='cython code score-0 '>  __pyx_t_10 = __pyx_v_n_trials;
  __pyx_t_11 = __pyx_t_10;
  for (__pyx_t_12 = 0; __pyx_t_12 &lt; __pyx_t_11; __pyx_t_12+=1) {
    __pyx_v_k = __pyx_t_12;
</pre><pre class="cython line score-0">&#xA0;<span class="">3360</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3361</span>:         for n in range(n_samples):</pre>
<pre class='cython code score-0 '>    __pyx_t_13 = __pyx_v_n_samples;
    __pyx_t_14 = __pyx_t_13;
    for (__pyx_t_15 = 0; __pyx_t_15 &lt; __pyx_t_14; __pyx_t_15+=1) {
      __pyx_v_n = __pyx_t_15;
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3362</span>:             zs = np.random.uniform(0, z_view[k], nact)</pre>
<pre class='cython code score-27 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3362, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3362, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_uniform);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3362, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_2.data = __pyx_v_z_view.data;
      __pyx_t_2.memview = __pyx_v_z_view.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 1);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_k;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_z_view.strides[0];
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_2.shape[0] = __pyx_v_z_view.shape[1];
__pyx_t_2.strides[0] = __pyx_v_z_view.strides[1];
    __pyx_t_2.suboffsets[0] = -1;

__pyx_t_5 = __pyx_memoryview_fromslice(__pyx_t_2, 1, (PyObject *(*)(char *)) __pyx_memview_get_float, (int (*)(char *, PyObject *)) __pyx_memview_set_float, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3362, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_2, 1);
      __pyx_t_2.memview = NULL; __pyx_t_2.data = NULL;
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nact);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3362, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_3 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
        __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
        if (likely(__pyx_t_3)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[4] = {__pyx_t_3, __pyx_int_0, __pyx_t_5, __pyx_t_6};
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_16, 3+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 3362, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_zs, __pyx_t_8);
      __pyx_t_8 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3363</span>: </pre>
<pre class="cython line score-50" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3364</span>:             vs = np.abs(np.random.normal(v_view[k], sd)) # np.abs() to avoid negative vs</pre>
<pre class='cython code score-50 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3364, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_abs);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3364, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3364, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3364, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_normal);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3364, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_2.data = __pyx_v_v_view.data;
      __pyx_t_2.memview = __pyx_v_v_view.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 1);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_k;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_v_view.strides[0];
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_2.shape[0] = __pyx_v_v_view.shape[1];
__pyx_t_2.strides[0] = __pyx_v_v_view.strides[1];
    __pyx_t_2.suboffsets[0] = -1;

__pyx_t_3 = __pyx_memoryview_fromslice(__pyx_t_2, 1, (PyObject *(*)(char *)) __pyx_memview_get_float, (int (*)(char *, PyObject *)) __pyx_memview_set_float, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3364, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_2, 1);
      __pyx_t_2.memview = NULL; __pyx_t_2.data = NULL;
      __pyx_t_17 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_sd);<span class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 3364, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
      __pyx_t_18 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
        __pyx_t_18 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
        if (likely(__pyx_t_18)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_18);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_18, __pyx_t_3, __pyx_t_17};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_16, 2+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
        if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 3364, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      }
      __pyx_t_5 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
        __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
        if (likely(__pyx_t_5)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_4};
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_16, 1+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 3364, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_vs, __pyx_t_8);
      __pyx_t_8 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3365</span>: </pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3366</span>:             x_t = ([a_view[k]]*nact - zs)/vs</pre>
<pre class='cython code score-19 '>      __pyx_t_2.data = __pyx_v_a_view.data;
      __pyx_t_2.memview = __pyx_v_a_view.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 1);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_k;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_a_view.strides[0];
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_2.shape[0] = __pyx_v_a_view.shape[1];
__pyx_t_2.strides[0] = __pyx_v_a_view.strides[1];
    __pyx_t_2.suboffsets[0] = -1;

__pyx_t_8 = __pyx_memoryview_fromslice(__pyx_t_2, 1, (PyObject *(*)(char *)) __pyx_memview_get_float, (int (*)(char *, PyObject *)) __pyx_memview_set_float, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3366, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_2, 1);
      __pyx_t_2.memview = NULL; __pyx_t_2.data = NULL;
      __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(1 * ((__pyx_v_nact&lt;0) ? 0:__pyx_v_nact));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3366, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      { Py_ssize_t __pyx_temp;
        for (__pyx_temp=0; __pyx_temp &lt; __pyx_v_nact; __pyx_temp++) {
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
          if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, __pyx_temp, __pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 3366, __pyx_L1_error)</span>;
        }
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_6, __pyx_v_zs);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3366, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_8, __pyx_v_vs);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3366, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_x_t, __pyx_t_6);
      __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3367</span>: </pre>
<pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3368</span>:             choices_view[n, k, 0] = np.argmin(x_t) # store choices for sample n</pre>
<pre class='cython code score-27 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3368, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_argmin);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3368, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
        __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
        if (likely(__pyx_t_8)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_8, __pyx_v_x_t};
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_16, 1+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 3368, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      }
      __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_6); if (unlikely((__pyx_t_16 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3368, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_19 = __pyx_v_n;
      __pyx_t_20 = __pyx_v_k;
      __pyx_t_21 = 0;
      *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_19 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_21 * __pyx_v_choices_view.strides[2]) )) = __pyx_t_16;
</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3369</span>:             rts_view[n, k, 0] = np.min(x_t) + ndt  # store reaction time for sample n</pre>
<pre class='cython code score-42 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3369, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_min);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3369, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_x_t};
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+1-__pyx_t_16, 1+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 3369, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      }
      __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_ndt);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3369, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_6, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3369, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_22 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_4); if (unlikely((__pyx_t_22 == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3369, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_21 = __pyx_v_n;
      __pyx_t_20 = __pyx_v_k;
      __pyx_t_19 = 0;
      *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_21 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_20 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_19 * __pyx_v_rts_view.strides[2]) )) = __pyx_t_22;
</pre><pre class="cython line score-0">&#xA0;<span class="">3370</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3371</span>:             # If the rt exceeds the deadline, set rt to -999</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3372</span>:             if rts_view[n, k, 0] &gt;= deadline_view[k]:</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = __pyx_v_n;
      __pyx_t_20 = __pyx_v_k;
      __pyx_t_21 = 0;
      __pyx_t_23 = __pyx_v_k;
      __pyx_t_24 = ((*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_19 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_20 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_21 * __pyx_v_rts_view.strides[2]) ))) &gt;= (*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_23 * __pyx_v_deadline_view.strides[0]) ))));
      if (__pyx_t_24) {
/* … */
      }
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3373</span>:                 rts_view[n, k, 0] = -999</pre>
<pre class='cython code score-0 '>        __pyx_t_23 = __pyx_v_n;
        __pyx_t_21 = __pyx_v_k;
        __pyx_t_20 = 0;
        *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_23 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_21 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_20 * __pyx_v_rts_view.strides[2]) )) = -999.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3374</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3375</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3376</span>:     v_dict = {}</pre>
<pre class='cython code score-2 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3376, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_v_v_dict = ((PyObject*)__pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3377</span>:     for i in range(nact):</pre>
<pre class='cython code score-0 '>  __pyx_t_10 = __pyx_v_nact;
  __pyx_t_11 = __pyx_t_10;
  for (__pyx_t_12 = 0; __pyx_t_12 &lt; __pyx_t_11; __pyx_t_12+=1) {
    __pyx_v_i = __pyx_t_12;
</pre><pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3378</span>:         v_dict['v_' + str(i)] = v[:, i]</pre>
<pre class='cython code score-39 '>    __pyx_t_4 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3378, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3378, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__5);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_slice__5)) <span class='error_goto'>__PYX_ERR(0, 3378, __pyx_L1_error)</span>;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 3378, __pyx_L1_error)</span>;
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_v), __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3378, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3378, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Str</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3378, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_n_u_v_2, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3378, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely((<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_v_dict, __pyx_t_8, __pyx_t_4) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3378, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">3379</span>: </pre>
<pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3380</span>:     return {'rts': rts, 'choices': choices, 'metadata': {**v_dict,</pre>
<pre class='cython code score-18 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3380, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3380, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3380, __pyx_L1_error)</span>
  __pyx_t_8 = <span class='py_c_api'>PyDict_Copy</span>(__pyx_v_v_dict);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3380, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3381</span>:                                                          'a': a,</pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3381, __pyx_L1_error)</span>
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3382</span>:                                                          'z': z,</pre>
<pre class='cython code score-10 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_u_z, ((PyObject *)__pyx_v_z)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3382, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_u_t, __pyx_int_0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3383, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">3383</span>:                                                          't': 0,</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3384</span>:                                                          'deadline': deadline,</pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_u_deadline, ((PyObject *)__pyx_v_deadline)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3384, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3385</span>:                                                          'sd': sd,</pre>
<pre class='cython code score-11 '>  __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_sd);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3385, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_u_sd, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3385, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3386</span>:                                                          'n_samples': n_samples,</pre>
<pre class='cython code score-13 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3386, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_u_n_samples, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3386, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_u_simulator, __pyx_n_u_lba_vanilla) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3387, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">3387</span>:                                                          'simulator' : 'lba_vanilla',</pre>
<pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3388</span>:                                                          'possible_choices': list(np.arange(0, nact, 1)),</pre>
<pre class='cython code score-31 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3388, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 3388, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nact);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3388, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = NULL;
  __pyx_t_10 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_17))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_17);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_17);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_17, function);
      __pyx_t_10 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[4] = {__pyx_t_3, __pyx_int_0, __pyx_t_5, __pyx_int_1};
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_17, __pyx_callargs+1-__pyx_t_10, 3+__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 3388, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
  }
  __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PySequence_ListKeepNew</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 3388, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_u_possible_choices, __pyx_t_17) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3388, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3389</span>:                                                          'max_t': max_t,</pre>
<pre class='cython code score-17 '>  __pyx_t_17 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_max_t);<span class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 3389, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_u_max_t, __pyx_t_17) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3389, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_metadata, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3380, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3390</span>:                                                          }}</pre>
<pre class="cython line score-0">&#xA0;<span class="">3391</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3392</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3393</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3394</span>: # Simulate (rt, choice) tuples from: Collapsing bound angle LBA Model -----------------------------</pre>
<pre class="cython line score-323" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3395</span>: def lba_angle(np.ndarray[float, ndim = 2] v,</pre>
<pre class='cython code score-323 '>/* Python wrapper */
static PyObject *__pyx_pw_4cssm_37lba_angle(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_4cssm_37lba_angle = {"lba_angle", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_4cssm_37lba_angle, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_4cssm_37lba_angle(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyArrayObject *__pyx_v_v = 0;
  PyArrayObject *__pyx_v_a = 0;
  PyArrayObject *__pyx_v_z = 0;
  PyArrayObject *__pyx_v_theta = 0;
  PyArrayObject *__pyx_v_deadline = 0;
  float __pyx_v_sd;
  float __pyx_v_ndt;
  int __pyx_v_nact;
  int __pyx_v_n_samples;
  int __pyx_v_n_trials;
  float __pyx_v_max_t;
  CYTHON_UNUSED PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lba_angle (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_v,&amp;__pyx_n_s_a,&amp;__pyx_n_s_z,&amp;__pyx_n_s_theta,&amp;__pyx_n_s_deadline,&amp;__pyx_n_s_sd,&amp;__pyx_n_s_ndt,&amp;__pyx_n_s_nact,&amp;__pyx_n_s_n_samples,&amp;__pyx_n_s_n_trials,&amp;__pyx_n_s_max_t,0};
  PyObject* values[11] = {0,0,0,0,0,0,0,0,0,0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_v)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_a)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("lba_angle", 0, 6, 11, 1); <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_z)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("lba_angle", 0, 6, 11, 2); <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_theta)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[3]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("lba_angle", 0, 6, 11, 3); <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_deadline)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[4]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("lba_angle", 0, 6, 11, 4); <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_sd)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[5]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("lba_angle", 0, 6, 11, 5); <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_ndt);
          if (value) { values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_nact);
          if (value) { values[7] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_samples);
          if (value) { values[8] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  9:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_trials);
          if (value) { values[9] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 10:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_max_t);
          if (value) { values[10] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values + 0, kwd_pos_args, "lba_angle") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_v = ((PyArrayObject *)values[0]);
    __pyx_v_a = ((PyArrayObject *)values[1]);
    __pyx_v_z = ((PyArrayObject *)values[2]);
    __pyx_v_theta = ((PyArrayObject *)values[3]);
    __pyx_v_deadline = ((PyArrayObject *)values[4]);
    __pyx_v_sd = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[5]); if (unlikely((__pyx_v_sd == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3400, __pyx_L3_error)</span>
    if (values[6]) {
      __pyx_v_ndt = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[6]); if (unlikely((__pyx_v_ndt == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3401, __pyx_L3_error)</span>
    } else {
      __pyx_v_ndt = ((float)((float)0.0));
    }
    if (values[7]) {
      __pyx_v_nact = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[7]); if (unlikely((__pyx_v_nact == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3402, __pyx_L3_error)</span>
    } else {
      __pyx_v_nact = ((int)((int)3));
    }
    if (values[8]) {
      __pyx_v_n_samples = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[8]); if (unlikely((__pyx_v_n_samples == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3403, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_samples = ((int)((int)0x7D0));
    }
    if (values[9]) {
      __pyx_v_n_trials = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[9]); if (unlikely((__pyx_v_n_trials == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3404, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_trials = ((int)((int)1));
    }
    if (values[10]) {
      __pyx_v_max_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[10]); if (unlikely((__pyx_v_max_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3405, __pyx_L3_error)</span>
    } else {
      __pyx_v_max_t = ((float)((float)20.0));
    }
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("lba_angle", 0, 6, 11, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.lba_angle", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_v), __pyx_ptype_5numpy_ndarray, 1, "v", 0))) <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) <span class='error_goto'>__PYX_ERR(0, 3396, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) <span class='error_goto'>__PYX_ERR(0, 3397, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_theta), __pyx_ptype_5numpy_ndarray, 1, "theta", 0))) <span class='error_goto'>__PYX_ERR(0, 3398, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_deadline), __pyx_ptype_5numpy_ndarray, 1, "deadline", 0))) <span class='error_goto'>__PYX_ERR(0, 3399, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_4cssm_36lba_angle(__pyx_self, __pyx_v_v, __pyx_v_a, __pyx_v_z, __pyx_v_theta, __pyx_v_deadline, __pyx_v_sd, __pyx_v_ndt, __pyx_v_nact, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_max_t, __pyx_v_kwargs);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs);
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4cssm_36lba_angle(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_theta, PyArrayObject *__pyx_v_deadline, float __pyx_v_sd, float __pyx_v_ndt, int __pyx_v_nact, int __pyx_v_n_samples, int __pyx_v_n_trials, float __pyx_v_max_t, CYTHON_UNUSED PyObject *__pyx_v_kwargs) {
  __Pyx_memviewslice __pyx_v_v_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_a_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_z_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_theta_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_deadline_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_rts = NULL;
  __Pyx_memviewslice __pyx_v_rts_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_choices = NULL;
  __Pyx_memviewslice __pyx_v_choices_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  Py_ssize_t __pyx_v_n;
  Py_ssize_t __pyx_v_k;
  Py_ssize_t __pyx_v_i;
  PyObject *__pyx_v_zs = NULL;
  PyObject *__pyx_v_vs = NULL;
  PyObject *__pyx_v_x_t = NULL;
  PyObject *__pyx_v_v_dict = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_a;
  __Pyx_Buffer __pyx_pybuffer_a;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_deadline;
  __Pyx_Buffer __pyx_pybuffer_deadline;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_theta;
  __Pyx_Buffer __pyx_pybuffer_theta;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_v;
  __Pyx_Buffer __pyx_pybuffer_v;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_z;
  __Pyx_Buffer __pyx_pybuffer_z;
  PyObject *__pyx_r = NULL;
  __pyx_pybuffer_v.pybuffer.buf = NULL;
  __pyx_pybuffer_v.refcount = 0;
  __pyx_pybuffernd_v.data = NULL;
  __pyx_pybuffernd_v.rcbuffer = &amp;__pyx_pybuffer_v;
  __pyx_pybuffer_a.pybuffer.buf = NULL;
  __pyx_pybuffer_a.refcount = 0;
  __pyx_pybuffernd_a.data = NULL;
  __pyx_pybuffernd_a.rcbuffer = &amp;__pyx_pybuffer_a;
  __pyx_pybuffer_z.pybuffer.buf = NULL;
  __pyx_pybuffer_z.refcount = 0;
  __pyx_pybuffernd_z.data = NULL;
  __pyx_pybuffernd_z.rcbuffer = &amp;__pyx_pybuffer_z;
  __pyx_pybuffer_theta.pybuffer.buf = NULL;
  __pyx_pybuffer_theta.refcount = 0;
  __pyx_pybuffernd_theta.data = NULL;
  __pyx_pybuffernd_theta.rcbuffer = &amp;__pyx_pybuffer_theta;
  __pyx_pybuffer_deadline.pybuffer.buf = NULL;
  __pyx_pybuffer_deadline.refcount = 0;
  __pyx_pybuffernd_deadline.data = NULL;
  __pyx_pybuffernd_deadline.rcbuffer = &amp;__pyx_pybuffer_deadline;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_v, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_v.diminfo[0].strides = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_v.diminfo[0].shape = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_v.diminfo[1].strides = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_v.diminfo[1].shape = __pyx_pybuffernd_v.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_a, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_a.diminfo[1].strides = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_a.diminfo[1].shape = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_z, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_z.diminfo[0].strides = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_z.diminfo[0].shape = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_z.diminfo[1].strides = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_z.diminfo[1].shape = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_theta.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_theta, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_theta.diminfo[0].strides = __pyx_pybuffernd_theta.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_theta.diminfo[0].shape = __pyx_pybuffernd_theta.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_theta.diminfo[1].strides = __pyx_pybuffernd_theta.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_theta.diminfo[1].shape = __pyx_pybuffernd_theta.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_deadline, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_deadline.diminfo[0].strides = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_deadline.diminfo[0].shape = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.shape[0];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_1, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_2, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_7, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_9, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_theta.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.lba_angle", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_theta.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_v.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_v_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_a_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_z_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_theta_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_deadline_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rts);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_rts_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_choices);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_choices_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_zs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x_t);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_v_dict);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__59 = <span class='py_c_api'>PyTuple_Pack</span>(28, __pyx_n_s_v, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_theta, __pyx_n_s_deadline, __pyx_n_s_sd, __pyx_n_s_ndt, __pyx_n_s_nact, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_max_t, __pyx_n_s_kwargs, __pyx_n_s_v_view, __pyx_n_s_a_view, __pyx_n_s_z_view, __pyx_n_s_theta_view, __pyx_n_s_deadline_view, __pyx_n_s_rts, __pyx_n_s_rts_view, __pyx_n_s_choices, __pyx_n_s_choices_view, __pyx_n_s_n, __pyx_n_s_k, __pyx_n_s_i, __pyx_n_s_zs, __pyx_n_s_vs, __pyx_n_s_x_t, __pyx_n_s_v_dict);<span class='error_goto'> if (unlikely(!__pyx_tuple__59)) __PYX_ERR(0, 3395, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__59);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__59);
/* … */
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3395, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_11)) <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_t_10)) <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 3, __pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 4, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L1_error)</span>;
  __pyx_t_11 = 0;
  __pyx_t_7 = 0;
  __pyx_t_10 = 0;
  __pyx_t_9 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_4cssm_37lba_angle, 0, __pyx_n_s_lba_angle, NULL, __pyx_n_s_cssm, __pyx_d, ((PyObject *)__pyx_codeobj__60));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3395, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_4, __pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_lba_angle, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_codeobj__60 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(11, 0, 0, 28, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__59, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_lba_angle, 3395, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__60)) __PYX_ERR(0, 3395, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">3396</span>:         np.ndarray[float, ndim = 2] a,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3397</span>:         np.ndarray[float, ndim = 2] z,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3398</span>:         np.ndarray[float, ndim = 2] theta,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3399</span>:         np.ndarray[float, ndim = 1] deadline,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3400</span>:         float sd, # std dev</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3401</span>:         float ndt = 0, # ndt is supposed to be 0 by default because of parameter identifiability issues</pre>
<pre class='cython code score-5 '>  __pyx_t_11 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)0.0));<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 3401, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3402</span>:         int nact = 3,</pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)3));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 3402, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3403</span>:         int n_samples = 2000,</pre>
<pre class='cython code score-2 '>  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)0x7D0));<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3403, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3404</span>:         int n_trials = 1,</pre>
<pre class='cython code score-2 '>  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)1));<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3404, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3405</span>:         float max_t = 20,</pre>
<pre class='cython code score-5 '>  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)20.0));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3405, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
</pre><pre class="cython line score-0">&#xA0;<span class="">3406</span>:         **kwargs</pre>
<pre class="cython line score-0">&#xA0;<span class="">3407</span>:         ):</pre>
<pre class="cython line score-0">&#xA0;<span class="">3408</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3409</span>:     # Param views</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3410</span>:     cdef float[:, :] v_view = v</pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(((PyObject *)__pyx_v_v), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 3410, __pyx_L1_error)</span>
  __pyx_v_v_view = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3411</span>:     cdef float[:, :] a_view = a</pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(((PyObject *)__pyx_v_a), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 3411, __pyx_L1_error)</span>
  __pyx_v_a_view = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3412</span>:     cdef float[:, :] z_view = z</pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(((PyObject *)__pyx_v_z), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 3412, __pyx_L1_error)</span>
  __pyx_v_z_view = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3413</span>:     cdef float[:, :] theta_view = theta</pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(((PyObject *)__pyx_v_theta), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 3413, __pyx_L1_error)</span>
  __pyx_v_theta_view = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">3414</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3415</span>:     cdef float[:] deadline_view = deadline</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_deadline), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 3415, __pyx_L1_error)</span>
  __pyx_v_deadline_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">3416</span>: </pre>
<pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3417</span>:     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)</pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3417, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3417, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3417, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3417, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3417, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 3417, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3417, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 3417, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3417, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 3417, __pyx_L1_error)</span>;
  __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3417, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3417, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3417, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_5, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3417, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_rts = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3418</span>:     cdef float[:, :, :] rts_view = rts</pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_rts, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 3418, __pyx_L1_error)</span>
  __pyx_v_rts_view = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">3419</span>: </pre>
<pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3420</span>:     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)</pre>
<pre class='cython code score-46 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3420, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3420, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3420, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3420, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3420, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 3420, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3420, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 3420, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3420, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 3420, __pyx_L1_error)</span>;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3420, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3420, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_intc);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3420, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3420, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_5, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3420, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_choices = __pyx_t_8;
  __pyx_t_8 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3421</span>:     cdef int[:, :, :] choices_view = choices</pre>
<pre class='cython code score-2 '>  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_int</span>(__pyx_v_choices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 3421, __pyx_L1_error)</span>
  __pyx_v_choices_view = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">3422</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3423</span>:     cdef Py_ssize_t n, k, i</pre>
<pre class="cython line score-0">&#xA0;<span class="">3424</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3425</span>:     for k in range(n_trials):</pre>
<pre class='cython code score-0 '>  __pyx_t_10 = __pyx_v_n_trials;
  __pyx_t_11 = __pyx_t_10;
  for (__pyx_t_12 = 0; __pyx_t_12 &lt; __pyx_t_11; __pyx_t_12+=1) {
    __pyx_v_k = __pyx_t_12;
</pre><pre class="cython line score-0">&#xA0;<span class="">3426</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3427</span>:         for n in range(n_samples):</pre>
<pre class='cython code score-0 '>    __pyx_t_13 = __pyx_v_n_samples;
    __pyx_t_14 = __pyx_t_13;
    for (__pyx_t_15 = 0; __pyx_t_15 &lt; __pyx_t_14; __pyx_t_15+=1) {
      __pyx_v_n = __pyx_t_15;
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3428</span>:             zs = np.random.uniform(0, z_view[k], nact)</pre>
<pre class='cython code score-27 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3428, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3428, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_uniform);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3428, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_2.data = __pyx_v_z_view.data;
      __pyx_t_2.memview = __pyx_v_z_view.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 1);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_k;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_z_view.strides[0];
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_2.shape[0] = __pyx_v_z_view.shape[1];
__pyx_t_2.strides[0] = __pyx_v_z_view.strides[1];
    __pyx_t_2.suboffsets[0] = -1;

__pyx_t_5 = __pyx_memoryview_fromslice(__pyx_t_2, 1, (PyObject *(*)(char *)) __pyx_memview_get_float, (int (*)(char *, PyObject *)) __pyx_memview_set_float, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3428, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_2, 1);
      __pyx_t_2.memview = NULL; __pyx_t_2.data = NULL;
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nact);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3428, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_3 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
        __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
        if (likely(__pyx_t_3)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[4] = {__pyx_t_3, __pyx_int_0, __pyx_t_5, __pyx_t_6};
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_16, 3+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 3428, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_zs, __pyx_t_8);
      __pyx_t_8 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3429</span>: </pre>
<pre class="cython line score-50" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3430</span>:             vs = np.abs(np.random.normal(v_view[k], sd)) # np.abs() to avoid negative vs</pre>
<pre class='cython code score-50 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3430, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_abs);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3430, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3430, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3430, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_normal);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3430, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_2.data = __pyx_v_v_view.data;
      __pyx_t_2.memview = __pyx_v_v_view.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 1);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_k;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_v_view.strides[0];
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_2.shape[0] = __pyx_v_v_view.shape[1];
__pyx_t_2.strides[0] = __pyx_v_v_view.strides[1];
    __pyx_t_2.suboffsets[0] = -1;

__pyx_t_3 = __pyx_memoryview_fromslice(__pyx_t_2, 1, (PyObject *(*)(char *)) __pyx_memview_get_float, (int (*)(char *, PyObject *)) __pyx_memview_set_float, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3430, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_2, 1);
      __pyx_t_2.memview = NULL; __pyx_t_2.data = NULL;
      __pyx_t_17 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_sd);<span class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 3430, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
      __pyx_t_18 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
        __pyx_t_18 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
        if (likely(__pyx_t_18)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_18);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_18, __pyx_t_3, __pyx_t_17};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_16, 2+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
        if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 3430, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      }
      __pyx_t_5 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
        __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
        if (likely(__pyx_t_5)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_4};
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_16, 1+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 3430, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_vs, __pyx_t_8);
      __pyx_t_8 = 0;
</pre><pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3431</span>:             x_t = ([a_view[k]]*nact - zs)/(vs + np.tan(theta_view[k, 0]))</pre>
<pre class='cython code score-51 '>      __pyx_t_2.data = __pyx_v_a_view.data;
      __pyx_t_2.memview = __pyx_v_a_view.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 1);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_k;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_a_view.strides[0];
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_2.shape[0] = __pyx_v_a_view.shape[1];
__pyx_t_2.strides[0] = __pyx_v_a_view.strides[1];
    __pyx_t_2.suboffsets[0] = -1;

__pyx_t_8 = __pyx_memoryview_fromslice(__pyx_t_2, 1, (PyObject *(*)(char *)) __pyx_memview_get_float, (int (*)(char *, PyObject *)) __pyx_memview_set_float, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3431, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_2, 1);
      __pyx_t_2.memview = NULL; __pyx_t_2.data = NULL;
      __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(1 * ((__pyx_v_nact&lt;0) ? 0:__pyx_v_nact));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3431, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      { Py_ssize_t __pyx_temp;
        for (__pyx_temp=0; __pyx_temp &lt; __pyx_v_nact; __pyx_temp++) {
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
          if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, __pyx_temp, __pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 3431, __pyx_L1_error)</span>;
        }
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_6, __pyx_v_zs);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3431, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3431, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_tan);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3431, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_20 = 0;
      __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_theta_view.data + __pyx_t_19 * __pyx_v_theta_view.strides[0]) ) + __pyx_t_20 * __pyx_v_theta_view.strides[1]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3431, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_17 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
        __pyx_t_17 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
        if (likely(__pyx_t_17)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_17);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_17, __pyx_t_4};
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_16, 1+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 3431, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      }
      __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_vs, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3431, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_8, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3431, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_x_t, __pyx_t_6);
      __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3432</span>: </pre>
<pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3433</span>:             choices_view[n, k, 0] = np.argmin(x_t) # store choices for sample n</pre>
<pre class='cython code score-27 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3433, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_argmin);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3433, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
        __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
        if (likely(__pyx_t_5)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_v_x_t};
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+1-__pyx_t_16, 1+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 3433, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      }
      __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_6); if (unlikely((__pyx_t_16 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3433, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_20 = __pyx_v_n;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_21 = 0;
      *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_20 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_21 * __pyx_v_choices_view.strides[2]) )) = __pyx_t_16;
</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3434</span>:             rts_view[n, k, 0] = np.min(x_t) + ndt # store reaction time for sample n</pre>
<pre class='cython code score-42 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3434, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_min);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3434, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
        __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
        if (likely(__pyx_t_8)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_8, __pyx_v_x_t};
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_16, 1+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 3434, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      }
      __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_ndt);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3434, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_8 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_6, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3434, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_22 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_8); if (unlikely((__pyx_t_22 == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3434, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_21 = __pyx_v_n;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_20 = 0;
      *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_21 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_19 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_20 * __pyx_v_rts_view.strides[2]) )) = __pyx_t_22;
</pre><pre class="cython line score-0">&#xA0;<span class="">3435</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3436</span>:             # If the rt exceeds the deadline, set rt to -999</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3437</span>:             if rts_view[n, k, 0] &gt;= deadline_view[k]:</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = __pyx_v_n;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_21 = 0;
      __pyx_t_23 = __pyx_v_k;
      __pyx_t_24 = ((*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_20 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_19 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_21 * __pyx_v_rts_view.strides[2]) ))) &gt;= (*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_23 * __pyx_v_deadline_view.strides[0]) ))));
      if (__pyx_t_24) {
/* … */
      }
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3438</span>:                 rts_view[n, k, 0] = -999</pre>
<pre class='cython code score-0 '>        __pyx_t_23 = __pyx_v_n;
        __pyx_t_21 = __pyx_v_k;
        __pyx_t_19 = 0;
        *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_23 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_21 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_19 * __pyx_v_rts_view.strides[2]) )) = -999.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3439</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3440</span>:             # if np.min(x_t) &lt;= 0:</pre>
<pre class="cython line score-0">&#xA0;<span class="">3441</span>:             #     print("\n ssms sim error: ", a[k], zs, vs, np.tan(theta[k]))</pre>
<pre class="cython line score-0">&#xA0;<span class="">3442</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3443</span>:     v_dict = {}</pre>
<pre class='cython code score-2 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3443, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_v_v_dict = ((PyObject*)__pyx_t_8);
  __pyx_t_8 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3444</span>:     for i in range(nact):</pre>
<pre class='cython code score-0 '>  __pyx_t_10 = __pyx_v_nact;
  __pyx_t_11 = __pyx_t_10;
  for (__pyx_t_12 = 0; __pyx_t_12 &lt; __pyx_t_11; __pyx_t_12+=1) {
    __pyx_v_i = __pyx_t_12;
</pre><pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3445</span>:         v_dict['v_' + str(i)] = v[:, i]</pre>
<pre class='cython code score-39 '>    __pyx_t_8 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3445, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3445, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__5);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_slice__5)) <span class='error_goto'>__PYX_ERR(0, 3445, __pyx_L1_error)</span>;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 3445, __pyx_L1_error)</span>;
    __pyx_t_8 = 0;
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_v), __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3445, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3445, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Str</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3445, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_n_u_v_2, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3445, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely((<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_v_dict, __pyx_t_5, __pyx_t_8) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3445, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">3446</span>: </pre>
<pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3447</span>:     return {'rts': rts, 'choices': choices, 'metadata': {**v_dict,</pre>
<pre class='cython code score-18 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3447, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3447, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3447, __pyx_L1_error)</span>
  __pyx_t_5 = <span class='py_c_api'>PyDict_Copy</span>(__pyx_v_v_dict);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3447, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3448</span>:                                                          'a': a,</pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3448, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3449</span>:                                                          'z': z,</pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_z, ((PyObject *)__pyx_v_z)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3449, __pyx_L1_error)</span>
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3450</span>:                                                          'theta': theta,</pre>
<pre class='cython code score-10 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_theta, ((PyObject *)__pyx_v_theta)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3450, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_t, __pyx_int_0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3451, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">3451</span>:                                                          't': 0,</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3452</span>:                                                          'deadline': deadline,</pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_deadline, ((PyObject *)__pyx_v_deadline)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3452, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3453</span>:                                                          'sd': sd,</pre>
<pre class='cython code score-11 '>  __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_sd);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3453, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_sd, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3453, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3454</span>:                                                          'n_samples': n_samples,</pre>
<pre class='cython code score-13 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3454, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_n_samples, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3454, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_simulator, __pyx_n_u_lba_angle) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3455, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">3455</span>:                                                          'simulator' : 'lba_angle',</pre>
<pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3456</span>:                                                          'possible_choices': list(np.arange(0, nact, 1)),</pre>
<pre class='cython code score-31 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3456, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 3456, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nact);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3456, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = NULL;
  __pyx_t_10 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_17))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_17);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_17);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_17, function);
      __pyx_t_10 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[4] = {__pyx_t_3, __pyx_int_0, __pyx_t_4, __pyx_int_1};
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_17, __pyx_callargs+1-__pyx_t_10, 3+__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 3456, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
  }
  __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PySequence_ListKeepNew</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 3456, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_possible_choices, __pyx_t_17) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3456, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3457</span>:                                                          'max_t': max_t,</pre>
<pre class='cython code score-17 '>  __pyx_t_17 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_max_t);<span class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 3457, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_max_t, __pyx_t_17) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3457, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_u_metadata, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3447, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_r = __pyx_t_8;
  __pyx_t_8 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3458</span>:                                                          }}</pre>
<pre class="cython line score-0">&#xA0;<span class="">3459</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3460</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3461</span>: # Simulate (rt, choice) tuples from:  -----------------------------</pre>
<pre class="cython line score-364" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3462</span>: def rlwm_lba_pw_v1(np.ndarray[float, ndim = 2] v_RL,</pre>
<pre class='cython code score-364 '>/* Python wrapper */
static PyObject *__pyx_pw_4cssm_39rlwm_lba_pw_v1(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_4cssm_39rlwm_lba_pw_v1 = {"rlwm_lba_pw_v1", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_4cssm_39rlwm_lba_pw_v1, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_4cssm_39rlwm_lba_pw_v1(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyArrayObject *__pyx_v_v_RL = 0;
  PyArrayObject *__pyx_v_v_WM = 0;
  PyArrayObject *__pyx_v_a = 0;
  PyArrayObject *__pyx_v_z = 0;
  PyArrayObject *__pyx_v_t_WM = 0;
  PyArrayObject *__pyx_v_deadline = 0;
  float __pyx_v_sd;
  float __pyx_v_ndt;
  int __pyx_v_nact;
  int __pyx_v_n_samples;
  int __pyx_v_n_trials;
  float __pyx_v_max_t;
  CYTHON_UNUSED PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("rlwm_lba_pw_v1 (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_v_RL,&amp;__pyx_n_s_v_WM,&amp;__pyx_n_s_a,&amp;__pyx_n_s_z,&amp;__pyx_n_s_t_WM,&amp;__pyx_n_s_deadline,&amp;__pyx_n_s_sd,&amp;__pyx_n_s_ndt,&amp;__pyx_n_s_nact,&amp;__pyx_n_s_n_samples,&amp;__pyx_n_s_n_trials,&amp;__pyx_n_s_max_t,0};
  PyObject* values[12] = {0,0,0,0,0,0,0,0,0,0,0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_v_RL)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3462, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_v_WM)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3462, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("rlwm_lba_pw_v1", 0, 7, 12, 1); <span class='error_goto'>__PYX_ERR(0, 3462, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_a)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3462, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("rlwm_lba_pw_v1", 0, 7, 12, 2); <span class='error_goto'>__PYX_ERR(0, 3462, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_z)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[3]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3462, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("rlwm_lba_pw_v1", 0, 7, 12, 3); <span class='error_goto'>__PYX_ERR(0, 3462, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_t_WM)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[4]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3462, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("rlwm_lba_pw_v1", 0, 7, 12, 4); <span class='error_goto'>__PYX_ERR(0, 3462, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_deadline)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[5]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3462, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("rlwm_lba_pw_v1", 0, 7, 12, 5); <span class='error_goto'>__PYX_ERR(0, 3462, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_sd)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[6]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3462, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("rlwm_lba_pw_v1", 0, 7, 12, 6); <span class='error_goto'>__PYX_ERR(0, 3462, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_ndt);
          if (value) { values[7] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3462, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_nact);
          if (value) { values[8] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3462, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  9:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_samples);
          if (value) { values[9] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3462, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 10:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_trials);
          if (value) { values[10] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3462, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 11:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_max_t);
          if (value) { values[11] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3462, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values + 0, kwd_pos_args, "rlwm_lba_pw_v1") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 3462, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_v_RL = ((PyArrayObject *)values[0]);
    __pyx_v_v_WM = ((PyArrayObject *)values[1]);
    __pyx_v_a = ((PyArrayObject *)values[2]);
    __pyx_v_z = ((PyArrayObject *)values[3]);
    __pyx_v_t_WM = ((PyArrayObject *)values[4]);
    __pyx_v_deadline = ((PyArrayObject *)values[5]);
    __pyx_v_sd = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[6]); if (unlikely((__pyx_v_sd == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3468, __pyx_L3_error)</span>
    if (values[7]) {
      __pyx_v_ndt = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[7]); if (unlikely((__pyx_v_ndt == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3469, __pyx_L3_error)</span>
    } else {
      __pyx_v_ndt = ((float)((float)0.0));
    }
    if (values[8]) {
      __pyx_v_nact = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[8]); if (unlikely((__pyx_v_nact == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3470, __pyx_L3_error)</span>
    } else {
      __pyx_v_nact = ((int)((int)3));
    }
    if (values[9]) {
      __pyx_v_n_samples = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[9]); if (unlikely((__pyx_v_n_samples == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3471, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_samples = ((int)((int)0x7D0));
    }
    if (values[10]) {
      __pyx_v_n_trials = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[10]); if (unlikely((__pyx_v_n_trials == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3472, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_trials = ((int)((int)1));
    }
    if (values[11]) {
      __pyx_v_max_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[11]); if (unlikely((__pyx_v_max_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3473, __pyx_L3_error)</span>
    } else {
      __pyx_v_max_t = ((float)((float)20.0));
    }
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("rlwm_lba_pw_v1", 0, 7, 12, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 3462, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.rlwm_lba_pw_v1", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_v_RL), __pyx_ptype_5numpy_ndarray, 1, "v_RL", 0))) <span class='error_goto'>__PYX_ERR(0, 3462, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_v_WM), __pyx_ptype_5numpy_ndarray, 1, "v_WM", 0))) <span class='error_goto'>__PYX_ERR(0, 3463, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) <span class='error_goto'>__PYX_ERR(0, 3464, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) <span class='error_goto'>__PYX_ERR(0, 3465, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_t_WM), __pyx_ptype_5numpy_ndarray, 1, "t_WM", 0))) <span class='error_goto'>__PYX_ERR(0, 3466, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_deadline), __pyx_ptype_5numpy_ndarray, 1, "deadline", 0))) <span class='error_goto'>__PYX_ERR(0, 3467, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_4cssm_38rlwm_lba_pw_v1(__pyx_self, __pyx_v_v_RL, __pyx_v_v_WM, __pyx_v_a, __pyx_v_z, __pyx_v_t_WM, __pyx_v_deadline, __pyx_v_sd, __pyx_v_ndt, __pyx_v_nact, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_max_t, __pyx_v_kwargs);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs);
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4cssm_38rlwm_lba_pw_v1(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v_RL, PyArrayObject *__pyx_v_v_WM, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_t_WM, PyArrayObject *__pyx_v_deadline, float __pyx_v_sd, float __pyx_v_ndt, int __pyx_v_nact, int __pyx_v_n_samples, int __pyx_v_n_trials, float __pyx_v_max_t, CYTHON_UNUSED PyObject *__pyx_v_kwargs) {
  __Pyx_memviewslice __pyx_v_v_RL_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_v_WM_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_a_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_z_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_t_WM_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_deadline_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyArrayObject *__pyx_v_zs = 0;
  PyArrayObject *__pyx_v_x_t_RL = 0;
  PyArrayObject *__pyx_v_vs_RL = 0;
  PyArrayObject *__pyx_v_vs_WM = 0;
  PyObject *__pyx_v_rts = NULL;
  __Pyx_memviewslice __pyx_v_rts_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_choices = NULL;
  __Pyx_memviewslice __pyx_v_choices_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  Py_ssize_t __pyx_v_n;
  Py_ssize_t __pyx_v_k;
  Py_ssize_t __pyx_v_i;
  PyObject *__pyx_v_x_t = NULL;
  PyObject *__pyx_v_v_dict = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_a;
  __Pyx_Buffer __pyx_pybuffer_a;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_deadline;
  __Pyx_Buffer __pyx_pybuffer_deadline;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_t_WM;
  __Pyx_Buffer __pyx_pybuffer_t_WM;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_v_RL;
  __Pyx_Buffer __pyx_pybuffer_v_RL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_v_WM;
  __Pyx_Buffer __pyx_pybuffer_v_WM;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_vs_RL;
  __Pyx_Buffer __pyx_pybuffer_vs_RL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_vs_WM;
  __Pyx_Buffer __pyx_pybuffer_vs_WM;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_x_t_RL;
  __Pyx_Buffer __pyx_pybuffer_x_t_RL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_z;
  __Pyx_Buffer __pyx_pybuffer_z;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_zs;
  __Pyx_Buffer __pyx_pybuffer_zs;
  PyObject *__pyx_r = NULL;
  __pyx_pybuffer_zs.pybuffer.buf = NULL;
  __pyx_pybuffer_zs.refcount = 0;
  __pyx_pybuffernd_zs.data = NULL;
  __pyx_pybuffernd_zs.rcbuffer = &amp;__pyx_pybuffer_zs;
  __pyx_pybuffer_x_t_RL.pybuffer.buf = NULL;
  __pyx_pybuffer_x_t_RL.refcount = 0;
  __pyx_pybuffernd_x_t_RL.data = NULL;
  __pyx_pybuffernd_x_t_RL.rcbuffer = &amp;__pyx_pybuffer_x_t_RL;
  __pyx_pybuffer_vs_RL.pybuffer.buf = NULL;
  __pyx_pybuffer_vs_RL.refcount = 0;
  __pyx_pybuffernd_vs_RL.data = NULL;
  __pyx_pybuffernd_vs_RL.rcbuffer = &amp;__pyx_pybuffer_vs_RL;
  __pyx_pybuffer_vs_WM.pybuffer.buf = NULL;
  __pyx_pybuffer_vs_WM.refcount = 0;
  __pyx_pybuffernd_vs_WM.data = NULL;
  __pyx_pybuffernd_vs_WM.rcbuffer = &amp;__pyx_pybuffer_vs_WM;
  __pyx_pybuffer_v_RL.pybuffer.buf = NULL;
  __pyx_pybuffer_v_RL.refcount = 0;
  __pyx_pybuffernd_v_RL.data = NULL;
  __pyx_pybuffernd_v_RL.rcbuffer = &amp;__pyx_pybuffer_v_RL;
  __pyx_pybuffer_v_WM.pybuffer.buf = NULL;
  __pyx_pybuffer_v_WM.refcount = 0;
  __pyx_pybuffernd_v_WM.data = NULL;
  __pyx_pybuffernd_v_WM.rcbuffer = &amp;__pyx_pybuffer_v_WM;
  __pyx_pybuffer_a.pybuffer.buf = NULL;
  __pyx_pybuffer_a.refcount = 0;
  __pyx_pybuffernd_a.data = NULL;
  __pyx_pybuffernd_a.rcbuffer = &amp;__pyx_pybuffer_a;
  __pyx_pybuffer_z.pybuffer.buf = NULL;
  __pyx_pybuffer_z.refcount = 0;
  __pyx_pybuffernd_z.data = NULL;
  __pyx_pybuffernd_z.rcbuffer = &amp;__pyx_pybuffer_z;
  __pyx_pybuffer_t_WM.pybuffer.buf = NULL;
  __pyx_pybuffer_t_WM.refcount = 0;
  __pyx_pybuffernd_t_WM.data = NULL;
  __pyx_pybuffernd_t_WM.rcbuffer = &amp;__pyx_pybuffer_t_WM;
  __pyx_pybuffer_deadline.pybuffer.buf = NULL;
  __pyx_pybuffer_deadline.refcount = 0;
  __pyx_pybuffernd_deadline.data = NULL;
  __pyx_pybuffernd_deadline.rcbuffer = &amp;__pyx_pybuffer_deadline;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_v_RL.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_v_RL, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3462, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_v_RL.diminfo[0].strides = __pyx_pybuffernd_v_RL.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_v_RL.diminfo[0].shape = __pyx_pybuffernd_v_RL.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_v_RL.diminfo[1].strides = __pyx_pybuffernd_v_RL.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_v_RL.diminfo[1].shape = __pyx_pybuffernd_v_RL.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_v_WM.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_v_WM, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3462, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_v_WM.diminfo[0].strides = __pyx_pybuffernd_v_WM.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_v_WM.diminfo[0].shape = __pyx_pybuffernd_v_WM.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_v_WM.diminfo[1].strides = __pyx_pybuffernd_v_WM.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_v_WM.diminfo[1].shape = __pyx_pybuffernd_v_WM.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_a, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3462, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_a.diminfo[1].strides = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_a.diminfo[1].shape = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_z, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3462, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_z.diminfo[0].strides = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_z.diminfo[0].shape = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_z.diminfo[1].strides = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_z.diminfo[1].shape = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_t_WM.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_t_WM, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3462, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_t_WM.diminfo[0].strides = __pyx_pybuffernd_t_WM.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_t_WM.diminfo[0].shape = __pyx_pybuffernd_t_WM.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_t_WM.diminfo[1].strides = __pyx_pybuffernd_t_WM.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_t_WM.diminfo[1].shape = __pyx_pybuffernd_t_WM.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_deadline, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3462, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_deadline.diminfo[0].strides = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_deadline.diminfo[0].shape = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.shape[0];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_1, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_2, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_7, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_9, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_22);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t_WM.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_v_RL.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_v_WM.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vs_RL.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vs_WM.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_x_t_RL.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zs.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.rlwm_lba_pw_v1", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t_WM.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_v_RL.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_v_WM.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vs_RL.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vs_WM.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_x_t_RL.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zs.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_v_RL_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_v_WM_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_a_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_z_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_t_WM_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_deadline_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_zs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_x_t_RL);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_vs_RL);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_vs_WM);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rts);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_rts_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_choices);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_choices_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x_t);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_v_dict);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__61 = <span class='py_c_api'>PyTuple_Pack</span>(33, __pyx_n_s_v_RL, __pyx_n_s_v_WM, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_t_WM, __pyx_n_s_deadline, __pyx_n_s_sd, __pyx_n_s_ndt, __pyx_n_s_nact, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_max_t, __pyx_n_s_kwargs, __pyx_n_s_v_RL_view, __pyx_n_s_v_WM_view, __pyx_n_s_a_view, __pyx_n_s_z_view, __pyx_n_s_t_WM_view, __pyx_n_s_deadline_view, __pyx_n_s_zs, __pyx_n_s_x_t_RL, __pyx_n_s_x_t_WM, __pyx_n_s_vs_RL, __pyx_n_s_vs_WM, __pyx_n_s_rts, __pyx_n_s_rts_view, __pyx_n_s_choices, __pyx_n_s_choices_view, __pyx_n_s_n, __pyx_n_s_k, __pyx_n_s_i, __pyx_n_s_x_t, __pyx_n_s_v_dict);<span class='error_goto'> if (unlikely(!__pyx_tuple__61)) __PYX_ERR(0, 3462, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__61);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__61);
/* … */
  __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 3462, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 3462, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_11, 1, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3462, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_11, 2, __pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 3462, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_11, 3, __pyx_t_10)) <span class='error_goto'>__PYX_ERR(0, 3462, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_11, 4, __pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 3462, __pyx_L1_error)</span>;
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_9 = 0;
  __pyx_t_10 = 0;
  __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_4cssm_39rlwm_lba_pw_v1, 0, __pyx_n_s_rlwm_lba_pw_v1, NULL, __pyx_n_s_cssm, __pyx_d, ((PyObject *)__pyx_codeobj__62));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 3462, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_7, __pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_rlwm_lba_pw_v1, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3462, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_codeobj__62 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(12, 0, 0, 33, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__61, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_rlwm_lba_pw_v1, 3462, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__62)) __PYX_ERR(0, 3462, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">3463</span>:         np.ndarray[float, ndim = 2] v_WM,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3464</span>:         np.ndarray[float, ndim = 2] a,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3465</span>:         np.ndarray[float, ndim = 2] z,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3466</span>:         np.ndarray[float, ndim = 2] t_WM,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3467</span>:         np.ndarray[float, ndim = 1] deadline,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3468</span>:         float sd, # std dev</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3469</span>:         float ndt = 0, # ndt is supposed to be 0 by default because of parameter identifiability issues</pre>
<pre class='cython code score-5 '>  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)0.0));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3469, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3470</span>:         int nact = 3,</pre>
<pre class='cython code score-2 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)3));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3470, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3471</span>:         int n_samples = 2000,</pre>
<pre class='cython code score-2 '>  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)0x7D0));<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3471, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3472</span>:         int n_trials = 1,</pre>
<pre class='cython code score-2 '>  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)1));<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3472, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3473</span>:         float max_t = 20,</pre>
<pre class='cython code score-5 '>  __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)20.0));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 3473, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
</pre><pre class="cython line score-0">&#xA0;<span class="">3474</span>:         **kwargs</pre>
<pre class="cython line score-0">&#xA0;<span class="">3475</span>:         ):</pre>
<pre class="cython line score-0">&#xA0;<span class="">3476</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3477</span>:     # Param views</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3478</span>:     cdef float[:, :] v_RL_view = v_RL</pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(((PyObject *)__pyx_v_v_RL), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 3478, __pyx_L1_error)</span>
  __pyx_v_v_RL_view = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3479</span>:     cdef float[:, :] v_WM_view = v_WM</pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(((PyObject *)__pyx_v_v_WM), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 3479, __pyx_L1_error)</span>
  __pyx_v_v_WM_view = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3480</span>:     cdef float[:, :] a_view = a</pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(((PyObject *)__pyx_v_a), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 3480, __pyx_L1_error)</span>
  __pyx_v_a_view = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3481</span>:     cdef float[:, :] z_view = z</pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(((PyObject *)__pyx_v_z), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 3481, __pyx_L1_error)</span>
  __pyx_v_z_view = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3482</span>:     cdef float[:, :] t_WM_view = t_WM</pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(((PyObject *)__pyx_v_t_WM), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 3482, __pyx_L1_error)</span>
  __pyx_v_t_WM_view = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">3483</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3484</span>:     cdef float[:] deadline_view = deadline</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_deadline), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 3484, __pyx_L1_error)</span>
  __pyx_v_deadline_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">3485</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3486</span>:     cdef np.ndarray[float, ndim = 1] zs</pre>
<pre class="cython line score-0">&#xA0;<span class="">3487</span>:     cdef np.ndarray[double, ndim = 2] x_t_RL</pre>
<pre class="cython line score-0">&#xA0;<span class="">3488</span>:     cdef np.ndarray[double, ndim = 2] x_t_WM</pre>
<pre class="cython line score-0">&#xA0;<span class="">3489</span>:     cdef np.ndarray[double, ndim = 1] vs_RL</pre>
<pre class="cython line score-0">&#xA0;<span class="">3490</span>:     cdef np.ndarray[double, ndim = 1] vs_WM</pre>
<pre class="cython line score-0">&#xA0;<span class="">3491</span>: </pre>
<pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3492</span>:     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)</pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3492, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3492, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3492, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3492, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3492, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 3492, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3492, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 3492, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3492, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 3492, __pyx_L1_error)</span>;
  __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3492, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3492, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3492, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_5, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3492, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_rts = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3493</span>:     cdef float[:, :, :] rts_view = rts</pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_rts, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 3493, __pyx_L1_error)</span>
  __pyx_v_rts_view = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">3494</span>: </pre>
<pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3495</span>:     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)</pre>
<pre class='cython code score-46 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3495, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3495, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3495, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3495, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3495, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 3495, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3495, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 3495, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3495, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 3495, __pyx_L1_error)</span>;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3495, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3495, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_intc);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3495, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3495, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_5, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3495, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_choices = __pyx_t_8;
  __pyx_t_8 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3496</span>:     cdef int[:, :, :] choices_view = choices</pre>
<pre class='cython code score-2 '>  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_int</span>(__pyx_v_choices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 3496, __pyx_L1_error)</span>
  __pyx_v_choices_view = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">3497</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3498</span>:     cdef Py_ssize_t n, k, i</pre>
<pre class="cython line score-0">&#xA0;<span class="">3499</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3500</span>:     for k in range(n_trials):</pre>
<pre class='cython code score-0 '>  __pyx_t_10 = __pyx_v_n_trials;
  __pyx_t_11 = __pyx_t_10;
  for (__pyx_t_12 = 0; __pyx_t_12 &lt; __pyx_t_11; __pyx_t_12+=1) {
    __pyx_v_k = __pyx_t_12;
</pre><pre class="cython line score-0">&#xA0;<span class="">3501</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3502</span>:         for n in range(n_samples):</pre>
<pre class='cython code score-0 '>    __pyx_t_13 = __pyx_v_n_samples;
    __pyx_t_14 = __pyx_t_13;
    for (__pyx_t_15 = 0; __pyx_t_15 &lt; __pyx_t_14; __pyx_t_15+=1) {
      __pyx_v_n = __pyx_t_15;
</pre><pre class="cython line score-67" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3503</span>:             zs = np.random.uniform(0, z_view[k], nact).astype(DTYPE)</pre>
<pre class='cython code score-67 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3503, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3503, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_uniform);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3503, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_2.data = __pyx_v_z_view.data;
      __pyx_t_2.memview = __pyx_v_z_view.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 1);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_k;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_z_view.strides[0];
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_2.shape[0] = __pyx_v_z_view.shape[1];
__pyx_t_2.strides[0] = __pyx_v_z_view.strides[1];
    __pyx_t_2.suboffsets[0] = -1;

__pyx_t_6 = __pyx_memoryview_fromslice(__pyx_t_2, 1, (PyObject *(*)(char *)) __pyx_memview_get_float, (int (*)(char *, PyObject *)) __pyx_memview_set_float, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3503, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_2, 1);
      __pyx_t_2.memview = NULL; __pyx_t_2.data = NULL;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nact);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3503, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_16 = NULL;
      __pyx_t_17 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
        __pyx_t_16 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
        if (likely(__pyx_t_16)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_16);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
          __pyx_t_17 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[4] = {__pyx_t_16, __pyx_int_0, __pyx_t_6, __pyx_t_3};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_17, 3+__pyx_t_17);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 3503, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      }
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3503, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3503, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_3 = NULL;
      __pyx_t_17 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
        __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
        if (likely(__pyx_t_3)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
          __pyx_t_17 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_4};
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_17, 1+__pyx_t_17);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 3503, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      }
      if (!(likely(((__pyx_t_8) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_8, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 3503, __pyx_L1_error)</span>
      __pyx_t_18 = ((PyArrayObject *)__pyx_t_8);
      {
        __Pyx_BufFmt_StackElem __pyx_stack[1];
        <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zs.rcbuffer-&gt;pybuffer);
        __pyx_t_17 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_zs.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_18, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
        if (unlikely(__pyx_t_17 &lt; 0)) {
          <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_19, &amp;__pyx_t_20, &amp;__pyx_t_21);
          if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_zs.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_zs, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
            Py_XDECREF(__pyx_t_19); Py_XDECREF(__pyx_t_20); Py_XDECREF(__pyx_t_21);
            <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
          } else {
            <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_19, __pyx_t_20, __pyx_t_21);
          }
          __pyx_t_19 = __pyx_t_20 = __pyx_t_21 = 0;
        }
        __pyx_pybuffernd_zs.diminfo[0].strides = __pyx_pybuffernd_zs.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_zs.diminfo[0].shape = __pyx_pybuffernd_zs.rcbuffer-&gt;pybuffer.shape[0];
        if (unlikely((__pyx_t_17 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3503, __pyx_L1_error)</span>
      }
      __pyx_t_18 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_zs, ((PyArrayObject *)__pyx_t_8));
      __pyx_t_8 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3504</span>: </pre>
<pre class="cython line score-70" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3505</span>:             vs_RL = np.abs(np.random.normal(v_RL_view[k], sd)) # np.abs() to avoid negative vs</pre>
<pre class='cython code score-70 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3505, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_abs);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3505, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3505, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3505, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_normal);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3505, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_2.data = __pyx_v_v_RL_view.data;
      __pyx_t_2.memview = __pyx_v_v_RL_view.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 1);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_k;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_v_RL_view.strides[0];
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_2.shape[0] = __pyx_v_v_RL_view.shape[1];
__pyx_t_2.strides[0] = __pyx_v_v_RL_view.strides[1];
    __pyx_t_2.suboffsets[0] = -1;

__pyx_t_6 = __pyx_memoryview_fromslice(__pyx_t_2, 1, (PyObject *(*)(char *)) __pyx_memview_get_float, (int (*)(char *, PyObject *)) __pyx_memview_set_float, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3505, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_2, 1);
      __pyx_t_2.memview = NULL; __pyx_t_2.data = NULL;
      __pyx_t_16 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_sd);<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 3505, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
      __pyx_t_22 = NULL;
      __pyx_t_17 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_22 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_22)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_22);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          __pyx_t_17 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_22, __pyx_t_6, __pyx_t_16};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_17, 2+__pyx_t_17);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
        if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3505, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      }
      __pyx_t_3 = NULL;
      __pyx_t_17 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
        __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
        if (likely(__pyx_t_3)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
          __pyx_t_17 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_5};
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_17, 1+__pyx_t_17);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 3505, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      }
      if (!(likely(((__pyx_t_8) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_8, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 3505, __pyx_L1_error)</span>
      __pyx_t_23 = ((PyArrayObject *)__pyx_t_8);
      {
        __Pyx_BufFmt_StackElem __pyx_stack[1];
        <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vs_RL.rcbuffer-&gt;pybuffer);
        __pyx_t_17 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vs_RL.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_23, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
        if (unlikely(__pyx_t_17 &lt; 0)) {
          <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_21, &amp;__pyx_t_20, &amp;__pyx_t_19);
          if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vs_RL.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_vs_RL, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
            Py_XDECREF(__pyx_t_21); Py_XDECREF(__pyx_t_20); Py_XDECREF(__pyx_t_19);
            <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
          } else {
            <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_21, __pyx_t_20, __pyx_t_19);
          }
          __pyx_t_21 = __pyx_t_20 = __pyx_t_19 = 0;
        }
        __pyx_pybuffernd_vs_RL.diminfo[0].strides = __pyx_pybuffernd_vs_RL.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_vs_RL.diminfo[0].shape = __pyx_pybuffernd_vs_RL.rcbuffer-&gt;pybuffer.shape[0];
        if (unlikely((__pyx_t_17 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3505, __pyx_L1_error)</span>
      }
      __pyx_t_23 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_vs_RL, ((PyArrayObject *)__pyx_t_8));
      __pyx_t_8 = 0;
</pre><pre class="cython line score-70" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3506</span>:             vs_WM = np.abs(np.random.normal(v_WM_view[k], sd)) # np.abs() to avoid negative vs</pre>
<pre class='cython code score-70 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3506, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_abs);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3506, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3506, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 3506, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_16, __pyx_n_s_normal);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3506, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
      __pyx_t_2.data = __pyx_v_v_WM_view.data;
      __pyx_t_2.memview = __pyx_v_v_WM_view.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 1);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_k;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_v_WM_view.strides[0];
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_2.shape[0] = __pyx_v_v_WM_view.shape[1];
__pyx_t_2.strides[0] = __pyx_v_v_WM_view.strides[1];
    __pyx_t_2.suboffsets[0] = -1;

__pyx_t_16 = __pyx_memoryview_fromslice(__pyx_t_2, 1, (PyObject *(*)(char *)) __pyx_memview_get_float, (int (*)(char *, PyObject *)) __pyx_memview_set_float, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 3506, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
      __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_2, 1);
      __pyx_t_2.memview = NULL; __pyx_t_2.data = NULL;
      __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_sd);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3506, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_22 = NULL;
      __pyx_t_17 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_22 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_22)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_22);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          __pyx_t_17 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_22, __pyx_t_16, __pyx_t_6};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_17, 2+__pyx_t_17);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 3506, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      }
      __pyx_t_3 = NULL;
      __pyx_t_17 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
        __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
        if (likely(__pyx_t_3)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
          __pyx_t_17 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_4};
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_17, 1+__pyx_t_17);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 3506, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      }
      if (!(likely(((__pyx_t_8) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_8, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 3506, __pyx_L1_error)</span>
      __pyx_t_24 = ((PyArrayObject *)__pyx_t_8);
      {
        __Pyx_BufFmt_StackElem __pyx_stack[1];
        <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vs_WM.rcbuffer-&gt;pybuffer);
        __pyx_t_17 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vs_WM.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_24, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
        if (unlikely(__pyx_t_17 &lt; 0)) {
          <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_19, &amp;__pyx_t_20, &amp;__pyx_t_21);
          if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vs_WM.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_vs_WM, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
            Py_XDECREF(__pyx_t_19); Py_XDECREF(__pyx_t_20); Py_XDECREF(__pyx_t_21);
            <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
          } else {
            <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_19, __pyx_t_20, __pyx_t_21);
          }
          __pyx_t_19 = __pyx_t_20 = __pyx_t_21 = 0;
        }
        __pyx_pybuffernd_vs_WM.diminfo[0].strides = __pyx_pybuffernd_vs_WM.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_vs_WM.diminfo[0].shape = __pyx_pybuffernd_vs_WM.rcbuffer-&gt;pybuffer.shape[0];
        if (unlikely((__pyx_t_17 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3506, __pyx_L1_error)</span>
      }
      __pyx_t_24 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_vs_WM, ((PyArrayObject *)__pyx_t_8));
      __pyx_t_8 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3507</span>: </pre>
<pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3508</span>:             x_t_RL = ([a_view[k]]*nact - zs)/vs_RL</pre>
<pre class='cython code score-39 '>      __pyx_t_2.data = __pyx_v_a_view.data;
      __pyx_t_2.memview = __pyx_v_a_view.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 1);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_k;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_a_view.strides[0];
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_2.shape[0] = __pyx_v_a_view.shape[1];
__pyx_t_2.strides[0] = __pyx_v_a_view.strides[1];
    __pyx_t_2.suboffsets[0] = -1;

__pyx_t_8 = __pyx_memoryview_fromslice(__pyx_t_2, 1, (PyObject *(*)(char *)) __pyx_memview_get_float, (int (*)(char *, PyObject *)) __pyx_memview_set_float, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3508, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_2, 1);
      __pyx_t_2.memview = NULL; __pyx_t_2.data = NULL;
      __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(1 * ((__pyx_v_nact&lt;0) ? 0:__pyx_v_nact));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3508, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      { Py_ssize_t __pyx_temp;
        for (__pyx_temp=0; __pyx_temp &lt; __pyx_v_nact; __pyx_temp++) {
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
          if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_5, __pyx_temp, __pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 3508, __pyx_L1_error)</span>;
        }
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_5, ((PyObject *)__pyx_v_zs));<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3508, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_8, ((PyObject *)__pyx_v_vs_RL));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3508, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 3508, __pyx_L1_error)</span>
      __pyx_t_25 = ((PyArrayObject *)__pyx_t_5);
      {
        __Pyx_BufFmt_StackElem __pyx_stack[1];
        <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_x_t_RL.rcbuffer-&gt;pybuffer);
        __pyx_t_17 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_x_t_RL.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_25, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
        if (unlikely(__pyx_t_17 &lt; 0)) {
          <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_21, &amp;__pyx_t_20, &amp;__pyx_t_19);
          if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_x_t_RL.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_x_t_RL, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
            Py_XDECREF(__pyx_t_21); Py_XDECREF(__pyx_t_20); Py_XDECREF(__pyx_t_19);
            <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
          } else {
            <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_21, __pyx_t_20, __pyx_t_19);
          }
          __pyx_t_21 = __pyx_t_20 = __pyx_t_19 = 0;
        }
        __pyx_pybuffernd_x_t_RL.diminfo[0].strides = __pyx_pybuffernd_x_t_RL.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_x_t_RL.diminfo[0].shape = __pyx_pybuffernd_x_t_RL.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_x_t_RL.diminfo[1].strides = __pyx_pybuffernd_x_t_RL.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_x_t_RL.diminfo[1].shape = __pyx_pybuffernd_x_t_RL.rcbuffer-&gt;pybuffer.shape[1];
        if (unlikely((__pyx_t_17 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3508, __pyx_L1_error)</span>
      }
      __pyx_t_25 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_x_t_RL, ((PyArrayObject *)__pyx_t_5));
      __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3509</span>:             # x_t_WM = ([a_view[k]]*nact - zs)/vs_WM</pre>
<pre class="cython line score-0">&#xA0;<span class="">3510</span>: </pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3511</span>:             if np.min(x_t_RL) &lt; t_WM_view[k]:</pre>
<pre class='cython code score-29 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3511, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_min);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3511, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = NULL;
      __pyx_t_17 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
        __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
        if (likely(__pyx_t_8)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
          __pyx_t_17 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_8, ((PyObject *)__pyx_v_x_t_RL)};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_17, 1+__pyx_t_17);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3511, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      }
      __pyx_t_2.data = __pyx_v_t_WM_view.data;
      __pyx_t_2.memview = __pyx_v_t_WM_view.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 1);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_k;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_t_WM_view.strides[0];
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_2.shape[0] = __pyx_v_t_WM_view.shape[1];
__pyx_t_2.strides[0] = __pyx_v_t_WM_view.strides[1];
    __pyx_t_2.suboffsets[0] = -1;

__pyx_t_4 = __pyx_memoryview_fromslice(__pyx_t_2, 1, (PyObject *(*)(char *)) __pyx_memview_get_float, (int (*)(char *, PyObject *)) __pyx_memview_set_float, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3511, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_2, 1);
      __pyx_t_2.memview = NULL; __pyx_t_2.data = NULL;
      __pyx_t_8 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_5, __pyx_t_4, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3511, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_26 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_8); if (unlikely((__pyx_t_26 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3511, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      if (__pyx_t_26) {
/* … */
        goto __pyx_L7;
      }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3512</span>:                 x_t = x_t_RL</pre>
<pre class='cython code score-2 '>        <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_v_x_t_RL);
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_x_t, ((PyObject *)__pyx_v_x_t_RL));
</pre><pre class="cython line score-0">&#xA0;<span class="">3513</span>:             else:</pre>
<pre class="cython line score-54" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3514</span>:                 x_t = t_WM_view[k] + ( [a_view[k]]*nact - zs - ([t_WM_view[k]]*nact)*vs_RL ) / ( vs_RL + vs_WM )</pre>
<pre class='cython code score-54 '>      /*else*/ {
        __pyx_t_2.data = __pyx_v_t_WM_view.data;
        __pyx_t_2.memview = __pyx_v_t_WM_view.memview;
        __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 1);
        {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_k;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_t_WM_view.strides[0];
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_2.shape[0] = __pyx_v_t_WM_view.shape[1];
__pyx_t_2.strides[0] = __pyx_v_t_WM_view.strides[1];
    __pyx_t_2.suboffsets[0] = -1;

__pyx_t_8 = __pyx_memoryview_fromslice(__pyx_t_2, 1, (PyObject *(*)(char *)) __pyx_memview_get_float, (int (*)(char *, PyObject *)) __pyx_memview_set_float, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3514, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_2, 1);
        __pyx_t_2.memview = NULL; __pyx_t_2.data = NULL;
        __pyx_t_2.data = __pyx_v_a_view.data;
        __pyx_t_2.memview = __pyx_v_a_view.memview;
        __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 1);
        {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_k;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_a_view.strides[0];
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_2.shape[0] = __pyx_v_a_view.shape[1];
__pyx_t_2.strides[0] = __pyx_v_a_view.strides[1];
    __pyx_t_2.suboffsets[0] = -1;

__pyx_t_4 = __pyx_memoryview_fromslice(__pyx_t_2, 1, (PyObject *(*)(char *)) __pyx_memview_get_float, (int (*)(char *, PyObject *)) __pyx_memview_set_float, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3514, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_2, 1);
        __pyx_t_2.memview = NULL; __pyx_t_2.data = NULL;
        __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(1 * ((__pyx_v_nact&lt;0) ? 0:__pyx_v_nact));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3514, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        { Py_ssize_t __pyx_temp;
          for (__pyx_temp=0; __pyx_temp &lt; __pyx_v_nact; __pyx_temp++) {
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
            if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_5, __pyx_temp, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 3514, __pyx_L1_error)</span>;
          }
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_5, ((PyObject *)__pyx_v_zs));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3514, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_2.data = __pyx_v_t_WM_view.data;
        __pyx_t_2.memview = __pyx_v_t_WM_view.memview;
        __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 1);
        {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_k;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_t_WM_view.strides[0];
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_2.shape[0] = __pyx_v_t_WM_view.shape[1];
__pyx_t_2.strides[0] = __pyx_v_t_WM_view.strides[1];
    __pyx_t_2.suboffsets[0] = -1;

__pyx_t_5 = __pyx_memoryview_fromslice(__pyx_t_2, 1, (PyObject *(*)(char *)) __pyx_memview_get_float, (int (*)(char *, PyObject *)) __pyx_memview_set_float, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3514, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_2, 1);
        __pyx_t_2.memview = NULL; __pyx_t_2.data = NULL;
        __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(1 * ((__pyx_v_nact&lt;0) ? 0:__pyx_v_nact));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3514, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        { Py_ssize_t __pyx_temp;
          for (__pyx_temp=0; __pyx_temp &lt; __pyx_v_nact; __pyx_temp++) {
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
            if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, __pyx_temp, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3514, __pyx_L1_error)</span>;
          }
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, ((PyObject *)__pyx_v_vs_RL));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3514, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3514, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(((PyObject *)__pyx_v_vs_RL), ((PyObject *)__pyx_v_vs_WM));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3514, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3514, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_8, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3514, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_x_t, __pyx_t_5);
        __pyx_t_5 = 0;
      }
      __pyx_L7:;
</pre><pre class="cython line score-0">&#xA0;<span class="">3515</span>: </pre>
<pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3516</span>:             choices_view[n, k, 0] = np.argmin(x_t) # store choices for sample n</pre>
<pre class='cython code score-27 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3516, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_argmin);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3516, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = NULL;
      __pyx_t_17 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
          __pyx_t_17 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_x_t};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+1-__pyx_t_17, 1+__pyx_t_17);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3516, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      }
      __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_5); if (unlikely((__pyx_t_17 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3516, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_27 = __pyx_v_n;
      __pyx_t_28 = __pyx_v_k;
      __pyx_t_29 = 0;
      *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_27 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_28 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_29 * __pyx_v_choices_view.strides[2]) )) = __pyx_t_17;
</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3517</span>:             rts_view[n, k, 0] = np.min(x_t) + ndt # store reaction time for sample n</pre>
<pre class='cython code score-42 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3517, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_min);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3517, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = NULL;
      __pyx_t_17 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
        __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
        if (likely(__pyx_t_8)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
          __pyx_t_17 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_8, __pyx_v_x_t};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_17, 1+__pyx_t_17);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3517, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      }
      __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_ndt);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3517, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_8 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_5, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3517, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_30 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_8); if (unlikely((__pyx_t_30 == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3517, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_29 = __pyx_v_n;
      __pyx_t_28 = __pyx_v_k;
      __pyx_t_27 = 0;
      *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_29 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_28 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_27 * __pyx_v_rts_view.strides[2]) )) = __pyx_t_30;
</pre><pre class="cython line score-0">&#xA0;<span class="">3518</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3519</span>:             # If the rt exceeds the deadline, set rt to -999</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3520</span>:             if rts_view[n, k, 0] &gt;= deadline_view[k]:</pre>
<pre class='cython code score-0 '>      __pyx_t_27 = __pyx_v_n;
      __pyx_t_28 = __pyx_v_k;
      __pyx_t_29 = 0;
      __pyx_t_31 = __pyx_v_k;
      __pyx_t_26 = ((*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_27 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_28 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_29 * __pyx_v_rts_view.strides[2]) ))) &gt;= (*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_31 * __pyx_v_deadline_view.strides[0]) ))));
      if (__pyx_t_26) {
/* … */
      }
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3521</span>:                 rts_view[n, k, 0] = -999</pre>
<pre class='cython code score-0 '>        __pyx_t_31 = __pyx_v_n;
        __pyx_t_29 = __pyx_v_k;
        __pyx_t_28 = 0;
        *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_31 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_29 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_28 * __pyx_v_rts_view.strides[2]) )) = -999.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3522</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3523</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3524</span>:     v_dict = {}</pre>
<pre class='cython code score-2 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3524, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_v_v_dict = ((PyObject*)__pyx_t_8);
  __pyx_t_8 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3525</span>:     for i in range(nact):</pre>
<pre class='cython code score-0 '>  __pyx_t_10 = __pyx_v_nact;
  __pyx_t_11 = __pyx_t_10;
  for (__pyx_t_12 = 0; __pyx_t_12 &lt; __pyx_t_11; __pyx_t_12+=1) {
    __pyx_v_i = __pyx_t_12;
</pre><pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3526</span>:         v_dict['v_RL_' + str(i)] = v_RL[:, i]</pre>
<pre class='cython code score-39 '>    __pyx_t_8 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3526, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3526, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__5);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_slice__5)) <span class='error_goto'>__PYX_ERR(0, 3526, __pyx_L1_error)</span>;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 3526, __pyx_L1_error)</span>;
    __pyx_t_8 = 0;
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_v_RL), __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3526, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3526, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Str</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3526, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_n_u_v_RL_2, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3526, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely((<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_v_dict, __pyx_t_4, __pyx_t_8) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3526, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3527</span>:         v_dict['v_WM_' + str(i)] = v_WM[:, i]</pre>
<pre class='cython code score-39 '>    __pyx_t_8 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3527, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3527, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__5);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_slice__5)) <span class='error_goto'>__PYX_ERR(0, 3527, __pyx_L1_error)</span>;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 3527, __pyx_L1_error)</span>;
    __pyx_t_8 = 0;
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_v_WM), __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3527, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3527, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Str</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3527, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_n_u_v_WM_2, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3527, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely((<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_v_dict, __pyx_t_4, __pyx_t_8) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3527, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">3528</span>: </pre>
<pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3529</span>:     return {'rts': rts, 'choices': choices, 'metadata': {**v_dict,</pre>
<pre class='cython code score-18 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3529, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3529, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3529, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='py_c_api'>PyDict_Copy</span>(__pyx_v_v_dict);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3529, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3530</span>:                                                          'a': a,</pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3530, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3531</span>:                                                          'z': z,</pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_z, ((PyObject *)__pyx_v_z)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3531, __pyx_L1_error)</span>
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3532</span>:                                                          't_WM': t_WM,</pre>
<pre class='cython code score-10 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_t_WM, ((PyObject *)__pyx_v_t_WM)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3532, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_t, __pyx_int_0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3533, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">3533</span>:                                                          't': 0,</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3534</span>:                                                          'deadline': deadline,</pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_deadline, ((PyObject *)__pyx_v_deadline)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3534, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3535</span>:                                                          'sd': sd,</pre>
<pre class='cython code score-11 '>  __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_sd);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3535, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_sd, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3535, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3536</span>:                                                          'n_samples': n_samples,</pre>
<pre class='cython code score-13 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3536, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_n_samples, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3536, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_simulator, __pyx_n_u_rlwm_lba_pw_v1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3537, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">3537</span>:                                                          'simulator' : 'rlwm_lba_pw_v1',</pre>
<pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3538</span>:                                                          'possible_choices': list(np.arange(0, nact, 1)),</pre>
<pre class='cython code score-31 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3538, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3538, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nact);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3538, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_16 = NULL;
  __pyx_t_10 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_16 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_16)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_16);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      __pyx_t_10 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[4] = {__pyx_t_16, __pyx_int_0, __pyx_t_3, __pyx_int_1};
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_10, 3+__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3538, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PySequence_ListKeepNew</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3538, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_possible_choices, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3538, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3539</span>:                                                          'max_t': max_t,</pre>
<pre class='cython code score-17 '>  __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_max_t);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3539, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_max_t, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3539, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_u_metadata, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3529, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_r = __pyx_t_8;
  __pyx_t_8 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3540</span>:                                                          }}</pre>
<pre class="cython line score-0">&#xA0;<span class="">3541</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3542</span>: # Simulate (rt, choice) tuples from: RLWM LBA Race Model without ndt -----------------------------</pre>
<pre class="cython line score-345" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3543</span>: def rlwm_lba_race(np.ndarray[float, ndim = 2] v_RL, # RL drift parameters (np.array expect: one column of floats)</pre>
<pre class='cython code score-345 '>/* Python wrapper */
static PyObject *__pyx_pw_4cssm_41rlwm_lba_race(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_4cssm_41rlwm_lba_race = {"rlwm_lba_race", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_4cssm_41rlwm_lba_race, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_4cssm_41rlwm_lba_race(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyArrayObject *__pyx_v_v_RL = 0;
  PyArrayObject *__pyx_v_v_WM = 0;
  PyArrayObject *__pyx_v_a = 0;
  PyArrayObject *__pyx_v_z = 0;
  PyArrayObject *__pyx_v_deadline = 0;
  float __pyx_v_sd;
  float __pyx_v_ndt;
  int __pyx_v_nact;
  int __pyx_v_n_samples;
  int __pyx_v_n_trials;
  float __pyx_v_max_t;
  CYTHON_UNUSED PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("rlwm_lba_race (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_v_RL,&amp;__pyx_n_s_v_WM,&amp;__pyx_n_s_a,&amp;__pyx_n_s_z,&amp;__pyx_n_s_deadline,&amp;__pyx_n_s_sd,&amp;__pyx_n_s_ndt,&amp;__pyx_n_s_nact,&amp;__pyx_n_s_n_samples,&amp;__pyx_n_s_n_trials,&amp;__pyx_n_s_max_t,0};
  PyObject* values[11] = {0,0,0,0,0,0,0,0,0,0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_v_RL)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3543, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_v_WM)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3543, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("rlwm_lba_race", 0, 6, 11, 1); <span class='error_goto'>__PYX_ERR(0, 3543, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_a)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3543, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("rlwm_lba_race", 0, 6, 11, 2); <span class='error_goto'>__PYX_ERR(0, 3543, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_z)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[3]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3543, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("rlwm_lba_race", 0, 6, 11, 3); <span class='error_goto'>__PYX_ERR(0, 3543, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_deadline)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[4]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3543, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("rlwm_lba_race", 0, 6, 11, 4); <span class='error_goto'>__PYX_ERR(0, 3543, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_sd)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[5]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3543, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("rlwm_lba_race", 0, 6, 11, 5); <span class='error_goto'>__PYX_ERR(0, 3543, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_ndt);
          if (value) { values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3543, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_nact);
          if (value) { values[7] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3543, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_samples);
          if (value) { values[8] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3543, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  9:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_trials);
          if (value) { values[9] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3543, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 10:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_max_t);
          if (value) { values[10] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3543, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values + 0, kwd_pos_args, "rlwm_lba_race") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 3543, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_v_RL = ((PyArrayObject *)values[0]);
    __pyx_v_v_WM = ((PyArrayObject *)values[1]);
    __pyx_v_a = ((PyArrayObject *)values[2]);
    __pyx_v_z = ((PyArrayObject *)values[3]);
    __pyx_v_deadline = ((PyArrayObject *)values[4]);
    __pyx_v_sd = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[5]); if (unlikely((__pyx_v_sd == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3548, __pyx_L3_error)</span>
    if (values[6]) {
      __pyx_v_ndt = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[6]); if (unlikely((__pyx_v_ndt == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3549, __pyx_L3_error)</span>
    } else {
      __pyx_v_ndt = ((float)((float)0.0));
    }
    if (values[7]) {
      __pyx_v_nact = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[7]); if (unlikely((__pyx_v_nact == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3550, __pyx_L3_error)</span>
    } else {
      __pyx_v_nact = ((int)((int)3));
    }
    if (values[8]) {
      __pyx_v_n_samples = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[8]); if (unlikely((__pyx_v_n_samples == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3551, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_samples = ((int)((int)0x7D0));
    }
    if (values[9]) {
      __pyx_v_n_trials = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[9]); if (unlikely((__pyx_v_n_trials == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3552, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_trials = ((int)((int)1));
    }
    if (values[10]) {
      __pyx_v_max_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[10]); if (unlikely((__pyx_v_max_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3553, __pyx_L3_error)</span>
    } else {
      __pyx_v_max_t = ((float)((float)20.0));
    }
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("rlwm_lba_race", 0, 6, 11, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 3543, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.rlwm_lba_race", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_v_RL), __pyx_ptype_5numpy_ndarray, 1, "v_RL", 0))) <span class='error_goto'>__PYX_ERR(0, 3543, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_v_WM), __pyx_ptype_5numpy_ndarray, 1, "v_WM", 0))) <span class='error_goto'>__PYX_ERR(0, 3544, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) <span class='error_goto'>__PYX_ERR(0, 3545, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_z), __pyx_ptype_5numpy_ndarray, 1, "z", 0))) <span class='error_goto'>__PYX_ERR(0, 3546, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_deadline), __pyx_ptype_5numpy_ndarray, 1, "deadline", 0))) <span class='error_goto'>__PYX_ERR(0, 3547, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_4cssm_40rlwm_lba_race(__pyx_self, __pyx_v_v_RL, __pyx_v_v_WM, __pyx_v_a, __pyx_v_z, __pyx_v_deadline, __pyx_v_sd, __pyx_v_ndt, __pyx_v_nact, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_max_t, __pyx_v_kwargs);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs);
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4cssm_40rlwm_lba_race(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_v_RL, PyArrayObject *__pyx_v_v_WM, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_z, PyArrayObject *__pyx_v_deadline, float __pyx_v_sd, float __pyx_v_ndt, int __pyx_v_nact, int __pyx_v_n_samples, int __pyx_v_n_trials, float __pyx_v_max_t, CYTHON_UNUSED PyObject *__pyx_v_kwargs) {
  __Pyx_memviewslice __pyx_v_v_RL_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_v_WM_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_a_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_z_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_deadline_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyArrayObject *__pyx_v_zs = 0;
  PyArrayObject *__pyx_v_x_t_RL = 0;
  PyArrayObject *__pyx_v_x_t_WM = 0;
  PyArrayObject *__pyx_v_vs_RL = 0;
  PyArrayObject *__pyx_v_vs_WM = 0;
  PyObject *__pyx_v_rts = NULL;
  __Pyx_memviewslice __pyx_v_rts_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_choices = NULL;
  __Pyx_memviewslice __pyx_v_choices_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  Py_ssize_t __pyx_v_n;
  Py_ssize_t __pyx_v_k;
  Py_ssize_t __pyx_v_i;
  PyObject *__pyx_v_v_dict = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_a;
  __Pyx_Buffer __pyx_pybuffer_a;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_deadline;
  __Pyx_Buffer __pyx_pybuffer_deadline;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_v_RL;
  __Pyx_Buffer __pyx_pybuffer_v_RL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_v_WM;
  __Pyx_Buffer __pyx_pybuffer_v_WM;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_vs_RL;
  __Pyx_Buffer __pyx_pybuffer_vs_RL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_vs_WM;
  __Pyx_Buffer __pyx_pybuffer_vs_WM;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_x_t_RL;
  __Pyx_Buffer __pyx_pybuffer_x_t_RL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_x_t_WM;
  __Pyx_Buffer __pyx_pybuffer_x_t_WM;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_z;
  __Pyx_Buffer __pyx_pybuffer_z;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_zs;
  __Pyx_Buffer __pyx_pybuffer_zs;
  PyObject *__pyx_r = NULL;
  __pyx_pybuffer_zs.pybuffer.buf = NULL;
  __pyx_pybuffer_zs.refcount = 0;
  __pyx_pybuffernd_zs.data = NULL;
  __pyx_pybuffernd_zs.rcbuffer = &amp;__pyx_pybuffer_zs;
  __pyx_pybuffer_x_t_RL.pybuffer.buf = NULL;
  __pyx_pybuffer_x_t_RL.refcount = 0;
  __pyx_pybuffernd_x_t_RL.data = NULL;
  __pyx_pybuffernd_x_t_RL.rcbuffer = &amp;__pyx_pybuffer_x_t_RL;
  __pyx_pybuffer_x_t_WM.pybuffer.buf = NULL;
  __pyx_pybuffer_x_t_WM.refcount = 0;
  __pyx_pybuffernd_x_t_WM.data = NULL;
  __pyx_pybuffernd_x_t_WM.rcbuffer = &amp;__pyx_pybuffer_x_t_WM;
  __pyx_pybuffer_vs_RL.pybuffer.buf = NULL;
  __pyx_pybuffer_vs_RL.refcount = 0;
  __pyx_pybuffernd_vs_RL.data = NULL;
  __pyx_pybuffernd_vs_RL.rcbuffer = &amp;__pyx_pybuffer_vs_RL;
  __pyx_pybuffer_vs_WM.pybuffer.buf = NULL;
  __pyx_pybuffer_vs_WM.refcount = 0;
  __pyx_pybuffernd_vs_WM.data = NULL;
  __pyx_pybuffernd_vs_WM.rcbuffer = &amp;__pyx_pybuffer_vs_WM;
  __pyx_pybuffer_v_RL.pybuffer.buf = NULL;
  __pyx_pybuffer_v_RL.refcount = 0;
  __pyx_pybuffernd_v_RL.data = NULL;
  __pyx_pybuffernd_v_RL.rcbuffer = &amp;__pyx_pybuffer_v_RL;
  __pyx_pybuffer_v_WM.pybuffer.buf = NULL;
  __pyx_pybuffer_v_WM.refcount = 0;
  __pyx_pybuffernd_v_WM.data = NULL;
  __pyx_pybuffernd_v_WM.rcbuffer = &amp;__pyx_pybuffer_v_WM;
  __pyx_pybuffer_a.pybuffer.buf = NULL;
  __pyx_pybuffer_a.refcount = 0;
  __pyx_pybuffernd_a.data = NULL;
  __pyx_pybuffernd_a.rcbuffer = &amp;__pyx_pybuffer_a;
  __pyx_pybuffer_z.pybuffer.buf = NULL;
  __pyx_pybuffer_z.refcount = 0;
  __pyx_pybuffernd_z.data = NULL;
  __pyx_pybuffernd_z.rcbuffer = &amp;__pyx_pybuffer_z;
  __pyx_pybuffer_deadline.pybuffer.buf = NULL;
  __pyx_pybuffer_deadline.refcount = 0;
  __pyx_pybuffernd_deadline.data = NULL;
  __pyx_pybuffernd_deadline.rcbuffer = &amp;__pyx_pybuffer_deadline;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_v_RL.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_v_RL, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3543, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_v_RL.diminfo[0].strides = __pyx_pybuffernd_v_RL.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_v_RL.diminfo[0].shape = __pyx_pybuffernd_v_RL.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_v_RL.diminfo[1].strides = __pyx_pybuffernd_v_RL.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_v_RL.diminfo[1].shape = __pyx_pybuffernd_v_RL.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_v_WM.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_v_WM, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3543, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_v_WM.diminfo[0].strides = __pyx_pybuffernd_v_WM.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_v_WM.diminfo[0].shape = __pyx_pybuffernd_v_WM.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_v_WM.diminfo[1].strides = __pyx_pybuffernd_v_WM.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_v_WM.diminfo[1].shape = __pyx_pybuffernd_v_WM.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_a, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3543, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_a.diminfo[1].strides = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_a.diminfo[1].shape = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_z, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3543, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_z.diminfo[0].strides = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_z.diminfo[0].shape = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_z.diminfo[1].strides = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_z.diminfo[1].shape = __pyx_pybuffernd_z.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_deadline, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3543, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_deadline.diminfo[0].strides = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_deadline.diminfo[0].shape = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.shape[0];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_1, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_2, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_7, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_9, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_22);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_v_RL.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_v_WM.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vs_RL.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vs_WM.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_x_t_RL.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_x_t_WM.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zs.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.rlwm_lba_race", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_v_RL.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_v_WM.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vs_RL.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vs_WM.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_x_t_RL.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_x_t_WM.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_z.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zs.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_v_RL_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_v_WM_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_a_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_z_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_deadline_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_zs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_x_t_RL);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_x_t_WM);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_vs_RL);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_vs_WM);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rts);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_rts_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_choices);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_choices_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_v_dict);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__63 = <span class='py_c_api'>PyTuple_Pack</span>(30, __pyx_n_s_v_RL, __pyx_n_s_v_WM, __pyx_n_s_a, __pyx_n_s_z, __pyx_n_s_deadline, __pyx_n_s_sd, __pyx_n_s_ndt, __pyx_n_s_nact, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_max_t, __pyx_n_s_kwargs, __pyx_n_s_v_RL_view, __pyx_n_s_v_WM_view, __pyx_n_s_a_view, __pyx_n_s_z_view, __pyx_n_s_deadline_view, __pyx_n_s_zs, __pyx_n_s_x_t_RL, __pyx_n_s_x_t_WM, __pyx_n_s_vs_RL, __pyx_n_s_vs_WM, __pyx_n_s_rts, __pyx_n_s_rts_view, __pyx_n_s_choices, __pyx_n_s_choices_view, __pyx_n_s_n, __pyx_n_s_k, __pyx_n_s_i, __pyx_n_s_v_dict);<span class='error_goto'> if (unlikely(!__pyx_tuple__63)) __PYX_ERR(0, 3543, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__63);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__63);
/* … */
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3543, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 3543, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_11)) <span class='error_goto'>__PYX_ERR(0, 3543, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_t_10)) <span class='error_goto'>__PYX_ERR(0, 3543, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 3, __pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 3543, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 4, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3543, __pyx_L1_error)</span>;
  __pyx_t_7 = 0;
  __pyx_t_11 = 0;
  __pyx_t_10 = 0;
  __pyx_t_9 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_4cssm_41rlwm_lba_race, 0, __pyx_n_s_rlwm_lba_race, NULL, __pyx_n_s_cssm, __pyx_d, ((PyObject *)__pyx_codeobj__64));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3543, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_5, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_rlwm_lba_race, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3543, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_codeobj__64 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(11, 0, 0, 30, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__63, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_rlwm_lba_race, 3543, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__64)) __PYX_ERR(0, 3543, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">3544</span>:         np.ndarray[float, ndim = 2] v_WM, # WM drift parameters (np.array expect: one column of floats)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3545</span>:         np.ndarray[float, ndim = 2] a, # criterion height</pre>
<pre class="cython line score-0">&#xA0;<span class="">3546</span>:         np.ndarray[float, ndim = 2] z, # initial bias parameters (np.array expect: one column of floats)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3547</span>:         np.ndarray[float, ndim = 1] deadline,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3548</span>:         float sd, # std dev of Normal from where we sample vs</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3549</span>:         float ndt = 0, # ndt is supposed to be 0 by default because of parameter identifiability issues</pre>
<pre class='cython code score-5 '>  __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)0.0));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 3549, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3550</span>:         int nact = 3,</pre>
<pre class='cython code score-2 '>  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)3));<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 3550, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3551</span>:         int n_samples = 2000,</pre>
<pre class='cython code score-2 '>  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)0x7D0));<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3551, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3552</span>:         int n_trials = 1,</pre>
<pre class='cython code score-2 '>  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)1));<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3552, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3553</span>:         float max_t = 20,</pre>
<pre class='cython code score-5 '>  __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)20.0));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3553, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
</pre><pre class="cython line score-0">&#xA0;<span class="">3554</span>:         **kwargs</pre>
<pre class="cython line score-0">&#xA0;<span class="">3555</span>:         ):</pre>
<pre class="cython line score-0">&#xA0;<span class="">3556</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3557</span>:     # v_t = np.random.normal(v, sd)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3558</span>:     # print(len(z), nact, np.array([z]*nact).transpose().shape)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3559</span>:     # z_t = np.random.uniform(np.zeros((len(z), nact)), np.array([z]*nact).transpose(), (len(z), nact))</pre>
<pre class="cython line score-0">&#xA0;<span class="">3560</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3561</span>:     # Param views</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3562</span>:     cdef float[:, :] v_RL_view = v_RL</pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(((PyObject *)__pyx_v_v_RL), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 3562, __pyx_L1_error)</span>
  __pyx_v_v_RL_view = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3563</span>:     cdef float[:, :] v_WM_view = v_WM</pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(((PyObject *)__pyx_v_v_WM), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 3563, __pyx_L1_error)</span>
  __pyx_v_v_WM_view = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3564</span>:     cdef float[:, :] a_view = a</pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(((PyObject *)__pyx_v_a), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 3564, __pyx_L1_error)</span>
  __pyx_v_a_view = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3565</span>:     cdef float[:, :] z_view = z</pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(((PyObject *)__pyx_v_z), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 3565, __pyx_L1_error)</span>
  __pyx_v_z_view = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">3566</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3567</span>:     cdef float[:] deadline_view = deadline</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_deadline), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 3567, __pyx_L1_error)</span>
  __pyx_v_deadline_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">3568</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3569</span>:     cdef np.ndarray[float, ndim = 1] zs</pre>
<pre class="cython line score-0">&#xA0;<span class="">3570</span>:     cdef np.ndarray[double, ndim = 2] x_t_RL</pre>
<pre class="cython line score-0">&#xA0;<span class="">3571</span>:     cdef np.ndarray[double, ndim = 2] x_t_WM</pre>
<pre class="cython line score-0">&#xA0;<span class="">3572</span>:     cdef np.ndarray[double, ndim = 1] vs_RL</pre>
<pre class="cython line score-0">&#xA0;<span class="">3573</span>:     cdef np.ndarray[double, ndim = 1] vs_WM</pre>
<pre class="cython line score-0">&#xA0;<span class="">3574</span>: </pre>
<pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3575</span>:     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)</pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3575, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3575, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3575, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3575, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3575, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 3575, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3575, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 3575, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3575, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 3575, __pyx_L1_error)</span>;
  __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3575, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3575, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3575, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_5, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3575, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_rts = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3576</span>:     cdef float[:, :, :] rts_view = rts</pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_rts, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 3576, __pyx_L1_error)</span>
  __pyx_v_rts_view = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">3577</span>: </pre>
<pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3578</span>:     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)</pre>
<pre class='cython code score-46 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3578, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3578, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3578, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3578, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3578, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 3578, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3578, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 3578, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3578, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 3578, __pyx_L1_error)</span>;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3578, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3578, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_intc);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3578, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3578, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_5, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3578, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_choices = __pyx_t_8;
  __pyx_t_8 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3579</span>:     cdef int[:, :, :] choices_view = choices</pre>
<pre class='cython code score-2 '>  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_int</span>(__pyx_v_choices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 3579, __pyx_L1_error)</span>
  __pyx_v_choices_view = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">3580</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3581</span>:     cdef Py_ssize_t n, k, i</pre>
<pre class="cython line score-0">&#xA0;<span class="">3582</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3583</span>:     for k in range(n_trials):</pre>
<pre class='cython code score-0 '>  __pyx_t_10 = __pyx_v_n_trials;
  __pyx_t_11 = __pyx_t_10;
  for (__pyx_t_12 = 0; __pyx_t_12 &lt; __pyx_t_11; __pyx_t_12+=1) {
    __pyx_v_k = __pyx_t_12;
</pre><pre class="cython line score-0">&#xA0;<span class="">3584</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3585</span>:         for n in range(n_samples):</pre>
<pre class='cython code score-0 '>    __pyx_t_13 = __pyx_v_n_samples;
    __pyx_t_14 = __pyx_t_13;
    for (__pyx_t_15 = 0; __pyx_t_15 &lt; __pyx_t_14; __pyx_t_15+=1) {
      __pyx_v_n = __pyx_t_15;
</pre><pre class="cython line score-67" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3586</span>:             zs = np.random.uniform(0, z_view[k], nact).astype(DTYPE)</pre>
<pre class='cython code score-67 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3586, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3586, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_uniform);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3586, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_2.data = __pyx_v_z_view.data;
      __pyx_t_2.memview = __pyx_v_z_view.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 1);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_k;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_z_view.strides[0];
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_2.shape[0] = __pyx_v_z_view.shape[1];
__pyx_t_2.strides[0] = __pyx_v_z_view.strides[1];
    __pyx_t_2.suboffsets[0] = -1;

__pyx_t_6 = __pyx_memoryview_fromslice(__pyx_t_2, 1, (PyObject *(*)(char *)) __pyx_memview_get_float, (int (*)(char *, PyObject *)) __pyx_memview_set_float, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3586, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_2, 1);
      __pyx_t_2.memview = NULL; __pyx_t_2.data = NULL;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nact);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3586, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_16 = NULL;
      __pyx_t_17 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
        __pyx_t_16 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
        if (likely(__pyx_t_16)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_16);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
          __pyx_t_17 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[4] = {__pyx_t_16, __pyx_int_0, __pyx_t_6, __pyx_t_3};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_17, 3+__pyx_t_17);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 3586, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      }
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3586, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3586, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_3 = NULL;
      __pyx_t_17 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
        __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
        if (likely(__pyx_t_3)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
          __pyx_t_17 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_4};
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_17, 1+__pyx_t_17);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 3586, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      }
      if (!(likely(((__pyx_t_8) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_8, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 3586, __pyx_L1_error)</span>
      __pyx_t_18 = ((PyArrayObject *)__pyx_t_8);
      {
        __Pyx_BufFmt_StackElem __pyx_stack[1];
        <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zs.rcbuffer-&gt;pybuffer);
        __pyx_t_17 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_zs.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_18, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
        if (unlikely(__pyx_t_17 &lt; 0)) {
          <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_19, &amp;__pyx_t_20, &amp;__pyx_t_21);
          if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_zs.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_zs, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
            Py_XDECREF(__pyx_t_19); Py_XDECREF(__pyx_t_20); Py_XDECREF(__pyx_t_21);
            <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
          } else {
            <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_19, __pyx_t_20, __pyx_t_21);
          }
          __pyx_t_19 = __pyx_t_20 = __pyx_t_21 = 0;
        }
        __pyx_pybuffernd_zs.diminfo[0].strides = __pyx_pybuffernd_zs.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_zs.diminfo[0].shape = __pyx_pybuffernd_zs.rcbuffer-&gt;pybuffer.shape[0];
        if (unlikely((__pyx_t_17 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3586, __pyx_L1_error)</span>
      }
      __pyx_t_18 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_zs, ((PyArrayObject *)__pyx_t_8));
      __pyx_t_8 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3587</span>: </pre>
<pre class="cython line score-70" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3588</span>:             vs_RL = np.abs(np.random.normal(v_RL_view[k], sd)) # np.abs() to avoid negative vs</pre>
<pre class='cython code score-70 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3588, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_abs);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3588, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3588, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3588, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_normal);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3588, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_2.data = __pyx_v_v_RL_view.data;
      __pyx_t_2.memview = __pyx_v_v_RL_view.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 1);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_k;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_v_RL_view.strides[0];
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_2.shape[0] = __pyx_v_v_RL_view.shape[1];
__pyx_t_2.strides[0] = __pyx_v_v_RL_view.strides[1];
    __pyx_t_2.suboffsets[0] = -1;

__pyx_t_6 = __pyx_memoryview_fromslice(__pyx_t_2, 1, (PyObject *(*)(char *)) __pyx_memview_get_float, (int (*)(char *, PyObject *)) __pyx_memview_set_float, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3588, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_2, 1);
      __pyx_t_2.memview = NULL; __pyx_t_2.data = NULL;
      __pyx_t_16 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_sd);<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 3588, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
      __pyx_t_22 = NULL;
      __pyx_t_17 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_22 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_22)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_22);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          __pyx_t_17 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_22, __pyx_t_6, __pyx_t_16};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_17, 2+__pyx_t_17);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
        if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3588, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      }
      __pyx_t_3 = NULL;
      __pyx_t_17 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
        __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
        if (likely(__pyx_t_3)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
          __pyx_t_17 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_5};
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_17, 1+__pyx_t_17);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 3588, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      }
      if (!(likely(((__pyx_t_8) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_8, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 3588, __pyx_L1_error)</span>
      __pyx_t_23 = ((PyArrayObject *)__pyx_t_8);
      {
        __Pyx_BufFmt_StackElem __pyx_stack[1];
        <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vs_RL.rcbuffer-&gt;pybuffer);
        __pyx_t_17 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vs_RL.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_23, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
        if (unlikely(__pyx_t_17 &lt; 0)) {
          <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_21, &amp;__pyx_t_20, &amp;__pyx_t_19);
          if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vs_RL.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_vs_RL, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
            Py_XDECREF(__pyx_t_21); Py_XDECREF(__pyx_t_20); Py_XDECREF(__pyx_t_19);
            <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
          } else {
            <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_21, __pyx_t_20, __pyx_t_19);
          }
          __pyx_t_21 = __pyx_t_20 = __pyx_t_19 = 0;
        }
        __pyx_pybuffernd_vs_RL.diminfo[0].strides = __pyx_pybuffernd_vs_RL.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_vs_RL.diminfo[0].shape = __pyx_pybuffernd_vs_RL.rcbuffer-&gt;pybuffer.shape[0];
        if (unlikely((__pyx_t_17 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3588, __pyx_L1_error)</span>
      }
      __pyx_t_23 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_vs_RL, ((PyArrayObject *)__pyx_t_8));
      __pyx_t_8 = 0;
</pre><pre class="cython line score-70" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3589</span>:             vs_WM = np.abs(np.random.normal(v_WM_view[k], sd)) # np.abs() to avoid negative vs</pre>
<pre class='cython code score-70 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3589, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_abs);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3589, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3589, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 3589, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_16, __pyx_n_s_normal);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3589, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
      __pyx_t_2.data = __pyx_v_v_WM_view.data;
      __pyx_t_2.memview = __pyx_v_v_WM_view.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 1);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_k;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_v_WM_view.strides[0];
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_2.shape[0] = __pyx_v_v_WM_view.shape[1];
__pyx_t_2.strides[0] = __pyx_v_v_WM_view.strides[1];
    __pyx_t_2.suboffsets[0] = -1;

__pyx_t_16 = __pyx_memoryview_fromslice(__pyx_t_2, 1, (PyObject *(*)(char *)) __pyx_memview_get_float, (int (*)(char *, PyObject *)) __pyx_memview_set_float, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 3589, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
      __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_2, 1);
      __pyx_t_2.memview = NULL; __pyx_t_2.data = NULL;
      __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_sd);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3589, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_22 = NULL;
      __pyx_t_17 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_22 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_22)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_22);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          __pyx_t_17 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_22, __pyx_t_16, __pyx_t_6};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_17, 2+__pyx_t_17);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 3589, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      }
      __pyx_t_3 = NULL;
      __pyx_t_17 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
        __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
        if (likely(__pyx_t_3)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
          __pyx_t_17 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_4};
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_17, 1+__pyx_t_17);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 3589, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      }
      if (!(likely(((__pyx_t_8) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_8, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 3589, __pyx_L1_error)</span>
      __pyx_t_24 = ((PyArrayObject *)__pyx_t_8);
      {
        __Pyx_BufFmt_StackElem __pyx_stack[1];
        <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vs_WM.rcbuffer-&gt;pybuffer);
        __pyx_t_17 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vs_WM.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_24, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
        if (unlikely(__pyx_t_17 &lt; 0)) {
          <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_19, &amp;__pyx_t_20, &amp;__pyx_t_21);
          if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vs_WM.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_vs_WM, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
            Py_XDECREF(__pyx_t_19); Py_XDECREF(__pyx_t_20); Py_XDECREF(__pyx_t_21);
            <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
          } else {
            <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_19, __pyx_t_20, __pyx_t_21);
          }
          __pyx_t_19 = __pyx_t_20 = __pyx_t_21 = 0;
        }
        __pyx_pybuffernd_vs_WM.diminfo[0].strides = __pyx_pybuffernd_vs_WM.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_vs_WM.diminfo[0].shape = __pyx_pybuffernd_vs_WM.rcbuffer-&gt;pybuffer.shape[0];
        if (unlikely((__pyx_t_17 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3589, __pyx_L1_error)</span>
      }
      __pyx_t_24 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_vs_WM, ((PyArrayObject *)__pyx_t_8));
      __pyx_t_8 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3590</span>: </pre>
<pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3591</span>:             x_t_RL = ([a_view[k]]*nact - zs)/vs_RL</pre>
<pre class='cython code score-39 '>      __pyx_t_2.data = __pyx_v_a_view.data;
      __pyx_t_2.memview = __pyx_v_a_view.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 1);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_k;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_a_view.strides[0];
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_2.shape[0] = __pyx_v_a_view.shape[1];
__pyx_t_2.strides[0] = __pyx_v_a_view.strides[1];
    __pyx_t_2.suboffsets[0] = -1;

__pyx_t_8 = __pyx_memoryview_fromslice(__pyx_t_2, 1, (PyObject *(*)(char *)) __pyx_memview_get_float, (int (*)(char *, PyObject *)) __pyx_memview_set_float, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3591, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_2, 1);
      __pyx_t_2.memview = NULL; __pyx_t_2.data = NULL;
      __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(1 * ((__pyx_v_nact&lt;0) ? 0:__pyx_v_nact));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3591, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      { Py_ssize_t __pyx_temp;
        for (__pyx_temp=0; __pyx_temp &lt; __pyx_v_nact; __pyx_temp++) {
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
          if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_5, __pyx_temp, __pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 3591, __pyx_L1_error)</span>;
        }
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_5, ((PyObject *)__pyx_v_zs));<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3591, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_8, ((PyObject *)__pyx_v_vs_RL));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3591, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 3591, __pyx_L1_error)</span>
      __pyx_t_25 = ((PyArrayObject *)__pyx_t_5);
      {
        __Pyx_BufFmt_StackElem __pyx_stack[1];
        <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_x_t_RL.rcbuffer-&gt;pybuffer);
        __pyx_t_17 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_x_t_RL.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_25, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
        if (unlikely(__pyx_t_17 &lt; 0)) {
          <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_21, &amp;__pyx_t_20, &amp;__pyx_t_19);
          if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_x_t_RL.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_x_t_RL, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
            Py_XDECREF(__pyx_t_21); Py_XDECREF(__pyx_t_20); Py_XDECREF(__pyx_t_19);
            <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
          } else {
            <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_21, __pyx_t_20, __pyx_t_19);
          }
          __pyx_t_21 = __pyx_t_20 = __pyx_t_19 = 0;
        }
        __pyx_pybuffernd_x_t_RL.diminfo[0].strides = __pyx_pybuffernd_x_t_RL.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_x_t_RL.diminfo[0].shape = __pyx_pybuffernd_x_t_RL.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_x_t_RL.diminfo[1].strides = __pyx_pybuffernd_x_t_RL.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_x_t_RL.diminfo[1].shape = __pyx_pybuffernd_x_t_RL.rcbuffer-&gt;pybuffer.shape[1];
        if (unlikely((__pyx_t_17 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3591, __pyx_L1_error)</span>
      }
      __pyx_t_25 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_x_t_RL, ((PyArrayObject *)__pyx_t_5));
      __pyx_t_5 = 0;
</pre><pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3592</span>:             x_t_WM = ([a_view[k]]*nact - zs)/vs_WM</pre>
<pre class='cython code score-39 '>      __pyx_t_2.data = __pyx_v_a_view.data;
      __pyx_t_2.memview = __pyx_v_a_view.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 1);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_k;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_a_view.strides[0];
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_2.shape[0] = __pyx_v_a_view.shape[1];
__pyx_t_2.strides[0] = __pyx_v_a_view.strides[1];
    __pyx_t_2.suboffsets[0] = -1;

__pyx_t_5 = __pyx_memoryview_fromslice(__pyx_t_2, 1, (PyObject *(*)(char *)) __pyx_memview_get_float, (int (*)(char *, PyObject *)) __pyx_memview_set_float, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3592, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_2, 1);
      __pyx_t_2.memview = NULL; __pyx_t_2.data = NULL;
      __pyx_t_8 = <span class='py_c_api'>PyList_New</span>(1 * ((__pyx_v_nact&lt;0) ? 0:__pyx_v_nact));<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3592, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      { Py_ssize_t __pyx_temp;
        for (__pyx_temp=0; __pyx_temp &lt; __pyx_v_nact; __pyx_temp++) {
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
          if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_8, __pyx_temp, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3592, __pyx_L1_error)</span>;
        }
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_8, ((PyObject *)__pyx_v_zs));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3592, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_5, ((PyObject *)__pyx_v_vs_WM));<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3592, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (!(likely(((__pyx_t_8) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_8, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 3592, __pyx_L1_error)</span>
      __pyx_t_26 = ((PyArrayObject *)__pyx_t_8);
      {
        __Pyx_BufFmt_StackElem __pyx_stack[1];
        <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_x_t_WM.rcbuffer-&gt;pybuffer);
        __pyx_t_17 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_x_t_WM.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_26, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
        if (unlikely(__pyx_t_17 &lt; 0)) {
          <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_19, &amp;__pyx_t_20, &amp;__pyx_t_21);
          if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_x_t_WM.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_x_t_WM, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
            Py_XDECREF(__pyx_t_19); Py_XDECREF(__pyx_t_20); Py_XDECREF(__pyx_t_21);
            <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
          } else {
            <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_19, __pyx_t_20, __pyx_t_21);
          }
          __pyx_t_19 = __pyx_t_20 = __pyx_t_21 = 0;
        }
        __pyx_pybuffernd_x_t_WM.diminfo[0].strides = __pyx_pybuffernd_x_t_WM.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_x_t_WM.diminfo[0].shape = __pyx_pybuffernd_x_t_WM.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_x_t_WM.diminfo[1].strides = __pyx_pybuffernd_x_t_WM.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_x_t_WM.diminfo[1].shape = __pyx_pybuffernd_x_t_WM.rcbuffer-&gt;pybuffer.shape[1];
        if (unlikely((__pyx_t_17 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3592, __pyx_L1_error)</span>
      }
      __pyx_t_26 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_x_t_WM, ((PyArrayObject *)__pyx_t_8));
      __pyx_t_8 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3593</span>: </pre>
<pre class="cython line score-48" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3594</span>:             if np.min(x_t_RL) &lt;= np.min(x_t_WM):</pre>
<pre class='cython code score-48 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3594, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_min);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3594, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = NULL;
      __pyx_t_17 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
        __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
        if (likely(__pyx_t_5)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
          __pyx_t_17 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_5, ((PyObject *)__pyx_v_x_t_RL)};
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_17, 1+__pyx_t_17);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 3594, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      }
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3594, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_min);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3594, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = NULL;
      __pyx_t_17 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_5)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          __pyx_t_17 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_5, ((PyObject *)__pyx_v_x_t_WM)};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_17, 1+__pyx_t_17);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 3594, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      }
      __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_8, __pyx_t_4, Py_LE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3594, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_27 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely((__pyx_t_27 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3594, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (__pyx_t_27) {
/* … */
        goto __pyx_L7;
      }
</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3595</span>:                 rts_view[n, k, 0] = np.min(x_t_RL) + ndt  # store reaction time for sample n</pre>
<pre class='cython code score-42 '>        <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3595, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_min);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3595, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = NULL;
        __pyx_t_17 = 0;
        #if CYTHON_UNPACK_METHODS
        if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
          __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
          if (likely(__pyx_t_4)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
            __pyx_t_17 = 1;
          }
        }
        #endif
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_4, ((PyObject *)__pyx_v_x_t_RL)};
          __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+1-__pyx_t_17, 1+__pyx_t_17);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 3595, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        }
        __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_ndt);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3595, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3595, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_t_28 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_4); if (unlikely((__pyx_t_28 == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3595, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_29 = __pyx_v_n;
        __pyx_t_30 = __pyx_v_k;
        __pyx_t_31 = 0;
        *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_29 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_30 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_31 * __pyx_v_rts_view.strides[2]) )) = __pyx_t_28;
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3596</span>:                 choices_view[n, k, 0] = np.argmin(x_t_RL) # store choices for sample n</pre>
<pre class='cython code score-27 '>        <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3596, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_argmin);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3596, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_t_8 = NULL;
        __pyx_t_17 = 0;
        #if CYTHON_UNPACK_METHODS
        if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
          __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
          if (likely(__pyx_t_8)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
            __pyx_t_17 = 1;
          }
        }
        #endif
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_8, ((PyObject *)__pyx_v_x_t_RL)};
          __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_17, 1+__pyx_t_17);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
          if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 3596, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        }
        __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_4); if (unlikely((__pyx_t_17 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3596, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_31 = __pyx_v_n;
        __pyx_t_30 = __pyx_v_k;
        __pyx_t_29 = 0;
        *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_31 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_30 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_29 * __pyx_v_choices_view.strides[2]) )) = __pyx_t_17;
</pre><pre class="cython line score-0">&#xA0;<span class="">3597</span>:             else:</pre>
<pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3598</span>:                 rts_view[n, k, 0] = np.min(x_t_WM) + ndt  # store reaction time for sample n</pre>
<pre class='cython code score-42 '>      /*else*/ {
        <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3598, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_min);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3598, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_3 = NULL;
        __pyx_t_17 = 0;
        #if CYTHON_UNPACK_METHODS
        if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
          __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
          if (likely(__pyx_t_3)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
            __pyx_t_17 = 1;
          }
        }
        #endif
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_3, ((PyObject *)__pyx_v_x_t_WM)};
          __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+1-__pyx_t_17, 1+__pyx_t_17);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 3598, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        }
        __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_ndt);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3598, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3598, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_t_28 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_3); if (unlikely((__pyx_t_28 == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3598, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_29 = __pyx_v_n;
        __pyx_t_30 = __pyx_v_k;
        __pyx_t_31 = 0;
        *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_29 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_30 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_31 * __pyx_v_rts_view.strides[2]) )) = __pyx_t_28;
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3599</span>:                 choices_view[n, k, 0] = np.argmin(x_t_WM) # store choices for sample n</pre>
<pre class='cython code score-27 '>        <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3599, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_argmin);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3599, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_t_8 = NULL;
        __pyx_t_17 = 0;
        #if CYTHON_UNPACK_METHODS
        if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
          __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
          if (likely(__pyx_t_8)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
            __pyx_t_17 = 1;
          }
        }
        #endif
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_8, ((PyObject *)__pyx_v_x_t_WM)};
          __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_17, 1+__pyx_t_17);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
          if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 3599, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        }
        __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_3); if (unlikely((__pyx_t_17 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3599, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_31 = __pyx_v_n;
        __pyx_t_30 = __pyx_v_k;
        __pyx_t_29 = 0;
        *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_31 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_30 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_29 * __pyx_v_choices_view.strides[2]) )) = __pyx_t_17;
      }
      __pyx_L7:;
</pre><pre class="cython line score-0">&#xA0;<span class="">3600</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3601</span>:             # If the rt exceeds the deadline, set rt to -999</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3602</span>:             if rts_view[n, k, 0] &gt;= deadline_view[k]:</pre>
<pre class='cython code score-0 '>      __pyx_t_29 = __pyx_v_n;
      __pyx_t_30 = __pyx_v_k;
      __pyx_t_31 = 0;
      __pyx_t_32 = __pyx_v_k;
      __pyx_t_27 = ((*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_29 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_30 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_31 * __pyx_v_rts_view.strides[2]) ))) &gt;= (*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_32 * __pyx_v_deadline_view.strides[0]) ))));
      if (__pyx_t_27) {
/* … */
      }
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3603</span>:                 rts_view[n, k, 0] = -999</pre>
<pre class='cython code score-0 '>        __pyx_t_32 = __pyx_v_n;
        __pyx_t_31 = __pyx_v_k;
        __pyx_t_30 = 0;
        *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_32 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_31 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_30 * __pyx_v_rts_view.strides[2]) )) = -999.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3604</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3605</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3606</span>:     v_dict = {}</pre>
<pre class='cython code score-2 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3606, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_v_v_dict = ((PyObject*)__pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3607</span>:     for i in range(nact):</pre>
<pre class='cython code score-0 '>  __pyx_t_10 = __pyx_v_nact;
  __pyx_t_11 = __pyx_t_10;
  for (__pyx_t_12 = 0; __pyx_t_12 &lt; __pyx_t_11; __pyx_t_12+=1) {
    __pyx_v_i = __pyx_t_12;
</pre><pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3608</span>:         v_dict['v_RL_' + str(i)] = v_RL[:, i]</pre>
<pre class='cython code score-39 '>    __pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3608, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3608, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__5);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_slice__5)) <span class='error_goto'>__PYX_ERR(0, 3608, __pyx_L1_error)</span>;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 3608, __pyx_L1_error)</span>;
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_v_RL), __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3608, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3608, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Str</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3608, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_n_u_v_RL_2, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3608, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely((<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_v_dict, __pyx_t_4, __pyx_t_3) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3608, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3609</span>:         v_dict['v_WM_' + str(i)] = v_WM[:, i]</pre>
<pre class='cython code score-39 '>    __pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3609, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3609, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__5);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_slice__5)) <span class='error_goto'>__PYX_ERR(0, 3609, __pyx_L1_error)</span>;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 3609, __pyx_L1_error)</span>;
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_v_WM), __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3609, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3609, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Str</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3609, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_n_u_v_WM_2, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3609, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely((<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_v_dict, __pyx_t_4, __pyx_t_3) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3609, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">3610</span>: </pre>
<pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3611</span>:     return {'rts': rts, 'choices': choices, 'metadata': {**v_dict,</pre>
<pre class='cython code score-18 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3611, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3611, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3611, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='py_c_api'>PyDict_Copy</span>(__pyx_v_v_dict);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3611, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3612</span>:                                                          'a': a,</pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3612, __pyx_L1_error)</span>
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3613</span>:                                                          'z': z,</pre>
<pre class='cython code score-10 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_z, ((PyObject *)__pyx_v_z)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3613, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_t, __pyx_int_0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3614, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">3614</span>:                                                          't': 0,</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3615</span>:                                                          'deadline': deadline,</pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_deadline, ((PyObject *)__pyx_v_deadline)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3615, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3616</span>:                                                          'sd': sd,</pre>
<pre class='cython code score-11 '>  __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_sd);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3616, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_sd, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3616, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3617</span>:                                                          'n_samples': n_samples,</pre>
<pre class='cython code score-13 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3617, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_n_samples, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3617, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_simulator, __pyx_n_u_rlwm_lba_race) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3618, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">3618</span>:                                                          'simulator' : 'rlwm_lba_race',</pre>
<pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3619</span>:                                                          'possible_choices': list(np.arange(0, nact, 1)),</pre>
<pre class='cython code score-31 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3619, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3619, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nact);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3619, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_16 = NULL;
  __pyx_t_10 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_16 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_16)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_16);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      __pyx_t_10 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[4] = {__pyx_t_16, __pyx_int_0, __pyx_t_5, __pyx_int_1};
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_10, 3+__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 3619, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PySequence_ListKeepNew</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3619, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_possible_choices, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3619, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3620</span>:                                                          'max_t': max_t,</pre>
<pre class='cython code score-17 '>  __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_max_t);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3620, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_u_max_t, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3620, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_metadata, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3611, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3621</span>:                                                          }}</pre>
<pre class="cython line score-0">&#xA0;<span class="">3622</span>: # ----------------------------------------------------------------------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">3623</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3624</span>: # Simulate (rt, choice) tuples from: DDM WITH FLEXIBLE BOUNDARIES ------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">3625</span>: # @cythonboundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3626</span>: # @cythonwraparound(False)</pre>
<pre class="cython line score-176" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3627</span>: def ddm_flexbound_mic2_unnormalized_ornstein_multinoise(np.ndarray[float, ndim = 1] vh,</pre>
<pre class='cython code score-176 '>static PyObject *__pyx_pf_4cssm_72__defaults__(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_r = NULL;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
/* … */
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(12);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3627, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 2, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 3, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 4, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_True));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_True));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 5, ((PyObject *)Py_True))) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 6, Py_None)) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_True));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_True));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 7, ((PyObject *)Py_True))) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults13, __pyx_self)-&gt;__pyx_arg_boundary_params);
  <span class='refnanny'>__Pyx_GIVEREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults13, __pyx_self)-&gt;__pyx_arg_boundary_params);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 8, <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults13, __pyx_self)-&gt;__pyx_arg_boundary_params)) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 9, Py_None)) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject*)__pyx_n_u_full));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject*)__pyx_n_u_full));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 10, ((PyObject*)__pyx_n_u_full))) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_False));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_False));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 11, ((PyObject *)Py_False))) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3627, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 1, Py_None)) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L1_error)</span>;
  __pyx_t_6 = 0;
  __pyx_r = __pyx_t_5;
  __pyx_t_5 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.__defaults__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_4cssm_43ddm_flexbound_mic2_unnormalized_ornstein_multinoise(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_4cssm_43ddm_flexbound_mic2_unnormalized_ornstein_multinoise = {"ddm_flexbound_mic2_unnormalized_ornstein_multinoise", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_4cssm_43ddm_flexbound_mic2_unnormalized_ornstein_multinoise, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_4cssm_43ddm_flexbound_mic2_unnormalized_ornstein_multinoise(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyArrayObject *__pyx_v_vh = 0;
  PyArrayObject *__pyx_v_vl1 = 0;
  PyArrayObject *__pyx_v_vl2 = 0;
  PyArrayObject *__pyx_v_a = 0;
  PyArrayObject *__pyx_v_zh = 0;
  PyArrayObject *__pyx_v_zl1 = 0;
  PyArrayObject *__pyx_v_zl2 = 0;
  PyArrayObject *__pyx_v_d = 0;
  PyArrayObject *__pyx_v_g = 0;
  PyArrayObject *__pyx_v_t = 0;
  PyArrayObject *__pyx_v_deadline = 0;
  float __pyx_v_s;
  float __pyx_v_delta_t;
  float __pyx_v_max_t;
  int __pyx_v_n_samples;
  int __pyx_v_n_trials;
  CYTHON_UNUSED PyObject *__pyx_v_print_info = 0;
  PyObject *__pyx_v_boundary_fun = 0;
  PyObject *__pyx_v_boundary_multiplicative = 0;
  PyObject *__pyx_v_boundary_params = 0;
  PyObject *__pyx_v_random_state = 0;
  PyObject *__pyx_v_return_option = 0;
  PyObject *__pyx_v_smooth = 0;
  CYTHON_UNUSED PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("ddm_flexbound_mic2_unnormalized_ornstein_multinoise (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_vh,&amp;__pyx_n_s_vl1,&amp;__pyx_n_s_vl2,&amp;__pyx_n_s_a,&amp;__pyx_n_s_zh,&amp;__pyx_n_s_zl1,&amp;__pyx_n_s_zl2,&amp;__pyx_n_s_d,&amp;__pyx_n_s_g,&amp;__pyx_n_s_t,&amp;__pyx_n_s_deadline,&amp;__pyx_n_s_s,&amp;__pyx_n_s_delta_t,&amp;__pyx_n_s_max_t,&amp;__pyx_n_s_n_samples,&amp;__pyx_n_s_n_trials,&amp;__pyx_n_s_print_info,&amp;__pyx_n_s_boundary_fun,&amp;__pyx_n_s_boundary_multiplicative,&amp;__pyx_n_s_boundary_params,&amp;__pyx_n_s_random_state,&amp;__pyx_n_s_return_option,&amp;__pyx_n_s_smooth,0};
  PyObject* values[23] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    __pyx_defaults13 *__pyx_dynamic_args = <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults13, __pyx_self);
    values[16] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_True)));
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs);
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4cssm_42ddm_flexbound_mic2_unnormalized_ornstein_multinoise(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_vh, PyArrayObject *__pyx_v_vl1, PyArrayObject *__pyx_v_vl2, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_zh, PyArrayObject *__pyx_v_zl1, PyArrayObject *__pyx_v_zl2, PyArrayObject *__pyx_v_d, PyArrayObject *__pyx_v_g, PyArrayObject *__pyx_v_t, PyArrayObject *__pyx_v_deadline, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, CYTHON_UNUSED PyObject *__pyx_v_print_info, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state, PyObject *__pyx_v_return_option, PyObject *__pyx_v_smooth, CYTHON_UNUSED PyObject *__pyx_v_kwargs) {
  __Pyx_memviewslice __pyx_v_vh_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_vl1_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_vl2_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_a_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_zh_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_zl1_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_zl2_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_d_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_g_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_t_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_deadline_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_rts = NULL;
  PyObject *__pyx_v_choices = NULL;
  PyObject *__pyx_v_rts_low = NULL;
  PyObject *__pyx_v_rts_high = NULL;
  __Pyx_memviewslice __pyx_v_rts_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_rts_high_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_rts_low_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_choices_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_traj = NULL;
  __Pyx_memviewslice __pyx_v_traj_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  float __pyx_v_delta_t_sqrt;
  float __pyx_v_sqrt_st;
  int __pyx_v_num_draws;
  PyObject *__pyx_v_t_s = NULL;
  PyObject *__pyx_v_boundary = NULL;
  __Pyx_memviewslice __pyx_v_boundary_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_bias_trace_l1 = NULL;
  PyObject *__pyx_v_bias_trace_l2 = NULL;
  __Pyx_memviewslice __pyx_v_bias_trace_l1_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_bias_trace_l2_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  float __pyx_v_y_h;
  float __pyx_v_y_l;
  float __pyx_v_y_l1;
  float __pyx_v_y_l2;
  float __pyx_v_t_h;
  float __pyx_v_t_l;
  float __pyx_v_t_l1;
  float __pyx_v_t_l2;
  CYTHON_UNUSED float __pyx_v_smooth_u;
  float __pyx_v_deadline_tmp;
  Py_ssize_t __pyx_v_n;
  Py_ssize_t __pyx_v_ix;
  Py_ssize_t __pyx_v_ix1;
  Py_ssize_t __pyx_v_ix2;
  CYTHON_UNUSED Py_ssize_t __pyx_v_ix_l;
  Py_ssize_t __pyx_v_ix1_tmp;
  Py_ssize_t __pyx_v_ix2_tmp;
  Py_ssize_t __pyx_v_k;
  Py_ssize_t __pyx_v_m;
  __Pyx_memviewslice __pyx_v_gaussian_values = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_boundary_params_tmp = NULL;
  PyObject *__pyx_9genexpr14__pyx_v_key = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_a;
  __Pyx_Buffer __pyx_pybuffer_a;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_d;
  __Pyx_Buffer __pyx_pybuffer_d;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_deadline;
  __Pyx_Buffer __pyx_pybuffer_deadline;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_g;
  __Pyx_Buffer __pyx_pybuffer_g;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_t;
  __Pyx_Buffer __pyx_pybuffer_t;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_vh;
  __Pyx_Buffer __pyx_pybuffer_vh;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_vl1;
  __Pyx_Buffer __pyx_pybuffer_vl1;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_vl2;
  __Pyx_Buffer __pyx_pybuffer_vl2;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_zh;
  __Pyx_Buffer __pyx_pybuffer_zh;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_zl1;
  __Pyx_Buffer __pyx_pybuffer_zl1;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_zl2;
  __Pyx_Buffer __pyx_pybuffer_zl2;
  PyObject *__pyx_r = NULL;
  __pyx_pybuffer_vh.pybuffer.buf = NULL;
  __pyx_pybuffer_vh.refcount = 0;
  __pyx_pybuffernd_vh.data = NULL;
  __pyx_pybuffernd_vh.rcbuffer = &amp;__pyx_pybuffer_vh;
  __pyx_pybuffer_vl1.pybuffer.buf = NULL;
  __pyx_pybuffer_vl1.refcount = 0;
  __pyx_pybuffernd_vl1.data = NULL;
  __pyx_pybuffernd_vl1.rcbuffer = &amp;__pyx_pybuffer_vl1;
  __pyx_pybuffer_vl2.pybuffer.buf = NULL;
  __pyx_pybuffer_vl2.refcount = 0;
  __pyx_pybuffernd_vl2.data = NULL;
  __pyx_pybuffernd_vl2.rcbuffer = &amp;__pyx_pybuffer_vl2;
  __pyx_pybuffer_a.pybuffer.buf = NULL;
  __pyx_pybuffer_a.refcount = 0;
  __pyx_pybuffernd_a.data = NULL;
  __pyx_pybuffernd_a.rcbuffer = &amp;__pyx_pybuffer_a;
  __pyx_pybuffer_zh.pybuffer.buf = NULL;
  __pyx_pybuffer_zh.refcount = 0;
  __pyx_pybuffernd_zh.data = NULL;
  __pyx_pybuffernd_zh.rcbuffer = &amp;__pyx_pybuffer_zh;
  __pyx_pybuffer_zl1.pybuffer.buf = NULL;
  __pyx_pybuffer_zl1.refcount = 0;
  __pyx_pybuffernd_zl1.data = NULL;
  __pyx_pybuffernd_zl1.rcbuffer = &amp;__pyx_pybuffer_zl1;
  __pyx_pybuffer_zl2.pybuffer.buf = NULL;
  __pyx_pybuffer_zl2.refcount = 0;
  __pyx_pybuffernd_zl2.data = NULL;
  __pyx_pybuffernd_zl2.rcbuffer = &amp;__pyx_pybuffer_zl2;
  __pyx_pybuffer_d.pybuffer.buf = NULL;
  __pyx_pybuffer_d.refcount = 0;
  __pyx_pybuffernd_d.data = NULL;
  __pyx_pybuffernd_d.rcbuffer = &amp;__pyx_pybuffer_d;
  __pyx_pybuffer_g.pybuffer.buf = NULL;
  __pyx_pybuffer_g.refcount = 0;
  __pyx_pybuffernd_g.data = NULL;
  __pyx_pybuffernd_g.rcbuffer = &amp;__pyx_pybuffer_g;
  __pyx_pybuffer_t.pybuffer.buf = NULL;
  __pyx_pybuffer_t.refcount = 0;
  __pyx_pybuffernd_t.data = NULL;
  __pyx_pybuffernd_t.rcbuffer = &amp;__pyx_pybuffer_t;
  __pyx_pybuffer_deadline.pybuffer.buf = NULL;
  __pyx_pybuffer_deadline.refcount = 0;
  __pyx_pybuffernd_deadline.data = NULL;
  __pyx_pybuffernd_deadline.rcbuffer = &amp;__pyx_pybuffer_deadline;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_vh, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_vh.diminfo[0].strides = __pyx_pybuffernd_vh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_vh.diminfo[0].shape = __pyx_pybuffernd_vh.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vl1.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_vl1, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_vl1.diminfo[0].strides = __pyx_pybuffernd_vl1.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_vl1.diminfo[0].shape = __pyx_pybuffernd_vl1.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vl2.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_vl2, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_vl2.diminfo[0].strides = __pyx_pybuffernd_vl2.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_vl2.diminfo[0].shape = __pyx_pybuffernd_vl2.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_a, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_zh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_zh, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_zh.diminfo[0].strides = __pyx_pybuffernd_zh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_zh.diminfo[0].shape = __pyx_pybuffernd_zh.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_zl1.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_zl1, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_zl1.diminfo[0].strides = __pyx_pybuffernd_zl1.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_zl1.diminfo[0].shape = __pyx_pybuffernd_zl1.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_zl2.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_zl2, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_zl2.diminfo[0].strides = __pyx_pybuffernd_zl2.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_zl2.diminfo[0].shape = __pyx_pybuffernd_zl2.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_d.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_d, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_d.diminfo[0].strides = __pyx_pybuffernd_d.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_d.diminfo[0].shape = __pyx_pybuffernd_d.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_g.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_g, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_g.diminfo[0].strides = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_g.diminfo[0].shape = __pyx_pybuffernd_g.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_t, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_t.diminfo[0].strides = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_t.diminfo[0].shape = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_deadline, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_deadline.diminfo[0].strides = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_deadline.diminfo[0].shape = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.shape[0];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_2, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_7, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_9, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_d.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_g.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vh.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vl1.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vl2.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zh.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zl1.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zl2.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.ddm_flexbound_mic2_unnormalized_ornstein_multinoise", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_d.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_g.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vl1.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vl2.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zl1.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zl2.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_vh_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_vl1_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_vl2_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_a_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_zh_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_zl1_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_zl2_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_d_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_g_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_t_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_deadline_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_choices);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rts_low);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rts_high);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_rts_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_rts_high_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_rts_low_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_choices_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_traj);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_traj_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t_s);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_boundary);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_boundary_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_bias_trace_l1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_bias_trace_l2);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_bias_trace_l1_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_bias_trace_l2_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_boundary_params_tmp);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_9genexpr14__pyx_v_key);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_4cssm_43ddm_flexbound_mic2_unnormalized_ornstein_multinoise, 0, __pyx_n_s_ddm_flexbound_mic2_unnormalized, NULL, __pyx_n_s_cssm, __pyx_d, ((PyObject *)__pyx_codeobj__65));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3627, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (!<span class='pyx_c_api'>__Pyx_CyFunction_InitDefaults</span>(__pyx_t_5, sizeof(__pyx_defaults13), 1)) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L1_error)</span>
/* … */
  __pyx_codeobj__65 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(23, 0, 0, 81, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__55, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_cssm_pyx, __pyx_n_s_ddm_flexbound_mic2_unnormalized, 3627, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__65)) __PYX_ERR(0, 3627, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">3628</span>:                                                         np.ndarray[float, ndim = 1] vl1,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3629</span>:                                                         np.ndarray[float, ndim = 1] vl2,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3630</span>:                                                         np.ndarray[float, ndim = 1] a,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3631</span>:                                                         np.ndarray[float, ndim = 1] zh,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3632</span>:                                                         np.ndarray[float, ndim = 1] zl1,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3633</span>:                                                         np.ndarray[float, ndim = 1] zl2,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3634</span>:                                                         np.ndarray[float, ndim = 1] d, # damper (1 --&gt; no drift on low level until high level done, 0 --&gt; full drift on low level)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3635</span>:                                                         np.ndarray[float, ndim = 1] g, # inhibition parameter for the low dim choice procress while high dim is running</pre>
<pre class="cython line score-0">&#xA0;<span class="">3636</span>:                                                         np.ndarray[float, ndim = 1] t,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3637</span>:                                                         np.ndarray[float, ndim = 1] deadline,</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3638</span>:                                                         float s = 1.0,</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(((double)1.0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3638, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3639</span>:                                                         float delta_t = 0.001,</pre>
<pre class='cython code score-5 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(((double)0.001));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3639, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3640</span>:                                                         float max_t = 20,</pre>
<pre class='cython code score-5 '>  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)20.0));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3640, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3641</span>:                                                         int n_samples = 20000,</pre>
<pre class='cython code score-2 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)0x4E20));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3641, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3642</span>:                                                         int n_trials = 1,</pre>
<pre class='cython code score-2 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)1));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3642, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
</pre><pre class="cython line score-0">&#xA0;<span class="">3643</span>:                                                         print_info = True,</pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3644</span>:                                                         boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)</pre>
<pre class='cython code score-6 '>    values[17] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[18] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_True)));
    values[19] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(__pyx_dynamic_args-&gt;__pyx_arg_boundary_params);
</pre><pre class="cython line score-0">&#xA0;<span class="">3645</span>:                                                         boundary_multiplicative = True,</pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3646</span>:                                                         boundary_params = {},</pre>
<pre class='cython code score-12 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3646, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults13, __pyx_t_5)-&gt;__pyx_arg_boundary_params = __pyx_t_4;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_4 = 0;
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsGetter</span>(__pyx_t_5, __pyx_pf_4cssm_72__defaults__);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_ddm_flexbound_mic2_unnormalized, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-402" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3647</span>:                                                         random_state = None,</pre>
<pre class='cython code score-402 '>    values[20] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[21] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_full)));
    values[22] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case 23: values[22] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 22);
        CYTHON_FALLTHROUGH;
        case 22: values[21] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 21);
        CYTHON_FALLTHROUGH;
        case 21: values[20] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 20);
        CYTHON_FALLTHROUGH;
        case 20: values[19] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 19);
        CYTHON_FALLTHROUGH;
        case 19: values[18] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 18);
        CYTHON_FALLTHROUGH;
        case 18: values[17] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 17);
        CYTHON_FALLTHROUGH;
        case 17: values[16] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 16);
        CYTHON_FALLTHROUGH;
        case 16: values[15] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 15);
        CYTHON_FALLTHROUGH;
        case 15: values[14] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_vh)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_vl1)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_unnormalized_ornstein_multinoise", 0, 11, 23, 1); <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_vl2)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_unnormalized_ornstein_multinoise", 0, 11, 23, 2); <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_a)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[3]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_unnormalized_ornstein_multinoise", 0, 11, 23, 3); <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_zh)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[4]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_unnormalized_ornstein_multinoise", 0, 11, 23, 4); <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_zl1)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[5]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_unnormalized_ornstein_multinoise", 0, 11, 23, 5); <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_zl2)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[6]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_unnormalized_ornstein_multinoise", 0, 11, 23, 6); <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (likely((values[7] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_d)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[7]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_unnormalized_ornstein_multinoise", 0, 11, 23, 7); <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (likely((values[8] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_g)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[8]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_unnormalized_ornstein_multinoise", 0, 11, 23, 8); <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  9:
        if (likely((values[9] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_t)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[9]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_unnormalized_ornstein_multinoise", 0, 11, 23, 9); <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 10:
        if (likely((values[10] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_deadline)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[10]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_unnormalized_ornstein_multinoise", 0, 11, 23, 10); <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 11:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_s);
          if (value) { values[11] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 12:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_delta_t);
          if (value) { values[12] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 13:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_max_t);
          if (value) { values[13] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 14:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_samples);
          if (value) { values[14] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 15:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_trials);
          if (value) { values[15] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 16:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_print_info);
          if (value) { values[16] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 17:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_fun);
          if (value) { values[17] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 18:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_multiplicative);
          if (value) { values[18] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 19:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_params);
          if (value) { values[19] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 20:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_random_state);
          if (value) { values[20] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 21:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_return_option);
          if (value) { values[21] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 22:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_smooth);
          if (value) { values[22] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values + 0, kwd_pos_args, "ddm_flexbound_mic2_unnormalized_ornstein_multinoise") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case 23: values[22] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 22);
        CYTHON_FALLTHROUGH;
        case 22: values[21] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 21);
        CYTHON_FALLTHROUGH;
        case 21: values[20] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 20);
        CYTHON_FALLTHROUGH;
        case 20: values[19] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 19);
        CYTHON_FALLTHROUGH;
        case 19: values[18] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 18);
        CYTHON_FALLTHROUGH;
        case 18: values[17] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 17);
        CYTHON_FALLTHROUGH;
        case 17: values[16] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 16);
        CYTHON_FALLTHROUGH;
        case 16: values[15] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 15);
        CYTHON_FALLTHROUGH;
        case 15: values[14] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_vh = ((PyArrayObject *)values[0]);
    __pyx_v_vl1 = ((PyArrayObject *)values[1]);
    __pyx_v_vl2 = ((PyArrayObject *)values[2]);
    __pyx_v_a = ((PyArrayObject *)values[3]);
    __pyx_v_zh = ((PyArrayObject *)values[4]);
    __pyx_v_zl1 = ((PyArrayObject *)values[5]);
    __pyx_v_zl2 = ((PyArrayObject *)values[6]);
    __pyx_v_d = ((PyArrayObject *)values[7]);
    __pyx_v_g = ((PyArrayObject *)values[8]);
    __pyx_v_t = ((PyArrayObject *)values[9]);
    __pyx_v_deadline = ((PyArrayObject *)values[10]);
    if (values[11]) {
      __pyx_v_s = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[11]); if (unlikely((__pyx_v_s == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3638, __pyx_L3_error)</span>
    } else {
      __pyx_v_s = ((float)((double)1.0));
    }
    if (values[12]) {
      __pyx_v_delta_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[12]); if (unlikely((__pyx_v_delta_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3639, __pyx_L3_error)</span>
    } else {
      __pyx_v_delta_t = ((float)((double)0.001));
    }
    if (values[13]) {
      __pyx_v_max_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[13]); if (unlikely((__pyx_v_max_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3640, __pyx_L3_error)</span>
    } else {
      __pyx_v_max_t = ((float)((float)20.0));
    }
    if (values[14]) {
      __pyx_v_n_samples = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[14]); if (unlikely((__pyx_v_n_samples == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3641, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_samples = ((int)((int)0x4E20));
    }
    if (values[15]) {
      __pyx_v_n_trials = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[15]); if (unlikely((__pyx_v_n_trials == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3642, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_trials = ((int)((int)1));
    }
    __pyx_v_print_info = values[16];
    __pyx_v_boundary_fun = values[17];
    __pyx_v_boundary_multiplicative = values[18];
    __pyx_v_boundary_params = values[19];
    __pyx_v_random_state = values[20];
    __pyx_v_return_option = values[21];
    __pyx_v_smooth = values[22];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_mic2_unnormalized_ornstein_multinoise", 0, 11, 23, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.ddm_flexbound_mic2_unnormalized_ornstein_multinoise", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_vh), __pyx_ptype_5numpy_ndarray, 1, "vh", 0))) <span class='error_goto'>__PYX_ERR(0, 3627, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_vl1), __pyx_ptype_5numpy_ndarray, 1, "vl1", 0))) <span class='error_goto'>__PYX_ERR(0, 3628, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_vl2), __pyx_ptype_5numpy_ndarray, 1, "vl2", 0))) <span class='error_goto'>__PYX_ERR(0, 3629, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) <span class='error_goto'>__PYX_ERR(0, 3630, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_zh), __pyx_ptype_5numpy_ndarray, 1, "zh", 0))) <span class='error_goto'>__PYX_ERR(0, 3631, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_zl1), __pyx_ptype_5numpy_ndarray, 1, "zl1", 0))) <span class='error_goto'>__PYX_ERR(0, 3632, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_zl2), __pyx_ptype_5numpy_ndarray, 1, "zl2", 0))) <span class='error_goto'>__PYX_ERR(0, 3633, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_d), __pyx_ptype_5numpy_ndarray, 1, "d", 0))) <span class='error_goto'>__PYX_ERR(0, 3634, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_g), __pyx_ptype_5numpy_ndarray, 1, "g", 0))) <span class='error_goto'>__PYX_ERR(0, 3635, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) <span class='error_goto'>__PYX_ERR(0, 3636, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_deadline), __pyx_ptype_5numpy_ndarray, 1, "deadline", 0))) <span class='error_goto'>__PYX_ERR(0, 3637, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_4cssm_42ddm_flexbound_mic2_unnormalized_ornstein_multinoise(__pyx_self, __pyx_v_vh, __pyx_v_vl1, __pyx_v_vl2, __pyx_v_a, __pyx_v_zh, __pyx_v_zl1, __pyx_v_zl2, __pyx_v_d, __pyx_v_g, __pyx_v_t, __pyx_v_deadline, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_print_info, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state, __pyx_v_return_option, __pyx_v_smooth, __pyx_v_kwargs);
</pre><pre class="cython line score-0">&#xA0;<span class="">3648</span>:                                                         return_option = 'full',</pre>
<pre class="cython line score-0">&#xA0;<span class="">3649</span>:                                                         smooth = False,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3650</span>:                                                         **kwargs):</pre>
<pre class="cython line score-0">&#xA0;<span class="">3651</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3652</span>:     set_seed(random_state)</pre>
<pre class='cython code score-1 '>  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3652, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3653</span>:     # Param views</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3654</span>:     cdef float[:] vh_view = vh</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_vh), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 3654, __pyx_L1_error)</span>
  __pyx_v_vh_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3655</span>:     cdef float[:] vl1_view = vl1</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_vl1), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 3655, __pyx_L1_error)</span>
  __pyx_v_vl1_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3656</span>:     cdef float[:] vl2_view = vl2</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_vl2), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 3656, __pyx_L1_error)</span>
  __pyx_v_vl2_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3657</span>:     cdef float[:] a_view = a</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_a), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 3657, __pyx_L1_error)</span>
  __pyx_v_a_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3658</span>:     cdef float[:] zh_view = zh</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_zh), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 3658, __pyx_L1_error)</span>
  __pyx_v_zh_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3659</span>:     cdef float[:] zl1_view = zl1</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_zl1), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 3659, __pyx_L1_error)</span>
  __pyx_v_zl1_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3660</span>:     cdef float[:] zl2_view = zl2</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_zl2), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 3660, __pyx_L1_error)</span>
  __pyx_v_zl2_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3661</span>:     cdef float[:] d_view = d</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_d), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 3661, __pyx_L1_error)</span>
  __pyx_v_d_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3662</span>:     cdef float[:] g_view = g</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_g), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 3662, __pyx_L1_error)</span>
  __pyx_v_g_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3663</span>:     cdef float[:] t_view = t</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_t), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 3663, __pyx_L1_error)</span>
  __pyx_v_t_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3664</span>:     cdef float[:] deadline_view = deadline</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_deadline), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 3664, __pyx_L1_error)</span>
  __pyx_v_deadline_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">3665</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3666</span>:     # TD: Add trajectory --&gt; same issue as with par2 model above... might need to make a separate simulator for trajectories</pre>
<pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3667</span>:     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)</pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3667, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3667, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3667, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3667, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3667, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3667, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 3667, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 3667, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3667, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3667, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3667, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3667, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3667, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3667, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_rts = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3668</span>:     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)</pre>
<pre class='cython code score-46 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3668, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3668, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3668, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3668, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3668, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3668, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 3668, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 3668, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3668, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 3668, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3668, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3668, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_intc);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3668, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3668, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3668, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_choices = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3669</span>:     rts_low = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)</pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3669, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3669, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3669, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3669, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3669, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 3669, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 3669, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 3669, __pyx_L1_error)</span>;
  __pyx_t_6 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3669, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3669, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3669, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3669, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3669, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3669, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_rts_low = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3670</span>:     rts_high = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)</pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3670, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3670, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3670, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3670, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3670, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 3670, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 3670, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 3670, __pyx_L1_error)</span>;
  __pyx_t_6 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3670, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 3670, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3670, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3670, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3670, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3670, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_rts_high = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3671</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3672</span>:     cdef float[:, :, :] rts_view = rts</pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_rts, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 3672, __pyx_L1_error)</span>
  __pyx_v_rts_view = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3673</span>:     cdef float[:, :, :] rts_high_view = rts_high</pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_rts_high, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 3673, __pyx_L1_error)</span>
  __pyx_v_rts_high_view = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3674</span>:     cdef float[:, :, :] rts_low_view = rts_low</pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_rts_low, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 3674, __pyx_L1_error)</span>
  __pyx_v_rts_low_view = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3675</span>:     cdef int[:, :, :] choices_view = choices</pre>
<pre class='cython code score-2 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_int</span>(__pyx_v_choices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 3675, __pyx_L1_error)</span>
  __pyx_v_choices_view = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">3676</span>: </pre>
<pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3677</span>:     traj = np.zeros((int(max_t / delta_t) + 1, 3), dtype = DTYPE)</pre>
<pre class='cython code score-42 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3677, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3677, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_FromDouble</span>((__pyx_v_max_t / __pyx_v_delta_t));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3677, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_6, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3677, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3677, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 3677, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_int_3)) <span class='error_goto'>__PYX_ERR(0, 3677, __pyx_L1_error)</span>;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3677, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 3677, __pyx_L1_error)</span>;
  __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3677, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3677, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3677, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3677, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_traj = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3678</span>:     traj[:, :] = -999</pre>
<pre class='cython code score-5 '>  if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_traj, __pyx_tuple__12, __pyx_int_neg_999) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3678, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3679</span>:     cdef float[:, :] traj_view = traj</pre>
<pre class='cython code score-2 '>  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_float</span>(__pyx_v_traj, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 3679, __pyx_L1_error)</span>
  __pyx_v_traj_view = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">3680</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3681</span>:     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion</pre>
<pre class='cython code score-0 '>  __pyx_v_delta_t_sqrt = sqrt(__pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3682</span>:     cdef float sqrt_st = delta_t_sqrt * s # scalar to ensure the correct variance for the gaussian step</pre>
<pre class='cython code score-0 '>  __pyx_v_sqrt_st = (__pyx_v_delta_t_sqrt * __pyx_v_s);
</pre><pre class="cython line score-0">&#xA0;<span class="">3683</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3684</span>:     # Boundary storage for the upper bound</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3685</span>:     cdef int num_draws = int((max_t / delta_t) + 1)</pre>
<pre class='cython code score-0 '>  __pyx_v_num_draws = ((int)((__pyx_v_max_t / __pyx_v_delta_t) + 1.0));
</pre><pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3686</span>:     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)</pre>
<pre class='cython code score-51 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3686, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3686, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_max_t + __pyx_v_delta_t));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3686, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_t);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3686, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_10 = NULL;
  __pyx_t_11 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_10)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_11 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[4] = {__pyx_t_10, __pyx_int_0, __pyx_t_4, __pyx_t_1};
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_11, 3+__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 3686, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3686, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3686, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_1 = NULL;
  __pyx_t_11 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_11 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_6};
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_11, 1+__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3686, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_v_t_s = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3687</span>:     boundary = np.zeros(t_s.shape, dtype = DTYPE)</pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3687, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3687, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_t_s, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3687, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3687, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3687, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3687, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3687, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3687, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_6, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3687, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_boundary = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3688</span>:     cdef float[:] boundary_view = boundary</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(__pyx_v_boundary, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 3688, __pyx_L1_error)</span>
  __pyx_v_boundary_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">3689</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3690</span>:     # Y particle trace</pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3691</span>:     bias_trace_l1 = np.zeros(num_draws, dtype = DTYPE)</pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3691, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3691, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3691, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3691, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3691, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3691, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3691, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3691, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_6, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3691, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_bias_trace_l1 = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3692</span>:     bias_trace_l2 = np.zeros(num_draws, dtype = DTYPE)</pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3692, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3692, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3692, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3692, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 3692, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3692, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3692, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3692, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_6, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3692, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_bias_trace_l2 = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3693</span>:     cdef float[:] bias_trace_l1_view = bias_trace_l1</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(__pyx_v_bias_trace_l1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 3693, __pyx_L1_error)</span>
  __pyx_v_bias_trace_l1_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3694</span>:     cdef float[:] bias_trace_l2_view = bias_trace_l2</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(__pyx_v_bias_trace_l2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 3694, __pyx_L1_error)</span>
  __pyx_v_bias_trace_l2_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">3695</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3696</span>:     cdef float y_h, y_l, y_l1, y_l2</pre>
<pre class="cython line score-0">&#xA0;<span class="">3697</span>:     cdef float v_l, v_l1, v_l2,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3698</span>:     cdef float t_h, t_l, t_l1, t_l2, smooth_u, deadline_tmp</pre>
<pre class="cython line score-0">&#xA0;<span class="">3699</span>:     cdef Py_ssize_t n, ix, ix1, ix2, ix_l, ix_tmp, ix1_tmp, ix2_tmp, k</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3700</span>:     cdef Py_ssize_t m = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_m = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3701</span>:     cdef float[:] gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 3701, __pyx_L1_error)</span>
  __pyx_v_gaussian_values = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">3702</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3703</span>:     for k in range(n_trials):</pre>
<pre class='cython code score-0 '>  __pyx_t_11 = __pyx_v_n_trials;
  __pyx_t_12 = __pyx_t_11;
  for (__pyx_t_13 = 0; __pyx_t_13 &lt; __pyx_t_12; __pyx_t_13+=1) {
    __pyx_v_k = __pyx_t_13;
</pre><pre class="cython line score-0">&#xA0;<span class="">3704</span>:         # Precompute boundary evaluations</pre>
<pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3705</span>:         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}</pre>
<pre class='cython code score-27 '>    { /* enter inner scope */
      __pyx_t_5 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3705, __pyx_L7_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_14 = 0;
      if (unlikely(__pyx_v_boundary_params == Py_None)) {
        <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "keys");
        <span class='error_goto'>__PYX_ERR(0, 3705, __pyx_L7_error)</span>
      }
      __pyx_t_6 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&amp;__pyx_t_15), (&amp;__pyx_t_16));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3705, __pyx_L7_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
      __pyx_t_3 = __pyx_t_6;
      __pyx_t_6 = 0;
      while (1) {
        __pyx_t_17 = __Pyx_dict_iter_next(__pyx_t_3, __pyx_t_15, &amp;__pyx_t_14, &amp;__pyx_t_6, NULL, NULL, __pyx_t_16);
        if (unlikely(__pyx_t_17 == 0)) break;
        if (unlikely(__pyx_t_17 == -1)) <span class='error_goto'>__PYX_ERR(0, 3705, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_9genexpr14__pyx_v_key, __pyx_t_6);
        __pyx_t_6 = 0;
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_boundary_params, __pyx_9genexpr14__pyx_v_key);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3705, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_6, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3705, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, (PyObject*)__pyx_9genexpr14__pyx_v_key, (PyObject*)__pyx_t_1))) <span class='error_goto'>__PYX_ERR(0, 3705, __pyx_L7_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_9genexpr14__pyx_v_key); __pyx_9genexpr14__pyx_v_key = 0;
      goto __pyx_L10_exit_scope;
      __pyx_L7_error:;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_9genexpr14__pyx_v_key); __pyx_9genexpr14__pyx_v_key = 0;
      goto __pyx_L1_error;
      __pyx_L10_exit_scope:;
    } /* exit inner scope */
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_boundary_params_tmp, ((PyObject*)__pyx_t_5));
    __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3706</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3707</span>:         # Precompute boundary evaluations</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3708</span>:         if boundary_multiplicative:</pre>
<pre class='cython code score-2 '>    __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_boundary_multiplicative); if (unlikely((__pyx_t_18 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3708, __pyx_L1_error)</span>
    if (__pyx_t_18) {
/* … */
      goto __pyx_L11;
    }
</pre><pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3709</span>:             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)</pre>
<pre class='cython code score-61 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3709, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_multiply);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3709, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_19 * __pyx_v_a_view.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3709, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3709, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_t, __pyx_v_t_s) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3709, __pyx_L1_error)</span>
      __pyx_t_4 = __pyx_t_10;
      __pyx_t_10 = 0;
      if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_4, __pyx_v_boundary_params_tmp) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3709, __pyx_L1_error)</span>
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3709, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_4, __pyx_t_1, __pyx_t_10};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_16, 2+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 3709, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      }
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3709, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3709, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_10 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
        __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
        if (likely(__pyx_t_10)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_10, __pyx_t_3};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_16, 1+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3709, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      }
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_boundary, __pyx_t_5, 0, 0, NULL, NULL, &amp;__pyx_slice__5, 0, 0, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3709, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3710</span>:         else:</pre>
<pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3711</span>:             boundary[:] = np.add(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)</pre>
<pre class='cython code score-61 '>    /*else*/ {
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3711, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_add);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3711, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_19 * __pyx_v_a_view.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3711, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3711, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_t, __pyx_v_t_s) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3711, __pyx_L1_error)</span>
      __pyx_t_1 = __pyx_t_4;
      __pyx_t_4 = 0;
      if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_1, __pyx_v_boundary_params_tmp) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3711, __pyx_L1_error)</span>
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3711, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
        __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
        if (likely(__pyx_t_1)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_1, __pyx_t_3, __pyx_t_4};
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_16, 2+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 3711, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      }
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3711, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3711, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_4 = NULL;
      __pyx_t_16 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
          __pyx_t_16 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_6};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_16, 1+__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3711, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      }
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_boundary, __pyx_t_5, 0, 0, NULL, NULL, &amp;__pyx_slice__5, 0, 0, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3711, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
    __pyx_L11:;
</pre><pre class="cython line score-0">&#xA0;<span class="">3712</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3713</span>:         deadline_tmp = min(max_t, deadline_view[k] - t_view[k])</pre>
<pre class='cython code score-0 '>    __pyx_t_19 = __pyx_v_k;
    __pyx_t_20 = __pyx_v_k;
    __pyx_t_21 = ((*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_19 * __pyx_v_deadline_view.strides[0]) ))) - (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_20 * __pyx_v_t_view.strides[0]) ))));
    __pyx_t_22 = __pyx_v_max_t;
    __pyx_t_18 = (__pyx_t_21 &lt; __pyx_t_22);
    if (__pyx_t_18) {
      __pyx_t_23 = __pyx_t_21;
    } else {
      __pyx_t_23 = __pyx_t_22;
    }
    __pyx_v_deadline_tmp = __pyx_t_23;
</pre><pre class="cython line score-0">&#xA0;<span class="">3714</span>:         # Loop over samples</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3715</span>:         for n in range(n_samples):</pre>
<pre class='cython code score-0 '>    __pyx_t_16 = __pyx_v_n_samples;
    __pyx_t_17 = __pyx_t_16;
    for (__pyx_t_15 = 0; __pyx_t_15 &lt; __pyx_t_17; __pyx_t_15+=1) {
      __pyx_v_n = __pyx_t_15;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3716</span>:             choices_view[n, k, 0] = 0 # reset choice</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = __pyx_v_n;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_24 = 0;
      *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_20 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[2]) )) = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3717</span>:             t_h = 0 # reset time high dimension</pre>
<pre class='cython code score-0 '>      __pyx_v_t_h = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3718</span>:             t_l = 0 # reset time low dimension</pre>
<pre class='cython code score-0 '>      __pyx_v_t_l = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3719</span>:             t_l1 = 0 # reset time low dimension (1)</pre>
<pre class='cython code score-0 '>      __pyx_v_t_l1 = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3720</span>:             t_l2 = 0 # reset time low dimension (2)</pre>
<pre class='cython code score-0 '>      __pyx_v_t_l2 = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3721</span>:             ix = 0 # reset boundary index</pre>
<pre class='cython code score-0 '>      __pyx_v_ix = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3722</span>:             ix1 = 0 # reset boundary index (1)</pre>
<pre class='cython code score-0 '>      __pyx_v_ix1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3723</span>:             ix2 = 0 # reset boundary index (2)</pre>
<pre class='cython code score-0 '>      __pyx_v_ix2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3724</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3725</span>:             # Initialize walkers</pre>
<pre class="cython line score-0">&#xA0;<span class="">3726</span>:             # Particle</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3727</span>:             y_h = (-1) * boundary_view[0] + (zh_view[k] * 2 * (boundary_view[0]))</pre>
<pre class='cython code score-0 '>      __pyx_t_24 = 0;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_20 = 0;
      __pyx_v_y_h = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_24 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_zh_view.data + __pyx_t_19 * __pyx_v_zh_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">3728</span>:             # Relative particle position (used as resource allocator for low dim choice)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3729</span>:             bias_trace_l2_view[0] = ((y_h + boundary_view[0]) / (2))</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = 0;
      __pyx_t_19 = 0;
      *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l2_view.data + __pyx_t_19 * __pyx_v_bias_trace_l2_view.strides[0]) )) = ((__pyx_v_y_h + (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))) / 2.0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3730</span>:             bias_trace_l1_view[0] = boundary_view[0] - bias_trace_l2_view[0]</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = 0;
      __pyx_t_19 = 0;
      __pyx_t_24 = 0;
      *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l1_view.data + __pyx_t_24 * __pyx_v_bias_trace_l1_view.strides[0]) )) = ((*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) ))) - (*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l2_view.data + __pyx_t_19 * __pyx_v_bias_trace_l2_view.strides[0]) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">3731</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3732</span>:             if n == 0:</pre>
<pre class='cython code score-0 '>      __pyx_t_18 = (__pyx_v_n == 0);
      if (__pyx_t_18) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3733</span>:                 if k == 0:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (__pyx_v_k == 0);
        if (__pyx_t_18) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3734</span>:                     traj_view[0, 0] = y_h</pre>
<pre class='cython code score-0 '>          __pyx_t_19 = 0;
          __pyx_t_20 = 0;
          *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_19 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_20 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y_h;
</pre><pre class="cython line score-0">&#xA0;<span class="">3735</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3736</span>:             # Random walks until y_h hits bound</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3737</span>:             while (y_h &gt;= ((-1) * boundary_view[ix])) and ((y_h &lt;= boundary_view[ix])) and (t_h &lt;= deadline_tmp):</pre>
<pre class='cython code score-0 '>      while (1) {
        __pyx_t_20 = __pyx_v_ix;
        __pyx_t_25 = (__pyx_v_y_h &gt;= (-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))));
        if (__pyx_t_25) {
        } else {
          __pyx_t_18 = __pyx_t_25;
          goto __pyx_L18_bool_binop_done;
        }
        __pyx_t_20 = __pyx_v_ix;
        __pyx_t_25 = (__pyx_v_y_h &lt;= (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) ))));
        if (__pyx_t_25) {
        } else {
          __pyx_t_18 = __pyx_t_25;
          goto __pyx_L18_bool_binop_done;
        }
        __pyx_t_25 = (__pyx_v_t_h &lt;= __pyx_v_deadline_tmp);
        __pyx_t_18 = __pyx_t_25;
        __pyx_L18_bool_binop_done:;
        if (!__pyx_t_18) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3738</span>:                 y_h += (vh_view[k] * delta_t) + (sqrt_st * gaussian_values[m])</pre>
<pre class='cython code score-0 '>        __pyx_t_20 = __pyx_v_k;
        __pyx_t_19 = __pyx_v_m;
        __pyx_v_y_h = (__pyx_v_y_h + (((*((float *) ( /* dim=0 */ (__pyx_v_vh_view.data + __pyx_t_20 * __pyx_v_vh_view.strides[0]) ))) * __pyx_v_delta_t) + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_19 * __pyx_v_gaussian_values.strides[0]) ))))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3739</span>:                 bias_trace_l2_view[ix] = ((y_h + boundary_view[ix]) / (2))</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = __pyx_v_ix;
        __pyx_t_20 = __pyx_v_ix;
        *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l2_view.data + __pyx_t_20 * __pyx_v_bias_trace_l2_view.strides[0]) )) = ((__pyx_v_y_h + (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))) / 2.0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3740</span>:                 bias_trace_l1_view[ix] = boundary_view[ix] - bias_trace_l2_view[ix]</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = __pyx_v_ix;
        __pyx_t_20 = __pyx_v_ix;
        __pyx_t_24 = __pyx_v_ix;
        *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l1_view.data + __pyx_t_24 * __pyx_v_bias_trace_l1_view.strides[0]) )) = ((*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) ))) - (*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l2_view.data + __pyx_t_20 * __pyx_v_bias_trace_l2_view.strides[0]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3741</span>:                 t_h += delta_t</pre>
<pre class='cython code score-0 '>        __pyx_v_t_h = (__pyx_v_t_h + __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3742</span>:                 ix += 1</pre>
<pre class='cython code score-0 '>        __pyx_v_ix = (__pyx_v_ix + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3743</span>:                 m += 1</pre>
<pre class='cython code score-0 '>        __pyx_v_m = (__pyx_v_m + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3744</span>:                 if m == num_draws:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (__pyx_v_m == __pyx_v_num_draws);
        if (__pyx_t_18) {
/* … */
        }
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3745</span>:                     gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 3745, __pyx_L1_error)</span>
          __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
          __pyx_v_gaussian_values = __pyx_t_2;
          __pyx_t_2.memview = NULL;
          __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3746</span>:                     m = 0</pre>
<pre class='cython code score-0 '>          __pyx_v_m = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3747</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3748</span>:             # The probability of making a 'mistake' 1 - (relative y position)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3749</span>:             # y at upper bound --&gt; choices_view[n, k, 0] add 2 deterministically</pre>
<pre class="cython line score-0">&#xA0;<span class="">3750</span>:             # y at lower bound --&gt; choice_view[n, k, 0] stay the same deterministically</pre>
<pre class="cython line score-0">&#xA0;<span class="">3751</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3752</span>:             # If boundary is negative (or 0) already, we flip a coin</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3753</span>:             if boundary_view[ix] &lt;= 0:</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = __pyx_v_ix;
      __pyx_t_18 = ((*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) ))) &lt;= 0.0);
      if (__pyx_t_18) {
/* … */
        goto __pyx_L22;
      }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3754</span>:                 if random_uniform() &lt;= 0.5:</pre>
<pre class='cython code score-5 '>        __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3754, __pyx_L1_error)</span>
        __pyx_t_18 = (__pyx_t_23 &lt;= 0.5);
        if (__pyx_t_18) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3755</span>:                     choices_view[n, k, 0] += 2</pre>
<pre class='cython code score-0 '>          __pyx_t_20 = __pyx_v_n;
          __pyx_t_19 = __pyx_v_k;
          __pyx_t_24 = 0;
          *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_20 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[2]) )) += 2;
</pre><pre class="cython line score-0">&#xA0;<span class="">3756</span>:             # Otherwise, apply rule from above</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3757</span>:             elif random_uniform() &lt;= ((y_h + boundary_view[ix]) / (2 * boundary_view[ix])):</pre>
<pre class='cython code score-5 '>      __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3757, __pyx_L1_error)</span>
      __pyx_t_24 = __pyx_v_ix;
      __pyx_t_19 = __pyx_v_ix;
      __pyx_t_18 = (__pyx_t_23 &lt;= ((__pyx_v_y_h + (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_24 * __pyx_v_boundary_view.strides[0]) )))) / (2.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) ))))));
      if (__pyx_t_18) {
/* … */
      }
      __pyx_L22:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3758</span>:                 choices_view[n, k, 0] += 2</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = __pyx_v_n;
        __pyx_t_24 = __pyx_v_k;
        __pyx_t_20 = 0;
        *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_19 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[2]) )) += 2;
</pre><pre class="cython line score-0">&#xA0;<span class="">3759</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3760</span>:             y_l2 = (- 1) * boundary_view[0] + (zl2_view[k] * 2 * (boundary_view[0]))</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = 0;
      __pyx_t_24 = __pyx_v_k;
      __pyx_t_19 = 0;
      __pyx_v_y_l2 = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_zl2_view.data + __pyx_t_24 * __pyx_v_zl2_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3761</span>:             y_l1 = (- 1) * boundary_view[0] + (zl1_view[k] * 2 * (boundary_view[0]))</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = 0;
      __pyx_t_24 = __pyx_v_k;
      __pyx_t_20 = 0;
      __pyx_v_y_l1 = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_zl1_view.data + __pyx_t_24 * __pyx_v_zl1_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">3762</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3763</span>:             if choices_view[n, k, 0] == 0:</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = __pyx_v_n;
      __pyx_t_24 = __pyx_v_k;
      __pyx_t_19 = 0;
      __pyx_t_18 = ((*((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_20 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[2]) ))) == 0);
      if (__pyx_t_18) {
/* … */
        goto __pyx_L24;
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">3764</span>:                  # Fill bias trace a until max_rt reached</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3765</span>:                 ix1_tmp = ix + 1</pre>
<pre class='cython code score-0 '>        __pyx_v_ix1_tmp = (__pyx_v_ix + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3766</span>:                 while ix1_tmp &lt; num_draws:</pre>
<pre class='cython code score-0 '>        while (1) {
          __pyx_t_18 = (__pyx_v_ix1_tmp &lt; __pyx_v_num_draws);
          if (!__pyx_t_18) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3767</span>:                     bias_trace_l2_view[ix1_tmp] = 0.0</pre>
<pre class='cython code score-0 '>          __pyx_t_19 = __pyx_v_ix1_tmp;
          *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l2_view.data + __pyx_t_19 * __pyx_v_bias_trace_l2_view.strides[0]) )) = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3768</span>:                     bias_trace_l1_view[ix1_tmp] = 1.0</pre>
<pre class='cython code score-0 '>          __pyx_t_19 = __pyx_v_ix1_tmp;
          *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l1_view.data + __pyx_t_19 * __pyx_v_bias_trace_l1_view.strides[0]) )) = 1.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3769</span>:                     ix1_tmp += 1</pre>
<pre class='cython code score-0 '>          __pyx_v_ix1_tmp = (__pyx_v_ix1_tmp + 1);
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">3770</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3771</span>:             else: # Store intermediate choice</pre>
<pre class="cython line score-0">&#xA0;<span class="">3772</span>:                 # Fill bias tracea until max_rt reached</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3773</span>:                 ix2_tmp = ix + 1</pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_v_ix2_tmp = (__pyx_v_ix + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3774</span>:                 while ix2_tmp &lt; num_draws:</pre>
<pre class='cython code score-0 '>        while (1) {
          __pyx_t_18 = (__pyx_v_ix2_tmp &lt; __pyx_v_num_draws);
          if (!__pyx_t_18) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3775</span>:                     bias_trace_l2_view[ix2_tmp] = 1.0</pre>
<pre class='cython code score-0 '>          __pyx_t_19 = __pyx_v_ix2_tmp;
          *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l2_view.data + __pyx_t_19 * __pyx_v_bias_trace_l2_view.strides[0]) )) = 1.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3776</span>:                     bias_trace_l1_view[ix2_tmp] = 0.0</pre>
<pre class='cython code score-0 '>          __pyx_t_19 = __pyx_v_ix2_tmp;
          *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l1_view.data + __pyx_t_19 * __pyx_v_bias_trace_l1_view.strides[0]) )) = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3777</span>:                     ix2_tmp += 1</pre>
<pre class='cython code score-0 '>          __pyx_v_ix2_tmp = (__pyx_v_ix2_tmp + 1);
        }
      }
      __pyx_L24:;
</pre><pre class="cython line score-0">&#xA0;<span class="">3778</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3779</span>:             # lower level random walker (1)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3780</span>:             if (choices_view[n, k, 0] == 0) | ((n == 0) &amp; (k == 0)):</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = __pyx_v_n;
      __pyx_t_24 = __pyx_v_k;
      __pyx_t_20 = 0;
      __pyx_t_18 = (((*((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_19 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[2]) ))) == 0) | ((__pyx_v_n == 0) &amp; (__pyx_v_k == 0)));
      if (__pyx_t_18) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3781</span>:                 while (y_l1 &gt;= ((-1) * boundary_view[ix1])) and (y_l1 &lt;= boundary_view[ix1]) and (t_l1 &lt;= deadline_tmp):</pre>
<pre class='cython code score-0 '>        while (1) {
          __pyx_t_20 = __pyx_v_ix1;
          __pyx_t_25 = (__pyx_v_y_l1 &gt;= (-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))));
          if (__pyx_t_25) {
          } else {
            __pyx_t_18 = __pyx_t_25;
            goto __pyx_L32_bool_binop_done;
          }
          __pyx_t_20 = __pyx_v_ix1;
          __pyx_t_25 = (__pyx_v_y_l1 &lt;= (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) ))));
          if (__pyx_t_25) {
          } else {
            __pyx_t_18 = __pyx_t_25;
            goto __pyx_L32_bool_binop_done;
          }
          __pyx_t_25 = (__pyx_v_t_l1 &lt;= __pyx_v_deadline_tmp);
          __pyx_t_18 = __pyx_t_25;
          __pyx_L32_bool_binop_done:;
          if (!__pyx_t_18) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3782</span>:                     if (bias_trace_l1_view[ix1] &lt; boundary_view[ix1]) and (bias_trace_l1_view[ix1] &gt; 0):</pre>
<pre class='cython code score-0 '>          __pyx_t_20 = __pyx_v_ix1;
          __pyx_t_24 = __pyx_v_ix1;
          __pyx_t_25 = ((*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l1_view.data + __pyx_t_20 * __pyx_v_bias_trace_l1_view.strides[0]) ))) &lt; (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_24 * __pyx_v_boundary_view.strides[0]) ))));
          if (__pyx_t_25) {
          } else {
            __pyx_t_18 = __pyx_t_25;
            goto __pyx_L36_bool_binop_done;
          }
          __pyx_t_24 = __pyx_v_ix1;
          __pyx_t_25 = ((*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l1_view.data + __pyx_t_24 * __pyx_v_bias_trace_l1_view.strides[0]) ))) &gt; 0.0);
          __pyx_t_18 = __pyx_t_25;
          __pyx_L36_bool_binop_done:;
          if (__pyx_t_18) {
/* … */
            goto __pyx_L35;
          }
</pre><pre class="cython line score-0">&#xA0;<span class="">3783</span>:                         # main propagation if bias_trace is between 0 and 1 (high level choice is not yet made)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3784</span>:                         y_l1 += (((vl1_view[k] * bias_trace_l1_view[ix1] * (1 - d_view[k])) - (g_view[k] * y_l1)) * delta_t)</pre>
<pre class='cython code score-0 '>            __pyx_t_24 = __pyx_v_k;
            __pyx_t_20 = __pyx_v_ix1;
            __pyx_t_19 = __pyx_v_k;
            __pyx_t_26 = __pyx_v_k;
            __pyx_v_y_l1 = (__pyx_v_y_l1 + (((((*((float *) ( /* dim=0 */ (__pyx_v_vl1_view.data + __pyx_t_24 * __pyx_v_vl1_view.strides[0]) ))) * (*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l1_view.data + __pyx_t_20 * __pyx_v_bias_trace_l1_view.strides[0]) )))) * (1.0 - (*((float *) ( /* dim=0 */ (__pyx_v_d_view.data + __pyx_t_19 * __pyx_v_d_view.strides[0]) ))))) - ((*((float *) ( /* dim=0 */ (__pyx_v_g_view.data + __pyx_t_26 * __pyx_v_g_view.strides[0]) ))) * __pyx_v_y_l1)) * __pyx_v_delta_t));
</pre><pre class="cython line score-0">&#xA0;<span class="">3785</span>:                         # add gaussian displacement</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3786</span>:                         y_l1 += (sqrt_st * gaussian_values[m]) * bias_trace_l1_view[ix1]</pre>
<pre class='cython code score-0 '>            __pyx_t_26 = __pyx_v_m;
            __pyx_t_19 = __pyx_v_ix1;
            __pyx_v_y_l1 = (__pyx_v_y_l1 + ((__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_26 * __pyx_v_gaussian_values.strides[0]) )))) * (*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l1_view.data + __pyx_t_19 * __pyx_v_bias_trace_l1_view.strides[0]) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">3787</span>:                     else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">3788</span>:                         # main propagation if bias_trace is not between 0 and 1 (high level choice is already made)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3789</span>:                         y_l1 += (vl1_view[k] * delta_t)</pre>
<pre class='cython code score-0 '>          /*else*/ {
            __pyx_t_19 = __pyx_v_k;
            __pyx_v_y_l1 = (__pyx_v_y_l1 + ((*((float *) ( /* dim=0 */ (__pyx_v_vl1_view.data + __pyx_t_19 * __pyx_v_vl1_view.strides[0]) ))) * __pyx_v_delta_t));
</pre><pre class="cython line score-0">&#xA0;<span class="">3790</span>:                         # add gaussian displacement</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3791</span>:                         y_l1 += (sqrt_st * gaussian_values[m])</pre>
<pre class='cython code score-0 '>            __pyx_t_19 = __pyx_v_m;
            __pyx_v_y_l1 = (__pyx_v_y_l1 + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_19 * __pyx_v_gaussian_values.strides[0]) )))));
          }
          __pyx_L35:;
</pre><pre class="cython line score-0">&#xA0;<span class="">3792</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3793</span>:                     # propagate time and indices</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3794</span>:                     t_l1 += delta_t</pre>
<pre class='cython code score-0 '>          __pyx_v_t_l1 = (__pyx_v_t_l1 + __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3795</span>:                     ix1 += 1</pre>
<pre class='cython code score-0 '>          __pyx_v_ix1 = (__pyx_v_ix1 + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3796</span>:                     m += 1</pre>
<pre class='cython code score-0 '>          __pyx_v_m = (__pyx_v_m + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3797</span>:                     if m == num_draws:</pre>
<pre class='cython code score-0 '>          __pyx_t_18 = (__pyx_v_m == __pyx_v_num_draws);
          if (__pyx_t_18) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3798</span>:                         gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>            __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 3798, __pyx_L1_error)</span>
            __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
            __pyx_v_gaussian_values = __pyx_t_2;
            __pyx_t_2.memview = NULL;
            __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3799</span>:                         m = 0</pre>
<pre class='cython code score-0 '>            __pyx_v_m = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3800</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3801</span>:                     if n == 0:</pre>
<pre class='cython code score-0 '>          __pyx_t_18 = (__pyx_v_n == 0);
          if (__pyx_t_18) {
/* … */
          }
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3802</span>:                         if k == 0:</pre>
<pre class='cython code score-0 '>            __pyx_t_18 = (__pyx_v_k == 0);
            if (__pyx_t_18) {
/* … */
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3803</span>:                             traj_view[ix1, 1] = y_l1</pre>
<pre class='cython code score-0 '>              __pyx_t_19 = __pyx_v_ix1;
              __pyx_t_26 = 1;
              *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_19 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_26 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y_l1;
</pre><pre class="cython line score-0">&#xA0;<span class="">3804</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3805</span>:             # lower level random walker (2)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3806</span>:             if (choices_view[n, k, 0] == 2) | ((n == 0) &amp; (k == 0)):</pre>
<pre class='cython code score-0 '>      __pyx_t_26 = __pyx_v_n;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_20 = 0;
      __pyx_t_18 = (((*((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_26 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[2]) ))) == 2) | ((__pyx_v_n == 0) &amp; (__pyx_v_k == 0)));
      if (__pyx_t_18) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3807</span>:                 while (y_l2 &gt;= ((-1) * boundary_view[ix2])) and (y_l2 &lt;= boundary_view[ix2]) and (t_l2 &lt;= deadline_tmp):</pre>
<pre class='cython code score-0 '>        while (1) {
          __pyx_t_20 = __pyx_v_ix2;
          __pyx_t_25 = (__pyx_v_y_l2 &gt;= (-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) )))));
          if (__pyx_t_25) {
          } else {
            __pyx_t_18 = __pyx_t_25;
            goto __pyx_L44_bool_binop_done;
          }
          __pyx_t_20 = __pyx_v_ix2;
          __pyx_t_25 = (__pyx_v_y_l2 &lt;= (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) ))));
          if (__pyx_t_25) {
          } else {
            __pyx_t_18 = __pyx_t_25;
            goto __pyx_L44_bool_binop_done;
          }
          __pyx_t_25 = (__pyx_v_t_l2 &lt;= __pyx_v_deadline_tmp);
          __pyx_t_18 = __pyx_t_25;
          __pyx_L44_bool_binop_done:;
          if (!__pyx_t_18) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3808</span>:                     if (bias_trace_l2_view[ix2] &lt; boundary_view[ix2]) and (bias_trace_l2_view[ix2] &gt; 0):</pre>
<pre class='cython code score-0 '>          __pyx_t_20 = __pyx_v_ix2;
          __pyx_t_19 = __pyx_v_ix2;
          __pyx_t_25 = ((*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l2_view.data + __pyx_t_20 * __pyx_v_bias_trace_l2_view.strides[0]) ))) &lt; (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) ))));
          if (__pyx_t_25) {
          } else {
            __pyx_t_18 = __pyx_t_25;
            goto __pyx_L48_bool_binop_done;
          }
          __pyx_t_19 = __pyx_v_ix2;
          __pyx_t_25 = ((*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l2_view.data + __pyx_t_19 * __pyx_v_bias_trace_l2_view.strides[0]) ))) &gt; 0.0);
          __pyx_t_18 = __pyx_t_25;
          __pyx_L48_bool_binop_done:;
          if (__pyx_t_18) {
/* … */
            goto __pyx_L47;
          }
</pre><pre class="cython line score-0">&#xA0;<span class="">3809</span>:                         # main propagation if bias_trace is between 0 and 1 (high level choice is not yet made)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3810</span>:                         y_l2 += (((vl2_view[k] * bias_trace_l2_view[ix2] * (1 - d_view[k])) - (g_view[k] * y_l2)) * delta_t)</pre>
<pre class='cython code score-0 '>            __pyx_t_19 = __pyx_v_k;
            __pyx_t_20 = __pyx_v_ix2;
            __pyx_t_26 = __pyx_v_k;
            __pyx_t_24 = __pyx_v_k;
            __pyx_v_y_l2 = (__pyx_v_y_l2 + (((((*((float *) ( /* dim=0 */ (__pyx_v_vl2_view.data + __pyx_t_19 * __pyx_v_vl2_view.strides[0]) ))) * (*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l2_view.data + __pyx_t_20 * __pyx_v_bias_trace_l2_view.strides[0]) )))) * (1.0 - (*((float *) ( /* dim=0 */ (__pyx_v_d_view.data + __pyx_t_26 * __pyx_v_d_view.strides[0]) ))))) - ((*((float *) ( /* dim=0 */ (__pyx_v_g_view.data + __pyx_t_24 * __pyx_v_g_view.strides[0]) ))) * __pyx_v_y_l2)) * __pyx_v_delta_t));
</pre><pre class="cython line score-0">&#xA0;<span class="">3811</span>:                         # add gaussian displacement</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3812</span>:                         y_l2 += (sqrt_st * gaussian_values[m]) * bias_trace_l2_view[ix2]</pre>
<pre class='cython code score-0 '>            __pyx_t_24 = __pyx_v_m;
            __pyx_t_26 = __pyx_v_ix2;
            __pyx_v_y_l2 = (__pyx_v_y_l2 + ((__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_24 * __pyx_v_gaussian_values.strides[0]) )))) * (*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_l2_view.data + __pyx_t_26 * __pyx_v_bias_trace_l2_view.strides[0]) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">3813</span>:                     else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">3814</span>:                         # main propagation if bias_trace is not between 0 and 1 (high level choice is already made)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3815</span>:                         y_l2 += (vl2_view[k] * delta_t)</pre>
<pre class='cython code score-0 '>          /*else*/ {
            __pyx_t_26 = __pyx_v_k;
            __pyx_v_y_l2 = (__pyx_v_y_l2 + ((*((float *) ( /* dim=0 */ (__pyx_v_vl2_view.data + __pyx_t_26 * __pyx_v_vl2_view.strides[0]) ))) * __pyx_v_delta_t));
</pre><pre class="cython line score-0">&#xA0;<span class="">3816</span>:                         # add gaussian displacement</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3817</span>:                         y_l2 += (sqrt_st * gaussian_values[m])</pre>
<pre class='cython code score-0 '>            __pyx_t_26 = __pyx_v_m;
            __pyx_v_y_l2 = (__pyx_v_y_l2 + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_26 * __pyx_v_gaussian_values.strides[0]) )))));
          }
          __pyx_L47:;
</pre><pre class="cython line score-0">&#xA0;<span class="">3818</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3819</span>:                     # propagate time and indices</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3820</span>:                     t_l2 += delta_t</pre>
<pre class='cython code score-0 '>          __pyx_v_t_l2 = (__pyx_v_t_l2 + __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3821</span>:                     ix2 += 1</pre>
<pre class='cython code score-0 '>          __pyx_v_ix2 = (__pyx_v_ix2 + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3822</span>:                     m += 1</pre>
<pre class='cython code score-0 '>          __pyx_v_m = (__pyx_v_m + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3823</span>:                     if m == num_draws:</pre>
<pre class='cython code score-0 '>          __pyx_t_18 = (__pyx_v_m == __pyx_v_num_draws);
          if (__pyx_t_18) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3824</span>:                         gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>            __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 3824, __pyx_L1_error)</span>
            __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
            __pyx_v_gaussian_values = __pyx_t_2;
            __pyx_t_2.memview = NULL;
            __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3825</span>:                         m = 0</pre>
<pre class='cython code score-0 '>            __pyx_v_m = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3826</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3827</span>:                     if n == 0:</pre>
<pre class='cython code score-0 '>          __pyx_t_18 = (__pyx_v_n == 0);
          if (__pyx_t_18) {
/* … */
          }
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3828</span>:                         if k == 0:</pre>
<pre class='cython code score-0 '>            __pyx_t_18 = (__pyx_v_k == 0);
            if (__pyx_t_18) {
/* … */
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3829</span>:                             traj_view[ix2, 2] = y_l2</pre>
<pre class='cython code score-0 '>              __pyx_t_26 = __pyx_v_ix2;
              __pyx_t_24 = 2;
              *((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_traj_view.data + __pyx_t_26 * __pyx_v_traj_view.strides[0]) ) + __pyx_t_24 * __pyx_v_traj_view.strides[1]) )) = __pyx_v_y_l2;
</pre><pre class="cython line score-0">&#xA0;<span class="">3830</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3831</span>:             # Get back to single y_l and t_l</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3832</span>:             if (choices_view[n, k, 0] == 0):</pre>
<pre class='cython code score-0 '>      __pyx_t_24 = __pyx_v_n;
      __pyx_t_26 = __pyx_v_k;
      __pyx_t_20 = 0;
      __pyx_t_18 = ((*((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_24 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_26 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[2]) ))) == 0);
      if (__pyx_t_18) {
/* … */
        goto __pyx_L53;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3833</span>:                 t_l = t_l1</pre>
<pre class='cython code score-0 '>        __pyx_v_t_l = __pyx_v_t_l1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3834</span>:                 y_l = y_l1</pre>
<pre class='cython code score-0 '>        __pyx_v_y_l = __pyx_v_y_l1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3835</span>:                 ix_l = ix1</pre>
<pre class='cython code score-0 '>        __pyx_v_ix_l = __pyx_v_ix1;
</pre><pre class="cython line score-0">&#xA0;<span class="">3836</span>:             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3837</span>:                 t_l = t_l2</pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_v_t_l = __pyx_v_t_l2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3838</span>:                 y_l = y_l2</pre>
<pre class='cython code score-0 '>        __pyx_v_y_l = __pyx_v_y_l2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3839</span>:                 ix_l = ix2</pre>
<pre class='cython code score-0 '>        __pyx_v_ix_l = __pyx_v_ix2;
      }
      __pyx_L53:;
</pre><pre class="cython line score-0">&#xA0;<span class="">3840</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3841</span>:             if smooth:</pre>
<pre class='cython code score-2 '>      __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_smooth); if (unlikely((__pyx_t_18 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3841, __pyx_L1_error)</span>
      if (__pyx_t_18) {
/* … */
        goto __pyx_L54;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3842</span>:                 if t_h == 0.0:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (__pyx_v_t_h == 0.0);
        if (__pyx_t_18) {
/* … */
          goto __pyx_L55;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3843</span>:                     smooth_u = random_uniform() * 0.5 * delta_t</pre>
<pre class='cython code score-5 '>          __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3843, __pyx_L1_error)</span>
          __pyx_v_smooth_u = ((__pyx_t_23 * 0.5) * __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3844</span>:                 elif fmax(t_h, t_l) &lt; deadline_tmp:</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = (fmax(__pyx_v_t_h, __pyx_v_t_l) &lt; __pyx_v_deadline_tmp);
        if (__pyx_t_18) {
/* … */
          goto __pyx_L55;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3845</span>:                     smooth_u = (0.5 - random_uniform()) * delta_t</pre>
<pre class='cython code score-5 '>          __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3845, __pyx_L1_error)</span>
          __pyx_v_smooth_u = ((0.5 - __pyx_t_23) * __pyx_v_delta_t);
</pre><pre class="cython line score-0">&#xA0;<span class="">3846</span>:                 else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3847</span>:                     smooth_u = 0.0</pre>
<pre class='cython code score-0 '>        /*else*/ {
          __pyx_v_smooth_u = 0.0;
        }
        __pyx_L55:;
</pre><pre class="cython line score-0">&#xA0;<span class="">3848</span>:             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3849</span>:                 smooth_u = 0.0</pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_v_smooth_u = 0.0;
      }
      __pyx_L54:;
</pre><pre class="cython line score-0">&#xA0;<span class="">3850</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3851</span>:             rts_view[n, k, 0] = fmax(t_h, t_l) + t_view[k]</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = __pyx_v_k;
      __pyx_t_26 = __pyx_v_n;
      __pyx_t_24 = __pyx_v_k;
      __pyx_t_19 = 0;
      *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_26 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_24 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_19 * __pyx_v_rts_view.strides[2]) )) = (fmax(__pyx_v_t_h, __pyx_v_t_l) + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_20 * __pyx_v_t_view.strides[0]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3852</span>:             rts_high_view[n, k, 0] = t_h + t_view[k]</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = __pyx_v_k;
      __pyx_t_19 = __pyx_v_n;
      __pyx_t_24 = __pyx_v_k;
      __pyx_t_26 = 0;
      *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_high_view.data + __pyx_t_19 * __pyx_v_rts_high_view.strides[0]) ) + __pyx_t_24 * __pyx_v_rts_high_view.strides[1]) ) + __pyx_t_26 * __pyx_v_rts_high_view.strides[2]) )) = (__pyx_v_t_h + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_20 * __pyx_v_t_view.strides[0]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3853</span>:             rts_low_view[n, k, 0] = t_l + t_view[k]</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = __pyx_v_k;
      __pyx_t_26 = __pyx_v_n;
      __pyx_t_24 = __pyx_v_k;
      __pyx_t_19 = 0;
      *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_low_view.data + __pyx_t_26 * __pyx_v_rts_low_view.strides[0]) ) + __pyx_t_24 * __pyx_v_rts_low_view.strides[1]) ) + __pyx_t_19 * __pyx_v_rts_low_view.strides[2]) )) = (__pyx_v_t_l + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_20 * __pyx_v_t_view.strides[0]) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">3854</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3855</span>:             # The probability of making a 'mistake' 1 - (relative y position)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3856</span>:             # y at upper bound --&gt; choices_view[n, k, 0] add one deterministically</pre>
<pre class="cython line score-0">&#xA0;<span class="">3857</span>:             # y at lower bound --&gt; choice_view[n, k, 0] stays the same deterministically</pre>
<pre class="cython line score-0">&#xA0;<span class="">3858</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3859</span>:             # If boundary is negative (or 0) already, we flip a coin</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3860</span>:             if boundary_view[ix] &lt;= 0:</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = __pyx_v_ix;
      __pyx_t_18 = ((*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_20 * __pyx_v_boundary_view.strides[0]) ))) &lt;= 0.0);
      if (__pyx_t_18) {
/* … */
        goto __pyx_L56;
      }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3861</span>:                 if random_uniform() &lt;= 0.5:</pre>
<pre class='cython code score-5 '>        __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3861, __pyx_L1_error)</span>
        __pyx_t_18 = (__pyx_t_23 &lt;= 0.5);
        if (__pyx_t_18) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3862</span>:                     choices_view[n, k, 0] += 1</pre>
<pre class='cython code score-0 '>          __pyx_t_20 = __pyx_v_n;
          __pyx_t_19 = __pyx_v_k;
          __pyx_t_24 = 0;
          *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_20 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[2]) )) += 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">3863</span>:             # Otherwise apply rule from above</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3864</span>:             elif random_uniform() &lt;= ((y_l + boundary_view[ix]) / (2 * boundary_view[ix])):</pre>
<pre class='cython code score-5 '>      __pyx_t_23 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_23 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3864, __pyx_L1_error)</span>
      __pyx_t_24 = __pyx_v_ix;
      __pyx_t_19 = __pyx_v_ix;
      __pyx_t_18 = (__pyx_t_23 &lt;= ((__pyx_v_y_l + (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_24 * __pyx_v_boundary_view.strides[0]) )))) / (2.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) ))))));
      if (__pyx_t_18) {
/* … */
      }
      __pyx_L56:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3865</span>:                 choices_view[n, k, 0] += 1</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = __pyx_v_n;
        __pyx_t_24 = __pyx_v_k;
        __pyx_t_20 = 0;
        *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_19 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_24 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_20 * __pyx_v_choices_view.strides[2]) )) += 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">3866</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3867</span>:             if (rts_view[n, k, 0] &gt;= deadline_view[k]) | (deadline_view[k] &lt;= 0):</pre>
<pre class='cython code score-0 '>      __pyx_t_20 = __pyx_v_n;
      __pyx_t_24 = __pyx_v_k;
      __pyx_t_19 = 0;
      __pyx_t_26 = __pyx_v_k;
      __pyx_t_27 = __pyx_v_k;
      __pyx_t_18 = (((*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_20 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_24 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_19 * __pyx_v_rts_view.strides[2]) ))) &gt;= (*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_26 * __pyx_v_deadline_view.strides[0]) )))) | ((*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_27 * __pyx_v_deadline_view.strides[0]) ))) &lt;= 0.0));
      if (__pyx_t_18) {
/* … */
      }
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3868</span>:                 rts_view[n, k, 0] = -999</pre>
<pre class='cython code score-0 '>        __pyx_t_27 = __pyx_v_n;
        __pyx_t_26 = __pyx_v_k;
        __pyx_t_19 = 0;
        *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_27 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_26 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_19 * __pyx_v_rts_view.strides[2]) )) = -999.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3869</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3870</span>:     if return_option == 'full':</pre>
<pre class='cython code score-2 '>  __pyx_t_18 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_return_option, __pyx_n_u_full, Py_EQ)); if (unlikely((__pyx_t_18 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3870, __pyx_L1_error)</span>
  if (__pyx_t_18) {
/* … */
  }
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3871</span>:         return {'rts': rts, 'choices': choices, 'rts_high': rts_high, 'rts_low': rts_low,</pre>
<pre class='cython code score-23 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3871, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3871, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3871, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_rts_high, __pyx_v_rts_high) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3871, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_rts_low, __pyx_v_rts_low) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3871, __pyx_L1_error)</span>
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3872</span>:                 'metadata': {'vh': vh,</pre>
<pre class='cython code score-7 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(11);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3872, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_vh, ((PyObject *)__pyx_v_vh)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3872, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3873</span>:                             'vl1': vl1,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_vl1, ((PyObject *)__pyx_v_vl1)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3872, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3874</span>:                             'vl2': vl2,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_vl2, ((PyObject *)__pyx_v_vl2)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3872, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3875</span>:                             'a': a,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3872, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3876</span>:                             'zh': zh,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_zh, ((PyObject *)__pyx_v_zh)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3872, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3877</span>:                             'zl1': zl1,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_zl1, ((PyObject *)__pyx_v_zl1)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3872, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3878</span>:                             'zl2': zl2,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_zl2, ((PyObject *)__pyx_v_zl2)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3872, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3879</span>:                             'd': d,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_d, ((PyObject *)__pyx_v_d)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3872, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3880</span>:                             't': t,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3872, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3881</span>:                             'deadline': deadline,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_deadline, ((PyObject *)__pyx_v_deadline)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3872, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3882</span>:                             's': s,</pre>
<pre class='cython code score-11 '>    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_s);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3882, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_s, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3872, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_10 = __pyx_t_6;
    __pyx_t_6 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3883</span>:                             **boundary_params,</pre>
<pre class='cython code score-17 '>    if (unlikely(__pyx_v_boundary_params == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
      <span class='error_goto'>__PYX_ERR(0, 3883, __pyx_L1_error)</span>
    }
    if (unlikely(<span class='py_c_api'>PyDict_Update</span>(__pyx_t_10, __pyx_v_boundary_params) &lt; 0)) {
      if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseMappingExpectedError</span>(__pyx_v_boundary_params);
      <span class='error_goto'>__PYX_ERR(0, 3883, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3884</span>:                             'delta_t': delta_t,</pre>
<pre class='cython code score-11 '>    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_t);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3884, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_delta_t, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3884, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3885</span>:                             'max_t': max_t,</pre>
<pre class='cython code score-11 '>    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_max_t);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3885, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_max_t, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3885, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3886</span>:                             'n_samples': n_samples,</pre>
<pre class='cython code score-8 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3886, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_n_samples, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3886, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3887</span>:                             'n_trials': n_trials,</pre>
<pre class='cython code score-13 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3887, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_n_trials, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3887, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_simulator, __pyx_n_u_ddm_flexbound_mic2_adj) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3888, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">3888</span>:                             'simulator': 'ddm_flexbound_mic2_adj',</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3889</span>:                             'boundary_fun_type': boundary_fun.__name__,</pre>
<pre class='cython code score-8 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_boundary_fun, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3889, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_boundary_fun_type, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3889, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3890</span>:                             'possible_choices': [0, 1, 2, 3],</pre>
<pre class='cython code score-23 '>    __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3890, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 0, __pyx_int_0)) <span class='error_goto'>__PYX_ERR(0, 3890, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 3890, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 2, __pyx_int_2)) <span class='error_goto'>__PYX_ERR(0, 3890, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 3, __pyx_int_3)) <span class='error_goto'>__PYX_ERR(0, 3890, __pyx_L1_error)</span>;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_possible_choices, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3890, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3891</span>:                             'trajectory': traj,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_trajectory, __pyx_v_traj) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3891, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3892</span>:                             'boundary': boundary}}</pre>
<pre class='cython code score-11 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_boundary, __pyx_v_boundary) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3892, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_metadata, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3871, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_r = __pyx_t_5;
    __pyx_t_5 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3893</span>:     elif return_option == 'minimal':</pre>
<pre class='cython code score-2 '>  __pyx_t_18 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_return_option, __pyx_n_u_minimal, Py_EQ)); if (unlikely((__pyx_t_18 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3893, __pyx_L1_error)</span>
  if (likely(__pyx_t_18)) {
/* … */
  }
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3894</span>:         return {'rts': rts, 'choices': choices, 'rts_high': rts_high, 'rts_low': rts_low,</pre>
<pre class='cython code score-23 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3894, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3894, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3894, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_rts_high, __pyx_v_rts_high) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3894, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_rts_low, __pyx_v_rts_low) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3894, __pyx_L1_error)</span>
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3895</span>:                 'metadata': {'simulator': 'ddm_flexbound_mic2_adj',</pre>
<pre class='cython code score-7 '>    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3895, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_simulator, __pyx_n_u_ddm_flexbound_mic2_adj) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3895, __pyx_L1_error)</span>
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3896</span>:                              'possible_choices': [0, 1, 2, 3],</pre>
<pre class='cython code score-23 '>    __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3896, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 0, __pyx_int_0)) <span class='error_goto'>__PYX_ERR(0, 3896, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 3896, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 2, __pyx_int_2)) <span class='error_goto'>__PYX_ERR(0, 3896, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 3, __pyx_int_3)) <span class='error_goto'>__PYX_ERR(0, 3896, __pyx_L1_error)</span>;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_possible_choices, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3895, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3897</span>:                              'boundary_fun_type': boundary_fun.__name__,</pre>
<pre class='cython code score-8 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_boundary_fun, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3897, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_boundary_fun_type, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3895, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3898</span>:                              'n_samples': n_samples,</pre>
<pre class='cython code score-8 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3898, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_n_samples, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3895, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3899</span>:                              'n_trials': n_trials,</pre>
<pre class='cython code score-14 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3899, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_u_n_trials, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3895, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_metadata, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3894, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_r = __pyx_t_5;
    __pyx_t_5 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3900</span>:                              }}</pre>
<pre class="cython line score-0">&#xA0;<span class="">3901</span>:     else:</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3902</span>:         raise ValueError('return_option must be either "full" or "minimal"')</pre>
<pre class='cython code score-5 '>  /*else*/ {
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3902, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_5, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='error_goto'>__PYX_ERR(0, 3902, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">3903</span>: # ----------------------------------------------------------------------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">3904</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3905</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3906</span>: ## Simulate (rt, choice) tuples from: DDM WITH FLEXIBLE BOUNDARIES ------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">3907</span>: ## @cythonboundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3908</span>: ## @cythonwraparound(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3909</span>: #def ddm_flexbound_mic2_unnormalized_ornstein_multinoise(np.ndarray[float, ndim = 1] vh,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3910</span>: #                                                        np.ndarray[float, ndim = 1] vl1,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3911</span>: #                                                        np.ndarray[float, ndim = 1] vl2,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3912</span>: #                                                        np.ndarray[float, ndim = 1] a,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3913</span>: #                                                        np.ndarray[float, ndim = 1] zh,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3914</span>: #                                                        np.ndarray[float, ndim = 1] zl1,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3915</span>: #                                                        np.ndarray[float, ndim = 1] zl2,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3916</span>: #                                                        np.ndarray[float, ndim = 1] d, # damper (1 --&gt; no drift on low level until high level done, 0 --&gt; full drift on low level)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3917</span>: #                                                        np.ndarray[float, ndim = 1] g, # inhibition parameter for the low dim choice procress while high dim is running</pre>
<pre class="cython line score-0">&#xA0;<span class="">3918</span>: #                                                        np.ndarray[float, ndim = 1] t,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3919</span>: #                                                        np.ndarray[float, ndim = 1] deadline,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3920</span>: #                                                        float s = 1.0,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3921</span>: #                                                        float delta_t = 0.001,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3922</span>: #                                                        float max_t = 20,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3923</span>: #                                                        int n_samples = 20000,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3924</span>: #                                                        int n_trials = 1,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3925</span>: #                                                        print_info = True,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3926</span>: #                                                        boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3927</span>: #                                                        boundary_multiplicative = True,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3928</span>: #                                                        boundary_params = {},</pre>
<pre class="cython line score-0">&#xA0;<span class="">3929</span>: #                                                        random_state = None,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3930</span>: #                                                        return_option = 'full',</pre>
<pre class="cython line score-0">&#xA0;<span class="">3931</span>: #                                                        smooth = False,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3932</span>: #                                                        **kwargs):</pre>
<pre class="cython line score-0">&#xA0;<span class="">3933</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">3934</span>: #    set_seed(random_state)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3935</span>: #    # Param views</pre>
<pre class="cython line score-0">&#xA0;<span class="">3936</span>: #    cdef float[:] vh_view = vh</pre>
<pre class="cython line score-0">&#xA0;<span class="">3937</span>: #    cdef float[:] vl1_view = vl1</pre>
<pre class="cython line score-0">&#xA0;<span class="">3938</span>: #    cdef float[:] vl2_view = vl2</pre>
<pre class="cython line score-0">&#xA0;<span class="">3939</span>: #    cdef float[:] a_view = a</pre>
<pre class="cython line score-0">&#xA0;<span class="">3940</span>: #    cdef float[:] zh_view = zh</pre>
<pre class="cython line score-0">&#xA0;<span class="">3941</span>: #    cdef float[:] zl1_view = zl1</pre>
<pre class="cython line score-0">&#xA0;<span class="">3942</span>: #    cdef float[:] zl2_view = zl2</pre>
<pre class="cython line score-0">&#xA0;<span class="">3943</span>: #    cdef float[:] d_view = d</pre>
<pre class="cython line score-0">&#xA0;<span class="">3944</span>: #    cdef float[:] g_view = g</pre>
<pre class="cython line score-0">&#xA0;<span class="">3945</span>: #    cdef float[:] t_view = t</pre>
<pre class="cython line score-0">&#xA0;<span class="">3946</span>: #    cdef float[:] deadline_view = deadline</pre>
<pre class="cython line score-0">&#xA0;<span class="">3947</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">3948</span>: #    # TD: Add trajectory --&gt; same issue as with par2 model above... might need to make a separate simulator for trajectories</pre>
<pre class="cython line score-0">&#xA0;<span class="">3949</span>: #    rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3950</span>: #    choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3951</span>: #    rts_low = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3952</span>: #    rts_high = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3953</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">3954</span>: #    cdef float[:, :, :] rts_view = rts</pre>
<pre class="cython line score-0">&#xA0;<span class="">3955</span>: #    cdef float[:, :, :] rts_high_view = rts_high</pre>
<pre class="cython line score-0">&#xA0;<span class="">3956</span>: #    cdef float[:, :, :] rts_low_view = rts_low</pre>
<pre class="cython line score-0">&#xA0;<span class="">3957</span>: #    cdef int[:, :, :] choices_view = choices</pre>
<pre class="cython line score-0">&#xA0;<span class="">3958</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">3959</span>: #    cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion</pre>
<pre class="cython line score-0">&#xA0;<span class="">3960</span>: #    cdef float sqrt_st = delta_t_sqrt * s # scalar to ensure the correct variance for the gaussian step</pre>
<pre class="cython line score-0">&#xA0;<span class="">3961</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">3962</span>: #    # Boundary storage for the upper bound</pre>
<pre class="cython line score-0">&#xA0;<span class="">3963</span>: #    cdef int num_draws = int((max_t / delta_t) + 1)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3964</span>: #    t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3965</span>: #    boundary = np.zeros(t_s.shape, dtype = DTYPE)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3966</span>: #    cdef float[:] boundary_view = boundary</pre>
<pre class="cython line score-0">&#xA0;<span class="">3967</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">3968</span>: #    # Y particle trace</pre>
<pre class="cython line score-0">&#xA0;<span class="">3969</span>: #    bias_trace = np.zeros(num_draws, dtype = DTYPE)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3970</span>: #    cdef float[:] bias_trace_view = bias_trace</pre>
<pre class="cython line score-0">&#xA0;<span class="">3971</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">3972</span>: #    cdef float y_h, y_l, v_l, t_h, t_l, smooth_u, deadline_tmp</pre>
<pre class="cython line score-0">&#xA0;<span class="">3973</span>: #    cdef Py_ssize_t n, ix, ix_tmp, k</pre>
<pre class="cython line score-0">&#xA0;<span class="">3974</span>: #    cdef Py_ssize_t m = 0</pre>
<pre class="cython line score-0">&#xA0;<span class="">3975</span>: #    cdef float[:] gaussian_values = draw_gaussian(num_draws)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3976</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">3977</span>: #    for k in range(n_trials):</pre>
<pre class="cython line score-0">&#xA0;<span class="">3978</span>: #        # Precompute boundary evaluations</pre>
<pre class="cython line score-0">&#xA0;<span class="">3979</span>: #        boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}</pre>
<pre class="cython line score-0">&#xA0;<span class="">3980</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">3981</span>: #        # Precompute boundary evaluations</pre>
<pre class="cython line score-0">&#xA0;<span class="">3982</span>: #        if boundary_multiplicative:</pre>
<pre class="cython line score-0">&#xA0;<span class="">3983</span>: #            boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3984</span>: #        else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">3985</span>: #            boundary[:] = np.add(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3986</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">3987</span>: #        deadline_tmp = min(max_t, deadline_view[k] - t_view[k])</pre>
<pre class="cython line score-0">&#xA0;<span class="">3988</span>: #        # Loop over samples</pre>
<pre class="cython line score-0">&#xA0;<span class="">3989</span>: #        for n in range(n_samples):</pre>
<pre class="cython line score-0">&#xA0;<span class="">3990</span>: #            choices_view[n, k, 0] = 0 # reset choice</pre>
<pre class="cython line score-0">&#xA0;<span class="">3991</span>: #            t_h = 0 # reset time high dimension</pre>
<pre class="cython line score-0">&#xA0;<span class="">3992</span>: #            t_l = 0 # reset time low dimension</pre>
<pre class="cython line score-0">&#xA0;<span class="">3993</span>: #            ix = 0 # reset boundary index</pre>
<pre class="cython line score-0">&#xA0;<span class="">3994</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">3995</span>: #            # Initialize walkers</pre>
<pre class="cython line score-0">&#xA0;<span class="">3996</span>: #            # Particle</pre>
<pre class="cython line score-0">&#xA0;<span class="">3997</span>: #            y_h = (-1) * boundary_view[0] + (zh_view[k] * 2 * (boundary_view[0]))</pre>
<pre class="cython line score-0">&#xA0;<span class="">3998</span>: #            # Relative particle position (used as resource allocator for low dim choice) / UNNORMALIZED</pre>
<pre class="cython line score-0">&#xA0;<span class="">3999</span>: #            bias_trace_view[0] = ((y_h + boundary_view[0]) / 2)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4000</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">4001</span>: #            # Random walks until y_h hits bound</pre>
<pre class="cython line score-0">&#xA0;<span class="">4002</span>: #            while (y_h &gt;= ((-1) * boundary_view[ix])) and ((y_h &lt;= boundary_view[ix])) and (t_h &lt;= deadline_tmp):</pre>
<pre class="cython line score-0">&#xA0;<span class="">4003</span>: #                y_h += (vh_view[k] * delta_t) + (sqrt_st * gaussian_values[m])</pre>
<pre class="cython line score-0">&#xA0;<span class="">4004</span>: #                bias_trace_view[ix] = ((y_h + boundary_view[ix]) / 2)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4005</span>: #                t_h += delta_t</pre>
<pre class="cython line score-0">&#xA0;<span class="">4006</span>: #                ix += 1</pre>
<pre class="cython line score-0">&#xA0;<span class="">4007</span>: #                m += 1</pre>
<pre class="cython line score-0">&#xA0;<span class="">4008</span>: #                if m == num_draws:</pre>
<pre class="cython line score-0">&#xA0;<span class="">4009</span>: #                    gaussian_values = draw_gaussian(num_draws)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4010</span>: #                    m = 0</pre>
<pre class="cython line score-0">&#xA0;<span class="">4011</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">4012</span>: #            # The probability of making a 'mistake' 1 - (relative y position)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4013</span>: #            # y at upper bound --&gt; choices_view[n, k, 0] add 2 deterministically</pre>
<pre class="cython line score-0">&#xA0;<span class="">4014</span>: #            # y at lower bound --&gt; choice_view[n, k, 0] stay the same deterministically</pre>
<pre class="cython line score-0">&#xA0;<span class="">4015</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">4016</span>: #            # If boundary is negative (or 0) already, we flip a coin</pre>
<pre class="cython line score-0">&#xA0;<span class="">4017</span>: #            if boundary_view[ix] &lt;= 0:</pre>
<pre class="cython line score-0">&#xA0;<span class="">4018</span>: #                if random_uniform() &lt;= 0.5:</pre>
<pre class="cython line score-0">&#xA0;<span class="">4019</span>: #                    choices_view[n, k, 0] += 2</pre>
<pre class="cython line score-0">&#xA0;<span class="">4020</span>: #            # Otherwise, apply rule from above</pre>
<pre class="cython line score-0">&#xA0;<span class="">4021</span>: #            elif random_uniform() &lt;= ((y_h + boundary_view[ix]) / (2 * boundary_view[ix])):</pre>
<pre class="cython line score-0">&#xA0;<span class="">4022</span>: #                choices_view[n, k, 0] += 2</pre>
<pre class="cython line score-0">&#xA0;<span class="">4023</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">4024</span>: #            if choices_view[n, k, 0] == 2:</pre>
<pre class="cython line score-0">&#xA0;<span class="">4025</span>: #                y_l = (- 1) * boundary_view[0] + (zl2_view[k] * 2 * (boundary_view[0]))</pre>
<pre class="cython line score-0">&#xA0;<span class="">4026</span>: #                v_l = vl2_view[k]</pre>
<pre class="cython line score-0">&#xA0;<span class="">4027</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">4028</span>: #                # Fill bias trace until max_rt reached</pre>
<pre class="cython line score-0">&#xA0;<span class="">4029</span>: #                ix_tmp = ix + 1</pre>
<pre class="cython line score-0">&#xA0;<span class="">4030</span>: #                while ix_tmp &lt; num_draws:</pre>
<pre class="cython line score-0">&#xA0;<span class="">4031</span>: #                    bias_trace_view[ix_tmp] = max(boundary_view[ix_tmp], 0)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4032</span>: #                    ix_tmp += 1</pre>
<pre class="cython line score-0">&#xA0;<span class="">4033</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">4034</span>: #            else: # Store intermediate choice</pre>
<pre class="cython line score-0">&#xA0;<span class="">4035</span>: #                y_l = (- 1) * boundary_view[0] + (zl1_view[k] * 2 * (boundary_view[0]))</pre>
<pre class="cython line score-0">&#xA0;<span class="">4036</span>: #                v_l = vl1_view[k]</pre>
<pre class="cython line score-0">&#xA0;<span class="">4037</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">4038</span>: #                # Fill bias trace until max_rt reached</pre>
<pre class="cython line score-0">&#xA0;<span class="">4039</span>: #                ix_tmp = ix + 1</pre>
<pre class="cython line score-0">&#xA0;<span class="">4040</span>: #                while ix_tmp &lt; num_draws:</pre>
<pre class="cython line score-0">&#xA0;<span class="">4041</span>: #                    bias_trace_view[ix_tmp] = 0.0</pre>
<pre class="cython line score-0">&#xA0;<span class="">4042</span>: #                    ix_tmp += 1</pre>
<pre class="cython line score-0">&#xA0;<span class="">4043</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">4044</span>: #                # We need to reverse the bias_trace if we took the lower choice</pre>
<pre class="cython line score-0">&#xA0;<span class="">4045</span>: #                ix_tmp = 0</pre>
<pre class="cython line score-0">&#xA0;<span class="">4046</span>: #                while ix_tmp &lt; num_draws:</pre>
<pre class="cython line score-0">&#xA0;<span class="">4047</span>: #                    bias_trace_view[ix_tmp] = max(boundary_view[ix_tmp] - bias_trace_view[ix_tmp], 0)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4048</span>: #                    ix_tmp += 1</pre>
<pre class="cython line score-0">&#xA0;<span class="">4049</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">4050</span>: #            # Random walks until the y_l corresponding to y_h hits bound</pre>
<pre class="cython line score-0">&#xA0;<span class="">4051</span>: #            ix = 0</pre>
<pre class="cython line score-0">&#xA0;<span class="">4052</span>: #            while (y_l &gt;= ((-1) * boundary_view[ix])) and (y_l &lt;= boundary_view[ix]) and (t_l &lt;= deadline_tmp):</pre>
<pre class="cython line score-0">&#xA0;<span class="">4053</span>: #                if (bias_trace_view[ix] &lt; boundary_view[ix]) and (bias_trace_view[ix] &gt; 0):</pre>
<pre class="cython line score-0">&#xA0;<span class="">4054</span>: #                    # main propagation if bias_trace is between 0 and 1 (high level choice is not yet made)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4055</span>: #                    y_l += (((v_l * bias_trace_view[ix] * (1 - d_view[k])) - (g_view[k] * y_l)) * delta_t)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4056</span>: #                    # add gaussian displacement</pre>
<pre class="cython line score-0">&#xA0;<span class="">4057</span>: #                    y_l += (sqrt_st * gaussian_values[m]) * bias_trace_view[ix]</pre>
<pre class="cython line score-0">&#xA0;<span class="">4058</span>: #                else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">4059</span>: #                    # main propagation if bias_trace is not between 0 and 1 (high level choice is already made)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4060</span>: #                    y_l += (v_l * delta_t)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4061</span>: #                    # add gaussian displacement</pre>
<pre class="cython line score-0">&#xA0;<span class="">4062</span>: #                    y_l += (sqrt_st * gaussian_values[m])</pre>
<pre class="cython line score-0">&#xA0;<span class="">4063</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">4064</span>: #                # propagate time and indices</pre>
<pre class="cython line score-0">&#xA0;<span class="">4065</span>: #                t_l += delta_t</pre>
<pre class="cython line score-0">&#xA0;<span class="">4066</span>: #                ix += 1</pre>
<pre class="cython line score-0">&#xA0;<span class="">4067</span>: #                m += 1</pre>
<pre class="cython line score-0">&#xA0;<span class="">4068</span>: #                if m == num_draws:</pre>
<pre class="cython line score-0">&#xA0;<span class="">4069</span>: #                    gaussian_values = draw_gaussian(num_draws)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4070</span>: #                    m = 0</pre>
<pre class="cython line score-0">&#xA0;<span class="">4071</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">4072</span>: #            if smooth:</pre>
<pre class="cython line score-0">&#xA0;<span class="">4073</span>: #                if t_h == 0:</pre>
<pre class="cython line score-0">&#xA0;<span class="">4074</span>: #                    smooth_u = random_uniform() * 0.5 * delta_t</pre>
<pre class="cython line score-0">&#xA0;<span class="">4075</span>: #                else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">4076</span>: #                    smooth_u = (0.5 - random_uniform()) * delta_t</pre>
<pre class="cython line score-0">&#xA0;<span class="">4077</span>: #            else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">4078</span>: #                smooth_u = 0.0</pre>
<pre class="cython line score-0">&#xA0;<span class="">4079</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">4080</span>: #            rts_view[n, k, 0] = fmax(t_h, t_l) + t_view[k]</pre>
<pre class="cython line score-0">&#xA0;<span class="">4081</span>: #            rts_high_view[n, k, 0] = t_h + t_view[k]</pre>
<pre class="cython line score-0">&#xA0;<span class="">4082</span>: #            rts_low_view[n, k, 0] = t_l + t_view[k]</pre>
<pre class="cython line score-0">&#xA0;<span class="">4083</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">4084</span>: #            # The probability of making a 'mistake' 1 - (relative y position)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4085</span>: #            # y at upper bound --&gt; choices_view[n, k, 0] add one deterministically</pre>
<pre class="cython line score-0">&#xA0;<span class="">4086</span>: #            # y at lower bound --&gt; choice_view[n, k, 0] stays the same deterministically</pre>
<pre class="cython line score-0">&#xA0;<span class="">4087</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">4088</span>: #            # If boundary is negative (or 0) already, we flip a coin</pre>
<pre class="cython line score-0">&#xA0;<span class="">4089</span>: #            if boundary_view[ix] &lt;= 0:</pre>
<pre class="cython line score-0">&#xA0;<span class="">4090</span>: #                if random_uniform() &lt;= 0.5:</pre>
<pre class="cython line score-0">&#xA0;<span class="">4091</span>: #                    choices_view[n, k, 0] += 1</pre>
<pre class="cython line score-0">&#xA0;<span class="">4092</span>: #            # Otherwise apply rule from above</pre>
<pre class="cython line score-0">&#xA0;<span class="">4093</span>: #            elif random_uniform() &lt;= ((y_l + boundary_view[ix]) / (2 * boundary_view[ix])):</pre>
<pre class="cython line score-0">&#xA0;<span class="">4094</span>: #                choices_view[n, k, 0] += 1</pre>
<pre class="cython line score-0">&#xA0;<span class="">4095</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">4096</span>: #            if rts_view[n, k, 0] &gt; deadline_tmp:</pre>
<pre class="cython line score-0">&#xA0;<span class="">4097</span>: #                rts_view[n, k, 0] = -999</pre>
<pre class="cython line score-0">&#xA0;<span class="">4098</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">4099</span>: #    if return_option == 'full':</pre>
<pre class="cython line score-0">&#xA0;<span class="">4100</span>: #        return {'rts': rts, 'choices': choices, 'rts_high': rts_high, 'rts_low': rts_low,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4101</span>: #                'metadata': {'vh': vh,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4102</span>: #                            'vl1': vl1,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4103</span>: #                            'vl2': vl2,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4104</span>: #                            'a': a,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4105</span>: #                            'zh': zh,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4106</span>: #                            'zl1': zl1,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4107</span>: #                            'zl2': zl2,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4108</span>: #                            'd': d,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4109</span>: #                            't': t,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4110</span>: #                            'deadline': deadline,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4111</span>: #                            's': s,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4112</span>: #                            **boundary_params,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4113</span>: #                            'delta_t': delta_t,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4114</span>: #                            'max_t': max_t,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4115</span>: #                            'n_samples': n_samples,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4116</span>: #                            'n_trials': n_trials,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4117</span>: #                            'simulator': 'ddm_flexbound_mic2_adj',</pre>
<pre class="cython line score-0">&#xA0;<span class="">4118</span>: #                            'boundary_fun_type': boundary_fun.__name__,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4119</span>: #                            'possible_choices': [0, 1, 2, 3],</pre>
<pre class="cython line score-0">&#xA0;<span class="">4120</span>: #                            'trajectory': 'This simulator does not yet allow for trajectory simulation',</pre>
<pre class="cython line score-0">&#xA0;<span class="">4121</span>: #                            'boundary': boundary}}</pre>
<pre class="cython line score-0">&#xA0;<span class="">4122</span>: #    elif return_option == 'minimal':</pre>
<pre class="cython line score-0">&#xA0;<span class="">4123</span>: #        return {'rts': rts, 'choices': choices, 'rts_high': rts_high, 'rts_low': rts_low,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4124</span>: #                'metadata': {'simulator': 'ddm_flexbound_mic2_adj',</pre>
<pre class="cython line score-0">&#xA0;<span class="">4125</span>: #                             'possible_choices': [0, 1, 2, 3],</pre>
<pre class="cython line score-0">&#xA0;<span class="">4126</span>: #                             'boundary_fun_type': boundary_fun.__name__,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4127</span>: #                             'n_samples': n_samples,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4128</span>: #                             'n_trials': n_trials,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4129</span>: #                             }}</pre>
<pre class="cython line score-0">&#xA0;<span class="">4130</span>: #    else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">4131</span>: #        raise ValueError('return_option must be either "full" or "minimal"')</pre>
<pre class="cython line score-0">&#xA0;<span class="">4132</span>: ## ----------------------------------------------------------------------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">4133</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4134</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4135</span>: # Simulate (rt, choice) tuples from: DDM WITH FLEXIBLE BOUNDARIES ------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">4136</span>: # @cythonboundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4137</span>: # @cythonwraparound(False)</pre>
<pre class="cython line score-169" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4138</span>: def ddm_flexbound_tradeoff(np.ndarray[float, ndim = 1] vh,</pre>
<pre class='cython code score-169 '>static PyObject *__pyx_pf_4cssm_74__defaults__(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_r = NULL;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
/* … */
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(12);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4138, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 2, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 3, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 4, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_True));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_True));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 5, ((PyObject *)Py_True))) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 6, Py_None)) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_True));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_True));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 7, ((PyObject *)Py_True))) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults14, __pyx_self)-&gt;__pyx_arg_boundary_params);
  <span class='refnanny'>__Pyx_GIVEREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults14, __pyx_self)-&gt;__pyx_arg_boundary_params);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 8, <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults14, __pyx_self)-&gt;__pyx_arg_boundary_params)) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 9, Py_None)) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject*)__pyx_n_u_full));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject*)__pyx_n_u_full));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 10, ((PyObject*)__pyx_n_u_full))) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_False));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_False));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 11, ((PyObject *)Py_False))) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4138, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 1, Py_None)) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L1_error)</span>;
  __pyx_t_6 = 0;
  __pyx_r = __pyx_t_5;
  __pyx_t_5 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.__defaults__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_4cssm_45ddm_flexbound_tradeoff(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_4cssm_45ddm_flexbound_tradeoff = {"ddm_flexbound_tradeoff", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_4cssm_45ddm_flexbound_tradeoff, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_4cssm_45ddm_flexbound_tradeoff(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyArrayObject *__pyx_v_vh = 0;
  PyArrayObject *__pyx_v_vl1 = 0;
  PyArrayObject *__pyx_v_vl2 = 0;
  PyArrayObject *__pyx_v_a = 0;
  PyArrayObject *__pyx_v_zh = 0;
  PyArrayObject *__pyx_v_zl1 = 0;
  PyArrayObject *__pyx_v_zl2 = 0;
  PyArrayObject *__pyx_v_d = 0;
  PyArrayObject *__pyx_v_t = 0;
  PyArrayObject *__pyx_v_deadline = 0;
  float __pyx_v_s;
  float __pyx_v_delta_t;
  float __pyx_v_max_t;
  int __pyx_v_n_samples;
  int __pyx_v_n_trials;
  CYTHON_UNUSED PyObject *__pyx_v_print_info = 0;
  PyObject *__pyx_v_boundary_fun = 0;
  PyObject *__pyx_v_boundary_multiplicative = 0;
  PyObject *__pyx_v_boundary_params = 0;
  PyObject *__pyx_v_random_state = 0;
  PyObject *__pyx_v_return_option = 0;
  PyObject *__pyx_v_smooth = 0;
  CYTHON_UNUSED PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("ddm_flexbound_tradeoff (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_vh,&amp;__pyx_n_s_vl1,&amp;__pyx_n_s_vl2,&amp;__pyx_n_s_a,&amp;__pyx_n_s_zh,&amp;__pyx_n_s_zl1,&amp;__pyx_n_s_zl2,&amp;__pyx_n_s_d,&amp;__pyx_n_s_t,&amp;__pyx_n_s_deadline,&amp;__pyx_n_s_s,&amp;__pyx_n_s_delta_t,&amp;__pyx_n_s_max_t,&amp;__pyx_n_s_n_samples,&amp;__pyx_n_s_n_trials,&amp;__pyx_n_s_print_info,&amp;__pyx_n_s_boundary_fun,&amp;__pyx_n_s_boundary_multiplicative,&amp;__pyx_n_s_boundary_params,&amp;__pyx_n_s_random_state,&amp;__pyx_n_s_return_option,&amp;__pyx_n_s_smooth,0};
  PyObject* values[22] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    __pyx_defaults14 *__pyx_dynamic_args = <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults14, __pyx_self);
    values[15] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_True)));
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs);
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4cssm_44ddm_flexbound_tradeoff(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_vh, PyArrayObject *__pyx_v_vl1, PyArrayObject *__pyx_v_vl2, PyArrayObject *__pyx_v_a, PyArrayObject *__pyx_v_zh, PyArrayObject *__pyx_v_zl1, PyArrayObject *__pyx_v_zl2, PyArrayObject *__pyx_v_d, PyArrayObject *__pyx_v_t, PyArrayObject *__pyx_v_deadline, float __pyx_v_s, float __pyx_v_delta_t, float __pyx_v_max_t, int __pyx_v_n_samples, int __pyx_v_n_trials, CYTHON_UNUSED PyObject *__pyx_v_print_info, PyObject *__pyx_v_boundary_fun, PyObject *__pyx_v_boundary_multiplicative, PyObject *__pyx_v_boundary_params, PyObject *__pyx_v_random_state, PyObject *__pyx_v_return_option, PyObject *__pyx_v_smooth, CYTHON_UNUSED PyObject *__pyx_v_kwargs) {
  __Pyx_memviewslice __pyx_v_vh_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_vl1_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_vl2_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_a_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_zh_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_zl1_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_zl2_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_d_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_t_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_deadline_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_rts = NULL;
  PyObject *__pyx_v_choices = NULL;
  __Pyx_memviewslice __pyx_v_rts_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_choices_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  float __pyx_v_delta_t_sqrt;
  float __pyx_v_sqrt_st;
  int __pyx_v_num_draws;
  PyObject *__pyx_v_t_s = NULL;
  PyObject *__pyx_v_boundary = NULL;
  __Pyx_memviewslice __pyx_v_boundary_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_bias_trace = NULL;
  __Pyx_memviewslice __pyx_v_bias_trace_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  float __pyx_v_y_h;
  float __pyx_v_y_l;
  float __pyx_v_v_l;
  float __pyx_v_t_h;
  float __pyx_v_t_l;
  float __pyx_v_tmp_pos_dep;
  CYTHON_UNUSED float __pyx_v_smooth_u;
  float __pyx_v_deadline_tmp;
  Py_ssize_t __pyx_v_n;
  Py_ssize_t __pyx_v_ix;
  Py_ssize_t __pyx_v_ix_tmp;
  Py_ssize_t __pyx_v_k;
  Py_ssize_t __pyx_v_m;
  __Pyx_memviewslice __pyx_v_gaussian_values = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_boundary_params_tmp = NULL;
  PyObject *__pyx_9genexpr15__pyx_v_key = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_a;
  __Pyx_Buffer __pyx_pybuffer_a;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_d;
  __Pyx_Buffer __pyx_pybuffer_d;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_deadline;
  __Pyx_Buffer __pyx_pybuffer_deadline;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_t;
  __Pyx_Buffer __pyx_pybuffer_t;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_vh;
  __Pyx_Buffer __pyx_pybuffer_vh;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_vl1;
  __Pyx_Buffer __pyx_pybuffer_vl1;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_vl2;
  __Pyx_Buffer __pyx_pybuffer_vl2;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_zh;
  __Pyx_Buffer __pyx_pybuffer_zh;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_zl1;
  __Pyx_Buffer __pyx_pybuffer_zl1;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_zl2;
  __Pyx_Buffer __pyx_pybuffer_zl2;
  PyObject *__pyx_r = NULL;
  __pyx_pybuffer_vh.pybuffer.buf = NULL;
  __pyx_pybuffer_vh.refcount = 0;
  __pyx_pybuffernd_vh.data = NULL;
  __pyx_pybuffernd_vh.rcbuffer = &amp;__pyx_pybuffer_vh;
  __pyx_pybuffer_vl1.pybuffer.buf = NULL;
  __pyx_pybuffer_vl1.refcount = 0;
  __pyx_pybuffernd_vl1.data = NULL;
  __pyx_pybuffernd_vl1.rcbuffer = &amp;__pyx_pybuffer_vl1;
  __pyx_pybuffer_vl2.pybuffer.buf = NULL;
  __pyx_pybuffer_vl2.refcount = 0;
  __pyx_pybuffernd_vl2.data = NULL;
  __pyx_pybuffernd_vl2.rcbuffer = &amp;__pyx_pybuffer_vl2;
  __pyx_pybuffer_a.pybuffer.buf = NULL;
  __pyx_pybuffer_a.refcount = 0;
  __pyx_pybuffernd_a.data = NULL;
  __pyx_pybuffernd_a.rcbuffer = &amp;__pyx_pybuffer_a;
  __pyx_pybuffer_zh.pybuffer.buf = NULL;
  __pyx_pybuffer_zh.refcount = 0;
  __pyx_pybuffernd_zh.data = NULL;
  __pyx_pybuffernd_zh.rcbuffer = &amp;__pyx_pybuffer_zh;
  __pyx_pybuffer_zl1.pybuffer.buf = NULL;
  __pyx_pybuffer_zl1.refcount = 0;
  __pyx_pybuffernd_zl1.data = NULL;
  __pyx_pybuffernd_zl1.rcbuffer = &amp;__pyx_pybuffer_zl1;
  __pyx_pybuffer_zl2.pybuffer.buf = NULL;
  __pyx_pybuffer_zl2.refcount = 0;
  __pyx_pybuffernd_zl2.data = NULL;
  __pyx_pybuffernd_zl2.rcbuffer = &amp;__pyx_pybuffer_zl2;
  __pyx_pybuffer_d.pybuffer.buf = NULL;
  __pyx_pybuffer_d.refcount = 0;
  __pyx_pybuffernd_d.data = NULL;
  __pyx_pybuffernd_d.rcbuffer = &amp;__pyx_pybuffer_d;
  __pyx_pybuffer_t.pybuffer.buf = NULL;
  __pyx_pybuffer_t.refcount = 0;
  __pyx_pybuffernd_t.data = NULL;
  __pyx_pybuffernd_t.rcbuffer = &amp;__pyx_pybuffer_t;
  __pyx_pybuffer_deadline.pybuffer.buf = NULL;
  __pyx_pybuffer_deadline.refcount = 0;
  __pyx_pybuffernd_deadline.data = NULL;
  __pyx_pybuffernd_deadline.rcbuffer = &amp;__pyx_pybuffer_deadline;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_vh, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_vh.diminfo[0].strides = __pyx_pybuffernd_vh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_vh.diminfo[0].shape = __pyx_pybuffernd_vh.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vl1.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_vl1, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_vl1.diminfo[0].strides = __pyx_pybuffernd_vl1.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_vl1.diminfo[0].shape = __pyx_pybuffernd_vl1.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_vl2.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_vl2, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_vl2.diminfo[0].strides = __pyx_pybuffernd_vl2.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_vl2.diminfo[0].shape = __pyx_pybuffernd_vl2.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_a, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_zh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_zh, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_zh.diminfo[0].strides = __pyx_pybuffernd_zh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_zh.diminfo[0].shape = __pyx_pybuffernd_zh.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_zl1.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_zl1, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_zl1.diminfo[0].strides = __pyx_pybuffernd_zl1.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_zl1.diminfo[0].shape = __pyx_pybuffernd_zl1.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_zl2.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_zl2, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_zl2.diminfo[0].strides = __pyx_pybuffernd_zl2.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_zl2.diminfo[0].shape = __pyx_pybuffernd_zl2.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_d.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_d, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_d.diminfo[0].strides = __pyx_pybuffernd_d.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_d.diminfo[0].shape = __pyx_pybuffernd_d.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_t, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_t.diminfo[0].strides = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_t.diminfo[0].shape = __pyx_pybuffernd_t.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_deadline, &amp;__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_deadline.diminfo[0].strides = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_deadline.diminfo[0].shape = __pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer.shape[0];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_2, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_7, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_d.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vh.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vl1.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vl2.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zh.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zl1.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zl2.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.ddm_flexbound_tradeoff", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_a.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_d.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_deadline.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vl1.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_vl2.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zh.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zl1.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_zl2.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_vh_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_vl1_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_vl2_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_a_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_zh_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_zl1_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_zl2_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_d_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_t_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_deadline_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_choices);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_rts_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_choices_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t_s);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_boundary);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_boundary_view, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_bias_trace);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_bias_trace_view, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_boundary_params_tmp);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_9genexpr15__pyx_v_key);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__66 = <span class='py_c_api'>PyTuple_Pack</span>(61, __pyx_n_s_vh, __pyx_n_s_vl1, __pyx_n_s_vl2, __pyx_n_s_a, __pyx_n_s_zh, __pyx_n_s_zl1, __pyx_n_s_zl2, __pyx_n_s_d, __pyx_n_s_t, __pyx_n_s_deadline, __pyx_n_s_s, __pyx_n_s_delta_t, __pyx_n_s_max_t, __pyx_n_s_n_samples, __pyx_n_s_n_trials, __pyx_n_s_print_info, __pyx_n_s_boundary_fun, __pyx_n_s_boundary_multiplicative, __pyx_n_s_boundary_params, __pyx_n_s_random_state, __pyx_n_s_return_option, __pyx_n_s_smooth, __pyx_n_s_kwargs, __pyx_n_s_vh_view, __pyx_n_s_vl1_view, __pyx_n_s_vl2_view, __pyx_n_s_a_view, __pyx_n_s_zh_view, __pyx_n_s_zl1_view, __pyx_n_s_zl2_view, __pyx_n_s_d_view, __pyx_n_s_t_view, __pyx_n_s_deadline_view, __pyx_n_s_rts, __pyx_n_s_choices, __pyx_n_s_rts_view, __pyx_n_s_choices_view, __pyx_n_s_delta_t_sqrt, __pyx_n_s_sqrt_st, __pyx_n_s_num_draws, __pyx_n_s_t_s, __pyx_n_s_boundary, __pyx_n_s_boundary_view, __pyx_n_s_bias_trace, __pyx_n_s_bias_trace_view, __pyx_n_s_y_h, __pyx_n_s_y_l, __pyx_n_s_v_l, __pyx_n_s_t_h, __pyx_n_s_t_l, __pyx_n_s_tmp_pos_dep, __pyx_n_s_smooth_u, __pyx_n_s_deadline_tmp, __pyx_n_s_n, __pyx_n_s_ix, __pyx_n_s_ix_tmp, __pyx_n_s_k, __pyx_n_s_m, __pyx_n_s_gaussian_values, __pyx_n_s_boundary_params_tmp, __pyx_n_s_key);<span class='error_goto'> if (unlikely(!__pyx_tuple__66)) __PYX_ERR(0, 4138, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__66);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__66);
/* … */
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_4cssm_45ddm_flexbound_tradeoff, 0, __pyx_n_s_ddm_flexbound_tradeoff, NULL, __pyx_n_s_cssm, __pyx_d, ((PyObject *)__pyx_codeobj__67));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4138, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (!<span class='pyx_c_api'>__Pyx_CyFunction_InitDefaults</span>(__pyx_t_5, sizeof(__pyx_defaults14), 1)) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">4139</span>:                            np.ndarray[float, ndim = 1] vl1,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4140</span>:                            np.ndarray[float, ndim = 1] vl2,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4141</span>:                            np.ndarray[float, ndim = 1] a,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4142</span>:                            np.ndarray[float, ndim = 1] zh,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4143</span>:                            np.ndarray[float, ndim = 1] zl1,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4144</span>:                            np.ndarray[float, ndim = 1] zl2,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4145</span>:                            np.ndarray[float, ndim = 1] d, # d for 'dampen' effect on drift parameter</pre>
<pre class="cython line score-0">&#xA0;<span class="">4146</span>:                            np.ndarray[float, ndim = 1] t,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4147</span>:                            np.ndarray[float, ndim = 1] deadline,</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4148</span>:                            float s = 1,</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)1.0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4148, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4149</span>:                            float delta_t = 0.001,</pre>
<pre class='cython code score-5 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(((double)0.001));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4149, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4150</span>:                            float max_t = 20,</pre>
<pre class='cython code score-5 '>  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(((float)20.0));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4150, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4151</span>:                            int n_samples = 20000,</pre>
<pre class='cython code score-2 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)0x4E20));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4151, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4152</span>:                            int n_trials = 1,</pre>
<pre class='cython code score-2 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(((int)1));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4152, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
</pre><pre class="cython line score-0">&#xA0;<span class="">4153</span>:                            print_info = True,</pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4154</span>:                            boundary_fun = None, # function of t (and potentially other parameters) that takes in (t, *args)</pre>
<pre class='cython code score-6 '>    values[16] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[17] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_True)));
    values[18] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(__pyx_dynamic_args-&gt;__pyx_arg_boundary_params);
</pre><pre class="cython line score-0">&#xA0;<span class="">4155</span>:                            boundary_multiplicative = True,</pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4156</span>:                            boundary_params = {},</pre>
<pre class='cython code score-12 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4156, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults14, __pyx_t_5)-&gt;__pyx_arg_boundary_params = __pyx_t_4;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_4 = 0;
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsGetter</span>(__pyx_t_5, __pyx_pf_4cssm_74__defaults__);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_ddm_flexbound_tradeoff, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-385" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4157</span>:                            random_state = None,</pre>
<pre class='cython code score-385 '>    values[19] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[20] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_full)));
    values[21] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case 22: values[21] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 21);
        CYTHON_FALLTHROUGH;
        case 21: values[20] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 20);
        CYTHON_FALLTHROUGH;
        case 20: values[19] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 19);
        CYTHON_FALLTHROUGH;
        case 19: values[18] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 18);
        CYTHON_FALLTHROUGH;
        case 18: values[17] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 17);
        CYTHON_FALLTHROUGH;
        case 17: values[16] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 16);
        CYTHON_FALLTHROUGH;
        case 16: values[15] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 15);
        CYTHON_FALLTHROUGH;
        case 15: values[14] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_vh)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_vl1)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_tradeoff", 0, 10, 22, 1); <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_vl2)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_tradeoff", 0, 10, 22, 2); <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_a)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[3]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_tradeoff", 0, 10, 22, 3); <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_zh)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[4]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_tradeoff", 0, 10, 22, 4); <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_zl1)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[5]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_tradeoff", 0, 10, 22, 5); <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_zl2)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[6]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_tradeoff", 0, 10, 22, 6); <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (likely((values[7] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_d)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[7]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_tradeoff", 0, 10, 22, 7); <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (likely((values[8] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_t)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[8]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_tradeoff", 0, 10, 22, 8); <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  9:
        if (likely((values[9] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_deadline)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[9]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_tradeoff", 0, 10, 22, 9); <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 10:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_s);
          if (value) { values[10] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 11:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_delta_t);
          if (value) { values[11] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 12:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_max_t);
          if (value) { values[12] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 13:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_samples);
          if (value) { values[13] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 14:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_trials);
          if (value) { values[14] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 15:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_print_info);
          if (value) { values[15] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 16:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_fun);
          if (value) { values[16] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 17:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_multiplicative);
          if (value) { values[17] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 18:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_boundary_params);
          if (value) { values[18] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 19:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_random_state);
          if (value) { values[19] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 20:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_return_option);
          if (value) { values[20] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 21:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_smooth);
          if (value) { values[21] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values + 0, kwd_pos_args, "ddm_flexbound_tradeoff") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case 22: values[21] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 21);
        CYTHON_FALLTHROUGH;
        case 21: values[20] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 20);
        CYTHON_FALLTHROUGH;
        case 20: values[19] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 19);
        CYTHON_FALLTHROUGH;
        case 19: values[18] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 18);
        CYTHON_FALLTHROUGH;
        case 18: values[17] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 17);
        CYTHON_FALLTHROUGH;
        case 17: values[16] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 16);
        CYTHON_FALLTHROUGH;
        case 16: values[15] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 15);
        CYTHON_FALLTHROUGH;
        case 15: values[14] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_vh = ((PyArrayObject *)values[0]);
    __pyx_v_vl1 = ((PyArrayObject *)values[1]);
    __pyx_v_vl2 = ((PyArrayObject *)values[2]);
    __pyx_v_a = ((PyArrayObject *)values[3]);
    __pyx_v_zh = ((PyArrayObject *)values[4]);
    __pyx_v_zl1 = ((PyArrayObject *)values[5]);
    __pyx_v_zl2 = ((PyArrayObject *)values[6]);
    __pyx_v_d = ((PyArrayObject *)values[7]);
    __pyx_v_t = ((PyArrayObject *)values[8]);
    __pyx_v_deadline = ((PyArrayObject *)values[9]);
    if (values[10]) {
      __pyx_v_s = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[10]); if (unlikely((__pyx_v_s == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4148, __pyx_L3_error)</span>
    } else {
      __pyx_v_s = ((float)((float)1.0));
    }
    if (values[11]) {
      __pyx_v_delta_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[11]); if (unlikely((__pyx_v_delta_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4149, __pyx_L3_error)</span>
    } else {
      __pyx_v_delta_t = ((float)((double)0.001));
    }
    if (values[12]) {
      __pyx_v_max_t = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[12]); if (unlikely((__pyx_v_max_t == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4150, __pyx_L3_error)</span>
    } else {
      __pyx_v_max_t = ((float)((float)20.0));
    }
    if (values[13]) {
      __pyx_v_n_samples = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[13]); if (unlikely((__pyx_v_n_samples == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4151, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_samples = ((int)((int)0x4E20));
    }
    if (values[14]) {
      __pyx_v_n_trials = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[14]); if (unlikely((__pyx_v_n_trials == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4152, __pyx_L3_error)</span>
    } else {
      __pyx_v_n_trials = ((int)((int)1));
    }
    __pyx_v_print_info = values[15];
    __pyx_v_boundary_fun = values[16];
    __pyx_v_boundary_multiplicative = values[17];
    __pyx_v_boundary_params = values[18];
    __pyx_v_random_state = values[19];
    __pyx_v_return_option = values[20];
    __pyx_v_smooth = values[21];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ddm_flexbound_tradeoff", 0, 10, 22, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("cssm.ddm_flexbound_tradeoff", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_vh), __pyx_ptype_5numpy_ndarray, 1, "vh", 0))) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_vl1), __pyx_ptype_5numpy_ndarray, 1, "vl1", 0))) <span class='error_goto'>__PYX_ERR(0, 4139, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_vl2), __pyx_ptype_5numpy_ndarray, 1, "vl2", 0))) <span class='error_goto'>__PYX_ERR(0, 4140, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_a), __pyx_ptype_5numpy_ndarray, 1, "a", 0))) <span class='error_goto'>__PYX_ERR(0, 4141, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_zh), __pyx_ptype_5numpy_ndarray, 1, "zh", 0))) <span class='error_goto'>__PYX_ERR(0, 4142, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_zl1), __pyx_ptype_5numpy_ndarray, 1, "zl1", 0))) <span class='error_goto'>__PYX_ERR(0, 4143, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_zl2), __pyx_ptype_5numpy_ndarray, 1, "zl2", 0))) <span class='error_goto'>__PYX_ERR(0, 4144, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_d), __pyx_ptype_5numpy_ndarray, 1, "d", 0))) <span class='error_goto'>__PYX_ERR(0, 4145, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_t), __pyx_ptype_5numpy_ndarray, 1, "t", 0))) <span class='error_goto'>__PYX_ERR(0, 4146, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_deadline), __pyx_ptype_5numpy_ndarray, 1, "deadline", 0))) <span class='error_goto'>__PYX_ERR(0, 4147, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_4cssm_44ddm_flexbound_tradeoff(__pyx_self, __pyx_v_vh, __pyx_v_vl1, __pyx_v_vl2, __pyx_v_a, __pyx_v_zh, __pyx_v_zl1, __pyx_v_zl2, __pyx_v_d, __pyx_v_t, __pyx_v_deadline, __pyx_v_s, __pyx_v_delta_t, __pyx_v_max_t, __pyx_v_n_samples, __pyx_v_n_trials, __pyx_v_print_info, __pyx_v_boundary_fun, __pyx_v_boundary_multiplicative, __pyx_v_boundary_params, __pyx_v_random_state, __pyx_v_return_option, __pyx_v_smooth, __pyx_v_kwargs);
</pre><pre class="cython line score-0">&#xA0;<span class="">4158</span>:                            return_option = 'full',</pre>
<pre class="cython line score-0">&#xA0;<span class="">4159</span>:                            smooth = False,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4160</span>:                            **kwargs):</pre>
<pre class="cython line score-0">&#xA0;<span class="">4161</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4162</span>:     set_seed(random_state)</pre>
<pre class='cython code score-1 '>  __pyx_t_1 = __pyx_f_4cssm_set_seed(__pyx_v_random_state);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4162, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4163</span>:     # Param views</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4164</span>:     cdef float[:] vh_view = vh</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_vh), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 4164, __pyx_L1_error)</span>
  __pyx_v_vh_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4165</span>:     cdef float[:] vl1_view = vl1</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_vl1), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 4165, __pyx_L1_error)</span>
  __pyx_v_vl1_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4166</span>:     cdef float[:] vl2_view = vl2</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_vl2), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 4166, __pyx_L1_error)</span>
  __pyx_v_vl2_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4167</span>:     cdef float[:] a_view = a</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_a), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 4167, __pyx_L1_error)</span>
  __pyx_v_a_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4168</span>:     cdef float[:] zh_view = zh</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_zh), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 4168, __pyx_L1_error)</span>
  __pyx_v_zh_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4169</span>:     cdef float[:] zl1_view = zl1</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_zl1), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 4169, __pyx_L1_error)</span>
  __pyx_v_zl1_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4170</span>:     cdef float[:] zl2_view = zl2</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_zl2), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 4170, __pyx_L1_error)</span>
  __pyx_v_zl2_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4171</span>:     cdef float[:] d_view = d</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_d), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 4171, __pyx_L1_error)</span>
  __pyx_v_d_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4172</span>:     cdef float[:] t_view = t</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_t), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 4172, __pyx_L1_error)</span>
  __pyx_v_t_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4173</span>:     cdef float[:] deadline_view = deadline</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(((PyObject *)__pyx_v_deadline), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 4173, __pyx_L1_error)</span>
  __pyx_v_deadline_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">4174</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4175</span>:     # TD: Add trajectory --&gt; same issue as with par2 model above... might need to make a separate simulator for trajectories</pre>
<pre class="cython line score-0">&#xA0;<span class="">4176</span>: </pre>
<pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4177</span>:     rts = np.zeros((n_samples, n_trials, 1), dtype = DTYPE)</pre>
<pre class='cython code score-43 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4177, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4177, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4177, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4177, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4177, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4177, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 4177, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 4177, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4177, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 4177, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4177, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4177, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4177, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4177, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_rts = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4178</span>:     choices = np.zeros((n_samples, n_trials, 1), dtype = np.intc)</pre>
<pre class='cython code score-46 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4178, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4178, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4178, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4178, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4178, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4178, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 4178, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 4178, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4178, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 4178, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4178, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4178, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_intc);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4178, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4178, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4178, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_choices = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4179</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4180</span>:     cdef float[:, :, :] rts_view = rts</pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_float</span>(__pyx_v_rts, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 4180, __pyx_L1_error)</span>
  __pyx_v_rts_view = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4181</span>:     cdef int[:, :, :] choices_view = choices</pre>
<pre class='cython code score-2 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_int</span>(__pyx_v_choices, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 4181, __pyx_L1_error)</span>
  __pyx_v_choices_view = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">4182</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4183</span>:     cdef float delta_t_sqrt = sqrt(delta_t) # correct scalar so we can use standard normal samples for the brownian motion</pre>
<pre class='cython code score-0 '>  __pyx_v_delta_t_sqrt = sqrt(__pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4184</span>:     cdef float sqrt_st = delta_t_sqrt * s # scalar to ensure the correct variance for the gaussian step</pre>
<pre class='cython code score-0 '>  __pyx_v_sqrt_st = (__pyx_v_delta_t_sqrt * __pyx_v_s);
</pre><pre class="cython line score-0">&#xA0;<span class="">4185</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4186</span>:     # Boundary storage for the upper bound</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4187</span>:     cdef int num_draws = int((max_t / delta_t) + 1)</pre>
<pre class='cython code score-0 '>  __pyx_v_num_draws = ((int)((__pyx_v_max_t / __pyx_v_delta_t) + 1.0));
</pre><pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4188</span>:     t_s = np.arange(0, max_t + delta_t, delta_t).astype(DTYPE)</pre>
<pre class='cython code score-51 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4188, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4188, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_max_t + __pyx_v_delta_t));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4188, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_t);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4188, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_9 = NULL;
  __pyx_t_10 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_9)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      __pyx_t_10 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[4] = {__pyx_t_9, __pyx_int_0, __pyx_t_4, __pyx_t_1};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_10, 3+__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 4188, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4188, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4188, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = NULL;
  __pyx_t_10 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      __pyx_t_10 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_3};
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_10, 1+__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 4188, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  __pyx_v_t_s = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4189</span>:     boundary = np.zeros(t_s.shape, dtype = DTYPE)</pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4189, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4189, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_t_s, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4189, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4189, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 4189, __pyx_L1_error)</span>;
  __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4189, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4189, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4189, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_3, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4189, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_boundary = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4190</span>:     cdef float[:] boundary_view = boundary</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(__pyx_v_boundary, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 4190, __pyx_L1_error)</span>
  __pyx_v_boundary_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">4191</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4192</span>:     # Y particle trace</pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4193</span>:     bias_trace = np.zeros(num_draws, dtype = DTYPE)</pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4193, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4193, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4193, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4193, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4193, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4193, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4193, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4193, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4193, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_bias_trace = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4194</span>:     cdef float[:] bias_trace_view = bias_trace</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_float</span>(__pyx_v_bias_trace, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 4194, __pyx_L1_error)</span>
  __pyx_v_bias_trace_view = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">4195</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4196</span>:     cdef float y_h, y_l, v_l, t_h, t_l, tmp_pos_dep, smooth_u, deadline_tmp</pre>
<pre class="cython line score-0">&#xA0;<span class="">4197</span>:     cdef Py_ssize_t n, ix, ix_tmp, k</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4198</span>:     cdef Py_ssize_t m = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_m = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4199</span>:     cdef float[:] gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 4199, __pyx_L1_error)</span>
  __pyx_v_gaussian_values = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">4200</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4201</span>:     for k in range(n_trials):</pre>
<pre class='cython code score-0 '>  __pyx_t_10 = __pyx_v_n_trials;
  __pyx_t_11 = __pyx_t_10;
  for (__pyx_t_12 = 0; __pyx_t_12 &lt; __pyx_t_11; __pyx_t_12+=1) {
    __pyx_v_k = __pyx_t_12;
</pre><pre class="cython line score-0">&#xA0;<span class="">4202</span>:         # Precompute boundary evaluations</pre>
<pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4203</span>:         boundary_params_tmp = {key: boundary_params[key][k] for key in boundary_params.keys()}</pre>
<pre class='cython code score-27 '>    { /* enter inner scope */
      __pyx_t_5 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4203, __pyx_L7_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_13 = 0;
      if (unlikely(__pyx_v_boundary_params == Py_None)) {
        <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "keys");
        <span class='error_goto'>__PYX_ERR(0, 4203, __pyx_L7_error)</span>
      }
      __pyx_t_3 = __Pyx_dict_iterator(__pyx_v_boundary_params, 0, __pyx_n_s_keys, (&amp;__pyx_t_14), (&amp;__pyx_t_15));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4203, __pyx_L7_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
      __pyx_t_1 = __pyx_t_3;
      __pyx_t_3 = 0;
      while (1) {
        __pyx_t_16 = __Pyx_dict_iter_next(__pyx_t_1, __pyx_t_14, &amp;__pyx_t_13, &amp;__pyx_t_3, NULL, NULL, __pyx_t_15);
        if (unlikely(__pyx_t_16 == 0)) break;
        if (unlikely(__pyx_t_16 == -1)) <span class='error_goto'>__PYX_ERR(0, 4203, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_9genexpr15__pyx_v_key, __pyx_t_3);
        __pyx_t_3 = 0;
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_boundary_params, __pyx_9genexpr15__pyx_v_key);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4203, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, __pyx_v_k, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4203, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, (PyObject*)__pyx_9genexpr15__pyx_v_key, (PyObject*)__pyx_t_6))) <span class='error_goto'>__PYX_ERR(0, 4203, __pyx_L7_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_9genexpr15__pyx_v_key); __pyx_9genexpr15__pyx_v_key = 0;
      goto __pyx_L10_exit_scope;
      __pyx_L7_error:;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_9genexpr15__pyx_v_key); __pyx_9genexpr15__pyx_v_key = 0;
      goto __pyx_L1_error;
      __pyx_L10_exit_scope:;
    } /* exit inner scope */
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_boundary_params_tmp, ((PyObject*)__pyx_t_5));
    __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4204</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4205</span>:         # Precompute boundary evaluations</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4206</span>:         if boundary_multiplicative:</pre>
<pre class='cython code score-2 '>    __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_boundary_multiplicative); if (unlikely((__pyx_t_17 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4206, __pyx_L1_error)</span>
    if (__pyx_t_17) {
/* … */
      goto __pyx_L11;
    }
</pre><pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4207</span>:             boundary[:] = np.multiply(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)</pre>
<pre class='cython code score-61 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4207, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_multiply);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4207, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_18 = __pyx_v_k;
      __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_18 * __pyx_v_a_view.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4207, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 4207, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_s_t, __pyx_v_t_s) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4207, __pyx_L1_error)</span>
      __pyx_t_4 = __pyx_t_9;
      __pyx_t_9 = 0;
      if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_4, __pyx_v_boundary_params_tmp) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4207, __pyx_L1_error)</span>
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 4207, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = NULL;
      __pyx_t_15 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          __pyx_t_15 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_4, __pyx_t_6, __pyx_t_9};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_15, 2+__pyx_t_15);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4207, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      }
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4207, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4207, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_9 = NULL;
      __pyx_t_15 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_9)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          __pyx_t_15 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_9, __pyx_t_1};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_15, 1+__pyx_t_15);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 4207, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      }
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_boundary, __pyx_t_5, 0, 0, NULL, NULL, &amp;__pyx_slice__5, 0, 0, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4207, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4208</span>:         else:</pre>
<pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4209</span>:             boundary[:] = np.add(a_view[k], boundary_fun(t = t_s, **boundary_params_tmp)).astype(DTYPE)</pre>
<pre class='cython code score-61 '>    /*else*/ {
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4209, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_add);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 4209, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_18 = __pyx_v_k;
      __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((float *) ( /* dim=0 */ (__pyx_v_a_view.data + __pyx_t_18 * __pyx_v_a_view.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4209, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4209, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_t, __pyx_v_t_s) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4209, __pyx_L1_error)</span>
      __pyx_t_6 = __pyx_t_4;
      __pyx_t_4 = 0;
      if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_6, __pyx_v_boundary_params_tmp) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4209, __pyx_L1_error)</span>
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_boundary_fun, __pyx_empty_tuple, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4209, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_6 = NULL;
      __pyx_t_15 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
        __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
        if (likely(__pyx_t_6)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
          __pyx_t_15 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_6, __pyx_t_1, __pyx_t_4};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+1-__pyx_t_15, 2+__pyx_t_15);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 4209, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      }
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 4209, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4209, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_4 = NULL;
      __pyx_t_15 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
          __pyx_t_15 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_3};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+1-__pyx_t_15, 1+__pyx_t_15);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 4209, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      }
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_boundary, __pyx_t_5, 0, 0, NULL, NULL, &amp;__pyx_slice__5, 0, 0, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4209, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
    __pyx_L11:;
</pre><pre class="cython line score-0">&#xA0;<span class="">4210</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4211</span>:         deadline_tmp = min(max_t, deadline_view[k] - t_view[k])</pre>
<pre class='cython code score-0 '>    __pyx_t_18 = __pyx_v_k;
    __pyx_t_19 = __pyx_v_k;
    __pyx_t_20 = ((*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_18 * __pyx_v_deadline_view.strides[0]) ))) - (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_19 * __pyx_v_t_view.strides[0]) ))));
    __pyx_t_21 = __pyx_v_max_t;
    __pyx_t_17 = (__pyx_t_20 &lt; __pyx_t_21);
    if (__pyx_t_17) {
      __pyx_t_22 = __pyx_t_20;
    } else {
      __pyx_t_22 = __pyx_t_21;
    }
    __pyx_v_deadline_tmp = __pyx_t_22;
</pre><pre class="cython line score-0">&#xA0;<span class="">4212</span>:         # Loop over samples</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4213</span>:         for n in range(n_samples):</pre>
<pre class='cython code score-0 '>    __pyx_t_15 = __pyx_v_n_samples;
    __pyx_t_16 = __pyx_t_15;
    for (__pyx_t_14 = 0; __pyx_t_14 &lt; __pyx_t_16; __pyx_t_14+=1) {
      __pyx_v_n = __pyx_t_14;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4214</span>:             choices_view[n, k, 0] = 0 # reset choice</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = __pyx_v_n;
      __pyx_t_18 = __pyx_v_k;
      __pyx_t_23 = 0;
      *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_19 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_18 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_23 * __pyx_v_choices_view.strides[2]) )) = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4215</span>:             t_h = 0 # reset time high dimension</pre>
<pre class='cython code score-0 '>      __pyx_v_t_h = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4216</span>:             t_l = 0 # reset time low dimension</pre>
<pre class='cython code score-0 '>      __pyx_v_t_l = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4217</span>:             ix = 0 # reset boundary index</pre>
<pre class='cython code score-0 '>      __pyx_v_ix = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4218</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4219</span>:             # Initialize walkers</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4220</span>:             y_h = (-1) * boundary_view[0] + (zh_view[k] * 2 * (boundary_view[0]))</pre>
<pre class='cython code score-0 '>      __pyx_t_23 = 0;
      __pyx_t_18 = __pyx_v_k;
      __pyx_t_19 = 0;
      __pyx_v_y_h = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_23 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_zh_view.data + __pyx_t_18 * __pyx_v_zh_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4221</span>:             bias_trace_view[0] = ((y_h + boundary_view[0]) / (2 * boundary_view[0]))</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = 0;
      __pyx_t_18 = 0;
      __pyx_t_23 = 0;
      *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_view.data + __pyx_t_23 * __pyx_v_bias_trace_view.strides[0]) )) = ((__pyx_v_y_h + (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))) / (2.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_18 * __pyx_v_boundary_view.strides[0]) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">4222</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4223</span>:             # Random walks until y_h hits bound</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4224</span>:             while (y_h &gt;= ((-1) * boundary_view[ix])) and ((y_h &lt;= boundary_view[ix])) and (t_h &lt;= deadline_tmp):</pre>
<pre class='cython code score-0 '>      while (1) {
        __pyx_t_18 = __pyx_v_ix;
        __pyx_t_24 = (__pyx_v_y_h &gt;= (-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_18 * __pyx_v_boundary_view.strides[0]) )))));
        if (__pyx_t_24) {
        } else {
          __pyx_t_17 = __pyx_t_24;
          goto __pyx_L16_bool_binop_done;
        }
        __pyx_t_18 = __pyx_v_ix;
        __pyx_t_24 = (__pyx_v_y_h &lt;= (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_18 * __pyx_v_boundary_view.strides[0]) ))));
        if (__pyx_t_24) {
        } else {
          __pyx_t_17 = __pyx_t_24;
          goto __pyx_L16_bool_binop_done;
        }
        __pyx_t_24 = (__pyx_v_t_h &lt;= __pyx_v_deadline_tmp);
        __pyx_t_17 = __pyx_t_24;
        __pyx_L16_bool_binop_done:;
        if (!__pyx_t_17) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4225</span>:                 y_h += (vh_view[k] * delta_t) + (sqrt_st * gaussian_values[m])</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = __pyx_v_k;
        __pyx_t_19 = __pyx_v_m;
        __pyx_v_y_h = (__pyx_v_y_h + (((*((float *) ( /* dim=0 */ (__pyx_v_vh_view.data + __pyx_t_18 * __pyx_v_vh_view.strides[0]) ))) * __pyx_v_delta_t) + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_19 * __pyx_v_gaussian_values.strides[0]) ))))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4226</span>:                 bias_trace_view[ix] = ((y_h + boundary_view[ix]) / (2 * boundary_view[ix]))</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = __pyx_v_ix;
        __pyx_t_18 = __pyx_v_ix;
        __pyx_t_23 = __pyx_v_ix;
        *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_view.data + __pyx_t_23 * __pyx_v_bias_trace_view.strides[0]) )) = ((__pyx_v_y_h + (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))) / (2.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_18 * __pyx_v_boundary_view.strides[0]) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4227</span>:                 t_h += delta_t</pre>
<pre class='cython code score-0 '>        __pyx_v_t_h = (__pyx_v_t_h + __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4228</span>:                 ix += 1</pre>
<pre class='cython code score-0 '>        __pyx_v_ix = (__pyx_v_ix + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4229</span>:                 m += 1</pre>
<pre class='cython code score-0 '>        __pyx_v_m = (__pyx_v_m + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4230</span>:                 if m == num_draws:</pre>
<pre class='cython code score-0 '>        __pyx_t_17 = (__pyx_v_m == __pyx_v_num_draws);
        if (__pyx_t_17) {
/* … */
        }
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4231</span>:                     gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 4231, __pyx_L1_error)</span>
          __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
          __pyx_v_gaussian_values = __pyx_t_2;
          __pyx_t_2.memview = NULL;
          __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4232</span>:                     m = 0</pre>
<pre class='cython code score-0 '>          __pyx_v_m = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4233</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4234</span>:             # The probability of making a 'mistake' 1 - (relative y position)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4235</span>:             # y at upper bound --&gt; choices_view[n, k, 0] add 2 deterministically</pre>
<pre class="cython line score-0">&#xA0;<span class="">4236</span>:             # y at lower bound --&gt; choice_view[n, k, 0] stay the same deterministically</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4237</span>:             if random_uniform() &lt;= ((y_h + boundary_view[ix]) / (2 * boundary_view[ix])):</pre>
<pre class='cython code score-5 '>      __pyx_t_22 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_22 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4237, __pyx_L1_error)</span>
      __pyx_t_18 = __pyx_v_ix;
      __pyx_t_19 = __pyx_v_ix;
      __pyx_t_17 = (__pyx_t_22 &lt;= ((__pyx_v_y_h + (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_18 * __pyx_v_boundary_view.strides[0]) )))) / (2.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) ))))));
      if (__pyx_t_17) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4238</span>:                 choices_view[n, k, 0] += 2</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = __pyx_v_n;
        __pyx_t_18 = __pyx_v_k;
        __pyx_t_23 = 0;
        *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_19 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_18 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_23 * __pyx_v_choices_view.strides[2]) )) += 2;
</pre><pre class="cython line score-0">&#xA0;<span class="">4239</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4240</span>:             if choices_view[n, k, 0] == 2:</pre>
<pre class='cython code score-0 '>      __pyx_t_23 = __pyx_v_n;
      __pyx_t_18 = __pyx_v_k;
      __pyx_t_19 = 0;
      __pyx_t_17 = ((*((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_23 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_18 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[2]) ))) == 2);
      if (__pyx_t_17) {
/* … */
        goto __pyx_L21;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4241</span>:                 y_l = (- 1) * boundary_view[0] + (zl2_view[k] * 2 * (boundary_view[0]))</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = 0;
        __pyx_t_18 = __pyx_v_k;
        __pyx_t_23 = 0;
        __pyx_v_y_l = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_zl2_view.data + __pyx_t_18 * __pyx_v_zl2_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_23 * __pyx_v_boundary_view.strides[0]) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4242</span>:                 v_l = vl2_view[k]</pre>
<pre class='cython code score-0 '>        __pyx_t_23 = __pyx_v_k;
        __pyx_v_v_l = (*((float *) ( /* dim=0 */ (__pyx_v_vl2_view.data + __pyx_t_23 * __pyx_v_vl2_view.strides[0]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">4243</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4244</span>:                 # Fill bias trace until max_rt reached</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4245</span>:                 ix_tmp = ix + 1</pre>
<pre class='cython code score-0 '>        __pyx_v_ix_tmp = (__pyx_v_ix + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4246</span>:                 while ix_tmp &lt; num_draws:</pre>
<pre class='cython code score-0 '>        while (1) {
          __pyx_t_17 = (__pyx_v_ix_tmp &lt; __pyx_v_num_draws);
          if (!__pyx_t_17) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4247</span>:                     bias_trace_view[ix_tmp] = 1.0</pre>
<pre class='cython code score-0 '>          __pyx_t_23 = __pyx_v_ix_tmp;
          *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_view.data + __pyx_t_23 * __pyx_v_bias_trace_view.strides[0]) )) = 1.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4248</span>:                     ix_tmp += 1</pre>
<pre class='cython code score-0 '>          __pyx_v_ix_tmp = (__pyx_v_ix_tmp + 1);
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">4249</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4250</span>:             else: # Store intermediate choice</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4251</span>:                 y_l = (- 1) * boundary_view[0] + (zl1_view[k] * 2 * (boundary_view[0]))</pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_t_23 = 0;
        __pyx_t_18 = __pyx_v_k;
        __pyx_t_19 = 0;
        __pyx_v_y_l = ((-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_23 * __pyx_v_boundary_view.strides[0]) )))) + (((*((float *) ( /* dim=0 */ (__pyx_v_zl1_view.data + __pyx_t_18 * __pyx_v_zl1_view.strides[0]) ))) * 2.0) * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4252</span>:                 v_l = vl1_view[k]</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = __pyx_v_k;
        __pyx_v_v_l = (*((float *) ( /* dim=0 */ (__pyx_v_vl1_view.data + __pyx_t_19 * __pyx_v_vl1_view.strides[0]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">4253</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4254</span>:                 # Fill bias trace until max_rt reached</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4255</span>:                 ix_tmp = ix + 1</pre>
<pre class='cython code score-0 '>        __pyx_v_ix_tmp = (__pyx_v_ix + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4256</span>:                 while ix_tmp &lt; num_draws:</pre>
<pre class='cython code score-0 '>        while (1) {
          __pyx_t_17 = (__pyx_v_ix_tmp &lt; __pyx_v_num_draws);
          if (!__pyx_t_17) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4257</span>:                     bias_trace_view[ix_tmp] = 0.0</pre>
<pre class='cython code score-0 '>          __pyx_t_19 = __pyx_v_ix_tmp;
          *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_view.data + __pyx_t_19 * __pyx_v_bias_trace_view.strides[0]) )) = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4258</span>:                     ix_tmp += 1</pre>
<pre class='cython code score-0 '>          __pyx_v_ix_tmp = (__pyx_v_ix_tmp + 1);
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">4259</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4260</span>:                 #We need to reverse the bias_trace if we took the lower choice</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4261</span>:                 ix_tmp = 0</pre>
<pre class='cython code score-0 '>        __pyx_v_ix_tmp = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4262</span>:                 while ix_tmp &lt; num_draws:</pre>
<pre class='cython code score-0 '>        while (1) {
          __pyx_t_17 = (__pyx_v_ix_tmp &lt; __pyx_v_num_draws);
          if (!__pyx_t_17) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4263</span>:                     bias_trace_view[ix_tmp] = 1.0 - bias_trace_view[ix_tmp]</pre>
<pre class='cython code score-0 '>          __pyx_t_19 = __pyx_v_ix_tmp;
          __pyx_t_18 = __pyx_v_ix_tmp;
          *((float *) ( /* dim=0 */ (__pyx_v_bias_trace_view.data + __pyx_t_18 * __pyx_v_bias_trace_view.strides[0]) )) = (1.0 - (*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_view.data + __pyx_t_19 * __pyx_v_bias_trace_view.strides[0]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4264</span>:                     ix_tmp += 1</pre>
<pre class='cython code score-0 '>          __pyx_v_ix_tmp = (__pyx_v_ix_tmp + 1);
        }
      }
      __pyx_L21:;
</pre><pre class="cython line score-0">&#xA0;<span class="">4265</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4266</span>:                 #print('new bias_trace: ', bias_trace)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4267</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4268</span>:             # Random walks until the y_l corresponding to y_h hits bound</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4269</span>:             ix = 0</pre>
<pre class='cython code score-0 '>      __pyx_v_ix = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4270</span>:             while (y_l &gt;= ((-1) * boundary_view[ix])) and (y_l &lt;= boundary_view[ix]) and (t_l &lt;= deadline_tmp):</pre>
<pre class='cython code score-0 '>      while (1) {
        __pyx_t_19 = __pyx_v_ix;
        __pyx_t_24 = (__pyx_v_y_l &gt;= (-1.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) )))));
        if (__pyx_t_24) {
        } else {
          __pyx_t_17 = __pyx_t_24;
          goto __pyx_L30_bool_binop_done;
        }
        __pyx_t_19 = __pyx_v_ix;
        __pyx_t_24 = (__pyx_v_y_l &lt;= (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_19 * __pyx_v_boundary_view.strides[0]) ))));
        if (__pyx_t_24) {
        } else {
          __pyx_t_17 = __pyx_t_24;
          goto __pyx_L30_bool_binop_done;
        }
        __pyx_t_24 = (__pyx_v_t_l &lt;= __pyx_v_deadline_tmp);
        __pyx_t_17 = __pyx_t_24;
        __pyx_L30_bool_binop_done:;
        if (!__pyx_t_17) break;
</pre><pre class="cython line score-0">&#xA0;<span class="">4271</span>:                 # Compute local position dependence</pre>
<pre class="cython line score-0">&#xA0;<span class="">4272</span>:                 # AF-todo: can't understand what the idea here is anymore</pre>
<pre class="cython line score-0">&#xA0;<span class="">4273</span>:                 # especially why bias_trace_view is flipped (-1) here</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4274</span>:                 tmp_pos_dep = (1 + (d_view[k] * (bias_trace_view[ix] - 1.0))) / (2 - d_view[k])</pre>
<pre class='cython code score-0 '>        __pyx_t_19 = __pyx_v_k;
        __pyx_t_18 = __pyx_v_ix;
        __pyx_t_23 = __pyx_v_k;
        __pyx_v_tmp_pos_dep = ((1.0 + ((*((float *) ( /* dim=0 */ (__pyx_v_d_view.data + __pyx_t_19 * __pyx_v_d_view.strides[0]) ))) * ((*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_view.data + __pyx_t_18 * __pyx_v_bias_trace_view.strides[0]) ))) - 1.0))) / ((double)(2.0 - (*((float *) ( /* dim=0 */ (__pyx_v_d_view.data + __pyx_t_23 * __pyx_v_d_view.strides[0]) ))))));
</pre><pre class="cython line score-0">&#xA0;<span class="">4275</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4276</span>:                 if (bias_trace_view[ix] &lt; 1) and (bias_trace_view[ix] &gt; 0):</pre>
<pre class='cython code score-0 '>        __pyx_t_23 = __pyx_v_ix;
        __pyx_t_24 = ((*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_view.data + __pyx_t_23 * __pyx_v_bias_trace_view.strides[0]) ))) &lt; 1.0);
        if (__pyx_t_24) {
        } else {
          __pyx_t_17 = __pyx_t_24;
          goto __pyx_L34_bool_binop_done;
        }
        __pyx_t_23 = __pyx_v_ix;
        __pyx_t_24 = ((*((float *) ( /* dim=0 */ (__pyx_v_bias_trace_view.data + __pyx_t_23 * __pyx_v_bias_trace_view.strides[0]) ))) &gt; 0.0);
        __pyx_t_17 = __pyx_t_24;
        __pyx_L34_bool_binop_done:;
        if (__pyx_t_17) {
/* … */
          goto __pyx_L33;
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">4277</span>:                     # Before high-dim choice is taken</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4278</span>:                     y_l += tmp_pos_dep * (v_l * delta_t) # Add drift</pre>
<pre class='cython code score-0 '>          __pyx_v_y_l = (__pyx_v_y_l + (__pyx_v_tmp_pos_dep * (__pyx_v_v_l * __pyx_v_delta_t)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4279</span>:                     y_l += tmp_pos_dep * sqrt_st * gaussian_values[m] # Add noise</pre>
<pre class='cython code score-0 '>          __pyx_t_23 = __pyx_v_m;
          __pyx_v_y_l = (__pyx_v_y_l + ((__pyx_v_tmp_pos_dep * __pyx_v_sqrt_st) * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_23 * __pyx_v_gaussian_values.strides[0]) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">4280</span>:                 else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">4281</span>:                     # After high-dim choice is taken</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4282</span>:                     y_l += (v_l * delta_t) # Add drift</pre>
<pre class='cython code score-0 '>        /*else*/ {
          __pyx_v_y_l = (__pyx_v_y_l + (__pyx_v_v_l * __pyx_v_delta_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4283</span>:                     y_l += sqrt_st * gaussian_values[m] # Add noise</pre>
<pre class='cython code score-0 '>          __pyx_t_23 = __pyx_v_m;
          __pyx_v_y_l = (__pyx_v_y_l + (__pyx_v_sqrt_st * (*((float *) ( /* dim=0 */ (__pyx_v_gaussian_values.data + __pyx_t_23 * __pyx_v_gaussian_values.strides[0]) )))));
        }
        __pyx_L33:;
</pre><pre class="cython line score-0">&#xA0;<span class="">4284</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4285</span>:                 t_l += delta_t # update time for low_dim choice</pre>
<pre class='cython code score-0 '>        __pyx_v_t_l = (__pyx_v_t_l + __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4286</span>:                 ix += 1 # update time index</pre>
<pre class='cython code score-0 '>        __pyx_v_ix = (__pyx_v_ix + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4287</span>:                 m += 1 # update rv couter</pre>
<pre class='cython code score-0 '>        __pyx_v_m = (__pyx_v_m + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">4288</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4289</span>:                 if m == num_draws:</pre>
<pre class='cython code score-0 '>        __pyx_t_17 = (__pyx_v_m == __pyx_v_num_draws);
        if (__pyx_t_17) {
/* … */
        }
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4290</span>:                     gaussian_values = draw_gaussian(num_draws)</pre>
<pre class='cython code score-0 '>          __pyx_t_2 = __pyx_f_4cssm_draw_gaussian(__pyx_v_num_draws);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 4290, __pyx_L1_error)</span>
          __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_gaussian_values, 1);
          __pyx_v_gaussian_values = __pyx_t_2;
          __pyx_t_2.memview = NULL;
          __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4291</span>:                     m = 0</pre>
<pre class='cython code score-0 '>          __pyx_v_m = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4292</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4293</span>:             if smooth:</pre>
<pre class='cython code score-2 '>      __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_smooth); if (unlikely((__pyx_t_17 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4293, __pyx_L1_error)</span>
      if (__pyx_t_17) {
/* … */
        goto __pyx_L37;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4294</span>:                 if t_h == 0.0:</pre>
<pre class='cython code score-0 '>        __pyx_t_17 = (__pyx_v_t_h == 0.0);
        if (__pyx_t_17) {
/* … */
          goto __pyx_L38;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4295</span>:                     smooth_u = random_uniform() * 0.5 * delta_t</pre>
<pre class='cython code score-5 '>          __pyx_t_22 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_22 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4295, __pyx_L1_error)</span>
          __pyx_v_smooth_u = ((__pyx_t_22 * 0.5) * __pyx_v_delta_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4296</span>:                 elif fmax(t_h, t_l) &lt; deadline_tmp:</pre>
<pre class='cython code score-0 '>        __pyx_t_17 = (fmax(__pyx_v_t_h, __pyx_v_t_l) &lt; __pyx_v_deadline_tmp);
        if (__pyx_t_17) {
/* … */
          goto __pyx_L38;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4297</span>:                     smooth_u = (0.5 - random_uniform()) * delta_t</pre>
<pre class='cython code score-5 '>          __pyx_t_22 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_22 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4297, __pyx_L1_error)</span>
          __pyx_v_smooth_u = ((0.5 - __pyx_t_22) * __pyx_v_delta_t);
</pre><pre class="cython line score-0">&#xA0;<span class="">4298</span>:                 else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4299</span>:                     smooth_u = 0.0</pre>
<pre class='cython code score-0 '>        /*else*/ {
          __pyx_v_smooth_u = 0.0;
        }
        __pyx_L38:;
</pre><pre class="cython line score-0">&#xA0;<span class="">4300</span>:             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4301</span>:                 smooth_u = 0.0</pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_v_smooth_u = 0.0;
      }
      __pyx_L37:;
</pre><pre class="cython line score-0">&#xA0;<span class="">4302</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4303</span>:             rts_view[n, k, 0] = fmax(t_h, t_l) + t_view[k]</pre>
<pre class='cython code score-0 '>      __pyx_t_23 = __pyx_v_k;
      __pyx_t_18 = __pyx_v_n;
      __pyx_t_19 = __pyx_v_k;
      __pyx_t_25 = 0;
      *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_18 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_19 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_25 * __pyx_v_rts_view.strides[2]) )) = (fmax(__pyx_v_t_h, __pyx_v_t_l) + (*((float *) ( /* dim=0 */ (__pyx_v_t_view.data + __pyx_t_23 * __pyx_v_t_view.strides[0]) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">4304</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4305</span>:             # The probability of making a 'mistake' 1 - (relative y position)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4306</span>:             # y at upper bound --&gt; choices_view[n, k, 0] add one deterministically</pre>
<pre class="cython line score-0">&#xA0;<span class="">4307</span>:             # y at lower bound --&gt; choice_view[n, k, 0] stays the same deterministically</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4308</span>:             if random_uniform() &lt;= ((y_l + boundary_view[ix]) / (2 * boundary_view[ix])):</pre>
<pre class='cython code score-5 '>      __pyx_t_22 = __pyx_f_4cssm_random_uniform(); if (unlikely(__pyx_t_22 == ((float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4308, __pyx_L1_error)</span>
      __pyx_t_23 = __pyx_v_ix;
      __pyx_t_25 = __pyx_v_ix;
      __pyx_t_17 = (__pyx_t_22 &lt;= ((__pyx_v_y_l + (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_23 * __pyx_v_boundary_view.strides[0]) )))) / (2.0 * (*((float *) ( /* dim=0 */ (__pyx_v_boundary_view.data + __pyx_t_25 * __pyx_v_boundary_view.strides[0]) ))))));
      if (__pyx_t_17) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4309</span>:                 choices_view[n, k, 0] += 1</pre>
<pre class='cython code score-0 '>        __pyx_t_25 = __pyx_v_n;
        __pyx_t_23 = __pyx_v_k;
        __pyx_t_19 = 0;
        *((int *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_choices_view.data + __pyx_t_25 * __pyx_v_choices_view.strides[0]) ) + __pyx_t_23 * __pyx_v_choices_view.strides[1]) ) + __pyx_t_19 * __pyx_v_choices_view.strides[2]) )) += 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">4310</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4311</span>:             if (rts_view[n, k, 0] &gt;= deadline_view[k]) | (deadline_view[k] &lt;= 0):</pre>
<pre class='cython code score-0 '>      __pyx_t_19 = __pyx_v_n;
      __pyx_t_23 = __pyx_v_k;
      __pyx_t_25 = 0;
      __pyx_t_18 = __pyx_v_k;
      __pyx_t_26 = __pyx_v_k;
      __pyx_t_17 = (((*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_19 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_23 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_25 * __pyx_v_rts_view.strides[2]) ))) &gt;= (*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_18 * __pyx_v_deadline_view.strides[0]) )))) | ((*((float *) ( /* dim=0 */ (__pyx_v_deadline_view.data + __pyx_t_26 * __pyx_v_deadline_view.strides[0]) ))) &lt;= 0.0));
      if (__pyx_t_17) {
/* … */
      }
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4312</span>:                 rts_view[n, k, 0] = -999</pre>
<pre class='cython code score-0 '>        __pyx_t_26 = __pyx_v_n;
        __pyx_t_18 = __pyx_v_k;
        __pyx_t_25 = 0;
        *((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rts_view.data + __pyx_t_26 * __pyx_v_rts_view.strides[0]) ) + __pyx_t_18 * __pyx_v_rts_view.strides[1]) ) + __pyx_t_25 * __pyx_v_rts_view.strides[2]) )) = -999.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4313</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4314</span>:     if return_option == 'full':</pre>
<pre class='cython code score-2 '>  __pyx_t_17 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_return_option, __pyx_n_u_full, Py_EQ)); if (unlikely((__pyx_t_17 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4314, __pyx_L1_error)</span>
  if (__pyx_t_17) {
/* … */
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4315</span>:         return {'rts': rts, 'choices': choices, 'metadata': {'vh': vh,</pre>
<pre class='cython code score-20 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4315, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4315, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4315, __pyx_L1_error)</span>
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(11);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4315, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_vh, ((PyObject *)__pyx_v_vh)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4315, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4316</span>:                                                             'vl1': vl1,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_vl1, ((PyObject *)__pyx_v_vl1)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4315, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4317</span>:                                                             'vl2': vl2,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_vl2, ((PyObject *)__pyx_v_vl2)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4315, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4318</span>:                                                             'a': a,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_a, ((PyObject *)__pyx_v_a)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4315, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4319</span>:                                                             'zh': zh,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_zh, ((PyObject *)__pyx_v_zh)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4315, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4320</span>:                                                             'zl1': zl1,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_zl1, ((PyObject *)__pyx_v_zl1)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4315, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4321</span>:                                                             'zl2': zl2,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_zl2, ((PyObject *)__pyx_v_zl2)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4315, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4322</span>:                                                             'd': d,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_d, ((PyObject *)__pyx_v_d)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4315, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4323</span>:                                                             't': t,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_t, ((PyObject *)__pyx_v_t)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4315, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4324</span>:                                                             'deadline': deadline,</pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_deadline, ((PyObject *)__pyx_v_deadline)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4315, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4325</span>:                                                             's': s,</pre>
<pre class='cython code score-11 '>    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_s);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4325, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_u_s, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4315, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_9 = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4326</span>:                                                             **boundary_params,</pre>
<pre class='cython code score-17 '>    if (unlikely(__pyx_v_boundary_params == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
      <span class='error_goto'>__PYX_ERR(0, 4326, __pyx_L1_error)</span>
    }
    if (unlikely(<span class='py_c_api'>PyDict_Update</span>(__pyx_t_9, __pyx_v_boundary_params) &lt; 0)) {
      if (<span class='py_c_api'>PyErr_ExceptionMatches</span>(PyExc_AttributeError)) <span class='pyx_c_api'>__Pyx_RaiseMappingExpectedError</span>(__pyx_v_boundary_params);
      <span class='error_goto'>__PYX_ERR(0, 4326, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4327</span>:                                                             'delta_t': delta_t,</pre>
<pre class='cython code score-11 '>    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_t);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4327, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_u_delta_t, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4327, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4328</span>:                                                             'max_t': max_t,</pre>
<pre class='cython code score-11 '>    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_max_t);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4328, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_u_max_t, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4328, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4329</span>:                                                             'n_samples': n_samples,</pre>
<pre class='cython code score-8 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4329, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_u_n_samples, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4329, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4330</span>:                                                             'n_trials': n_trials,</pre>
<pre class='cython code score-13 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4330, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_u_n_trials, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4330, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_u_simulator, __pyx_n_u_ddm_flexbound_mic2_adj) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4331, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">4331</span>:                                                             'simulator': 'ddm_flexbound_mic2_adj',</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4332</span>:                                                             'boundary_fun_type': boundary_fun.__name__,</pre>
<pre class='cython code score-8 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_boundary_fun, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4332, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_u_boundary_fun_type, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4332, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4333</span>:                                                             'possible_choices': [0, 1, 2, 3],</pre>
<pre class='cython code score-28 '>    __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4333, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_int_0)) <span class='error_goto'>__PYX_ERR(0, 4333, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 4333, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 2, __pyx_int_2)) <span class='error_goto'>__PYX_ERR(0, 4333, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 3, __pyx_int_3)) <span class='error_goto'>__PYX_ERR(0, 4333, __pyx_L1_error)</span>;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_u_possible_choices, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4333, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_u_trajectory, __pyx_kp_u_This_simulator_does_not_yet_allo) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4334, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">4334</span>:                                                             'trajectory': 'This simulator does not yet allow for trajectory simulation',</pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4335</span>:                                                             'boundary': boundary}}</pre>
<pre class='cython code score-11 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_u_boundary, __pyx_v_boundary) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4335, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_metadata, __pyx_t_9) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4315, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_r = __pyx_t_5;
    __pyx_t_5 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4336</span>:     elif return_option == 'minimal':</pre>
<pre class='cython code score-2 '>  __pyx_t_17 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_return_option, __pyx_n_u_minimal, Py_EQ)); if (unlikely((__pyx_t_17 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4336, __pyx_L1_error)</span>
  if (likely(__pyx_t_17)) {
/* … */
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4337</span>:         return {'rts': rts, 'choices': choices, 'metadata': {'simulator': 'ddm_flexbound_mic2_adj',</pre>
<pre class='cython code score-20 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4337, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_rts, __pyx_v_rts) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4337, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_choices, __pyx_v_choices) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4337, __pyx_L1_error)</span>
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 4337, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_u_simulator, __pyx_n_u_ddm_flexbound_mic2_adj) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4337, __pyx_L1_error)</span>
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4338</span>:                                                              'possible_choices': [0, 1, 2, 3],</pre>
<pre class='cython code score-23 '>    __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4338, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_int_0)) <span class='error_goto'>__PYX_ERR(0, 4338, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 4338, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 2, __pyx_int_2)) <span class='error_goto'>__PYX_ERR(0, 4338, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 3, __pyx_int_3)) <span class='error_goto'>__PYX_ERR(0, 4338, __pyx_L1_error)</span>;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_u_possible_choices, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4337, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4339</span>:                                                              'boundary_fun_type': boundary_fun.__name__,</pre>
<pre class='cython code score-8 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_boundary_fun, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4339, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_u_boundary_fun_type, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4337, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4340</span>:                                                              'n_samples': n_samples,</pre>
<pre class='cython code score-8 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4340, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_u_n_samples, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4337, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4341</span>:                                                              'n_trials': n_trials,</pre>
<pre class='cython code score-14 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_trials);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4341, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_u_n_trials, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4337, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_u_metadata, __pyx_t_9) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4337, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_r = __pyx_t_5;
    __pyx_t_5 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4342</span>:                                                              }}</pre>
<pre class="cython line score-0">&#xA0;<span class="">4343</span>:     else:</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4344</span>:         raise ValueError('return_option must be either "full" or "minimal"')</pre>
<pre class='cython code score-5 '>  /*else*/ {
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4344, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_5, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='error_goto'>__PYX_ERR(0, 4344, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">4345</span>: # -----------------------------------------------------------------------------------------------</pre>
</div></body></html>
